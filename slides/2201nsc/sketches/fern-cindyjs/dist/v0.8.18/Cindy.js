/* CindyJS - (C) 2014-2016  The CindyJS Project
 * Mostly licensed under the Apache License 2.0, but subprojects may use different licensing.
 * See https://github.com/CindyJS/CindyJS/tree/412441a5fb5c25d7a4677222e883cde733366807
 * for corresponding sources and their respective licensing conditions.
 */
/*
 npm.im/iphone-inline-video 2.2.2  npm.im/intervalometer  https://github.com/paulmillr/es6-shim
 @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
   and contributors,  MIT License
 es6-shim: v0.35.4
 see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 Details and documentation:
 https://github.com/paulmillr/es6-shim/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(E){var I=0;return function(){return I<E.length?{done:!1,value:E[I++]}:{done:!0}}};$jscomp.arrayIterator=function(E){return{next:$jscomp.arrayIteratorImpl(E)}};$jscomp.makeIterator=function(E){var I="undefined"!=typeof Symbol&&Symbol.iterator&&E[Symbol.iterator];return I?I.call(E):$jscomp.arrayIterator(E)};$jscomp.arrayFromIterator=function(E){for(var I,S=[];!(I=E.next()).done;)S.push(I.value);return S};
$jscomp.arrayFromIterable=function(E){return E instanceof Array?E:$jscomp.arrayFromIterator($jscomp.makeIterator(E))};$jscomp.owns=function(E,I){return Object.prototype.hasOwnProperty.call(E,I)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(E,I,S){if(E==Array.prototype||E==Object.prototype)return E;E[I]=S.value;return E};$jscomp.getGlobal=function(E){E=["object"==typeof globalThis&&globalThis,E,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var I=0;I<E.length;++I){var S=E[I];if(S&&S.Math==Math)return S}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(E,I){var S=$jscomp.propertyToPolyfillSymbol[I];if(null==S)return E[I];S=E[S];return void 0!==S?S:E[I]};
$jscomp.polyfill=function(E,I,S,aa){I&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(E,I,S,aa):$jscomp.polyfillUnisolated(E,I,S,aa))};$jscomp.polyfillUnisolated=function(E,I,S,aa){S=$jscomp.global;E=E.split(".");for(aa=0;aa<E.length-1;aa++){var ba=E[aa];if(!(ba in S))return;S=S[ba]}E=E[E.length-1];aa=S[E];I=I(aa);I!=aa&&null!=I&&$jscomp.defineProperty(S,E,{configurable:!0,writable:!0,value:I})};
$jscomp.polyfillIsolated=function(E,I,S,aa){var ba=E.split(".");E=1===ba.length;aa=ba[0];aa=!E&&aa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var ka=0;ka<ba.length-1;ka++){var ca=ba[ka];if(!(ca in aa))return;aa=aa[ca]}ba=ba[ba.length-1];S=$jscomp.IS_SYMBOL_NATIVE&&"es6"===S?aa[ba]:null;I=I(S);null!=I&&(E?$jscomp.defineProperty($jscomp.polyfills,ba,{configurable:!0,writable:!0,value:I}):I!==S&&(void 0===$jscomp.propertyToPolyfillSymbol[ba]&&(S=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[ba]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(ba):$jscomp.POLYFILL_PREFIX+S+"$"+ba),$jscomp.defineProperty(aa,$jscomp.propertyToPolyfillSymbol[ba],{configurable:!0,writable:!0,value:I})))};$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(E,I){for(var S=1;S<arguments.length;S++){var aa=arguments[S];if(aa)for(var ba in aa)$jscomp.owns(aa,ba)&&(E[ba]=aa[ba])}return E};$jscomp.polyfill("Object.assign",function(E){return E||$jscomp.assign},"es6","es3");
$jscomp.underscoreProtoCanBeSet=function(){var E={a:!0},I={};try{return I.__proto__=E,I.a}catch(S){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(E,I){E.__proto__=I;if(E.__proto__!==I)throw new TypeError(E+" is not extensible");return E}:null;$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(E){if(!(E instanceof Object))throw new TypeError("Iterator result "+E+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(E){this.yieldResult=E};
$jscomp.generator.Context.prototype.throw_=function(E){this.abruptCompletion_={exception:E,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(E){this.abruptCompletion_={return:E};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(E){this.abruptCompletion_={jumpTo:E};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(E,I){this.nextAddress=I;return{value:E}};
$jscomp.generator.Context.prototype.yieldAll=function(E,I){E=$jscomp.makeIterator(E);var S=E.next();$jscomp.generator.ensureIteratorResultIsObject_(S);if(S.done)this.yieldResult=S.value,this.nextAddress=I;else return this.yieldAllIterator_=E,this.yield(S.value,I)};$jscomp.generator.Context.prototype.jumpTo=function(E){this.nextAddress=E};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(E,I){this.catchAddress_=E;void 0!=I&&(this.finallyAddress_=I)};$jscomp.generator.Context.prototype.setFinallyBlock=function(E){this.catchAddress_=0;this.finallyAddress_=E||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(E,I){this.nextAddress=E;this.catchAddress_=I||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(E){this.catchAddress_=E||0;E=this.abruptCompletion_.exception;this.abruptCompletion_=null;return E};$jscomp.generator.Context.prototype.enterFinallyBlock=function(E,I,S){S?this.finallyContexts_[S]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=E||0;this.finallyAddress_=I||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(E,I){I=this.finallyContexts_.splice(I||0)[0];if(I=this.abruptCompletion_=this.abruptCompletion_||I){if(I.isException)return this.jumpToErrorHandler_();void 0!=I.jumpTo&&this.finallyAddress_<I.jumpTo?(this.nextAddress=I.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=E};$jscomp.generator.Context.prototype.forIn=function(E){return new $jscomp.generator.Context.PropertyIterator(E)};
$jscomp.generator.Context.PropertyIterator=function(E){this.object_=E;this.properties_=[];for(var I in E)this.properties_.push(I);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var E=this.properties_.pop();if(E in this.object_)return E}return null};$jscomp.generator.Engine_=function(E){this.context_=new $jscomp.generator.Context;this.program_=E};
$jscomp.generator.Engine_.prototype.next_=function(E){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,E,this.context_.next_);this.context_.next_(E);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(E){this.context_.start_();var I=this.context_.yieldAllIterator_;if(I)return this.yieldAllStep_("return"in I?I["return"]:function(S){return{value:S,done:!0}},E,this.context_.return);this.context_.return(E);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(E){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],E,this.context_.next_);this.context_.throw_(E);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(E,I,S){try{var aa=E.call(this.context_.yieldAllIterator_,I);$jscomp.generator.ensureIteratorResultIsObject_(aa);if(!aa.done)return this.context_.stop_(),aa;var ba=aa.value}catch(ka){return this.context_.yieldAllIterator_=null,this.context_.throw_(ka),this.nextStep_()}this.context_.yieldAllIterator_=null;S.call(this.context_,ba);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var E=this.program_(this.context_);if(E)return this.context_.stop_(),{value:E.value,done:!1}}catch(I){this.context_.yieldResult=void 0,this.context_.throw_(I)}this.context_.stop_();if(this.context_.abruptCompletion_){E=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(E.isException)throw E.exception;return{value:E.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(E){this.next=function(I){return E.next_(I)};this.throw=function(I){return E.throw_(I)};this.return=function(I){return E.return_(I)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(E,I){I=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(I));$jscomp.setPrototypeOf&&E.prototype&&$jscomp.setPrototypeOf(I,E.prototype);return I};
$jscomp.asyncExecutePromiseGenerator=function(E){function I(aa){return E.next(aa)}function S(aa){return E.throw(aa)}return new Promise(function(aa,ba){function ka(ca){ca.done?aa(ca.value):Promise.resolve(ca.value).then(I,S).then(ka,ba)}ka(E.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(E){return $jscomp.asyncExecutePromiseGenerator(E())};$jscomp.asyncExecutePromiseGeneratorProgram=function(E){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(E)))};
$jscomp.initSymbol=function(){};$jscomp.polyfill("Symbol",function(E){if(E)return E;var I=function(ka,ca){this.$jscomp$symbol$id_=ka;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:ca})};I.prototype.toString=function(){return this.$jscomp$symbol$id_};var S="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",aa=0,ba=function(ka){if(this instanceof ba)throw new TypeError("Symbol is not a constructor");return new I(S+(ka||"")+"_"+aa++,ka)};return ba},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(E){if(E)return E;E=Symbol("Symbol.iterator");for(var I="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),S=0;S<I.length;S++){var aa=$jscomp.global[I[S]];"function"===typeof aa&&"function"!=typeof aa.prototype[E]&&$jscomp.defineProperty(aa.prototype,E,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return E},"es6",
"es3");$jscomp.iteratorPrototype=function(E){E={next:E};E[Symbol.iterator]=function(){return this};return E};
$jscomp.polyfill("Promise",function(E){function I(){this.batch_=null}function S(ca){return ca instanceof ba?ca:new ba(function(B,ea){B(ca)})}if(E&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return E;I.prototype.asyncExecute=function(ca){if(null==this.batch_){this.batch_=[];var B=this;this.asyncExecuteFunction(function(){B.executeBatch_()})}this.batch_.push(ca)};
var aa=$jscomp.global.setTimeout;I.prototype.asyncExecuteFunction=function(ca){aa(ca,0)};I.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var ca=this.batch_;this.batch_=[];for(var B=0;B<ca.length;++B){var ea=ca[B];ca[B]=null;try{ea()}catch(Z){this.asyncThrow_(Z)}}}this.batch_=null};I.prototype.asyncThrow_=function(ca){this.asyncExecuteFunction(function(){throw ca;})};var ba=function(ca){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=
!1;var B=this.createResolveAndReject_();try{ca(B.resolve,B.reject)}catch(ea){B.reject(ea)}};ba.prototype.createResolveAndReject_=function(){function ca(Z){return function(fa){ea||(ea=!0,Z.call(B,fa))}}var B=this,ea=!1;return{resolve:ca(this.resolveTo_),reject:ca(this.reject_)}};ba.prototype.resolveTo_=function(ca){if(ca===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(ca instanceof ba)this.settleSameAsPromise_(ca);else{a:switch(typeof ca){case "object":var B=null!=
ca;break a;case "function":B=!0;break a;default:B=!1}B?this.resolveToNonPromiseObj_(ca):this.fulfill_(ca)}};ba.prototype.resolveToNonPromiseObj_=function(ca){var B=void 0;try{B=ca.then}catch(ea){this.reject_(ea);return}"function"==typeof B?this.settleSameAsThenable_(B,ca):this.fulfill_(ca)};ba.prototype.reject_=function(ca){this.settle_(2,ca)};ba.prototype.fulfill_=function(ca){this.settle_(1,ca)};ba.prototype.settle_=function(ca,B){if(0!=this.state_)throw Error("Cannot settle("+ca+", "+B+"): Promise already settled in state"+
this.state_);this.state_=ca;this.result_=B;2===this.state_&&this.scheduleUnhandledRejectionCheck_();this.executeOnSettledCallbacks_()};ba.prototype.scheduleUnhandledRejectionCheck_=function(){var ca=this;aa(function(){if(ca.notifyUnhandledRejection_()){var B=$jscomp.global.console;"undefined"!==typeof B&&B.error(ca.result_)}},1)};ba.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var ca=$jscomp.global.CustomEvent,B=$jscomp.global.Event,ea=$jscomp.global.dispatchEvent;
if("undefined"===typeof ea)return!0;"function"===typeof ca?ca=new ca("unhandledrejection",{cancelable:!0}):"function"===typeof B?ca=new B("unhandledrejection",{cancelable:!0}):(ca=$jscomp.global.document.createEvent("CustomEvent"),ca.initCustomEvent("unhandledrejection",!1,!0,ca));ca.promise=this;ca.reason=this.result_;return ea(ca)};ba.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var ca=0;ca<this.onSettledCallbacks_.length;++ca)ka.asyncExecute(this.onSettledCallbacks_[ca]);
this.onSettledCallbacks_=null}};var ka=new I;ba.prototype.settleSameAsPromise_=function(ca){var B=this.createResolveAndReject_();ca.callWhenSettled_(B.resolve,B.reject)};ba.prototype.settleSameAsThenable_=function(ca,B){var ea=this.createResolveAndReject_();try{ca.call(B,ea.resolve,ea.reject)}catch(Z){ea.reject(Z)}};ba.prototype.then=function(ca,B){function ea(Ra,Za){return"function"==typeof Ra?function(Ga){try{Z(Ra(Ga))}catch(bb){fa(bb)}}:Za}var Z,fa,sa=new ba(function(Ra,Za){Z=Ra;fa=Za});this.callWhenSettled_(ea(ca,
Z),ea(B,fa));return sa};ba.prototype.catch=function(ca){return this.then(void 0,ca)};ba.prototype.callWhenSettled_=function(ca,B){function ea(){switch(Z.state_){case 1:ca(Z.result_);break;case 2:B(Z.result_);break;default:throw Error("Unexpected state: "+Z.state_);}}var Z=this;null==this.onSettledCallbacks_?ka.asyncExecute(ea):this.onSettledCallbacks_.push(ea);this.isRejectionHandled_=!0};ba.resolve=S;ba.reject=function(ca){return new ba(function(B,ea){ea(ca)})};ba.race=function(ca){return new ba(function(B,
ea){for(var Z=$jscomp.makeIterator(ca),fa=Z.next();!fa.done;fa=Z.next())S(fa.value).callWhenSettled_(B,ea)})};ba.all=function(ca){var B=$jscomp.makeIterator(ca),ea=B.next();return ea.done?S([]):new ba(function(Z,fa){function sa(Ga){return function(bb){Ra[Ga]=bb;Za--;0==Za&&Z(Ra)}}var Ra=[],Za=0;do Ra.push(void 0),Za++,S(ea.value).callWhenSettled_(sa(Ra.length-1),fa),ea=B.next();while(!ea.done)})};return ba},"es6","es3");
$jscomp.iteratorFromArray=function(E,I){E instanceof String&&(E+="");var S=0,aa=!1,ba={next:function(){if(!aa&&S<E.length){var ka=S++;return{value:I(ka,E[ka]),done:!1}}aa=!0;return{done:!0,value:void 0}}};ba[Symbol.iterator]=function(){return ba};return ba};$jscomp.polyfill("Array.prototype.keys",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(I){return I})}},"es6","es3");
$jscomp.polyfill("Number.isNaN",function(E){return E?E:function(I){return"number"===typeof I&&isNaN(I)}},"es6","es3");$jscomp.polyfill("Number.isFinite",function(E){return E?E:function(I){return"number"!==typeof I?!1:!isNaN(I)&&Infinity!==I&&-Infinity!==I}},"es6","es3");$jscomp.polyfill("Math.sign",function(E){return E?E:function(I){I=Number(I);return 0===I||isNaN(I)?I:0<I?1:-1}},"es6","es3");$jscomp.polyfill("Number.EPSILON",function(E){return Math.pow(2,-52)},"es6","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.checkStringArgs=function(E,I,S){if(null==E)throw new TypeError("The 'this' value for String.prototype."+S+" must not be null or undefined");if(I instanceof RegExp)throw new TypeError("First argument to String.prototype."+S+" must not be a regular expression");return E+""};
$jscomp.polyfill("String.prototype.startsWith",function(E){return E?E:function(I,S){var aa=$jscomp.checkStringArgs(this,I,"startsWith");I+="";var ba=aa.length,ka=I.length;S=Math.max(0,Math.min(S|0,aa.length));for(var ca=0;ca<ka&&S<ba;)if(aa[S++]!=I[ca++])return!1;return ca>=ka}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(E){return E?E:function(I,S){var aa=$jscomp.checkStringArgs(this,I,"endsWith");I+="";void 0===S&&(S=aa.length);S=Math.max(0,Math.min(S|0,aa.length));for(var ba=I.length;0<ba&&0<S;)if(aa[--S]!=I[--ba])return!1;return 0>=ba}},"es6","es3");$jscomp.polyfill("Object.is",function(E){return E?E:function(I,S){return I===S?0!==I||1/I===1/S:I!==I&&S!==S}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(E){return E?E:function(I,S){var aa=this;aa instanceof String&&(aa=String(aa));var ba=aa.length;S=S||0;for(0>S&&(S=Math.max(S+ba,0));S<ba;S++){var ka=aa[S];if(ka===I||Object.is(ka,I))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(E){return E?E:function(I,S){return-1!==$jscomp.checkStringArgs(this,I,"includes").indexOf(I,S||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(I,S){return S})}},"es8","es3");
$jscomp.polyfill("Array.from",function(E){return E?E:function(I,S,aa){S=null!=S?S:function(B){return B};var ba=[],ka="undefined"!=typeof Symbol&&Symbol.iterator&&I[Symbol.iterator];if("function"==typeof ka){I=ka.call(I);for(var ca=0;!(ka=I.next()).done;)ba.push(S.call(aa,ka.value,ca++))}else for(ka=I.length,ca=0;ca<ka;ca++)ba.push(S.call(aa,I[ca],ca));return ba}},"es6","es3");
$jscomp.polyfill("Array.prototype.entries",function(E){return E?E:function(){return $jscomp.iteratorFromArray(this,function(I,S){return[I,S]})}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(E){return E?E:function(I){return Number.isFinite(I)?I===Math.floor(I):!1}},"es6","es3");$jscomp.findInternal=function(E,I,S){E instanceof String&&(E=String(E));for(var aa=E.length,ba=0;ba<aa;ba++){var ka=E[ba];if(I.call(S,ka,ba,E))return{i:ba,v:ka}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(E){return E?E:function(I,S){return $jscomp.findInternal(this,I,S).v}},"es6","es3");$jscomp.polyfill("Array.prototype.findIndex",function(E){return E?E:function(I,S){return $jscomp.findInternal(this,I,S).i}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(E){return E?E:function(){return[]}},"es6","es5");
$jscomp.polyfill("Math.expm1",function(E){return E?E:function(I){I=Number(I);if(.25>I&&-.25<I){for(var S=I,aa=1,ba=I,ka=0;ka!=ba;)S*=I/++aa,ba=(ka=ba)+S;return ba}return Math.exp(I)-1}},"es6","es3");$jscomp.polyfill("Math.sinh",function(E){if(E)return E;var I=Math.exp;return function(S){S=Number(S);return 0===S?S:(I(S)-I(-S))/2}},"es6","es3");$jscomp.polyfill("Math.cosh",function(E){if(E)return E;var I=Math.exp;return function(S){S=Number(S);return(I(S)+I(-S))/2}},"es6","es3");
$jscomp.polyfill("Math.log1p",function(E){return E?E:function(I){I=Number(I);if(.25>I&&-.25<I){for(var S=I,aa=1,ba=I,ka=0,ca=1;ka!=ba;)S*=I,ca*=-1,ba=(ka=ba)+ca*S/++aa;return ba}return Math.log(1+I)}},"es6","es3");$jscomp.polyfill("Math.asinh",function(E){return E?E:function(I){I=Number(I);if(0===I)return I;var S=Math.log(Math.abs(I)+Math.sqrt(I*I+1));return 0>I?-S:S}},"es6","es3");
$jscomp.polyfill("Math.atanh",function(E){if(E)return E;var I=Math.log1p;return function(S){S=Number(S);return(I(S)-I(-S))/2}},"es6","es3");$jscomp.polyfill("Math.tanh",function(E){return E?E:function(I){I=Number(I);if(0===I)return I;var S=Math.exp(-2*Math.abs(I));S=(1-S)/(1+S);return 0>I?-S:S}},"es6","es3");$jscomp.polyfill("Math.acosh",function(E){return E?E:function(I){I=Number(I);return Math.log(I+Math.sqrt(I*I-1))}},"es6","es3");
$jscomp.polyfill("Math.cbrt",function(E){return E?E:function(I){if(0===I)return I;I=Number(I);var S=Math.pow(Math.abs(I),1/3);return 0>I?-S:S}},"es6","es3");
$jscomp.polyfill("Math.hypot",function(E){return E?E:function(I){if(2>arguments.length)return arguments.length?Math.abs(arguments[0]):0;var S,aa,ba;for(S=ba=0;S<arguments.length;S++)ba=Math.max(ba,Math.abs(arguments[S]));if(1E100<ba||1E-100>ba){if(!ba)return ba;for(S=aa=0;S<arguments.length;S++){var ka=Number(arguments[S])/ba;aa+=ka*ka}return Math.sqrt(aa)*ba}for(S=aa=0;S<arguments.length;S++)ka=Number(arguments[S]),aa+=ka*ka;return Math.sqrt(aa)}},"es6","es3");
$jscomp.polyfill("Math.imul",function(E){return E?E:function(I,S){I=Number(I);S=Number(S);var aa=I&65535,ba=S&65535;return aa*ba+((I>>>16&65535)*ba+aa*(S>>>16&65535)<<16>>>0)|0}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var E={},I=Object.create(new $jscomp.global.Proxy(E,{get:function(S,aa,ba){return S==E&&"q"==aa&&ba==I}}));return!0===I.q}catch(S){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(E){function I(){if(!E||!Object.seal)return!1;try{var Z=Object.seal({}),fa=Object.seal({}),sa=new E([[Z,2],[fa,3]]);if(2!=sa.get(Z)||3!=sa.get(fa))return!1;sa.delete(Z);sa.set(fa,4);return!sa.has(Z)&&4==sa.get(fa)}catch(Ra){return!1}}function S(){}function aa(Z){var fa=typeof Z;return"object"===fa&&null!==Z||"function"===fa}function ba(Z){if(!$jscomp.owns(Z,ca)){var fa=new S;$jscomp.defineProperty(Z,ca,{value:fa})}}function ka(Z){if(!$jscomp.ISOLATE_POLYFILLS){var fa=
Object[Z];fa&&(Object[Z]=function(sa){if(sa instanceof S)return sa;Object.isExtensible(sa)&&ba(sa);return fa(sa)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(E&&$jscomp.ES6_CONFORMANCE)return E}else if(I())return E;var ca="$jscomp_hidden_"+Math.random();ka("freeze");ka("preventExtensions");ka("seal");var B=0,ea=function(Z){this.id_=(B+=Math.random()+1).toString();if(Z){Z=$jscomp.makeIterator(Z);for(var fa;!(fa=Z.next()).done;)fa=fa.value,this.set(fa[0],fa[1])}};ea.prototype.set=function(Z,
fa){if(!aa(Z))throw Error("Invalid WeakMap key");ba(Z);if(!$jscomp.owns(Z,ca))throw Error("WeakMap key fail: "+Z);Z[ca][this.id_]=fa;return this};ea.prototype.get=function(Z){return aa(Z)&&$jscomp.owns(Z,ca)?Z[ca][this.id_]:void 0};ea.prototype.has=function(Z){return aa(Z)&&$jscomp.owns(Z,ca)&&$jscomp.owns(Z[ca],this.id_)};ea.prototype.delete=function(Z){return aa(Z)&&$jscomp.owns(Z,ca)&&$jscomp.owns(Z[ca],this.id_)?delete Z[ca][this.id_]:!1};return ea},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(E){function I(){if($jscomp.ASSUME_NO_NATIVE_MAP||!E||"function"!=typeof E||!E.prototype.entries||"function"!=typeof Object.seal)return!1;try{var ea=Object.seal({x:4}),Z=new E($jscomp.makeIterator([[ea,"s"]]));if("s"!=Z.get(ea)||1!=Z.size||Z.get({x:4})||Z.set({x:4},"t")!=Z||2!=Z.size)return!1;var fa=Z.entries(),sa=fa.next();if(sa.done||sa.value[0]!=ea||"s"!=sa.value[1])return!1;sa=fa.next();return sa.done||4!=sa.value[0].x||"t"!=sa.value[1]||!fa.next().done?!1:!0}catch(Ra){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(E&&$jscomp.ES6_CONFORMANCE)return E}else if(I())return E;var S=new WeakMap,aa=function(ea){this.data_={};this.head_=ca();this.size=0;if(ea){ea=$jscomp.makeIterator(ea);for(var Z;!(Z=ea.next()).done;)Z=Z.value,this.set(Z[0],Z[1])}};aa.prototype.set=function(ea,Z){ea=0===ea?0:ea;var fa=ba(this,ea);fa.list||(fa.list=this.data_[fa.id]=[]);fa.entry?fa.entry.value=Z:(fa.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:ea,value:Z},
fa.list.push(fa.entry),this.head_.previous.next=fa.entry,this.head_.previous=fa.entry,this.size++);return this};aa.prototype.delete=function(ea){ea=ba(this,ea);return ea.entry&&ea.list?(ea.list.splice(ea.index,1),ea.list.length||delete this.data_[ea.id],ea.entry.previous.next=ea.entry.next,ea.entry.next.previous=ea.entry.previous,ea.entry.head=null,this.size--,!0):!1};aa.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=ca();this.size=0};aa.prototype.has=function(ea){return!!ba(this,
ea).entry};aa.prototype.get=function(ea){return(ea=ba(this,ea).entry)&&ea.value};aa.prototype.entries=function(){return ka(this,function(ea){return[ea.key,ea.value]})};aa.prototype.keys=function(){return ka(this,function(ea){return ea.key})};aa.prototype.values=function(){return ka(this,function(ea){return ea.value})};aa.prototype.forEach=function(ea,Z){for(var fa=this.entries(),sa;!(sa=fa.next()).done;)sa=sa.value,ea.call(Z,sa[1],sa[0],this)};aa.prototype[Symbol.iterator]=aa.prototype.entries;var ba=
function(ea,Z){var fa=Z&&typeof Z;"object"==fa||"function"==fa?S.has(Z)?fa=S.get(Z):(fa=""+ ++B,S.set(Z,fa)):fa="p_"+Z;var sa=ea.data_[fa];if(sa&&$jscomp.owns(ea.data_,fa))for(ea=0;ea<sa.length;ea++){var Ra=sa[ea];if(Z!==Z&&Ra.key!==Ra.key||Z===Ra.key)return{id:fa,list:sa,index:ea,entry:Ra}}return{id:fa,list:sa,index:-1,entry:void 0}},ka=function(ea,Z){var fa=ea.head_;return $jscomp.iteratorPrototype(function(){if(fa){for(;fa.head!=ea.head_;)fa=fa.previous;for(;fa.next!=fa.head;)return fa=fa.next,
{done:!1,value:Z(fa)};fa=null}return{done:!0,value:void 0}})},ca=function(){var ea={};return ea.previous=ea.next=ea.head=ea},B=0;return aa},"es6","es3");
$jscomp.polyfill("Set",function(E){function I(){if($jscomp.ASSUME_NO_NATIVE_SET||!E||"function"!=typeof E||!E.prototype.entries||"function"!=typeof Object.seal)return!1;try{var aa=Object.seal({x:4}),ba=new E($jscomp.makeIterator([aa]));if(!ba.has(aa)||1!=ba.size||ba.add(aa)!=ba||1!=ba.size||ba.add({x:4})!=ba||2!=ba.size)return!1;var ka=ba.entries(),ca=ka.next();if(ca.done||ca.value[0]!=aa||ca.value[1]!=aa)return!1;ca=ka.next();return ca.done||ca.value[0]==aa||4!=ca.value[0].x||ca.value[1]!=ca.value[0]?
!1:ka.next().done}catch(B){return!1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(E&&$jscomp.ES6_CONFORMANCE)return E}else if(I())return E;var S=function(aa){this.map_=new Map;if(aa){aa=$jscomp.makeIterator(aa);for(var ba;!(ba=aa.next()).done;)this.add(ba.value)}this.size=this.map_.size};S.prototype.add=function(aa){aa=0===aa?0:aa;this.map_.set(aa,aa);this.size=this.map_.size;return this};S.prototype.delete=function(aa){aa=this.map_.delete(aa);this.size=this.map_.size;return aa};S.prototype.clear=
function(){this.map_.clear();this.size=0};S.prototype.has=function(aa){return this.map_.has(aa)};S.prototype.entries=function(){return this.map_.entries()};S.prototype.values=function(){return this.map_.values()};S.prototype.keys=S.prototype.values;S.prototype[Symbol.iterator]=S.prototype.values;S.prototype.forEach=function(aa,ba){var ka=this;this.map_.forEach(function(ca){return aa.call(ba,ca,ca,ka)})};return S},"es6","es3");
$jscomp.polyfill("Object.setPrototypeOf",function(E){return E||$jscomp.setPrototypeOf},"es6","es5");$jscomp.polyfill("Object.values",function(E){return E?E:function(I){var S=[],aa;for(aa in I)$jscomp.owns(I,aa)&&S.push(I[aa]);return S}},"es8","es3");$jscomp.polyfill("Object.entries",function(E){return E?E:function(I){var S=[],aa;for(aa in I)$jscomp.owns(I,aa)&&S.push([aa,I[aa]]);return S}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(E){return E?E:function(I,S,aa){var ba=this.length||0;0>S&&(S=Math.max(0,ba+S));if(null==aa||aa>ba)aa=ba;aa=Number(aa);0>aa&&(aa=Math.max(0,ba+aa));for(S=Number(S||0);S<aa;S++)this[S]=I;return this}},"es6","es3");$jscomp.typedArrayFill=function(E){return E?E:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
var enableInlineVideo=function(){function E(U,za,Ha,Hb){function Nb(Cb){Db=za(Nb,Hb);U(Cb-(Ib||Cb));Ib=Cb}var Db,Ib;return{start:function(){Db||Nb(0)},stop:function(){Ha(Db);Db=null;Ib=0}}}function I(U,za,Ha){function Hb(Nb){Ha&&!Ha(U,za)||Nb.stopImmediatePropagation()}return U.addEventListener(za,Hb),Hb}function S(U,za,Ha,Hb){function Nb(Db){Ha[za]=Db}Hb&&Nb(U[za]);Object.defineProperty(U,za,{get:function(){return Ha[za]},set:Nb})}function aa(U,za,Ha){Ha.addEventListener(za,function(){return U.dispatchEvent(new Event(za))})}
function ba(U,za){Promise.resolve().then(function(){U.dispatchEvent(new Event(za))})}function ka(U){var za=new Audio;return aa(U,"play",za),aa(U,"playing",za),aa(U,"pause",za),za.crossOrigin=U.crossOrigin,za.src=U.src||U.currentSrc||"data:",za}function ca(U,za,Ha){(Za||0)+200<Date.now()&&(U[ob]=!0,Za=Date.now());Ha||(U.currentTime=za);cb[++gb%3]=100*za|0}function B(U){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=this.video.currentTime+U*this.video.playbackRate/
1E3,this.video.loop&&this.driver.currentTime>=this.video.duration&&(this.driver.currentTime=0)),ca(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&0===this.video.buffered.length&&this.video.load();this.video.ended&&(delete this.video[ob],this.video.pause(!0))}function ea(){var U=this[bb];if(this.webkitDisplayingFullscreen)return void this[r]();"data:"!==U.driver.src&&U.driver.src!==this.src&&(ca(this,0,!0),U.driver.src=this.src);this.paused&&(U.paused=!1,0===
this.buffered.length&&this.load(),U.driver.play(),U.updater.start(),U.hasAudio||(ba(this,"play"),U.video.readyState>=U.video.HAVE_ENOUGH_DATA&&ba(this,"playing")))}function Z(U){var za=this[bb];za.driver.pause();za.updater.stop();this.webkitDisplayingFullscreen&&this[$a]();za.paused&&!U||(za.paused=!0,za.hasAudio||ba(this,"pause"),this.ended&&!this.webkitDisplayingFullscreen&&(this[ob]=!0,ba(this,"ended")))}function fa(U,za){var Ha={};U[bb]=Ha;Ha.paused=!0;Ha.hasAudio=za;Ha.video=U;Ha.updater=E(B.bind(Ha),
requestAnimationFrame,cancelAnimationFrame);za?Ha.driver=ka(U):(U.addEventListener("canplay",function(){U.paused||ba(U,"playing")}),Ha.driver={src:U.src||U.currentSrc||"data:",muted:!0,paused:!0,pause:function(){Ha.driver.paused=!0},play:function(){Ha.driver.paused=!1;Ha.driver.currentTime>=Ha.video.duration&&ca(U,0)},get ended(){return Ha.driver.currentTime>=Ha.video.duration}});U.addEventListener("emptied",function(){var Hb=!Ha.driver.src||"data:"===Ha.driver.src;Ha.driver.src&&Ha.driver.src!==
U.src&&(ca(U,0,!0),Ha.driver.src=U.src,Hb||!za&&U.autoplay?Ha.driver.play():Ha.updater.stop())},!1);U.addEventListener("webkitbeginfullscreen",function(){U.paused?za&&0===Ha.driver.buffered.length&&Ha.driver.load():(U.pause(),U[r]())});za&&(U.addEventListener("webkitendfullscreen",function(){Ha.driver.currentTime=U.currentTime}),U.addEventListener("seeking",function(){0>cb.indexOf(100*U.currentTime|0)&&(Ha.driver.currentTime=U.currentTime)}))}function sa(U){var za=U[ob];return delete U[ob],!U.webkitDisplayingFullscreen&&
!za}function Ra(U){var za=U[bb];U[r]=U.play;U[$a]=U.pause;U.play=ea;U.pause=Z;S(U,"paused",za.driver);S(U,"muted",za.driver,!0);S(U,"playbackRate",za.driver,!0);S(U,"ended",za.driver);S(U,"loop",za.driver,!0);I(U,"seeking",function(Ha){return!Ha.webkitDisplayingFullscreen});I(U,"seeked",function(Ha){return!Ha.webkitDisplayingFullscreen});I(U,"timeupdate",sa);I(U,"ended",sa)}var Za,Ga="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,
bb="bfred-it:iphone-inline-video",ob="bfred-it:iphone-inline-video:event",r="bfred-it:iphone-inline-video:nativeplay",$a="bfred-it:iphone-inline-video:nativepause",cb=[],gb=0;return function(U,za){if(void 0===za&&(za={}),!U[bb])if(za.everywhere||Ga&&(za.iPad||za.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))U.pause(),za=U.autoplay,U.autoplay=!1,fa(U,!U.muted),Ra(U),U.classList.add("IIV"),U.muted&&za&&(U.play(),U.addEventListener("playing",function Hb(){U.autoplay=!0;U.removeEventListener("playing",
Hb)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}();
(function(){function E(e,g,l){r.biginteger_used=1;null!=e&&("number"==typeof e&&"undefined"==typeof g?this.fromInt(e):"number"==typeof e?this.fromNumber(e,g,l):null==g&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,g))}function I(){return new E(null,void 0,void 0)}function S(e,g,l,q,x,G){for(;0<=--G;){var L=g*this[e++]+l[q]+x;x=Math.floor(L/67108864);l[q++]=L&67108863}return x}function aa(e,g,l,q,x,G){var L=g&32767;for(g>>=15;0<=--G;){var Y=this[e]&32767,ja=this[e++]>>15,pa=g*Y+ja*L;
Y=L*Y+((pa&32767)<<15)+l[q]+(x&1073741823);x=(Y>>>30)+(pa>>>15)+g*ja+(x>>>30);l[q++]=Y&1073741823}return x}function ba(e,g,l,q,x,G){var L=g&16383;for(g>>=14;0<=--G;){var Y=this[e]&16383,ja=this[e++]>>14,pa=g*Y+ja*L;Y=L*Y+((pa&16383)<<14)+l[q]+x;x=(Y>>28)+(pa>>14)+g*ja;l[q++]=Y&268435455}return x}function ka(e,g){e=Ib[e.charCodeAt(g)];return null==e?-1:e}function ca(e){var g=I();g.fromInt(e);return g}function B(e){var g=1,l;0!=(l=e>>>16)&&(e=l,g+=16);0!=(l=e>>8)&&(e=l,g+=8);0!=(l=e>>4)&&(e=l,g+=4);
0!=(l=e>>2)&&(e=l,g+=2);0!=e>>1&&(g+=1);return g}function ea(e){this.m=e}function Z(e){this.m=e;this.mp=e.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<e.DB-15)-1;this.mt2=2*e.t}function fa(e,g){return e&g}function sa(e,g){return e|g}function Ra(e,g){return e^g}function Za(e,g){return e&~g}function Ga(){}function bb(e){return e}function ob(e){this.r2=I();this.q3=I();E.ONE.dlShiftTo(2*e.t,this.r2);this.mu=this.r2.divide(e);this.m=e}var r={use_lines:!0,use_xyz:!1},$a=!1;"undefined"!==
typeof module&&module.exports?(module.exports=r,$a=!0):"undefined"!==typeof document?window.ClipperLib=r:self.ClipperLib=r;if($a){gb="chrome";var cb="Netscape"}else{var gb=navigator.userAgent.toString().toLowerCase();cb=navigator.appName}var U=-1!=gb.indexOf("chrome")&&-1==gb.indexOf("chromium")?1:0;$a=-1!=gb.indexOf("chromium")?1:0;var za=-1!=gb.indexOf("safari")&&-1==gb.indexOf("chrome")&&-1==gb.indexOf("chromium")?1:0;var Ha=-1!=gb.indexOf("firefox")?1:0;gb.indexOf("firefox/17");gb.indexOf("firefox/15");
gb.indexOf("firefox/3");var Hb=-1!=gb.indexOf("opera")?1:0;gb.indexOf("msie 10");gb.indexOf("msie 9");var Nb=-1!=gb.indexOf("msie 8")?1:0;var Db=-1!=gb.indexOf("msie 7")?1:0;gb=-1!=gb.indexOf("msie ")?1:0;r.biginteger_used=null;"Microsoft Internet Explorer"==cb?(E.prototype.am=aa,cb=30):"Netscape"!=cb?(E.prototype.am=S,cb=26):(E.prototype.am=ba,cb=28);E.prototype.DB=cb;E.prototype.DM=(1<<cb)-1;E.prototype.DV=1<<cb;E.prototype.FV=Math.pow(2,52);E.prototype.F1=52-cb;E.prototype.F2=2*cb-52;var Ib=[],
Cb;cb=48;for(Cb=0;9>=Cb;++Cb)Ib[cb++]=Cb;cb=97;for(Cb=10;36>Cb;++Cb)Ib[cb++]=Cb;cb=65;for(Cb=10;36>Cb;++Cb)Ib[cb++]=Cb;ea.prototype.convert=function(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e};ea.prototype.revert=function(e){return e};ea.prototype.reduce=function(e){e.divRemTo(this.m,null,e)};ea.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};ea.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};Z.prototype.convert=function(e){var g=I();e.abs().dlShiftTo(this.m.t,
g);g.divRemTo(this.m,null,g);0>e.s&&0<g.compareTo(E.ZERO)&&this.m.subTo(g,g);return g};Z.prototype.revert=function(e){var g=I();e.copyTo(g);this.reduce(g);return g};Z.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var g=0;g<this.m.t;++g){var l=e[g]&32767,q=l*this.mpl+((l*this.mph+(e[g]>>15)*this.mpl&this.um)<<15)&e.DM;l=g+this.m.t;for(e[l]+=this.m.am(0,q,e,g,0,this.m.t);e[l]>=e.DV;)e[l]-=e.DV,e[++l]++}e.clamp();e.drShiftTo(this.m.t,e);0<=e.compareTo(this.m)&&e.subTo(this.m,e)};Z.prototype.mulTo=
function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};Z.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};E.prototype.copyTo=function(e){for(var g=this.t-1;0<=g;--g)e[g]=this[g];e.t=this.t;e.s=this.s};E.prototype.fromInt=function(e){this.t=1;this.s=0>e?-1:0;0<e?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0};E.prototype.fromString=function(e,g){if(16==g)g=4;else if(8==g)g=3;else if(256==g)g=8;else if(2==g)g=1;else if(32==g)g=5;else if(4==g)g=2;else{this.fromRadix(e,g);return}this.s=this.t=0;for(var l=
e.length,q=!1,x=0;0<=--l;){var G=8==g?e[l]&255:ka(e,l);0>G?"-"==e.charAt(l)&&(q=!0):(q=!1,0==x?this[this.t++]=G:x+g>this.DB?(this[this.t-1]|=(G&(1<<this.DB-x)-1)<<x,this[this.t++]=G>>this.DB-x):this[this.t-1]|=G<<x,x+=g,x>=this.DB&&(x-=this.DB))}8==g&&0!=(e[0]&128)&&(this.s=-1,0<x&&(this[this.t-1]|=(1<<this.DB-x)-1<<x));this.clamp();q&&E.ZERO.subTo(this,this)};E.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t};E.prototype.dlShiftTo=function(e,g){var l;for(l=
this.t-1;0<=l;--l)g[l+e]=this[l];for(l=e-1;0<=l;--l)g[l]=0;g.t=this.t+e;g.s=this.s};E.prototype.drShiftTo=function(e,g){for(var l=e;l<this.t;++l)g[l-e]=this[l];g.t=Math.max(this.t-e,0);g.s=this.s};E.prototype.lShiftTo=function(e,g){var l=e%this.DB,q=this.DB-l,x=(1<<q)-1;e=Math.floor(e/this.DB);var G=this.s<<l&this.DM,L;for(L=this.t-1;0<=L;--L)g[L+e+1]=this[L]>>q|G,G=(this[L]&x)<<l;for(L=e-1;0<=L;--L)g[L]=0;g[e]=G;g.t=this.t+e+1;g.s=this.s;g.clamp()};E.prototype.rShiftTo=function(e,g){g.s=this.s;var l=
Math.floor(e/this.DB);if(l>=this.t)g.t=0;else{e%=this.DB;var q=this.DB-e,x=(1<<e)-1;g[0]=this[l]>>e;for(var G=l+1;G<this.t;++G)g[G-l-1]|=(this[G]&x)<<q,g[G-l]=this[G]>>e;0<e&&(g[this.t-l-1]|=(this.s&x)<<q);g.t=this.t-l;g.clamp()}};E.prototype.subTo=function(e,g){for(var l=0,q=0,x=Math.min(e.t,this.t);l<x;)q+=this[l]-e[l],g[l++]=q&this.DM,q>>=this.DB;if(e.t<this.t){for(q-=e.s;l<this.t;)q+=this[l],g[l++]=q&this.DM,q>>=this.DB;q+=this.s}else{for(q+=this.s;l<e.t;)q-=e[l],g[l++]=q&this.DM,q>>=this.DB;
q-=e.s}g.s=0>q?-1:0;-1>q?g[l++]=this.DV+q:0<q&&(g[l++]=q);g.t=l;g.clamp()};E.prototype.multiplyTo=function(e,g){var l=this.abs(),q=e.abs(),x=l.t;for(g.t=x+q.t;0<=--x;)g[x]=0;for(x=0;x<q.t;++x)g[x+l.t]=l.am(0,q[x],g,x,0,l.t);g.s=0;g.clamp();this.s!=e.s&&E.ZERO.subTo(g,g)};E.prototype.squareTo=function(e){for(var g=this.abs(),l=e.t=2*g.t;0<=--l;)e[l]=0;for(l=0;l<g.t-1;++l){var q=g.am(l,g[l],e,2*l,0,1);(e[l+g.t]+=g.am(l+1,2*g[l],e,2*l+1,q,g.t-l-1))>=g.DV&&(e[l+g.t]-=g.DV,e[l+g.t+1]=1)}0<e.t&&(e[e.t-
1]+=g.am(l,g[l],e,2*l,0,1));e.s=0;e.clamp()};E.prototype.divRemTo=function(e,g,l){var q=e.abs();if(!(0>=q.t)){var x=this.abs();if(x.t<q.t)null!=g&&g.fromInt(0),null!=l&&this.copyTo(l);else{null==l&&(l=I());var G=I(),L=this.s;e=e.s;var Y=this.DB-B(q[q.t-1]);0<Y?(q.lShiftTo(Y,G),x.lShiftTo(Y,l)):(q.copyTo(G),x.copyTo(l));q=G.t;x=G[q-1];if(0!=x){var ja=x*(1<<this.F1)+(1<q?G[q-2]>>this.F2:0),pa=this.FV/ja;ja=(1<<this.F1)/ja;var Ma=1<<this.F2,ab=l.t,qa=ab-q,yb=null==g?I():g;G.dlShiftTo(qa,yb);0<=l.compareTo(yb)&&
(l[l.t++]=1,l.subTo(yb,l));E.ONE.dlShiftTo(q,yb);for(yb.subTo(G,G);G.t<q;)G[G.t++]=0;for(;0<=--qa;){var Va=l[--ab]==x?this.DM:Math.floor(l[ab]*pa+(l[ab-1]+Ma)*ja);if((l[ab]+=G.am(0,Va,l,qa,0,q))<Va)for(G.dlShiftTo(qa,yb),l.subTo(yb,l);l[ab]<--Va;)l.subTo(yb,l)}null!=g&&(l.drShiftTo(q,g),L!=e&&E.ZERO.subTo(g,g));l.t=q;l.clamp();0<Y&&l.rShiftTo(Y,l);0>L&&E.ZERO.subTo(l,l)}}}};E.prototype.invDigit=function(){if(1>this.t)return 0;var e=this[0];if(0==(e&1))return 0;var g=e&3;g=g*(2-(e&15)*g)&15;g=g*(2-
(e&255)*g)&255;g=g*(2-((e&65535)*g&65535))&65535;g=g*(2-e*g%this.DV)%this.DV;return 0<g?this.DV-g:-g};E.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};E.prototype.exp=function(e,g){if(4294967295<e||1>e)return E.ONE;var l=I(),q=I(),x=g.convert(this),G=B(e)-1;for(x.copyTo(l);0<=--G;)if(g.sqrTo(l,q),0<(e&1<<G))g.mulTo(q,x,l);else{var L=l;l=q;q=L}return g.revert(l)};E.prototype.toString=function(e){if(0>this.s)return"-"+this.negate().toString(e);if(16==e)e=4;else if(8==e)e=3;else if(2==
e)e=1;else if(32==e)e=5;else if(4==e)e=2;else return this.toRadix(e);var g=(1<<e)-1,l,q=!1,x="",G=this.t,L=this.DB-G*this.DB%e;if(0<G--)for(L<this.DB&&0<(l=this[G]>>L)&&(q=!0,x="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));0<=G;)L<e?(l=(this[G]&(1<<L)-1)<<e-L,l|=this[--G]>>(L+=this.DB-e)):(l=this[G]>>(L-=e)&g,0>=L&&(L+=this.DB,--G)),0<l&&(q=!0),q&&(x+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(l));return q?x:"0"};E.prototype.negate=function(){var e=I();E.ZERO.subTo(this,e);return e};E.prototype.abs=
function(){return 0>this.s?this.negate():this};E.prototype.compareTo=function(e){var g=this.s-e.s;if(0!=g)return g;var l=this.t;g=l-e.t;if(0!=g)return 0>this.s?-g:g;for(;0<=--l;)if(0!=(g=this[l]-e[l]))return g;return 0};E.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+B(this[this.t-1]^this.s&this.DM)};E.prototype.mod=function(e){var g=I();this.abs().divRemTo(e,null,g);0>this.s&&0<g.compareTo(E.ZERO)&&e.subTo(g,g);return g};E.prototype.modPowInt=function(e,g){g=256>e||g.isEven()?
new ea(g):new Z(g);return this.exp(e,g)};E.ZERO=ca(0);E.ONE=ca(1);Ga.prototype.convert=bb;Ga.prototype.revert=bb;Ga.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l)};Ga.prototype.sqrTo=function(e,g){e.squareTo(g)};ob.prototype.convert=function(e){if(0>e.s||e.t>2*this.m.t)return e.mod(this.m);if(0>e.compareTo(this.m))return e;var g=I();e.copyTo(g);this.reduce(g);return g};ob.prototype.revert=function(e){return e};ob.prototype.reduce=function(e){e.drShiftTo(this.m.t-1,this.r2);e.t>this.m.t+1&&(e.t=
this.m.t+1,e.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)};ob.prototype.mulTo=function(e,g,l){e.multiplyTo(g,l);this.reduce(l)};ob.prototype.sqrTo=function(e,g){e.squareTo(g);this.reduce(g)};var zb=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,
157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,
967,971,977,983,991,997],pd=67108864/zb[zb.length-1];E.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))};E.prototype.toRadix=function(e){null==e&&(e=10);if(0==this.signum()||2>e||36<e)return"0";var g=this.chunkSize(e);g=Math.pow(e,g);var l=ca(g),q=I(),x=I(),G="";for(this.divRemTo(l,q,x);0<q.signum();)G=(g+x.intValue()).toString(e).substr(1)+G,q.divRemTo(l,q,x);return x.intValue().toString(e)+G};E.prototype.fromRadix=function(e,g){this.fromInt(0);null==g&&(g=10);for(var l=
this.chunkSize(g),q=Math.pow(g,l),x=!1,G=0,L=0,Y=0;Y<e.length;++Y){var ja=ka(e,Y);0>ja?"-"==e.charAt(Y)&&0==this.signum()&&(x=!0):(L=g*L+ja,++G>=l&&(this.dMultiply(q),this.dAddOffset(L,0),L=G=0))}0<G&&(this.dMultiply(Math.pow(g,G)),this.dAddOffset(L,0));x&&E.ZERO.subTo(this,this)};E.prototype.fromNumber=function(e,g,l){if("number"==typeof g)if(2>e)this.fromInt(1);else for(this.fromNumber(e,l),this.testBit(e-1)||this.bitwiseTo(E.ONE.shiftLeft(e-1),sa,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(g);)this.dAddOffset(2,
0),this.bitLength()>e&&this.subTo(E.ONE.shiftLeft(e-1),this);else{l=[];var q=e&7;l.length=(e>>3)+1;g.nextBytes(l);l[0]=0<q?l[0]&(1<<q)-1:0;this.fromString(l,256)}};E.prototype.bitwiseTo=function(e,g,l){var q,x=Math.min(e.t,this.t);for(q=0;q<x;++q)l[q]=g(this[q],e[q]);if(e.t<this.t){var G=e.s&this.DM;for(q=x;q<this.t;++q)l[q]=g(this[q],G);l.t=this.t}else{G=this.s&this.DM;for(q=x;q<e.t;++q)l[q]=g(G,e[q]);l.t=e.t}l.s=g(this.s,e.s);l.clamp()};E.prototype.changeBit=function(e,g){e=E.ONE.shiftLeft(e);this.bitwiseTo(e,
g,e);return e};E.prototype.addTo=function(e,g){for(var l=0,q=0,x=Math.min(e.t,this.t);l<x;)q+=this[l]+e[l],g[l++]=q&this.DM,q>>=this.DB;if(e.t<this.t){for(q+=e.s;l<this.t;)q+=this[l],g[l++]=q&this.DM,q>>=this.DB;q+=this.s}else{for(q+=this.s;l<e.t;)q+=e[l],g[l++]=q&this.DM,q>>=this.DB;q+=e.s}g.s=0>q?-1:0;0<q?g[l++]=q:-1>q&&(g[l++]=this.DV+q);g.t=l;g.clamp()};E.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t);++this.t;this.clamp()};E.prototype.dAddOffset=function(e,g){if(0!=
e){for(;this.t<=g;)this[this.t++]=0;for(this[g]+=e;this[g]>=this.DV;)this[g]-=this.DV,++g>=this.t&&(this[this.t++]=0),++this[g]}};E.prototype.multiplyLowerTo=function(e,g,l){var q=Math.min(this.t+e.t,g);l.s=0;for(l.t=q;0<q;)l[--q]=0;var x;for(x=l.t-this.t;q<x;++q)l[q+this.t]=this.am(0,e[q],l,q,0,this.t);for(x=Math.min(e.t,g);q<x;++q)this.am(0,e[q],l,q,0,g-q);l.clamp()};E.prototype.multiplyUpperTo=function(e,g,l){--g;var q=l.t=this.t+e.t-g;for(l.s=0;0<=--q;)l[q]=0;for(q=Math.max(g-this.t,0);q<e.t;++q)l[this.t+
q-g]=this.am(g-q,e[q],l,0,0,this.t+q-g);l.clamp();l.drShiftTo(1,l)};E.prototype.modInt=function(e){if(0>=e)return 0;var g=this.DV%e,l=0>this.s?e-1:0;if(0<this.t)if(0==g)l=this[0]%e;else for(var q=this.t-1;0<=q;--q)l=(g*l+this[q])%e;return l};E.prototype.millerRabin=function(e){var g=this.subtract(E.ONE),l=g.getLowestSetBit();if(0>=l)return!1;var q=g.shiftRight(l);e=e+1>>1;e>zb.length&&(e=zb.length);for(var x=I(),G=0;G<e;++G){x.fromInt(zb[Math.floor(Math.random()*zb.length)]);var L=x.modPow(q,this);
if(0!=L.compareTo(E.ONE)&&0!=L.compareTo(g)){for(var Y=1;Y++<l&&0!=L.compareTo(g);)if(L=L.modPowInt(2,this),0==L.compareTo(E.ONE))return!1;if(0!=L.compareTo(g))return!1}}return!0};E.prototype.clone=function(){var e=I();this.copyTo(e);return e};E.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};E.prototype.byteValue=function(){return 0==this.t?
this.s:this[0]<<24>>24};E.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};E.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};E.prototype.toByteArray=function(){var e=this.t,g=[];g[0]=this.s;var l=this.DB-e*this.DB%8,q,x=0;if(0<e--)for(l<this.DB&&(q=this[e]>>l)!=(this.s&this.DM)>>l&&(g[x++]=q|this.s<<this.DB-l);0<=e;)if(8>l?(q=(this[e]&(1<<l)-1)<<8-l,q|=this[--e]>>(l+=this.DB-8)):(q=this[e]>>(l-=8)&255,0>=l&&(l+=this.DB,--e)),0!=(q&128)&&
(q|=-256),0==x&&(this.s&128)!=(q&128)&&++x,0<x||q!=this.s)g[x++]=q;return g};E.prototype.equals=function(e){return 0==this.compareTo(e)};E.prototype.min=function(e){return 0>this.compareTo(e)?this:e};E.prototype.max=function(e){return 0<this.compareTo(e)?this:e};E.prototype.and=function(e){var g=I();this.bitwiseTo(e,fa,g);return g};E.prototype.or=function(e){var g=I();this.bitwiseTo(e,sa,g);return g};E.prototype.xor=function(e){var g=I();this.bitwiseTo(e,Ra,g);return g};E.prototype.andNot=function(e){var g=
I();this.bitwiseTo(e,Za,g);return g};E.prototype.not=function(){for(var e=I(),g=0;g<this.t;++g)e[g]=this.DM&~this[g];e.t=this.t;e.s=~this.s;return e};E.prototype.shiftLeft=function(e){var g=I();0>e?this.rShiftTo(-e,g):this.lShiftTo(e,g);return g};E.prototype.shiftRight=function(e){var g=I();0>e?this.lShiftTo(-e,g):this.rShiftTo(e,g);return g};E.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e]){var g=e*this.DB;e=this[e];if(0==e)e=-1;else{var l=0;0==(e&65535)&&(e>>=16,l+=
16);0==(e&255)&&(e>>=8,l+=8);0==(e&15)&&(e>>=4,l+=4);0==(e&3)&&(e>>=2,l+=2);0==(e&1)&&++l;e=l}return g+e}return 0>this.s?this.t*this.DB:-1};E.prototype.bitCount=function(){for(var e=0,g=this.s&this.DM,l=0;l<this.t;++l){for(var q=this[l]^g,x=0;0!=q;)q&=q-1,++x;e+=x}return e};E.prototype.testBit=function(e){var g=Math.floor(e/this.DB);return g>=this.t?0!=this.s:0!=(this[g]&1<<e%this.DB)};E.prototype.setBit=function(e){return this.changeBit(e,sa)};E.prototype.clearBit=function(e){return this.changeBit(e,
Za)};E.prototype.flipBit=function(e){return this.changeBit(e,Ra)};E.prototype.add=function(e){var g=I();this.addTo(e,g);return g};E.prototype.subtract=function(e){var g=I();this.subTo(e,g);return g};E.prototype.multiply=function(e){var g=I();this.multiplyTo(e,g);return g};E.prototype.divide=function(e){var g=I();this.divRemTo(e,g,null);return g};E.prototype.remainder=function(e){var g=I();this.divRemTo(e,null,g);return g};E.prototype.divideAndRemainder=function(e){var g=I(),l=I();this.divRemTo(e,
g,l);return[g,l]};E.prototype.modPow=function(e,g){var l=e.bitLength(),q=ca(1);if(0>=l)return q;var x=18>l?1:48>l?3:144>l?4:768>l?5:6;g=8>l?new ea(g):g.isEven()?new ob(g):new Z(g);var G=[],L=3,Y=x-1,ja=(1<<x)-1;G[1]=g.convert(this);if(1<x)for(l=I(),g.sqrTo(G[1],l);L<=ja;)G[L]=I(),g.mulTo(l,G[L-2],G[L]),L+=2;var pa=e.t-1,Ma,ab=!0,qa=I();for(l=B(e[pa])-1;0<=pa;){l>=Y?Ma=e[pa]>>l-Y&ja:(Ma=(e[pa]&(1<<l+1)-1)<<Y-l,0<pa&&(Ma|=e[pa-1]>>this.DB+l-Y));for(L=x;0==(Ma&1);)Ma>>=1,--L;0>(l-=L)&&(l+=this.DB,--pa);
if(ab)G[Ma].copyTo(q),ab=!1;else{for(;1<L;)g.sqrTo(q,qa),g.sqrTo(qa,q),L-=2;0<L?g.sqrTo(q,qa):(L=q,q=qa,qa=L);g.mulTo(qa,G[Ma],q)}for(;0<=pa&&0==(e[pa]&1<<l);)g.sqrTo(q,qa),L=q,q=qa,qa=L,0>--l&&(l=this.DB-1,--pa)}return g.revert(q)};E.prototype.modInverse=function(e){var g=e.isEven();if(this.isEven()&&g||0==e.signum())return E.ZERO;for(var l=e.clone(),q=this.clone(),x=ca(1),G=ca(0),L=ca(0),Y=ca(1);0!=l.signum();){for(;l.isEven();)l.rShiftTo(1,l),g?(x.isEven()&&G.isEven()||(x.addTo(this,x),G.subTo(e,
G)),x.rShiftTo(1,x)):G.isEven()||G.subTo(e,G),G.rShiftTo(1,G);for(;q.isEven();)q.rShiftTo(1,q),g?(L.isEven()&&Y.isEven()||(L.addTo(this,L),Y.subTo(e,Y)),L.rShiftTo(1,L)):Y.isEven()||Y.subTo(e,Y),Y.rShiftTo(1,Y);0<=l.compareTo(q)?(l.subTo(q,l),g&&x.subTo(L,x),G.subTo(Y,G)):(q.subTo(l,q),g&&L.subTo(x,L),Y.subTo(G,Y))}if(0!=q.compareTo(E.ONE))return E.ZERO;if(0<=Y.compareTo(e))return Y.subtract(e);if(0>Y.signum())Y.addTo(e,Y);else return Y;return 0>Y.signum()?Y.add(e):Y};E.prototype.pow=function(e){return this.exp(e,
new Ga)};E.prototype.gcd=function(e){var g=0>this.s?this.negate():this.clone();e=0>e.s?e.negate():e.clone();if(0>g.compareTo(e)){var l=g;g=e;e=l}l=g.getLowestSetBit();var q=e.getLowestSetBit();if(0>q)return g;l<q&&(q=l);for(0<q&&(g.rShiftTo(q,g),e.rShiftTo(q,e));0<g.signum();)0<(l=g.getLowestSetBit())&&g.rShiftTo(l,g),0<(l=e.getLowestSetBit())&&e.rShiftTo(l,e),0<=g.compareTo(e)?(g.subTo(e,g),g.rShiftTo(1,g)):(e.subTo(g,e),e.rShiftTo(1,e));0<q&&e.lShiftTo(q,e);return e};E.prototype.isProbablePrime=
function(e){var g,l=this.abs();if(1==l.t&&l[0]<=zb[zb.length-1]){for(g=0;g<zb.length;++g)if(l[0]==zb[g])return!0;return!1}if(l.isEven())return!1;for(g=1;g<zb.length;){for(var q=zb[g],x=g+1;x<zb.length&&q<pd;)q*=zb[x++];for(q=l.modInt(q);g<x;)if(0==q%zb[g++])return!1}return l.millerRabin(e)};E.prototype.square=function(){var e=I();this.squareTo(e);return e};E.prototype.IsNegative=function(){return-1==this.compareTo(E.ZERO)?!0:!1};E.op_Equality=function(e,g){return 0==e.compareTo(g)?!0:!1};E.op_Inequality=
function(e,g){return 0!=e.compareTo(g)?!0:!1};E.op_GreaterThan=function(e,g){return 0<e.compareTo(g)?!0:!1};E.op_LessThan=function(e,g){return 0>e.compareTo(g)?!0:!1};E.op_Addition=function(e,g){return(new E(e)).add(new E(g))};E.op_Subtraction=function(e,g){return(new E(e)).subtract(new E(g))};E.Int128Mul=function(e,g){return(new E(e)).multiply(new E(g))};E.op_Division=function(e,g){return e.divide(g)};E.prototype.ToDouble=function(){return parseFloat(this.toString())};cb=function(e,g){var l;if("undefined"==
typeof Object.getOwnPropertyNames)for(l in g.prototype){if("undefined"==typeof e.prototype[l]||e.prototype[l]==Object.prototype[l])e.prototype[l]=g.prototype[l]}else for(var q=Object.getOwnPropertyNames(g.prototype),x=0;x<q.length;x++)"undefined"==typeof Object.getOwnPropertyDescriptor(e.prototype,q[x])&&Object.defineProperty(e.prototype,q[x],Object.getOwnPropertyDescriptor(g.prototype,q[x]));for(l in g)"undefined"==typeof e[l]&&(e[l]=g[l]);e.$baseCtor=g};r.Path=function(){return[]};r.Paths=function(){return[]};
r.DoublePoint=function(){var e=arguments;this.Y=this.X=0;1==e.length?(this.X=e[0].X,this.Y=e[0].Y):2==e.length&&(this.X=e[0],this.Y=e[1])};r.DoublePoint0=function(){this.Y=this.X=0};r.DoublePoint1=function(e){this.X=e.X;this.Y=e.Y};r.DoublePoint2=function(e,g){this.X=e;this.Y=g};r.PolyNode=function(){this.m_Parent=null;this.m_polygon=new r.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};r.PolyNode.prototype.IsHoleNode=function(){for(var e=!0,g=this.m_Parent;null!==
g;)e=!e,g=g.m_Parent;return e};r.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};r.PolyNode.prototype.Contour=function(){return this.m_polygon};r.PolyNode.prototype.AddChild=function(e){var g=this.m_Childs.length;this.m_Childs.push(e);e.m_Parent=this;e.m_Index=g};r.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};r.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-
1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]};r.PolyNode.prototype.Childs=function(){return this.m_Childs};r.PolyNode.prototype.Parent=function(){return this.m_Parent};r.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};r.PolyTree=function(){this.m_AllPolys=[];r.PolyNode.call(this)};r.PolyTree.prototype.Clear=function(){for(var e=0,g=this.m_AllPolys.length;e<g;e++)this.m_AllPolys[e]=null;this.m_AllPolys.length=0;this.m_Childs.length=0};r.PolyTree.prototype.GetFirst=
function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};r.PolyTree.prototype.Total=function(){var e=this.m_AllPolys.length;0<e&&this.m_Childs[0]!=this.m_AllPolys[0]&&e--;return e};cb(r.PolyTree,r.PolyNode);r.Math_Abs_Int64=r.Math_Abs_Int32=r.Math_Abs_Double=function(e){return Math.abs(e)};r.Math_Max_Int32_Int32=function(e,g){return Math.max(e,g)};r.Cast_Int32=gb||Hb||za?function(e){return e|0}:function(e){return~~e};r.Cast_Int64=U?function(e){return-2147483648>e||2147483647<e?0>e?Math.ceil(e):
Math.floor(e):~~e}:Ha&&"function"==typeof Number.toInteger?function(e){return Number.toInteger(e)}:Db||Nb?function(e){return parseInt(e,10)}:gb?function(e){return-2147483648>e||2147483647<e?0>e?Math.ceil(e):Math.floor(e):e|0}:function(e){return 0>e?Math.ceil(e):Math.floor(e)};r.Clear=function(e){e.length=0};r.PI=3.141592653589793;r.PI2=6.283185307179586;r.IntPoint=function(){var e=arguments,g=e.length;this.Y=this.X=0;r.use_xyz?(this.Z=0,3==g?(this.X=e[0],this.Y=e[1],this.Z=e[2]):2==g?(this.X=e[0],
this.Y=e[1],this.Z=0):1==g?e[0]instanceof r.DoublePoint?(e=e[0],this.X=r.Clipper.Round(e.X),this.Y=r.Clipper.Round(e.Y),this.Z=0):(e=e[0],"undefined"==typeof e.Z&&(e.Z=0),this.X=e.X,this.Y=e.Y,this.Z=e.Z):this.Z=this.Y=this.X=0):2==g?(this.X=e[0],this.Y=e[1]):1==g?e[0]instanceof r.DoublePoint?(e=e[0],this.X=r.Clipper.Round(e.X),this.Y=r.Clipper.Round(e.Y)):(e=e[0],this.X=e.X,this.Y=e.Y):this.Y=this.X=0};r.IntPoint.op_Equality=function(e,g){return e.X==g.X&&e.Y==g.Y};r.IntPoint.op_Inequality=function(e,
g){return e.X!=g.X||e.Y!=g.Y};r.use_xyz?(r.IntPoint0=function(){this.Z=this.Y=this.X=0},r.IntPoint1=function(e){this.X=e.X;this.Y=e.Y;this.Z=e.Z},r.IntPoint1dp=function(e){this.X=r.Clipper.Round(e.X);this.Y=r.Clipper.Round(e.Y);this.Z=0},r.IntPoint2=function(e,g){this.X=e;this.Y=g;this.Z=0},r.IntPoint3=function(e,g,l){this.X=e;this.Y=g;this.Z=l}):(r.IntPoint0=function(){this.Y=this.X=0},r.IntPoint1=function(e){this.X=e.X;this.Y=e.Y},r.IntPoint1dp=function(e){this.X=r.Clipper.Round(e.X);this.Y=r.Clipper.Round(e.Y)},
r.IntPoint2=function(e,g){this.X=e;this.Y=g});r.IntRect=function(){var e=arguments,g=e.length;4==g?(this.left=e[0],this.top=e[1],this.right=e[2],this.bottom=e[3]):1==g?(this.left=e[0].left,this.top=e[0].top,this.right=e[0].right,this.bottom=e[0].bottom):this.bottom=this.right=this.top=this.left=0};r.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};r.IntRect1=function(e){this.left=e.left;this.top=e.top;this.right=e.right;this.bottom=e.bottom};r.IntRect4=function(e,g,l,q){this.left=
e;this.top=g;this.right=l;this.bottom=q};r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};r.PolyType={ptSubject:0,ptClip:1};r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};r.JoinType={jtSquare:0,jtRound:1,jtMiter:2};r.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};r.EdgeSide={esLeft:0,esRight:1};r.Direction={dRightToLeft:0,dLeftToRight:1};r.TEdge=function(){this.Bot=new r.IntPoint;this.Curr=new r.IntPoint;this.Top=new r.IntPoint;
this.Delta=new r.IntPoint;this.Dx=0;this.PolyTyp=r.PolyType.ptSubject;this.Side=r.EdgeSide.esLeft;this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};r.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new r.IntPoint};r.MyIntersectNodeSort=function(){};r.MyIntersectNodeSort.Compare=function(e,g){e=g.Pt.Y-e.Pt.Y;return 0<e?1:0>e?-1:0};r.LocalMinima=function(){this.Y=0;this.Next=this.RightBound=
this.LeftBound=null};r.Scanbeam=function(){this.Y=0;this.Next=null};r.OutRec=function(){this.Idx=0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};r.OutPt=function(){this.Idx=0;this.Pt=new r.IntPoint;this.Prev=this.Next=null};r.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new r.IntPoint};r.ClipperBase=function(){this.m_edges=[];this.PreserveCollinear=!1;this.m_CurrentLM=this.m_MinimaList=null;this.m_HasOpenPaths=this.m_UseFullRange=!1};r.ClipperBase.horizontal=
-9007199254740992;r.ClipperBase.Skip=-2;r.ClipperBase.Unassigned=-1;r.ClipperBase.tolerance=1E-20;r.ClipperBase.loRange=47453132;r.ClipperBase.hiRange=0xfffffffffffff;r.ClipperBase.near_zero=function(e){return e>-r.ClipperBase.tolerance&&e<r.ClipperBase.tolerance};r.ClipperBase.IsHorizontal=function(e){return 0===e.Delta.Y};r.ClipperBase.prototype.PointIsVertex=function(e,g){var l=g;do{if(r.IntPoint.op_Equality(l.Pt,e))return!0;l=l.Next}while(l!=g);return!1};r.ClipperBase.prototype.PointOnLineSegment=
function(e,g,l,q){return q?e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&E.op_Equality(E.Int128Mul(e.X-g.X,l.Y-g.Y),E.Int128Mul(l.X-g.X,e.Y-g.Y)):e.X==g.X&&e.Y==g.Y||e.X==l.X&&e.Y==l.Y||e.X>g.X==e.X<l.X&&e.Y>g.Y==e.Y<l.Y&&(e.X-g.X)*(l.Y-g.Y)==(l.X-g.X)*(e.Y-g.Y)};r.ClipperBase.prototype.PointOnPolygon=function(e,g,l){for(var q=g;;){if(this.PointOnLineSegment(e,q.Pt,q.Next.Pt,l))return!0;q=q.Next;if(q==g)break}return!1};r.ClipperBase.prototype.SlopesEqual=r.ClipperBase.SlopesEqual=
function(){var e=arguments,g=e.length,l,q;if(3==g)return g=e[0],l=e[1],e[2]?E.op_Equality(E.Int128Mul(g.Delta.Y,l.Delta.X),E.Int128Mul(g.Delta.X,l.Delta.Y)):r.Cast_Int64(g.Delta.Y*l.Delta.X)==r.Cast_Int64(g.Delta.X*l.Delta.Y);if(4==g)return g=e[0],l=e[1],q=e[2],e[3]?E.op_Equality(E.Int128Mul(g.Y-l.Y,l.X-q.X),E.Int128Mul(g.X-l.X,l.Y-q.Y)):0===r.Cast_Int64((g.Y-l.Y)*(l.X-q.X))-r.Cast_Int64((g.X-l.X)*(l.Y-q.Y));g=e[0];l=e[1];q=e[2];var x=e[3];return e[4]?E.op_Equality(E.Int128Mul(g.Y-l.Y,q.X-x.X),E.Int128Mul(g.X-
l.X,q.Y-x.Y)):0===r.Cast_Int64((g.Y-l.Y)*(q.X-x.X))-r.Cast_Int64((g.X-l.X)*(q.Y-x.Y))};r.ClipperBase.SlopesEqual3=function(e,g,l){return l?E.op_Equality(E.Int128Mul(e.Delta.Y,g.Delta.X),E.Int128Mul(e.Delta.X,g.Delta.Y)):r.Cast_Int64(e.Delta.Y*g.Delta.X)==r.Cast_Int64(e.Delta.X*g.Delta.Y)};r.ClipperBase.SlopesEqual4=function(e,g,l,q){return q?E.op_Equality(E.Int128Mul(e.Y-g.Y,g.X-l.X),E.Int128Mul(e.X-g.X,g.Y-l.Y)):0===r.Cast_Int64((e.Y-g.Y)*(g.X-l.X))-r.Cast_Int64((e.X-g.X)*(g.Y-l.Y))};r.ClipperBase.SlopesEqual5=
function(e,g,l,q,x){return x?E.op_Equality(E.Int128Mul(e.Y-g.Y,l.X-q.X),E.Int128Mul(e.X-g.X,l.Y-q.Y)):0===r.Cast_Int64((e.Y-g.Y)*(l.X-q.X))-r.Cast_Int64((e.X-g.X)*(l.Y-q.Y))};r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var e=0,g=this.m_edges.length;e<g;++e){for(var l=0,q=this.m_edges[e].length;l<q;++l)this.m_edges[e][l]=null;r.Clear(this.m_edges[e])}r.Clear(this.m_edges);this.m_HasOpenPaths=this.m_UseFullRange=!1};r.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==
this.m_MinimaList;){var e=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=e}this.m_CurrentLM=null};r.ClipperBase.prototype.RangeTest=function(e,g){if(g.Value)(e.X>r.ClipperBase.hiRange||e.Y>r.ClipperBase.hiRange||-e.X>r.ClipperBase.hiRange||-e.Y>r.ClipperBase.hiRange)&&r.Error("Coordinate outside allowed range in RangeTest().");else if(e.X>r.ClipperBase.loRange||e.Y>r.ClipperBase.loRange||-e.X>r.ClipperBase.loRange||-e.Y>r.ClipperBase.loRange)g.Value=!0,this.RangeTest(e,g)};r.ClipperBase.prototype.InitEdge=
function(e,g,l,q){e.Next=g;e.Prev=l;e.Curr.X=q.X;e.Curr.Y=q.Y;r.use_xyz&&(e.Curr.Z=q.Z);e.OutIdx=-1};r.ClipperBase.prototype.InitEdge2=function(e,g){e.Curr.Y>=e.Next.Curr.Y?(e.Bot.X=e.Curr.X,e.Bot.Y=e.Curr.Y,r.use_xyz&&(e.Bot.Z=e.Curr.Z),e.Top.X=e.Next.Curr.X,e.Top.Y=e.Next.Curr.Y,r.use_xyz&&(e.Top.Z=e.Next.Curr.Z)):(e.Top.X=e.Curr.X,e.Top.Y=e.Curr.Y,r.use_xyz&&(e.Top.Z=e.Curr.Z),e.Bot.X=e.Next.Curr.X,e.Bot.Y=e.Next.Curr.Y,r.use_xyz&&(e.Bot.Z=e.Next.Curr.Z));this.SetDx(e);e.PolyTyp=g};r.ClipperBase.prototype.FindNextLocMin=
function(e){for(var g;;){for(;r.IntPoint.op_Inequality(e.Bot,e.Prev.Bot)||r.IntPoint.op_Equality(e.Curr,e.Top);)e=e.Next;if(e.Dx!=r.ClipperBase.horizontal&&e.Prev.Dx!=r.ClipperBase.horizontal)break;for(;e.Prev.Dx==r.ClipperBase.horizontal;)e=e.Prev;for(g=e;e.Dx==r.ClipperBase.horizontal;)e=e.Next;if(e.Top.Y!=e.Prev.Bot.Y){g.Prev.Bot.X<e.Bot.X&&(e=g);break}}return e};r.ClipperBase.prototype.ProcessBound=function(e,g){var l,q=e,x;if(q.OutIdx==r.ClipperBase.Skip){e=q;if(g){for(;e.Top.Y==e.Next.Bot.Y;)e=
e.Next;for(;e!=q&&e.Dx==r.ClipperBase.horizontal;)e=e.Prev}else{for(;e.Top.Y==e.Prev.Bot.Y;)e=e.Prev;for(;e!=q&&e.Dx==r.ClipperBase.horizontal;)e=e.Next}e==q?q=g?e.Next:e.Prev:(e=g?q.Next:q.Prev,l=new r.LocalMinima,l.Next=null,l.Y=e.Bot.Y,l.LeftBound=null,l.RightBound=e,e.WindDelta=0,q=this.ProcessBound(e,g),this.InsertLocalMinima(l));return q}e.Dx==r.ClipperBase.horizontal&&(l=g?e.Prev:e.Next,l.OutIdx!=r.ClipperBase.Skip&&(l.Dx==r.ClipperBase.horizontal?l.Bot.X!=e.Bot.X&&l.Top.X!=e.Bot.X&&this.ReverseHorizontal(e):
l.Bot.X!=e.Bot.X&&this.ReverseHorizontal(e)));l=e;if(g){for(;q.Top.Y==q.Next.Bot.Y&&q.Next.OutIdx!=r.ClipperBase.Skip;)q=q.Next;if(q.Dx==r.ClipperBase.horizontal&&q.Next.OutIdx!=r.ClipperBase.Skip){for(x=q;x.Prev.Dx==r.ClipperBase.horizontal;)x=x.Prev;x.Prev.Top.X==q.Next.Top.X?g||(q=x.Prev):x.Prev.Top.X>q.Next.Top.X&&(q=x.Prev)}for(;e!=q;)e.NextInLML=e.Next,e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=
e.Prev.Top.X&&this.ReverseHorizontal(e);q=q.Next}else{for(;q.Top.Y==q.Prev.Bot.Y&&q.Prev.OutIdx!=r.ClipperBase.Skip;)q=q.Prev;if(q.Dx==r.ClipperBase.horizontal&&q.Prev.OutIdx!=r.ClipperBase.Skip){for(x=q;x.Next.Dx==r.ClipperBase.horizontal;)x=x.Next;x.Next.Top.X==q.Prev.Top.X?g||(q=x.Next):x.Next.Top.X>q.Prev.Top.X&&(q=x.Next)}for(;e!=q;)e.NextInLML=e.Prev,e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=e.Next.Top.X&&this.ReverseHorizontal(e),e=e.Prev;e.Dx==r.ClipperBase.horizontal&&e!=l&&e.Bot.X!=
e.Next.Top.X&&this.ReverseHorizontal(e);q=q.Prev}return q};r.ClipperBase.prototype.AddPath=function(e,g,l){r.use_lines?l||g!=r.PolyType.ptClip||r.Error("AddPath: Open paths must be subject."):l||r.Error("AddPath: Open paths have been disabled.");var q=e.length-1;if(l)for(;0<q&&r.IntPoint.op_Equality(e[q],e[0]);)--q;for(;0<q&&r.IntPoint.op_Equality(e[q],e[q-1]);)--q;if(l&&2>q||!l&&1>q)return!1;for(var x=[],G=0;G<=q;G++)x.push(new r.TEdge);var L=!0;x[1].Curr.X=e[1].X;x[1].Curr.Y=e[1].Y;r.use_xyz&&(x[1].Curr.Z=
e[1].Z);var Y={Value:this.m_UseFullRange};this.RangeTest(e[0],Y);this.m_UseFullRange=Y.Value;Y.Value=this.m_UseFullRange;this.RangeTest(e[q],Y);this.m_UseFullRange=Y.Value;this.InitEdge(x[0],x[1],x[q],e[0]);this.InitEdge(x[q],x[0],x[q-1],e[q]);for(G=q-1;1<=G;--G)Y.Value=this.m_UseFullRange,this.RangeTest(e[G],Y),this.m_UseFullRange=Y.Value,this.InitEdge(x[G],x[G+1],x[G-1],e[G]);for(G=e=q=x[0];;)if(e.Curr!=e.Next.Curr||!l&&e.Next==q){if(e.Prev==e.Next)break;else if(l&&r.ClipperBase.SlopesEqual(e.Prev.Curr,
e.Curr,e.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(e.Prev.Curr,e.Curr,e.Next.Curr))){e==q&&(q=e.Next);e=this.RemoveEdge(e);G=e=e.Prev;continue}e=e.Next;if(e==G||!l&&e.Next==q)break}else{if(e==e.Next)break;e==q&&(q=e.Next);G=e=this.RemoveEdge(e)}if(!l&&e==e.Next||l&&e.Prev==e.Next)return!1;l||(this.m_HasOpenPaths=!0,q.Prev.OutIdx=r.ClipperBase.Skip);e=q;do this.InitEdge2(e,g),e=e.Next,L&&e.Curr.Y!=q.Curr.Y&&(L=!1);while(e!=q);if(L){if(l)return!1;e.Prev.OutIdx=
r.ClipperBase.Skip;e.Prev.Bot.X<e.Prev.Top.X&&this.ReverseHorizontal(e.Prev);g=new r.LocalMinima;g.Next=null;g.Y=e.Bot.Y;g.LeftBound=null;g.RightBound=e;g.RightBound.Side=r.EdgeSide.esRight;for(g.RightBound.WindDelta=0;e.Next.OutIdx!=r.ClipperBase.Skip;)e.NextInLML=e.Next,e.Bot.X!=e.Prev.Top.X&&this.ReverseHorizontal(e),e=e.Next;this.InsertLocalMinima(g);this.m_edges.push(x);return!0}this.m_edges.push(x);L=null;for(r.IntPoint.op_Equality(e.Prev.Bot,e.Prev.Top)&&(e=e.Next);;){e=this.FindNextLocMin(e);
if(e==L)break;else null==L&&(L=e);g=new r.LocalMinima;g.Next=null;g.Y=e.Bot.Y;e.Dx<e.Prev.Dx?(g.LeftBound=e.Prev,g.RightBound=e,x=!1):(g.LeftBound=e,g.RightBound=e.Prev,x=!0);g.LeftBound.Side=r.EdgeSide.esLeft;g.RightBound.Side=r.EdgeSide.esRight;g.LeftBound.WindDelta=l?g.LeftBound.Next==g.RightBound?-1:1:0;g.RightBound.WindDelta=-g.LeftBound.WindDelta;e=this.ProcessBound(g.LeftBound,x);e.OutIdx==r.ClipperBase.Skip&&(e=this.ProcessBound(e,x));q=this.ProcessBound(g.RightBound,!x);q.OutIdx==r.ClipperBase.Skip&&
(q=this.ProcessBound(q,!x));g.LeftBound.OutIdx==r.ClipperBase.Skip?g.LeftBound=null:g.RightBound.OutIdx==r.ClipperBase.Skip&&(g.RightBound=null);this.InsertLocalMinima(g);x||(e=q)}return!0};r.ClipperBase.prototype.AddPaths=function(e,g,l){for(var q=!1,x=0,G=e.length;x<G;++x)this.AddPath(e[x],g,l)&&(q=!0);return q};r.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(e,g,l){return r.IntPoint.op_Equality(e,l)||r.IntPoint.op_Equality(e,g)||r.IntPoint.op_Equality(l,g)?!1:e.X!=l.X?g.X>e.X==g.X<l.X:g.Y>
e.Y==g.Y<l.Y};r.ClipperBase.prototype.RemoveEdge=function(e){e.Prev.Next=e.Next;e.Next.Prev=e.Prev;var g=e.Next;e.Prev=null;return g};r.ClipperBase.prototype.SetDx=function(e){e.Delta.X=e.Top.X-e.Bot.X;e.Delta.Y=e.Top.Y-e.Bot.Y;e.Dx=0===e.Delta.Y?r.ClipperBase.horizontal:e.Delta.X/e.Delta.Y};r.ClipperBase.prototype.InsertLocalMinima=function(e){if(null===this.m_MinimaList)this.m_MinimaList=e;else if(e.Y>=this.m_MinimaList.Y)e.Next=this.m_MinimaList,this.m_MinimaList=e;else{for(var g=this.m_MinimaList;null!==
g.Next&&e.Y<g.Next.Y;)g=g.Next;e.Next=g.Next;g.Next=e}};r.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};r.ClipperBase.prototype.ReverseHorizontal=function(e){var g=e.Top.X;e.Top.X=e.Bot.X;e.Bot.X=g;r.use_xyz&&(g=e.Top.Z,e.Top.Z=e.Bot.Z,e.Bot.Z=g)};r.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;if(null!=this.m_CurrentLM)for(var e=this.m_MinimaList;null!=e;){var g=e.LeftBound;null!=g&&(g.Curr.X=g.Bot.X,
g.Curr.Y=g.Bot.Y,r.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=r.EdgeSide.esLeft,g.OutIdx=r.ClipperBase.Unassigned);g=e.RightBound;null!=g&&(g.Curr.X=g.Bot.X,g.Curr.Y=g.Bot.Y,r.use_xyz&&(g.Curr.Z=g.Bot.Z),g.Side=r.EdgeSide.esRight,g.OutIdx=r.ClipperBase.Unassigned);e=e.Next}};r.Clipper=function(e){"undefined"==typeof e&&(e=0);this.m_PolyOuts=null;this.m_ClipType=r.ClipType.ctIntersection;this.m_IntersectNodeComparer=this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=
!1;this.m_SubjFillType=this.m_ClipFillType=r.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;r.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=r.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=this.m_ExecuteLocked=!1;this.m_PolyOuts=[];this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&e);this.StrictlySimple=0!==(2&e);this.PreserveCollinear=
0!==(4&e);r.use_xyz&&(this.ZFillFunction=null)};r.Clipper.ioReverseSolution=1;r.Clipper.ioStrictlySimple=2;r.Clipper.ioPreserveCollinear=4;r.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),r.ClipperBase.prototype.Clear.call(this))};r.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var e=this.m_Scanbeam.Next;this.m_Scanbeam=null;this.m_Scanbeam=e}};r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=
this.m_ActiveEdges=this.m_Scanbeam=null;for(var e=this.m_MinimaList;null!==e;)this.InsertScanbeam(e.Y),e=e.Next};r.Clipper.prototype.InsertScanbeam=function(e){if(null===this.m_Scanbeam)this.m_Scanbeam=new r.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=e;else if(e>this.m_Scanbeam.Y){var g=new r.Scanbeam;g.Y=e;g.Next=this.m_Scanbeam;this.m_Scanbeam=g}else{for(var l=this.m_Scanbeam;null!==l.Next&&e<=l.Next.Y;)l=l.Next;e!=l.Y&&(g=new r.Scanbeam,g.Y=e,g.Next=l.Next,l.Next=g)}};r.Clipper.prototype.Execute=
function(){var e=arguments,g=e.length,l=e[1]instanceof r.PolyTree;if(4!=g||l){if(4==g&&l){g=e[0];var q=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!0;try{(x=this.ExecuteInternal())&&this.BuildResult2(q)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return x}if(2==g&&!l||2==g&&l)return g=e[0],q=e[1],this.Execute(g,q,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}else{g=
e[0];q=e[1];l=e[2];e=e[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&r.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;r.Clear(q);this.m_SubjFillType=l;this.m_ClipFillType=e;this.m_ClipType=g;this.m_UsingPolyTree=!1;try{var x=this.ExecuteInternal();x&&this.BuildResult(q)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return x}};r.Clipper.prototype.FixHoleLinkage=function(e){if(null!==e.FirstLeft&&(e.IsHole==e.FirstLeft.IsHole||null===e.FirstLeft.Pts)){for(var g=
e.FirstLeft;null!==g&&(g.IsHole==e.IsHole||null===g.Pts);)g=g.FirstLeft;e.FirstLeft=g}};r.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var e=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(e);r.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var g=this.PopScanbeam();if(!this.ProcessIntersections(g))return!1;this.ProcessEdgesAtTopOfScanbeam(g);e=g}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);e=0;
for(var l=this.m_PolyOuts.length;e<l;e++){var q=this.m_PolyOuts[e];null===q.Pts||q.IsOpen||(q.IsHole^this.ReverseSolution)==0<this.Area(q)&&this.ReversePolyPtLinks(q.Pts)}this.JoinCommonEdges();e=0;for(l=this.m_PolyOuts.length;e<l;e++)q=this.m_PolyOuts[e],null===q.Pts||q.IsOpen||this.FixupOutPolygon(q);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{r.Clear(this.m_Joins),r.Clear(this.m_GhostJoins)}};r.Clipper.prototype.PopScanbeam=function(){var e=this.m_Scanbeam.Y;this.m_Scanbeam=this.m_Scanbeam.Next;
return e};r.Clipper.prototype.DisposeAllPolyPts=function(){for(var e=0,g=this.m_PolyOuts.length;e<g;++e)this.DisposeOutRec(e);r.Clear(this.m_PolyOuts)};r.Clipper.prototype.DisposeOutRec=function(e){this.m_PolyOuts[e].Pts=null;this.m_PolyOuts[e]=null};r.Clipper.prototype.AddJoin=function(e,g,l){var q=new r.Join;q.OutPt1=e;q.OutPt2=g;q.OffPt.X=l.X;q.OffPt.Y=l.Y;r.use_xyz&&(q.OffPt.Z=l.Z);this.m_Joins.push(q)};r.Clipper.prototype.AddGhostJoin=function(e,g){var l=new r.Join;l.OutPt1=e;l.OffPt.X=g.X;l.OffPt.Y=
g.Y;r.use_xyz&&(l.OffPt.Z=g.Z);this.m_GhostJoins.push(l)};r.Clipper.prototype.SetZ=function(e,g,l){null!==this.ZFillFunction&&0==e.Z&&null!==this.ZFillFunction&&(r.IntPoint.op_Equality(e,g.Bot)?e.Z=g.Bot.Z:r.IntPoint.op_Equality(e,g.Top)?e.Z=g.Top.Z:r.IntPoint.op_Equality(e,l.Bot)?e.Z=l.Bot.Z:r.IntPoint.op_Equality(e,l.Top)?e.Z=l.Top.Z:this.ZFillFunction(g.Bot,g.Top,l.Bot,l.Top,e))};r.Clipper.prototype.InsertLocalMinimaIntoAEL=function(e){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==e;){var g=
this.m_CurrentLM.LeftBound,l=this.m_CurrentLM.RightBound;this.PopLocalMinima();var q=null;null===g?(this.InsertEdgeIntoAEL(l,null),this.SetWindingCount(l),this.IsContributing(l)&&(q=this.AddOutPt(l,l.Bot))):(null==l?(this.InsertEdgeIntoAEL(g,null),this.SetWindingCount(g),this.IsContributing(g)&&(q=this.AddOutPt(g,g.Bot))):(this.InsertEdgeIntoAEL(g,null),this.InsertEdgeIntoAEL(l,g),this.SetWindingCount(g),l.WindCnt=g.WindCnt,l.WindCnt2=g.WindCnt2,this.IsContributing(g)&&(q=this.AddLocalMinPoly(g,l,
g.Bot))),this.InsertScanbeam(g.Top.Y));null!=l&&(r.ClipperBase.IsHorizontal(l)?this.AddEdgeToSEL(l):this.InsertScanbeam(l.Top.Y));if(null!=g&&null!=l){if(null!==q&&r.ClipperBase.IsHorizontal(l)&&0<this.m_GhostJoins.length&&0!==l.WindDelta)for(var x=0,G=this.m_GhostJoins.length;x<G;x++){var L=this.m_GhostJoins[x];this.HorzSegmentsOverlap(L.OutPt1.Pt.X,L.OffPt.X,l.Bot.X,l.Top.X)&&this.AddJoin(L.OutPt1,q,L.OffPt)}0<=g.OutIdx&&null!==g.PrevInAEL&&g.PrevInAEL.Curr.X==g.Bot.X&&0<=g.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(g.PrevInAEL,
g,this.m_UseFullRange)&&0!==g.WindDelta&&0!==g.PrevInAEL.WindDelta&&(x=this.AddOutPt(g.PrevInAEL,g.Bot),this.AddJoin(q,x,g.Top));if(g.NextInAEL!=l&&(0<=l.OutIdx&&0<=l.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(l.PrevInAEL,l,this.m_UseFullRange)&&0!==l.WindDelta&&0!==l.PrevInAEL.WindDelta&&(x=this.AddOutPt(l.PrevInAEL,l.Bot),this.AddJoin(q,x,l.Top)),q=g.NextInAEL,null!==q))for(;q!=l;)this.IntersectEdges(l,q,g.Curr,!1),q=q.NextInAEL}}};r.Clipper.prototype.InsertEdgeIntoAEL=function(e,g){if(null===
this.m_ActiveEdges)e.PrevInAEL=null,e.NextInAEL=null,this.m_ActiveEdges=e;else if(null===g&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.PrevInAEL=null,e.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=e;else{for(null===g&&(g=this.m_ActiveEdges);null!==g.NextInAEL&&!this.E2InsertsBeforeE1(g.NextInAEL,e);)g=g.NextInAEL;e.NextInAEL=g.NextInAEL;null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=e);e.PrevInAEL=g;g.NextInAEL=e}};r.Clipper.prototype.E2InsertsBeforeE1=function(e,g){return g.Curr.X==
e.Curr.X?g.Top.Y>e.Top.Y?g.Top.X<r.Clipper.TopX(e,g.Top.Y):e.Top.X>r.Clipper.TopX(g,e.Top.Y):g.Curr.X<e.Curr.X};r.Clipper.prototype.IsEvenOddFillType=function(e){return e.PolyTyp==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsEvenOddAltFillType=function(e){return e.PolyTyp==r.PolyType.ptSubject?this.m_ClipFillType==r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsContributing=
function(e){var g,l;e.PolyTyp==r.PolyType.ptSubject?(g=this.m_SubjFillType,l=this.m_ClipFillType):(g=this.m_ClipFillType,l=this.m_SubjFillType);switch(g){case r.PolyFillType.pftEvenOdd:if(0===e.WindDelta&&1!=e.WindCnt)return!1;break;case r.PolyFillType.pftNonZero:if(1!=Math.abs(e.WindCnt))return!1;break;case r.PolyFillType.pftPositive:if(1!=e.WindCnt)return!1;break;default:if(-1!=e.WindCnt)return!1}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==
e.WindCnt2;case r.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case r.ClipType.ctUnion:switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===e.WindCnt2;case r.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}case r.ClipType.ctDifference:if(e.PolyTyp==r.PolyType.ptSubject)switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===e.WindCnt2;case r.PolyFillType.pftPositive:return 0>=e.WindCnt2;
default:return 0<=e.WindCnt2}else switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==e.WindCnt2;case r.PolyFillType.pftPositive:return 0<e.WindCnt2;default:return 0>e.WindCnt2}case r.ClipType.ctXor:if(0===e.WindDelta)switch(l){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===e.WindCnt2;case r.PolyFillType.pftPositive:return 0>=e.WindCnt2;default:return 0<=e.WindCnt2}}return!0};r.Clipper.prototype.SetWindingCount=function(e){for(var g=e.PrevInAEL;null!==
g&&(g.PolyTyp!=e.PolyTyp||0===g.WindDelta);)g=g.PrevInAEL;if(null===g)e.WindCnt=0===e.WindDelta?1:e.WindDelta,e.WindCnt2=0,g=this.m_ActiveEdges;else{if(0===e.WindDelta&&this.m_ClipType!=r.ClipType.ctUnion)e.WindCnt=1;else if(this.IsEvenOddFillType(e))if(0===e.WindDelta){for(var l=!0,q=g.PrevInAEL;null!==q;)q.PolyTyp==g.PolyTyp&&0!==q.WindDelta&&(l=!l),q=q.PrevInAEL;e.WindCnt=l?0:1}else e.WindCnt=e.WindDelta;else e.WindCnt=0>g.WindCnt*g.WindDelta?1<Math.abs(g.WindCnt)?0>g.WindDelta*e.WindDelta?g.WindCnt:
g.WindCnt+e.WindDelta:0===e.WindDelta?1:e.WindDelta:0===e.WindDelta?0>g.WindCnt?g.WindCnt-1:g.WindCnt+1:0>g.WindDelta*e.WindDelta?g.WindCnt:g.WindCnt+e.WindDelta;e.WindCnt2=g.WindCnt2;g=g.NextInAEL}if(this.IsEvenOddAltFillType(e))for(;g!=e;)0!==g.WindDelta&&(e.WindCnt2=0===e.WindCnt2?1:0),g=g.NextInAEL;else for(;g!=e;)e.WindCnt2+=g.WindDelta,g=g.NextInAEL};r.Clipper.prototype.AddEdgeToSEL=function(e){null===this.m_SortedEdges?(this.m_SortedEdges=e,e.PrevInSEL=null,e.NextInSEL=null):(e.NextInSEL=this.m_SortedEdges,
e.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=e)};r.Clipper.prototype.CopyAELToSEL=function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;null!==e;)e.PrevInSEL=e.PrevInAEL,e=e.NextInSEL=e.NextInAEL};r.Clipper.prototype.SwapPositionsInAEL=function(e,g){if(e.NextInAEL!=e.PrevInAEL&&g.NextInAEL!=g.PrevInAEL){if(e.NextInAEL==g){var l=g.NextInAEL;null!==l&&(l.PrevInAEL=e);var q=e.PrevInAEL;null!==q&&(q.NextInAEL=g);g.PrevInAEL=q;g.NextInAEL=e;e.PrevInAEL=g;e.NextInAEL=l}else g.NextInAEL==
e?(l=e.NextInAEL,null!==l&&(l.PrevInAEL=g),q=g.PrevInAEL,null!==q&&(q.NextInAEL=e),e.PrevInAEL=q,e.NextInAEL=g,g.PrevInAEL=e,g.NextInAEL=l):(l=e.NextInAEL,q=e.PrevInAEL,e.NextInAEL=g.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=g.PrevInAEL,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e),g.NextInAEL=l,null!==g.NextInAEL&&(g.NextInAEL.PrevInAEL=g),g.PrevInAEL=q,null!==g.PrevInAEL&&(g.PrevInAEL.NextInAEL=g));null===e.PrevInAEL?this.m_ActiveEdges=e:null===g.PrevInAEL&&(this.m_ActiveEdges=
g)}};r.Clipper.prototype.SwapPositionsInSEL=function(e,g){if(null!==e.NextInSEL||null!==e.PrevInSEL)if(null!==g.NextInSEL||null!==g.PrevInSEL){if(e.NextInSEL==g){var l=g.NextInSEL;null!==l&&(l.PrevInSEL=e);var q=e.PrevInSEL;null!==q&&(q.NextInSEL=g);g.PrevInSEL=q;g.NextInSEL=e;e.PrevInSEL=g;e.NextInSEL=l}else g.NextInSEL==e?(l=e.NextInSEL,null!==l&&(l.PrevInSEL=g),q=g.PrevInSEL,null!==q&&(q.NextInSEL=e),e.PrevInSEL=q,e.NextInSEL=g,g.PrevInSEL=e,g.NextInSEL=l):(l=e.NextInSEL,q=e.PrevInSEL,e.NextInSEL=
g.NextInSEL,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=g.PrevInSEL,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e),g.NextInSEL=l,null!==g.NextInSEL&&(g.NextInSEL.PrevInSEL=g),g.PrevInSEL=q,null!==g.PrevInSEL&&(g.PrevInSEL.NextInSEL=g));null===e.PrevInSEL?this.m_SortedEdges=e:null===g.PrevInSEL&&(this.m_SortedEdges=g)}};r.Clipper.prototype.AddLocalMaxPoly=function(e,g,l){this.AddOutPt(e,l);0==g.WindDelta&&this.AddOutPt(g,l);e.OutIdx==g.OutIdx?(e.OutIdx=-1,g.OutIdx=-1):e.OutIdx<g.OutIdx?
this.AppendPolygon(e,g):this.AppendPolygon(g,e)};r.Clipper.prototype.AddLocalMinPoly=function(e,g,l){var q,x;r.ClipperBase.IsHorizontal(g)||e.Dx>g.Dx?(q=this.AddOutPt(e,l),g.OutIdx=e.OutIdx,e.Side=r.EdgeSide.esLeft,g.Side=r.EdgeSide.esRight,x=e,e=x.PrevInAEL==g?g.PrevInAEL:x.PrevInAEL):(q=this.AddOutPt(g,l),e.OutIdx=g.OutIdx,e.Side=r.EdgeSide.esRight,g.Side=r.EdgeSide.esLeft,x=g,e=x.PrevInAEL==e?e.PrevInAEL:x.PrevInAEL);null!==e&&0<=e.OutIdx&&r.Clipper.TopX(e,l.Y)==r.Clipper.TopX(x,l.Y)&&r.ClipperBase.SlopesEqual(x,
e,this.m_UseFullRange)&&0!==x.WindDelta&&0!==e.WindDelta&&(l=this.AddOutPt(e,l),this.AddJoin(q,l,x.Top));return q};r.Clipper.prototype.CreateOutRec=function(){var e=new r.OutRec;e.Idx=-1;e.IsHole=!1;e.IsOpen=!1;e.FirstLeft=null;e.Pts=null;e.BottomPt=null;e.PolyNode=null;this.m_PolyOuts.push(e);e.Idx=this.m_PolyOuts.length-1;return e};r.Clipper.prototype.AddOutPt=function(e,g){var l=e.Side==r.EdgeSide.esLeft;if(0>e.OutIdx){var q=this.CreateOutRec();q.IsOpen=0===e.WindDelta;var x=new r.OutPt;q.Pts=
x;x.Idx=q.Idx;x.Pt.X=g.X;x.Pt.Y=g.Y;r.use_xyz&&(x.Pt.Z=g.Z);x.Next=x;x.Prev=x;q.IsOpen||this.SetHoleState(e,q);e.OutIdx=q.Idx}else{q=this.m_PolyOuts[e.OutIdx];e=q.Pts;if(l&&r.IntPoint.op_Equality(g,e.Pt))return e;if(!l&&r.IntPoint.op_Equality(g,e.Prev.Pt))return e.Prev;x=new r.OutPt;x.Idx=q.Idx;x.Pt.X=g.X;x.Pt.Y=g.Y;r.use_xyz&&(x.Pt.Z=g.Z);x.Next=e;x.Prev=e.Prev;x.Prev.Next=x;e.Prev=x;l&&(q.Pts=x)}return x};r.Clipper.prototype.SwapPoints=function(e,g){var l=new r.IntPoint(e.Value);e.Value.X=g.Value.X;
e.Value.Y=g.Value.Y;r.use_xyz&&(e.Value.Z=g.Value.Z);g.Value.X=l.X;g.Value.Y=l.Y;r.use_xyz&&(g.Value.Z=l.Z)};r.Clipper.prototype.HorzSegmentsOverlap=function(e,g,l,q){var x;e>g&&(x=e,e=g,g=x);l>q&&(x=l,l=q,q=x);return e<q&&l<g};r.Clipper.prototype.SetHoleState=function(e,g){var l=!1;for(e=e.PrevInAEL;null!==e;)0<=e.OutIdx&&0!=e.WindDelta&&(l=!l,null===g.FirstLeft&&(g.FirstLeft=this.m_PolyOuts[e.OutIdx])),e=e.PrevInAEL;l&&(g.IsHole=!0)};r.Clipper.prototype.GetDx=function(e,g){return e.Y==g.Y?r.ClipperBase.horizontal:
(g.X-e.X)/(g.Y-e.Y)};r.Clipper.prototype.FirstIsBottomPt=function(e,g){for(var l=e.Prev;r.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Prev;var q=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=e.Next;r.IntPoint.op_Equality(l.Pt,e.Pt)&&l!=e;)l=l.Next;e=Math.abs(this.GetDx(e.Pt,l.Pt));for(l=g.Prev;r.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Prev;var x=Math.abs(this.GetDx(g.Pt,l.Pt));for(l=g.Next;r.IntPoint.op_Equality(l.Pt,g.Pt)&&l!=g;)l=l.Next;l=Math.abs(this.GetDx(g.Pt,l.Pt));return q>=x&&q>=l||e>=x&&e>=l};
r.Clipper.prototype.GetBottomPt=function(e){for(var g=null,l=e.Next;l!=e;)l.Pt.Y>e.Pt.Y?(e=l,g=null):l.Pt.Y==e.Pt.Y&&l.Pt.X<=e.Pt.X&&(l.Pt.X<e.Pt.X?(g=null,e=l):l.Next!=e&&l.Prev!=e&&(g=l)),l=l.Next;if(null!==g)for(;g!=l;)for(this.FirstIsBottomPt(l,g)||(e=g),g=g.Next;r.IntPoint.op_Inequality(g.Pt,e.Pt);)g=g.Next;return e};r.Clipper.prototype.GetLowermostRec=function(e,g){null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));null===g.BottomPt&&(g.BottomPt=this.GetBottomPt(g.Pts));var l=e.BottomPt,
q=g.BottomPt;return l.Pt.Y>q.Pt.Y?e:l.Pt.Y<q.Pt.Y?g:l.Pt.X<q.Pt.X?e:l.Pt.X>q.Pt.X?g:l.Next==l?g:q.Next==q?e:this.FirstIsBottomPt(l,q)?e:g};r.Clipper.prototype.Param1RightOfParam2=function(e,g){do if(e=e.FirstLeft,e==g)return!0;while(null!==e);return!1};r.Clipper.prototype.GetOutRec=function(e){for(e=this.m_PolyOuts[e];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e};r.Clipper.prototype.AppendPolygon=function(e,g){var l=this.m_PolyOuts[e.OutIdx],q=this.m_PolyOuts[g.OutIdx];var x=this.Param1RightOfParam2(l,
q)?q:this.Param1RightOfParam2(q,l)?l:this.GetLowermostRec(l,q);var G=l.Pts,L=G.Prev,Y=q.Pts,ja=Y.Prev;e.Side==r.EdgeSide.esLeft?(g.Side==r.EdgeSide.esLeft?(this.ReversePolyPtLinks(Y),Y.Next=G,G.Prev=Y,L.Next=ja,ja.Prev=L,l.Pts=ja):(ja.Next=G,G.Prev=ja,Y.Prev=L,L.Next=Y,l.Pts=Y),G=r.EdgeSide.esLeft):(g.Side==r.EdgeSide.esRight?(this.ReversePolyPtLinks(Y),L.Next=ja,ja.Prev=L,Y.Next=G,G.Prev=Y):(L.Next=Y,Y.Prev=L,G.Prev=ja,ja.Next=G),G=r.EdgeSide.esRight);l.BottomPt=null;x==q&&(q.FirstLeft!=l&&(l.FirstLeft=
q.FirstLeft),l.IsHole=q.IsHole);q.Pts=null;q.BottomPt=null;q.FirstLeft=l;x=e.OutIdx;L=g.OutIdx;e.OutIdx=-1;g.OutIdx=-1;for(Y=this.m_ActiveEdges;null!==Y;){if(Y.OutIdx==L){Y.OutIdx=x;Y.Side=G;break}Y=Y.NextInAEL}q.Idx=l.Idx};r.Clipper.prototype.ReversePolyPtLinks=function(e){if(null!==e){var g=e;do{var l=g.Next;g.Next=g.Prev;g=g.Prev=l}while(g!=e)}};r.Clipper.SwapSides=function(e,g){var l=e.Side;e.Side=g.Side;g.Side=l};r.Clipper.SwapPolyIndexes=function(e,g){var l=e.OutIdx;e.OutIdx=g.OutIdx;g.OutIdx=
l};r.Clipper.prototype.IntersectEdges=function(e,g,l){var q=0<=e.OutIdx,x=0<=g.OutIdx;r.use_xyz&&this.SetZ(l,e,g);if(!r.use_lines||0!==e.WindDelta&&0!==g.WindDelta){if(e.PolyTyp==g.PolyTyp)if(this.IsEvenOddFillType(e)){var G=e.WindCnt;e.WindCnt=g.WindCnt;g.WindCnt=G}else e.WindCnt=0===e.WindCnt+g.WindDelta?-e.WindCnt:e.WindCnt+g.WindDelta,g.WindCnt=0===g.WindCnt-e.WindDelta?-g.WindCnt:g.WindCnt-e.WindDelta;else this.IsEvenOddFillType(g)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2+=g.WindDelta,this.IsEvenOddFillType(e)?
g.WindCnt2=0===g.WindCnt2?1:0:g.WindCnt2-=e.WindDelta;var L,Y,ja;e.PolyTyp==r.PolyType.ptSubject?(L=this.m_SubjFillType,ja=this.m_ClipFillType):(L=this.m_ClipFillType,ja=this.m_SubjFillType);g.PolyTyp==r.PolyType.ptSubject?(Y=this.m_SubjFillType,G=this.m_ClipFillType):(Y=this.m_ClipFillType,G=this.m_SubjFillType);switch(L){case r.PolyFillType.pftPositive:L=e.WindCnt;break;case r.PolyFillType.pftNegative:L=-e.WindCnt;break;default:L=Math.abs(e.WindCnt)}switch(Y){case r.PolyFillType.pftPositive:Y=g.WindCnt;
break;case r.PolyFillType.pftNegative:Y=-g.WindCnt;break;default:Y=Math.abs(g.WindCnt)}if(q&&x)0!=L&&1!=L||0!=Y&&1!=Y||e.PolyTyp!=g.PolyTyp&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(e,g,l):(this.AddOutPt(e,l),this.AddOutPt(g,l),r.Clipper.SwapSides(e,g),r.Clipper.SwapPolyIndexes(e,g));else if(q){if(0===Y||1==Y)this.AddOutPt(e,l),r.Clipper.SwapSides(e,g),r.Clipper.SwapPolyIndexes(e,g)}else if(x){if(0===L||1==L)this.AddOutPt(g,l),r.Clipper.SwapSides(e,g),r.Clipper.SwapPolyIndexes(e,g)}else if(!(0!=
L&&1!=L||0!=Y&&1!=Y)){switch(ja){case r.PolyFillType.pftPositive:q=e.WindCnt2;break;case r.PolyFillType.pftNegative:q=-e.WindCnt2;break;default:q=Math.abs(e.WindCnt2)}switch(G){case r.PolyFillType.pftPositive:x=g.WindCnt2;break;case r.PolyFillType.pftNegative:x=-g.WindCnt2;break;default:x=Math.abs(g.WindCnt2)}if(e.PolyTyp!=g.PolyTyp)this.AddLocalMinPoly(e,g,l);else if(1==L&&1==Y)switch(this.m_ClipType){case r.ClipType.ctIntersection:0<q&&0<x&&this.AddLocalMinPoly(e,g,l);break;case r.ClipType.ctUnion:0>=
q&&0>=x&&this.AddLocalMinPoly(e,g,l);break;case r.ClipType.ctDifference:(e.PolyTyp==r.PolyType.ptClip&&0<q&&0<x||e.PolyTyp==r.PolyType.ptSubject&&0>=q&&0>=x)&&this.AddLocalMinPoly(e,g,l);break;case r.ClipType.ctXor:this.AddLocalMinPoly(e,g,l)}else r.Clipper.SwapSides(e,g)}}else if(0!=e.WindDelta||0!=g.WindDelta)e.PolyTyp==g.PolyTyp&&e.WindDelta!=g.WindDelta&&this.m_ClipType==r.ClipType.ctUnion?0===e.WindDelta?x&&(this.AddOutPt(e,l),q&&(e.OutIdx=-1)):q&&(this.AddOutPt(g,l),x&&(g.OutIdx=-1)):e.PolyTyp!=
g.PolyTyp&&(0!==e.WindDelta||1!=Math.abs(g.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==g.WindCnt2?0!==g.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==e.WindCnt2||(this.AddOutPt(g,l),x&&(g.OutIdx=-1)):(this.AddOutPt(e,l),q&&(e.OutIdx=-1)))};r.Clipper.prototype.DeleteFromAEL=function(e){var g=e.PrevInAEL,l=e.NextInAEL;if(null!==g||null!==l||e==this.m_ActiveEdges)null!==g?g.NextInAEL=l:this.m_ActiveEdges=l,null!==l&&(l.PrevInAEL=g),e.NextInAEL=null,e.PrevInAEL=null};
r.Clipper.prototype.DeleteFromSEL=function(e){var g=e.PrevInSEL,l=e.NextInSEL;if(null!==g||null!==l||e==this.m_SortedEdges)null!==g?g.NextInSEL=l:this.m_SortedEdges=l,null!==l&&(l.PrevInSEL=g),e.NextInSEL=null,e.PrevInSEL=null};r.Clipper.prototype.UpdateEdgeIntoAEL=function(e){null===e.NextInLML&&r.Error("UpdateEdgeIntoAEL: invalid call");var g=e.PrevInAEL,l=e.NextInAEL;e.NextInLML.OutIdx=e.OutIdx;null!==g?g.NextInAEL=e.NextInLML:this.m_ActiveEdges=e.NextInLML;null!==l&&(l.PrevInAEL=e.NextInLML);
e.NextInLML.Side=e.Side;e.NextInLML.WindDelta=e.WindDelta;e.NextInLML.WindCnt=e.WindCnt;e.NextInLML.WindCnt2=e.WindCnt2;e=e.NextInLML;e.Curr.X=e.Bot.X;e.Curr.Y=e.Bot.Y;r.use_xyz&&(e.Curr.Z=e.Bot.Z);e.PrevInAEL=g;e.NextInAEL=l;r.ClipperBase.IsHorizontal(e)||this.InsertScanbeam(e.Top.Y);return e};r.Clipper.prototype.ProcessHorizontals=function(e){for(var g=this.m_SortedEdges;null!==g;)this.DeleteFromSEL(g),this.ProcessHorizontal(g,e),g=this.m_SortedEdges};r.Clipper.prototype.GetHorzDirection=function(e,
g){e.Bot.X<e.Top.X?(g.Left=e.Bot.X,g.Right=e.Top.X,g.Dir=r.Direction.dLeftToRight):(g.Left=e.Top.X,g.Right=e.Bot.X,g.Dir=r.Direction.dRightToLeft)};r.Clipper.prototype.ProcessHorizontal=function(e,g){var l={Dir:null,Left:null,Right:null};this.GetHorzDirection(e,l);for(var q=l.Dir,x=l.Left,G=l.Right,L=e,Y=null;null!==L.NextInLML&&r.ClipperBase.IsHorizontal(L.NextInLML);)L=L.NextInLML;for(null===L.NextInLML&&(Y=this.GetMaximaPair(L));;){for(var ja=e==L,pa=this.GetNextInAEL(e,q);null!==pa&&!(pa.Curr.X==
e.Top.X&&null!==e.NextInLML&&pa.Dx<e.NextInLML.Dx);){l=this.GetNextInAEL(pa,q);if(q==r.Direction.dLeftToRight&&pa.Curr.X<=G||q==r.Direction.dRightToLeft&&pa.Curr.X>=x){if(pa==Y&&ja){if(0<=e.OutIdx){q=this.AddOutPt(e,e.Top);for(l=this.m_SortedEdges;null!==l;)0<=l.OutIdx&&this.HorzSegmentsOverlap(e.Bot.X,e.Top.X,l.Bot.X,l.Top.X)&&(x=this.AddOutPt(l,l.Bot),this.AddJoin(x,q,l.Top)),l=l.NextInSEL;this.AddGhostJoin(q,e.Bot);this.AddLocalMaxPoly(e,Y,e.Top)}this.DeleteFromAEL(e);this.DeleteFromAEL(Y);return}if(q==
r.Direction.dLeftToRight){var Ma=new r.IntPoint(pa.Curr.X,e.Curr.Y);this.IntersectEdges(e,pa,Ma)}else Ma=new r.IntPoint(pa.Curr.X,e.Curr.Y),this.IntersectEdges(pa,e,Ma);this.SwapPositionsInAEL(e,pa)}else if(q==r.Direction.dLeftToRight&&pa.Curr.X>=G||q==r.Direction.dRightToLeft&&pa.Curr.X<=x)break;pa=l}if(null!==e.NextInLML&&r.ClipperBase.IsHorizontal(e.NextInLML))e=this.UpdateEdgeIntoAEL(e),0<=e.OutIdx&&this.AddOutPt(e,e.Bot),l={Dir:q,Left:x,Right:G},this.GetHorzDirection(e,l),q=l.Dir,x=l.Left,G=
l.Right;else break}null!==e.NextInLML?0<=e.OutIdx?(q=this.AddOutPt(e,e.Top),g&&this.AddGhostJoin(q,e.Bot),e=this.UpdateEdgeIntoAEL(e),0!==e.WindDelta&&(Y=e.PrevInAEL,l=e.NextInAEL,null!==Y&&Y.Curr.X==e.Bot.X&&Y.Curr.Y==e.Bot.Y&&0!==Y.WindDelta&&0<=Y.OutIdx&&Y.Curr.Y>Y.Top.Y&&r.ClipperBase.SlopesEqual(e,Y,this.m_UseFullRange)?(x=this.AddOutPt(Y,e.Bot),this.AddJoin(q,x,e.Top)):null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&0!==l.WindDelta&&0<=l.OutIdx&&l.Curr.Y>l.Top.Y&&r.ClipperBase.SlopesEqual(e,
l,this.m_UseFullRange)&&(x=this.AddOutPt(l,e.Bot),this.AddJoin(q,x,e.Top)))):this.UpdateEdgeIntoAEL(e):(0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e))};r.Clipper.prototype.GetNextInAEL=function(e,g){return g==r.Direction.dLeftToRight?e.NextInAEL:e.PrevInAEL};r.Clipper.prototype.IsMinima=function(e){return null!==e&&e.Prev.NextInLML!=e&&e.Next.NextInLML!=e};r.Clipper.prototype.IsMaxima=function(e,g){return null!==e&&e.Top.Y==g&&null===e.NextInLML};r.Clipper.prototype.IsIntermediate=function(e,
g){return e.Top.Y==g&&null!==e.NextInLML};r.Clipper.prototype.GetMaximaPair=function(e){var g=null;r.IntPoint.op_Equality(e.Next.Top,e.Top)&&null===e.Next.NextInLML?g=e.Next:r.IntPoint.op_Equality(e.Prev.Top,e.Top)&&null===e.Prev.NextInLML&&(g=e.Prev);return null===g||-2!=g.OutIdx&&(g.NextInAEL!=g.PrevInAEL||r.ClipperBase.IsHorizontal(g))?g:null};r.Clipper.prototype.ProcessIntersections=function(e){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(e);if(0==this.m_IntersectList.length)return!0;
if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch(g){this.m_SortedEdges=null,this.m_IntersectList.length=0,r.Error("ProcessIntersections error")}this.m_SortedEdges=null;return!0};r.Clipper.prototype.BuildIntersectList=function(e){if(null!==this.m_ActiveEdges){var g=this.m_ActiveEdges;for(this.m_SortedEdges=g;null!==g;)g.PrevInSEL=g.PrevInAEL,g.NextInSEL=g.NextInAEL,g.Curr.X=r.Clipper.TopX(g,e),g=g.NextInAEL;for(var l=!0;l&&null!==this.m_SortedEdges;){l=
!1;for(g=this.m_SortedEdges;null!==g.NextInSEL;){e=g.NextInSEL;var q=new r.IntPoint;g.Curr.X>e.Curr.X?(this.IntersectPoint(g,e,q),l=new r.IntersectNode,l.Edge1=g,l.Edge2=e,l.Pt.X=q.X,l.Pt.Y=q.Y,r.use_xyz&&(l.Pt.Z=q.Z),this.m_IntersectList.push(l),this.SwapPositionsInSEL(g,e),l=!0):g=e}if(null!==g.PrevInSEL)g.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};r.Clipper.prototype.EdgesAdjacent=function(e){return e.Edge1.NextInSEL==e.Edge2||e.Edge1.PrevInSEL==e.Edge2};r.Clipper.IntersectNodeSort=
function(e,g){return g.Pt.Y-e.Pt.Y};r.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var e=this.m_IntersectList.length,g=0;g<e;g++){if(!this.EdgesAdjacent(this.m_IntersectList[g])){for(var l=g+1;l<e&&!this.EdgesAdjacent(this.m_IntersectList[l]);)l++;if(l==e)return!1;var q=this.m_IntersectList[g];this.m_IntersectList[g]=this.m_IntersectList[l];this.m_IntersectList[l]=q}this.SwapPositionsInSEL(this.m_IntersectList[g].Edge1,
this.m_IntersectList[g].Edge2)}return!0};r.Clipper.prototype.ProcessIntersectList=function(){for(var e=0,g=this.m_IntersectList.length;e<g;e++){var l=this.m_IntersectList[e];this.IntersectEdges(l.Edge1,l.Edge2,l.Pt);this.SwapPositionsInAEL(l.Edge1,l.Edge2)}this.m_IntersectList.length=0};U=function(e){return 0>e?Math.ceil(e-.5):Math.round(e)};Ha=function(e){return 0>e?Math.ceil(e-.5):Math.floor(e+.5)};Hb=function(e){return 0>e?-Math.round(Math.abs(e)):Math.round(e)};Nb=function(e){if(0>e)return e-=
.5,-2147483648>e?Math.ceil(e):e|0;e+=.5;return 2147483647<e?Math.floor(e):e|0};r.Clipper.Round=gb?U:$a?Hb:za?Nb:Ha;r.Clipper.TopX=function(e,g){return g==e.Top.Y?e.Top.X:e.Bot.X+r.Clipper.Round(e.Dx*(g-e.Bot.Y))};r.Clipper.prototype.IntersectPoint=function(e,g,l){l.X=0;l.Y=0;var q,x;if(e.Dx==g.Dx)l.Y=e.Curr.Y,l.X=r.Clipper.TopX(e,l.Y);else{if(0===e.Delta.X)l.X=e.Bot.X,r.ClipperBase.IsHorizontal(g)?l.Y=g.Bot.Y:(x=g.Bot.Y-g.Bot.X/g.Dx,l.Y=r.Clipper.Round(l.X/g.Dx+x));else if(0===g.Delta.X)l.X=g.Bot.X,
r.ClipperBase.IsHorizontal(e)?l.Y=e.Bot.Y:(q=e.Bot.Y-e.Bot.X/e.Dx,l.Y=r.Clipper.Round(l.X/e.Dx+q));else{q=e.Bot.X-e.Bot.Y*e.Dx;x=g.Bot.X-g.Bot.Y*g.Dx;var G=(x-q)/(e.Dx-g.Dx);l.Y=r.Clipper.Round(G);l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?r.Clipper.Round(e.Dx*G+q):r.Clipper.Round(g.Dx*G+x)}if(l.Y<e.Top.Y||l.Y<g.Top.Y){if(e.Top.Y>g.Top.Y)return l.Y=e.Top.Y,l.X=r.Clipper.TopX(g,e.Top.Y),l.X<e.Top.X;l.Y=g.Top.Y;l.X=Math.abs(e.Dx)<Math.abs(g.Dx)?r.Clipper.TopX(e,l.Y):r.Clipper.TopX(g,l.Y)}l.Y>e.Curr.Y&&(l.Y=
e.Curr.Y,l.X=Math.abs(e.Dx)>Math.abs(g.Dx)?r.Clipper.TopX(g,l.Y):r.Clipper.TopX(e,l.Y))}};r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(e){for(var g=this.m_ActiveEdges;null!==g;){var l=this.IsMaxima(g,e);l&&(l=this.GetMaximaPair(g),l=null===l||!r.ClipperBase.IsHorizontal(l));if(l){var q=g.PrevInAEL;this.DoMaxima(g);g=null===q?this.m_ActiveEdges:q.NextInAEL}else{this.IsIntermediate(g,e)&&r.ClipperBase.IsHorizontal(g.NextInLML)?(g=this.UpdateEdgeIntoAEL(g),0<=g.OutIdx&&this.AddOutPt(g,g.Bot),
this.AddEdgeToSEL(g)):(g.Curr.X=r.Clipper.TopX(g,e),g.Curr.Y=e);if(this.StrictlySimple&&(q=g.PrevInAEL,0<=g.OutIdx&&0!==g.WindDelta&&null!==q&&0<=q.OutIdx&&q.Curr.X==g.Curr.X&&0!==q.WindDelta)){var x=new r.IntPoint(g.Curr);r.use_xyz&&this.SetZ(x,q,g);l=this.AddOutPt(q,x);q=this.AddOutPt(g,x);this.AddJoin(l,q,x)}g=g.NextInAEL}}this.ProcessHorizontals(!0);for(g=this.m_ActiveEdges;null!==g;)this.IsIntermediate(g,e)&&(l=null,0<=g.OutIdx&&(l=this.AddOutPt(g,g.Top)),g=this.UpdateEdgeIntoAEL(g),q=g.PrevInAEL,
x=g.NextInAEL,null!==q&&q.Curr.X==g.Bot.X&&q.Curr.Y==g.Bot.Y&&null!==l&&0<=q.OutIdx&&q.Curr.Y>q.Top.Y&&r.ClipperBase.SlopesEqual(g,q,this.m_UseFullRange)&&0!==g.WindDelta&&0!==q.WindDelta?(q=this.AddOutPt(q,g.Bot),this.AddJoin(l,q,g.Top)):null!==x&&x.Curr.X==g.Bot.X&&x.Curr.Y==g.Bot.Y&&null!==l&&0<=x.OutIdx&&x.Curr.Y>x.Top.Y&&r.ClipperBase.SlopesEqual(g,x,this.m_UseFullRange)&&0!==g.WindDelta&&0!==x.WindDelta&&(q=this.AddOutPt(x,g.Bot),this.AddJoin(l,q,g.Top))),g=g.NextInAEL};r.Clipper.prototype.DoMaxima=
function(e){var g=this.GetMaximaPair(e);if(null===g)0<=e.OutIdx&&this.AddOutPt(e,e.Top),this.DeleteFromAEL(e);else{for(var l=e.NextInAEL;null!==l&&l!=g;)this.IntersectEdges(e,l,e.Top),this.SwapPositionsInAEL(e,l),l=e.NextInAEL;-1==e.OutIdx&&-1==g.OutIdx?(this.DeleteFromAEL(e),this.DeleteFromAEL(g)):0<=e.OutIdx&&0<=g.OutIdx?(0<=e.OutIdx&&this.AddLocalMaxPoly(e,g,e.Top),this.DeleteFromAEL(e),this.DeleteFromAEL(g)):r.use_lines&&0===e.WindDelta?(0<=e.OutIdx&&(this.AddOutPt(e,e.Top),e.OutIdx=-1),this.DeleteFromAEL(e),
0<=g.OutIdx&&(this.AddOutPt(g,e.Top),g.OutIdx=-1),this.DeleteFromAEL(g)):r.Error("DoMaxima error")}};r.Clipper.ReversePaths=function(e){for(var g=0,l=e.length;g<l;g++)e[g].reverse()};r.Clipper.Orientation=function(e){return 0<=r.Clipper.Area(e)};r.Clipper.prototype.PointCount=function(e){if(null===e)return 0;var g=0,l=e;do g++,l=l.Next;while(l!=e);return g};r.Clipper.prototype.BuildResult=function(e){r.Clear(e);for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var q=this.m_PolyOuts[g];if(null!==q.Pts){q=
q.Pts.Prev;var x=this.PointCount(q);if(!(2>x)){for(var G=Array(x),L=0;L<x;L++)G[L]=q.Pt,q=q.Prev;e.push(G)}}}};r.Clipper.prototype.BuildResult2=function(e){e.Clear();for(var g=0,l=this.m_PolyOuts.length;g<l;g++){var q=this.m_PolyOuts[g],x=this.PointCount(q.Pts);if(!(q.IsOpen&&2>x||!q.IsOpen&&3>x)){this.FixHoleLinkage(q);var G=new r.PolyNode;e.m_AllPolys.push(G);q.PolyNode=G;G.m_polygon.length=x;q=q.Pts.Prev;for(var L=0;L<x;L++)G.m_polygon[L]=q.Pt,q=q.Prev}}g=0;for(l=this.m_PolyOuts.length;g<l;g++)q=
this.m_PolyOuts[g],null!==q.PolyNode&&(q.IsOpen?(q.PolyNode.IsOpen=!0,e.AddChild(q.PolyNode)):null!==q.FirstLeft&&null!=q.FirstLeft.PolyNode?q.FirstLeft.PolyNode.AddChild(q.PolyNode):e.AddChild(q.PolyNode))};r.Clipper.prototype.FixupOutPolygon=function(e){var g=null;e.BottomPt=null;for(var l=e.Pts;;){if(l.Prev==l||l.Prev==l.Next){e.Pts=null;return}if(r.IntPoint.op_Equality(l.Pt,l.Next.Pt)||r.IntPoint.op_Equality(l.Pt,l.Prev.Pt)||r.ClipperBase.SlopesEqual(l.Prev.Pt,l.Pt,l.Next.Pt,this.m_UseFullRange)&&
(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(l.Prev.Pt,l.Pt,l.Next.Pt)))g=null,l.Prev.Next=l.Next,l=l.Next.Prev=l.Prev;else if(l==g)break;else null===g&&(g=l),l=l.Next}e.Pts=l};r.Clipper.prototype.DupOutPt=function(e,g){var l=new r.OutPt;l.Pt.X=e.Pt.X;l.Pt.Y=e.Pt.Y;r.use_xyz&&(l.Pt.Z=e.Pt.Z);l.Idx=e.Idx;g?(l.Next=e.Next,l.Prev=e,e.Next.Prev=l,e.Next=l):(l.Prev=e.Prev,l.Next=e,e.Prev.Next=l,e.Prev=l);return l};r.Clipper.prototype.GetOverlap=function(e,g,l,q,x){e<g?l<q?(x.Left=Math.max(e,l),
x.Right=Math.min(g,q)):(x.Left=Math.max(e,q),x.Right=Math.min(g,l)):l<q?(x.Left=Math.max(g,l),x.Right=Math.min(e,q)):(x.Left=Math.max(g,q),x.Right=Math.min(e,l));return x.Left<x.Right};r.Clipper.prototype.JoinHorz=function(e,g,l,q,x,G){var L=e.Pt.X>g.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;q=l.Pt.X>q.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;if(L==q)return!1;if(L==r.Direction.dLeftToRight){for(;e.Next.Pt.X<=x.X&&e.Next.Pt.X>=e.Pt.X&&e.Next.Pt.Y==x.Y;)e=e.Next;G&&e.Pt.X!=
x.X&&(e=e.Next);g=this.DupOutPt(e,!G);r.IntPoint.op_Inequality(g.Pt,x)&&(e=g,e.Pt.X=x.X,e.Pt.Y=x.Y,r.use_xyz&&(e.Pt.Z=x.Z),g=this.DupOutPt(e,!G))}else{for(;e.Next.Pt.X>=x.X&&e.Next.Pt.X<=e.Pt.X&&e.Next.Pt.Y==x.Y;)e=e.Next;G||e.Pt.X==x.X||(e=e.Next);g=this.DupOutPt(e,G);r.IntPoint.op_Inequality(g.Pt,x)&&(e=g,e.Pt.X=x.X,e.Pt.Y=x.Y,r.use_xyz&&(e.Pt.Z=x.Z),g=this.DupOutPt(e,G))}if(q==r.Direction.dLeftToRight){for(;l.Next.Pt.X<=x.X&&l.Next.Pt.X>=l.Pt.X&&l.Next.Pt.Y==x.Y;)l=l.Next;G&&l.Pt.X!=x.X&&(l=l.Next);
q=this.DupOutPt(l,!G);r.IntPoint.op_Inequality(q.Pt,x)&&(l=q,l.Pt.X=x.X,l.Pt.Y=x.Y,r.use_xyz&&(l.Pt.Z=x.Z),q=this.DupOutPt(l,!G))}else{for(;l.Next.Pt.X>=x.X&&l.Next.Pt.X<=l.Pt.X&&l.Next.Pt.Y==x.Y;)l=l.Next;G||l.Pt.X==x.X||(l=l.Next);q=this.DupOutPt(l,G);r.IntPoint.op_Inequality(q.Pt,x)&&(l=q,l.Pt.X=x.X,l.Pt.Y=x.Y,r.use_xyz&&(l.Pt.Z=x.Z),q=this.DupOutPt(l,G))}L==r.Direction.dLeftToRight==G?(e.Prev=l,l.Next=e,g.Next=q,q.Prev=g):(e.Next=l,l.Prev=e,g.Prev=q,q.Next=g);return!0};r.Clipper.prototype.JoinPoints=
function(e,g,l){var q=e.OutPt1,x;new r.OutPt;var G=e.OutPt2,L;new r.OutPt;if((L=e.OutPt1.Pt.Y==e.OffPt.Y)&&r.IntPoint.op_Equality(e.OffPt,e.OutPt1.Pt)&&r.IntPoint.op_Equality(e.OffPt,e.OutPt2.Pt)){if(g!=l)return!1;for(x=e.OutPt1.Next;x!=q&&r.IntPoint.op_Equality(x.Pt,e.OffPt);)x=x.Next;x=x.Pt.Y>e.OffPt.Y;for(L=e.OutPt2.Next;L!=G&&r.IntPoint.op_Equality(L.Pt,e.OffPt);)L=L.Next;if(x==L.Pt.Y>e.OffPt.Y)return!1;x?(x=this.DupOutPt(q,!1),L=this.DupOutPt(G,!0),q.Prev=G,G.Next=q,x.Next=L,L.Prev=x):(x=this.DupOutPt(q,
!0),L=this.DupOutPt(G,!1),q.Next=G,G.Prev=q,x.Prev=L,L.Next=x);e.OutPt1=q;e.OutPt2=x;return!0}if(L){for(x=q;q.Prev.Pt.Y==q.Pt.Y&&q.Prev!=x&&q.Prev!=G;)q=q.Prev;for(;x.Next.Pt.Y==x.Pt.Y&&x.Next!=q&&x.Next!=G;)x=x.Next;if(x.Next==q||x.Next==G)return!1;for(L=G;G.Prev.Pt.Y==G.Pt.Y&&G.Prev!=L&&G.Prev!=x;)G=G.Prev;for(;L.Next.Pt.Y==L.Pt.Y&&L.Next!=G&&L.Next!=q;)L=L.Next;if(L.Next==G||L.Next==q)return!1;l={Left:null,Right:null};if(!this.GetOverlap(q.Pt.X,x.Pt.X,G.Pt.X,L.Pt.X,l))return!1;g=l.Left;var Y=l.Right;
l=new r.IntPoint;q.Pt.X>=g&&q.Pt.X<=Y?(l.X=q.Pt.X,l.Y=q.Pt.Y,r.use_xyz&&(l.Z=q.Pt.Z),g=q.Pt.X>x.Pt.X):G.Pt.X>=g&&G.Pt.X<=Y?(l.X=G.Pt.X,l.Y=G.Pt.Y,r.use_xyz&&(l.Z=G.Pt.Z),g=G.Pt.X>L.Pt.X):x.Pt.X>=g&&x.Pt.X<=Y?(l.X=x.Pt.X,l.Y=x.Pt.Y,r.use_xyz&&(l.Z=x.Pt.Z),g=x.Pt.X>q.Pt.X):(l.X=L.Pt.X,l.Y=L.Pt.Y,r.use_xyz&&(l.Z=L.Pt.Z),g=L.Pt.X>G.Pt.X);e.OutPt1=q;e.OutPt2=G;return this.JoinHorz(q,x,G,L,l,g)}for(x=q.Next;r.IntPoint.op_Equality(x.Pt,q.Pt)&&x!=q;)x=x.Next;if(Y=x.Pt.Y>q.Pt.Y||!r.ClipperBase.SlopesEqual(q.Pt,
x.Pt,e.OffPt,this.m_UseFullRange)){for(x=q.Prev;r.IntPoint.op_Equality(x.Pt,q.Pt)&&x!=q;)x=x.Prev;if(x.Pt.Y>q.Pt.Y||!r.ClipperBase.SlopesEqual(q.Pt,x.Pt,e.OffPt,this.m_UseFullRange))return!1}for(L=G.Next;r.IntPoint.op_Equality(L.Pt,G.Pt)&&L!=G;)L=L.Next;var ja=L.Pt.Y>G.Pt.Y||!r.ClipperBase.SlopesEqual(G.Pt,L.Pt,e.OffPt,this.m_UseFullRange);if(ja){for(L=G.Prev;r.IntPoint.op_Equality(L.Pt,G.Pt)&&L!=G;)L=L.Prev;if(L.Pt.Y>G.Pt.Y||!r.ClipperBase.SlopesEqual(G.Pt,L.Pt,e.OffPt,this.m_UseFullRange))return!1}if(x==
q||L==G||x==L||g==l&&Y==ja)return!1;Y?(x=this.DupOutPt(q,!1),L=this.DupOutPt(G,!0),q.Prev=G,G.Next=q,x.Next=L,L.Prev=x):(x=this.DupOutPt(q,!0),L=this.DupOutPt(G,!1),q.Next=G,G.Prev=q,x.Prev=L,L.Next=x);e.OutPt1=q;e.OutPt2=x;return!0};r.Clipper.GetBounds=function(e){for(var g=0,l=e.length;g<l&&0==e[g].length;)g++;if(g==l)return new r.IntRect(0,0,0,0);var q=new r.IntRect;q.left=e[g][0].X;q.right=q.left;q.top=e[g][0].Y;for(q.bottom=q.top;g<l;g++)for(var x=0,G=e[g].length;x<G;x++)e[g][x].X<q.left?q.left=
e[g][x].X:e[g][x].X>q.right&&(q.right=e[g][x].X),e[g][x].Y<q.top?q.top=e[g][x].Y:e[g][x].Y>q.bottom&&(q.bottom=e[g][x].Y);return q};r.Clipper.prototype.GetBounds2=function(e){var g=e,l=new r.IntRect;l.left=e.Pt.X;l.right=e.Pt.X;l.top=e.Pt.Y;l.bottom=e.Pt.Y;for(e=e.Next;e!=g;)e.Pt.X<l.left&&(l.left=e.Pt.X),e.Pt.X>l.right&&(l.right=e.Pt.X),e.Pt.Y<l.top&&(l.top=e.Pt.Y),e.Pt.Y>l.bottom&&(l.bottom=e.Pt.Y),e=e.Next;return l};r.Clipper.PointInPolygon=function(e,g){var l=0,q=g.length;if(3>q)return 0;for(var x=
g[0],G=1;G<=q;++G){var L=G==q?g[0]:g[G];if(L.Y==e.Y&&(L.X==e.X||x.Y==e.Y&&L.X>e.X==x.X<e.X))return-1;if(x.Y<e.Y!=L.Y<e.Y)if(x.X>=e.X)if(L.X>e.X)l=1-l;else{var Y=(x.X-e.X)*(L.Y-e.Y)-(L.X-e.X)*(x.Y-e.Y);if(0==Y)return-1;0<Y==L.Y>x.Y&&(l=1-l)}else if(L.X>e.X){Y=(x.X-e.X)*(L.Y-e.Y)-(L.X-e.X)*(x.Y-e.Y);if(0==Y)return-1;0<Y==L.Y>x.Y&&(l=1-l)}x=L}return l};r.Clipper.prototype.PointInPolygon=function(e,g){var l=0,q=g,x=e.X;e=e.Y;var G=g.Pt.X,L=g.Pt.Y;do{g=g.Next;var Y=g.Pt.X,ja=g.Pt.Y;if(ja==e&&(Y==x||L==
e&&Y>x==G<x))return-1;if(L<e!=ja<e)if(G>=x)if(Y>x)l=1-l;else{G=(G-x)*(ja-e)-(Y-x)*(L-e);if(0==G)return-1;0<G==ja>L&&(l=1-l)}else if(Y>x){G=(G-x)*(ja-e)-(Y-x)*(L-e);if(0==G)return-1;0<G==ja>L&&(l=1-l)}G=Y;L=ja}while(q!=g);return l};r.Clipper.prototype.Poly2ContainsPoly1=function(e,g){var l=e;do{var q=this.PointInPolygon(l.Pt,g);if(0<=q)return 0<q;l=l.Next}while(l!=e);return!0};r.Clipper.prototype.FixupFirstLefts1=function(e,g){for(var l=0,q=this.m_PolyOuts.length;l<q;l++){var x=this.m_PolyOuts[l];
null!=x.Pts&&null!=x.FirstLeft&&this.ParseFirstLeft(x.FirstLeft)==e&&this.Poly2ContainsPoly1(x.Pts,g.Pts)&&(x.FirstLeft=g)}};r.Clipper.prototype.FixupFirstLefts2=function(e,g){for(var l=0,q=this.m_PolyOuts,x=q.length,G=q[l];l<x;l++,G=q[l])G.FirstLeft==e&&(G.FirstLeft=g)};r.Clipper.ParseFirstLeft=function(e){for(;null!=e&&null==e.Pts;)e=e.FirstLeft;return e};r.Clipper.prototype.JoinCommonEdges=function(){for(var e=0,g=this.m_Joins.length;e<g;e++){var l=this.m_Joins[e],q=this.GetOutRec(l.OutPt1.Idx),
x=this.GetOutRec(l.OutPt2.Idx);if(null!=q.Pts&&null!=x.Pts){var G=q==x?q:this.Param1RightOfParam2(q,x)?x:this.Param1RightOfParam2(x,q)?q:this.GetLowermostRec(q,x);if(this.JoinPoints(l,q,x))if(q==x){q.Pts=l.OutPt1;q.BottomPt=null;x=this.CreateOutRec();x.Pts=l.OutPt2;this.UpdateOutPtIdxs(x);if(this.m_UsingPolyTree){G=0;for(var L=this.m_PolyOuts.length;G<L-1;G++){var Y=this.m_PolyOuts[G];null!=Y.Pts&&r.Clipper.ParseFirstLeft(Y.FirstLeft)==q&&Y.IsHole!=q.IsHole&&this.Poly2ContainsPoly1(Y.Pts,l.OutPt2)&&
(Y.FirstLeft=x)}}this.Poly2ContainsPoly1(x.Pts,q.Pts)?(x.IsHole=!q.IsHole,x.FirstLeft=q,this.m_UsingPolyTree&&this.FixupFirstLefts2(x,q),(x.IsHole^this.ReverseSolution)==0<this.Area(x)&&this.ReversePolyPtLinks(x.Pts)):this.Poly2ContainsPoly1(q.Pts,x.Pts)?(x.IsHole=q.IsHole,q.IsHole=!x.IsHole,x.FirstLeft=q.FirstLeft,q.FirstLeft=x,this.m_UsingPolyTree&&this.FixupFirstLefts2(q,x),(q.IsHole^this.ReverseSolution)==0<this.Area(q)&&this.ReversePolyPtLinks(q.Pts)):(x.IsHole=q.IsHole,x.FirstLeft=q.FirstLeft,
this.m_UsingPolyTree&&this.FixupFirstLefts1(q,x))}else x.Pts=null,x.BottomPt=null,x.Idx=q.Idx,q.IsHole=G.IsHole,G==x&&(q.FirstLeft=x.FirstLeft),x.FirstLeft=q,this.m_UsingPolyTree&&this.FixupFirstLefts2(x,q)}}};r.Clipper.prototype.UpdateOutPtIdxs=function(e){var g=e.Pts;do g.Idx=e.Idx,g=g.Prev;while(g!=e.Pts)};r.Clipper.prototype.DoSimplePolygons=function(){for(var e=0;e<this.m_PolyOuts.length;){var g=this.m_PolyOuts[e++],l=g.Pts;if(null!=l&&!g.IsOpen){do{for(var q=l.Next;q!=g.Pts;){if(r.IntPoint.op_Equality(l.Pt,
q.Pt)&&q.Next!=l&&q.Prev!=l){var x=l.Prev,G=q.Prev;l.Prev=G;G.Next=l;q.Prev=x;x.Next=q;g.Pts=l;x=this.CreateOutRec();x.Pts=q;this.UpdateOutPtIdxs(x);this.Poly2ContainsPoly1(x.Pts,g.Pts)?(x.IsHole=!g.IsHole,x.FirstLeft=g,this.m_UsingPolyTree&&this.FixupFirstLefts2(x,g)):this.Poly2ContainsPoly1(g.Pts,x.Pts)?(x.IsHole=g.IsHole,g.IsHole=!x.IsHole,x.FirstLeft=g.FirstLeft,g.FirstLeft=x,this.m_UsingPolyTree&&this.FixupFirstLefts2(g,x)):(x.IsHole=g.IsHole,x.FirstLeft=g.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(g,
x));q=l}q=q.Next}l=l.Next}while(l!=g.Pts)}}};r.Clipper.Area=function(e){var g=e.length;if(3>g)return 0;for(var l=0,q=0,x=g-1;q<g;++q)l+=(e[x].X+e[q].X)*(e[x].Y-e[q].Y),x=q;return.5*-l};r.Clipper.prototype.Area=function(e){var g=e.Pts;if(null==g)return 0;var l=0;do l+=(g.Prev.Pt.X+g.Pt.X)*(g.Prev.Pt.Y-g.Pt.Y),g=g.Next;while(g!=e.Pts);return.5*l};r.Clipper.SimplifyPolygon=function(e,g){var l=[],q=new r.Clipper(0);q.StrictlySimple=!0;q.AddPath(e,r.PolyType.ptSubject,!0);q.Execute(r.ClipType.ctUnion,
l,g,g);return l};r.Clipper.SimplifyPolygons=function(e,g){"undefined"==typeof g&&(g=r.PolyFillType.pftEvenOdd);var l=[],q=new r.Clipper(0);q.StrictlySimple=!0;q.AddPaths(e,r.PolyType.ptSubject,!0);q.Execute(r.ClipType.ctUnion,l,g,g);return l};r.Clipper.DistanceSqrd=function(e,g){var l=e.X-g.X;e=e.Y-g.Y;return l*l+e*e};r.Clipper.DistanceFromLineSqrd=function(e,g,l){var q=g.Y-l.Y;l=l.X-g.X;g=q*g.X+l*g.Y;g=q*e.X+l*e.Y-g;return g*g/(q*q+l*l)};r.Clipper.SlopesNearCollinear=function(e,g,l,q){return Math.abs(e.X-
g.X)>Math.abs(e.Y-g.Y)?e.X>g.X==e.X<l.X?r.Clipper.DistanceFromLineSqrd(e,g,l)<q:g.X>e.X==g.X<l.X?r.Clipper.DistanceFromLineSqrd(g,e,l)<q:r.Clipper.DistanceFromLineSqrd(l,e,g)<q:e.Y>g.Y==e.Y<l.Y?r.Clipper.DistanceFromLineSqrd(e,g,l)<q:g.Y>e.Y==g.Y<l.Y?r.Clipper.DistanceFromLineSqrd(g,e,l)<q:r.Clipper.DistanceFromLineSqrd(l,e,g)<q};r.Clipper.PointsAreClose=function(e,g,l){var q=e.X-g.X;e=e.Y-g.Y;return q*q+e*e<=l};r.Clipper.ExcludeOp=function(e){var g=e.Prev;g.Next=e.Next;e.Next.Prev=g;g.Idx=0;return g};
r.Clipper.CleanPolygon=function(e,g){"undefined"==typeof g&&(g=1.415);var l=e.length;if(0==l)return[];for(var q=Array(l),x=0;x<l;++x)q[x]=new r.OutPt;for(x=0;x<l;++x)q[x].Pt=e[x],q[x].Next=q[(x+1)%l],q[x].Next.Prev=q[x],q[x].Idx=0;x=g*g;for(q=q[0];0==q.Idx&&q.Next!=q.Prev;)r.Clipper.PointsAreClose(q.Pt,q.Prev.Pt,x)?(q=r.Clipper.ExcludeOp(q),l--):r.Clipper.PointsAreClose(q.Prev.Pt,q.Next.Pt,x)?(r.Clipper.ExcludeOp(q.Next),q=r.Clipper.ExcludeOp(q),l-=2):r.Clipper.SlopesNearCollinear(q.Prev.Pt,q.Pt,
q.Next.Pt,x)?(q=r.Clipper.ExcludeOp(q),l--):(q.Idx=1,q=q.Next);3>l&&(l=0);e=Array(l);for(x=0;x<l;++x)e[x]=new r.IntPoint(q.Pt),q=q.Next;return e};r.Clipper.CleanPolygons=function(e,g){for(var l=Array(e.length),q=0,x=e.length;q<x;q++)l[q]=r.Clipper.CleanPolygon(e[q],g);return l};r.Clipper.Minkowski=function(e,g,l,q){q=q?1:0;var x=e.length,G=g.length,L=[];if(l)for(l=0;l<G;l++){for(var Y=Array(x),ja=0,pa=e.length,Ma=e[ja];ja<pa;ja++,Ma=e[ja])Y[ja]=new r.IntPoint(g[l].X+Ma.X,g[l].Y+Ma.Y);L.push(Y)}else for(l=
0;l<G;l++){Y=Array(x);ja=0;pa=e.length;for(Ma=e[ja];ja<pa;ja++,Ma=e[ja])Y[ja]=new r.IntPoint(g[l].X-Ma.X,g[l].Y-Ma.Y);L.push(Y)}e=[];for(l=0;l<G-1+q;l++)for(ja=0;ja<x;ja++)g=[],g.push(L[l%G][ja%x]),g.push(L[(l+1)%G][ja%x]),g.push(L[(l+1)%G][(ja+1)%x]),g.push(L[l%G][(ja+1)%x]),r.Clipper.Orientation(g)||g.reverse(),e.push(g);return e};r.Clipper.MinkowskiSum=function(e,g,l){if(g[0]instanceof Array){L=g;g=new r.Paths;for(var q=new r.Clipper,x=0;x<L.length;++x){var G=r.Clipper.Minkowski(e,L[x],!0,l);q.AddPaths(G,
r.PolyType.ptSubject,!0);l&&(G=r.Clipper.TranslatePath(L[x],e[0]),q.AddPath(G,r.PolyType.ptClip,!0))}q.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return g}var L=r.Clipper.Minkowski(e,g,!0,l);q=new r.Clipper;q.AddPaths(L,r.PolyType.ptSubject,!0);q.Execute(r.ClipType.ctUnion,L,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return L};r.Clipper.TranslatePath=function(e,g){for(var l=new r.Path,q=0;q<e.length;q++)l.push(new r.IntPoint(e[q].X+g.X,e[q].Y+g.Y));
return l};r.Clipper.MinkowskiDiff=function(e,g){e=r.Clipper.Minkowski(e,g,!1,!0);g=new r.Clipper;g.AddPaths(e,r.PolyType.ptSubject,!0);g.Execute(r.ClipType.ctUnion,e,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return e};r.Clipper.PolyTreeToPaths=function(e){var g=[];r.Clipper.AddPolyNodeToPaths(e,r.Clipper.NodeType.ntAny,g);return g};r.Clipper.AddPolyNodeToPaths=function(e,g,l){var q=!0;switch(g){case r.Clipper.NodeType.ntOpen:return;case r.Clipper.NodeType.ntClosed:q=!e.IsOpen}0<e.m_polygon.length&&
q&&l.push(e.m_polygon);q=0;e=e.Childs();for(var x=e.length,G=e[q];q<x;q++,G=e[q])r.Clipper.AddPolyNodeToPaths(G,g,l)};r.Clipper.OpenPathsFromPolyTree=function(e){for(var g=new r.Paths,l=0,q=e.ChildCount();l<q;l++)e.Childs()[l].IsOpen&&g.push(e.Childs()[l].m_polygon);return g};r.Clipper.ClosedPathsFromPolyTree=function(e){var g=new r.Paths;r.Clipper.AddPolyNodeToPaths(e,r.Clipper.NodeType.ntClosed,g);return g};cb(r.Clipper,r.ClipperBase);r.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};r.ClipperOffset=
function(e,g){"undefined"==typeof e&&(e=2);"undefined"==typeof g&&(g=r.ClipperOffset.def_arc_tolerance);this.m_destPolys=new r.Paths;this.m_srcPoly=new r.Path;this.m_destPoly=new r.Path;this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new r.IntPoint;this.m_polyNodes=new r.PolyNode;this.MiterLimit=e;this.ArcTolerance=g;this.m_lowest.X=-1};r.ClipperOffset.two_pi=6.28318530717959;r.ClipperOffset.def_arc_tolerance=.25;r.ClipperOffset.prototype.Clear=
function(){r.Clear(this.m_polyNodes.Childs());this.m_lowest.X=-1};r.ClipperOffset.Round=r.Clipper.Round;r.ClipperOffset.prototype.AddPath=function(e,g,l){var q=e.length-1;if(!(0>q)){var x=new r.PolyNode;x.m_jointype=g;x.m_endtype=l;if(l==r.EndType.etClosedLine||l==r.EndType.etClosedPolygon)for(;0<q&&r.IntPoint.op_Equality(e[0],e[q]);)q--;x.m_polygon.push(e[0]);var G=0;g=0;for(var L=1;L<=q;L++)r.IntPoint.op_Inequality(x.m_polygon[G],e[L])&&(G++,x.m_polygon.push(e[L]),e[L].Y>x.m_polygon[g].Y||e[L].Y==
x.m_polygon[g].Y&&e[L].X<x.m_polygon[g].X)&&(g=G);if(!(l==r.EndType.etClosedPolygon&&2>G)&&(this.m_polyNodes.AddChild(x),l==r.EndType.etClosedPolygon))if(0>this.m_lowest.X)this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,g);else if(e=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],x.m_polygon[g].Y>e.Y||x.m_polygon[g].Y==e.Y&&x.m_polygon[g].X<e.X)this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,g)}};r.ClipperOffset.prototype.AddPaths=function(e,g,l){for(var q=
0,x=e.length;q<x;q++)this.AddPath(e[q],g,l)};r.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!r.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var g=this.m_polyNodes.Childs()[e];(g.m_endtype==r.EndType.etClosedPolygon||g.m_endtype==r.EndType.etClosedLine&&r.Clipper.Orientation(g.m_polygon))&&g.m_polygon.reverse()}else for(e=0;e<this.m_polyNodes.ChildCount();e++)g=this.m_polyNodes.Childs()[e],g.m_endtype!=
r.EndType.etClosedLine||r.Clipper.Orientation(g.m_polygon)||g.m_polygon.reverse()};r.ClipperOffset.GetUnitNormal=function(e,g){var l=g.X-e.X;e=g.Y-e.Y;if(0==l&&0==e)return new r.DoublePoint(0,0);g=1/Math.sqrt(l*l+e*e);return new r.DoublePoint(e*g,-(l*g))};r.ClipperOffset.prototype.DoOffset=function(e){this.m_destPolys=[];this.m_delta=e;if(r.ClipperBase.near_zero(e))for(var g=0;g<this.m_polyNodes.ChildCount();g++){var l=this.m_polyNodes.Childs()[g];l.m_endtype==r.EndType.etClosedPolygon&&this.m_destPolys.push(l.m_polygon)}else{this.m_miterLim=
2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var q=3.14159265358979/Math.acos(1-(0>=this.ArcTolerance?r.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(e)*r.ClipperOffset.def_arc_tolerance?Math.abs(e)*r.ClipperOffset.def_arc_tolerance:this.ArcTolerance)/Math.abs(e));this.m_sin=Math.sin(r.ClipperOffset.two_pi/q);this.m_cos=Math.cos(r.ClipperOffset.two_pi/q);this.m_StepsPerRad=q/r.ClipperOffset.two_pi;0>e&&(this.m_sin=-this.m_sin);for(g=0;g<this.m_polyNodes.ChildCount();g++){l=
this.m_polyNodes.Childs()[g];this.m_srcPoly=l.m_polygon;var x=this.m_srcPoly.length;if(!(0==x||0>=e&&(3>x||l.m_endtype!=r.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==x)if(l.m_jointype==r.JoinType.jtRound){l=1;x=0;for(var G=1;G<=q;G++){this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+l*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y+x*e)));var L=l;l=l*this.m_cos-this.m_sin*x;x=L*this.m_sin+x*this.m_cos}}else for(x=l=-1,G=0;4>G;++G)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+
l*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y+x*e))),0>l?l=1:0>x?x=1:l=-1;else{for(G=this.m_normals.length=0;G<x-1;G++)this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[G],this.m_srcPoly[G+1]));l.m_endtype==r.EndType.etClosedLine||l.m_endtype==r.EndType.etClosedPolygon?this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[x-1],this.m_srcPoly[0])):this.m_normals.push(new r.DoublePoint(this.m_normals[x-2]));if(l.m_endtype==r.EndType.etClosedPolygon)for(L=x-1,G=0;G<x;G++)L=
this.OffsetPoint(G,L,l.m_jointype);else if(l.m_endtype==r.EndType.etClosedLine){L=x-1;for(G=0;G<x;G++)L=this.OffsetPoint(G,L,l.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=[];L=this.m_normals[x-1];for(G=x-1;0<G;G--)this.m_normals[G]=new r.DoublePoint(-this.m_normals[G-1].X,-this.m_normals[G-1].Y);this.m_normals[0]=new r.DoublePoint(-L.X,-L.Y);L=0;for(G=x-1;0<=G;G--)L=this.OffsetPoint(G,L,l.m_jointype)}else{L=0;for(G=1;G<x-1;++G)L=this.OffsetPoint(G,L,l.m_jointype);l.m_endtype==
r.EndType.etOpenButt?(G=x-1,L=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[G].X+this.m_normals[G].X*e),r.ClipperOffset.Round(this.m_srcPoly[G].Y+this.m_normals[G].Y*e)),this.m_destPoly.push(L),L=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[G].X-this.m_normals[G].X*e),r.ClipperOffset.Round(this.m_srcPoly[G].Y-this.m_normals[G].Y*e)),this.m_destPoly.push(L)):(G=x-1,L=x-2,this.m_sinA=0,this.m_normals[G]=new r.DoublePoint(-this.m_normals[G].X,-this.m_normals[G].Y),l.m_endtype==r.EndType.etOpenSquare?
this.DoSquare(G,L):this.DoRound(G,L));for(G=x-1;0<G;G--)this.m_normals[G]=new r.DoublePoint(-this.m_normals[G-1].X,-this.m_normals[G-1].Y);this.m_normals[0]=new r.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y);L=x-1;for(G=L-1;0<G;--G)L=this.OffsetPoint(G,L,l.m_jointype);l.m_endtype==r.EndType.etOpenButt?(L=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*e)),this.m_destPoly.push(L),L=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+
this.m_normals[0].X*e),r.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*e)),this.m_destPoly.push(L)):(this.m_sinA=0,l.m_endtype==r.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};r.ClipperOffset.prototype.Execute=function(){var e=arguments;if(e[0]instanceof r.PolyTree)if(g=e[0],l=e[1],g.Clear(),this.FixOrientations(),this.DoOffset(l),e=new r.Clipper(0),e.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),0<l)e.Execute(r.ClipType.ctUnion,
g,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else if(l=r.Clipper.GetBounds(this.m_destPolys),q=new r.Path,q.push(new r.IntPoint(l.left-10,l.bottom+10)),q.push(new r.IntPoint(l.right+10,l.bottom+10)),q.push(new r.IntPoint(l.right+10,l.top-10)),q.push(new r.IntPoint(l.left-10,l.top-10)),e.AddPath(q,r.PolyType.ptSubject,!0),e.ReverseSolution=!0,e.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),1==g.ChildCount()&&0<g.Childs()[0].ChildCount())for(e=g.Childs()[0],
g.Childs()[0]=e.Childs()[0],g.Childs()[0].m_Parent=g,l=1;l<e.ChildCount();l++)g.AddChild(e.Childs()[l]);else g.Clear();else{var g=e[0],l=e[1];r.Clear(g);this.FixOrientations();this.DoOffset(l);e=new r.Clipper(0);e.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0);if(0<l)e.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{l=r.Clipper.GetBounds(this.m_destPolys);var q=new r.Path;q.push(new r.IntPoint(l.left-10,l.bottom+10));q.push(new r.IntPoint(l.right+10,l.bottom+
10));q.push(new r.IntPoint(l.right+10,l.top-10));q.push(new r.IntPoint(l.left-10,l.top-10));e.AddPath(q,r.PolyType.ptSubject,!0);e.ReverseSolution=!0;e.Execute(r.ClipType.ctUnion,g,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative);0<g.length&&g.splice(0,1)}}};r.ClipperOffset.prototype.OffsetPoint=function(e,g,l){this.m_sinA=this.m_normals[g].X*this.m_normals[e].Y-this.m_normals[e].X*this.m_normals[g].Y;if(1>Math.abs(this.m_sinA*this.m_delta)){if(0<this.m_normals[g].X*this.m_normals[e].X+this.m_normals[e].Y*
this.m_normals[g].Y)return this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),g}else 1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[g].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[g].Y*this.m_delta))),
this.m_destPoly.push(new r.IntPoint(this.m_srcPoly[e])),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)));else switch(l){case r.JoinType.jtMiter:l=1+(this.m_normals[e].X*this.m_normals[g].X+this.m_normals[e].Y*this.m_normals[g].Y);l>=this.m_miterLim?this.DoMiter(e,g,l):this.DoSquare(e,g);break;case r.JoinType.jtSquare:this.DoSquare(e,g);break;case r.JoinType.jtRound:this.DoRound(e,
g)}return e};r.ClipperOffset.prototype.DoSquare=function(e,g){var l=Math.tan(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)/4);this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*(this.m_normals[g].X-this.m_normals[g].Y*l)),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[g].Y+this.m_normals[g].X*l))));this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_delta*
(this.m_normals[e].X+this.m_normals[e].Y*l)),r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_delta*(this.m_normals[e].Y-this.m_normals[e].X*l))))};r.ClipperOffset.prototype.DoMiter=function(e,g,l){l=this.m_delta/l;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+(this.m_normals[g].X+this.m_normals[e].X)*l),r.ClipperOffset.Round(this.m_srcPoly[e].Y+(this.m_normals[g].Y+this.m_normals[e].Y)*l)))};r.ClipperOffset.prototype.DoRound=function(e,g){var l=Math.max(r.Cast_Int32(r.ClipperOffset.Round(this.m_StepsPerRad*
Math.abs(Math.atan2(this.m_sinA,this.m_normals[g].X*this.m_normals[e].X+this.m_normals[g].Y*this.m_normals[e].Y)))),1),q=this.m_normals[g].X;g=this.m_normals[g].Y;for(var x,G=0;G<l;++G)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+q*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[e].Y+g*this.m_delta))),x=q,q=q*this.m_cos-this.m_sin*g,g=x*this.m_sin+g*this.m_cos;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[e].X+this.m_normals[e].X*this.m_delta),
r.ClipperOffset.Round(this.m_srcPoly[e].Y+this.m_normals[e].Y*this.m_delta)))};r.Error=function(e){try{throw Error(e);}catch(g){alert(g.message)}};r.JS={};r.JS.AreaOfPolygon=function(e,g){g||(g=1);return r.Clipper.Area(e)/(g*g)};r.JS.AreaOfPolygons=function(e,g){g||(g=1);for(var l=0,q=0;q<e.length;q++)l+=r.Clipper.Area(e[q]);return l/(g*g)};r.JS.BoundsOfPath=function(e,g){return r.JS.BoundsOfPaths([e],g)};r.JS.BoundsOfPaths=function(e,g){g||(g=1);e=r.Clipper.GetBounds(e);e.left/=g;e.bottom/=g;e.right/=
g;e.top/=g;return e};r.JS.Clean=function(e,g){if(!(e instanceof Array))return[];var l=e[0]instanceof Array;e=r.JS.Clone(e);if("number"!=typeof g||null===g)return r.Error("Delta is not a number in Clean()."),e;if(0===e.length||1==e.length&&0===e[0].length||0>g)return e;l||(e=[e]);for(var q=e.length,x,G,L,Y,ja,pa,Ma,ab=[],qa=0;qa<q;qa++)if(G=e[qa],x=G.length,0!==x)if(3>x)L=G,ab.push(L);else{L=G;Y=g*g;ja=G[0];for(Ma=pa=1;Ma<x;Ma++)(G[Ma].X-ja.X)*(G[Ma].X-ja.X)+(G[Ma].Y-ja.Y)*(G[Ma].Y-ja.Y)<=Y||(L[pa]=
G[Ma],ja=G[Ma],pa++);ja=G[pa-1];(G[0].X-ja.X)*(G[0].X-ja.X)+(G[0].Y-ja.Y)*(G[0].Y-ja.Y)<=Y&&pa--;pa<x&&L.splice(pa,x-pa);L.length&&ab.push(L)}!l&&ab.length?ab=ab[0]:l||0!==ab.length?l&&0===ab.length&&(ab=[[]]):ab=[];return ab};r.JS.Clone=function(e){if(!(e instanceof Array)||0===e.length)return[];if(1==e.length&&0===e[0].length)return[[]];var g=e[0]instanceof Array;g||(e=[e]);var l=e.length,q,x,G=Array(l);for(q=0;q<l;q++){var L=e[q].length;var Y=Array(L);for(x=0;x<L;x++)Y[x]={X:e[q][x].X,Y:e[q][x].Y};
G[q]=Y}g||(G=G[0]);return G};r.JS.Lighten=function(e,g){if(!(e instanceof Array))return[];if("number"!=typeof g||null===g)return r.Error("Tolerance is not a number in Lighten()."),r.JS.Clone(e);if(0===e.length||1==e.length&&0===e[0].length||0>g)return r.JS.Clone(e);e[0]instanceof Array||(e=[e]);var l,q,x,G,L,Y=e.length,ja=g*g,pa=[];for(g=0;g<Y;g++)if(q=e[g],G=q.length,0!=G){for(x=0;1E6>x;x++){var Ma=[];G=q.length;q[G-1].X!=q[0].X||q[G-1].Y!=q[0].Y?(L=1,q.push({X:q[0].X,Y:q[0].Y}),G=q.length):L=0;
var ab=[];for(l=0;l<G-2;l++){var qa=q[l];var yb=q[l+1];var Va=q[l+2];var yc=qa.X;var vb=qa.Y;qa=Va.X-yc;var ac=Va.Y-vb;if(0!==qa||0!==ac){var kc=((yb.X-yc)*qa+(yb.Y-vb)*ac)/(qa*qa+ac*ac);1<kc?(yc=Va.X,vb=Va.Y):0<kc&&(yc+=qa*kc,vb+=ac*kc)}qa=yb.X-yc;ac=yb.Y-vb;Va=qa*qa+ac*ac;Va<=ja&&(ab[l+1]=1,l++)}Ma.push({X:q[0].X,Y:q[0].Y});for(l=1;l<G-1;l++)ab[l]||Ma.push({X:q[l].X,Y:q[l].Y});Ma.push({X:q[G-1].X,Y:q[G-1].Y});L&&q.pop();if(ab.length)q=Ma;else break}G=Ma.length;Ma[G-1].X==Ma[0].X&&Ma[G-1].Y==Ma[0].Y&&
Ma.pop();2<Ma.length&&pa.push(Ma)}e[0]instanceof Array||(pa=pa[0]);"undefined"==typeof pa&&(pa=[[]]);return pa};r.JS.PerimeterOfPath=function(e,g,l){if("undefined"==typeof e)return 0;var q=Math.sqrt,x=0,G=e.length;if(2>G)return 0;for(g&&(e[G]=e[0],G++);--G;){var L=e[G];var Y=L.X;L=L.Y;var ja=e[G-1];var pa=ja.X;ja=ja.Y;x+=q((Y-pa)*(Y-pa)+(L-ja)*(L-ja))}g&&e.pop();return x/l};r.JS.PerimeterOfPaths=function(e,g,l){l||(l=1);for(var q=0,x=0;x<e.length;x++)q+=r.JS.PerimeterOfPath(e[x],g,l);return q};r.JS.ScaleDownPath=
function(e,g){var l;g||(g=1);for(l=e.length;l--;){var q=e[l];q.X/=g;q.Y/=g}};r.JS.ScaleDownPaths=function(e,g){var l,q;g||(g=1);for(l=e.length;l--;)for(q=e[l].length;q--;){var x=e[l][q];x.X/=g;x.Y/=g}};r.JS.ScaleUpPath=function(e,g){var l,q=Math.round;g||(g=1);for(l=e.length;l--;){var x=e[l];x.X=q(x.X*g);x.Y=q(x.Y*g)}};r.JS.ScaleUpPaths=function(e,g){var l,q,x=Math.round;g||(g=1);for(l=e.length;l--;)for(q=e[l].length;q--;){var G=e[l][q];G.X=x(G.X*g);G.Y=x(G.Y*g)}};r.ExPolygons=function(){return[]};
r.ExPolygon=function(){this.holes=this.outer=null};r.JS.AddOuterPolyNodeToExPolygons=function(e,g){var l=new r.ExPolygon;l.outer=e.Contour();e=e.Childs();var q=e.length;l.holes=Array(q);var x,G;for(x=0;x<q;x++){var L=e[x];l.holes[x]=L.Contour();var Y=0;var ja=L.Childs();for(G=ja.length;Y<G;Y++)L=ja[Y],r.JS.AddOuterPolyNodeToExPolygons(L,g)}g.push(l)};r.JS.ExPolygonsToPaths=function(e){var g,l,q=new r.Paths;var x=0;for(g=e.length;x<g;x++){q.push(e[x].outer);var G=0;for(l=e[x].holes.length;G<l;G++)q.push(e[x].holes[G])}return q};
r.JS.PolyTreeToExPolygons=function(e){var g=new r.ExPolygons,l;var q=0;var x=e.Childs();for(l=x.length;q<l;q++)e=x[q],r.JS.AddOuterPolyNodeToExPolygons(e,g);return g}})();
(function(E,I){"function"===typeof define&&define.amd?define(I):"object"===typeof exports?module.exports=I():E.returnExports=I()})(this,function(){var E=Function.call.bind(Function.apply),I=Function.call.bind(Function.call),S=Array.isArray,aa=Object.keys,ba=function(A){try{return A(),!1}catch(v){return!0}},ka=function(A){try{return A()}catch(v){return!1}},ca=function(A){return function(){return!E(A,this,arguments)}}(ba),B=function(){return!ba(function(){return Object.defineProperty({},"x",{get:function(){}})})},
ea=!!Object.defineProperty&&B(),Z="foo"===function(){}.name,fa=Function.call.bind(Array.prototype.forEach),sa=Function.call.bind(Array.prototype.reduce),Ra=Function.call.bind(Array.prototype.filter),Za=Function.call.bind(Array.prototype.some),Ga=function(A,v,C,y){!y&&v in A||(ea?Object.defineProperty(A,v,{configurable:!0,enumerable:!1,writable:!0,value:C}):A[v]=C)},bb=function(A,v,C){fa(aa(v),function(y){Ga(A,y,v[y],!!C)})},ob=Function.call.bind(Object.prototype.toString),r="function"===typeof/abc/?
function(A){return"function"===typeof A&&"[object Function]"===ob(A)}:function(A){return"function"===typeof A},$a={getter:function(A,v,C){if(!ea)throw new TypeError("getters require true ES5 support");Object.defineProperty(A,v,{configurable:!0,enumerable:!1,get:C})},proxy:function(A,v,C){if(!ea)throw new TypeError("getters require true ES5 support");var y=Object.getOwnPropertyDescriptor(A,v);Object.defineProperty(C,v,{configurable:y.configurable,enumerable:y.enumerable,get:function(){return A[v]},
set:function(J){A[v]=J}})},redefine:function(A,v,C){if(ea){var y=Object.getOwnPropertyDescriptor(A,v);y.value=C;Object.defineProperty(A,v,y)}else A[v]=C},defineByDescriptor:function(A,v,C){ea?Object.defineProperty(A,v,C):"value"in C&&(A[v]=C.value)},preserveToString:function(A,v){v&&r(v.toString)&&Ga(A,"toString",v.toString.bind(v),!0)}},cb=Object.create||function(A,v){var C=function(){};C.prototype=A;var y=new C;"undefined"!==typeof v&&aa(v).forEach(function(J){$a.defineByDescriptor(y,J,v[J])});
return y},gb=function(A,v){return Object.setPrototypeOf?ka(function(){var C=function T(J){J=new A(J);Object.setPrototypeOf(J,T.prototype);return J};Object.setPrototypeOf(C,A);C.prototype=cb(A.prototype,{constructor:{value:C}});return v(C)}):!1},U=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof global)return global;throw Error("unable to locate global object");}(),za=U.isFinite,Ha=Function.call.bind(String.prototype.indexOf),
Hb=Function.apply.bind(Array.prototype.indexOf),Nb=Function.call.bind(Array.prototype.concat),Db=Function.call.bind(String.prototype.slice),Ib=Function.call.bind(Array.prototype.push),Cb=Function.apply.bind(Array.prototype.push),zb=Function.call.bind(Array.prototype.join),pd=Function.call.bind(Array.prototype.shift),e=Math.max,g=Math.min,l=Math.floor,q=Math.abs,x=Math.exp,G=Math.log,L=Math.sqrt,Y=Function.call.bind(Object.prototype.hasOwnProperty),ja=function(){},pa=U.Map,Ma=pa&&pa.prototype["delete"],
ab=pa&&pa.prototype.get,qa=pa&&pa.prototype.has,yb=pa&&pa.prototype.set,Va=U.Symbol||{},yc=Va.species||"@@species",vb=Number.isNaN||function(A){return A!==A},ac=Number.isFinite||function(A){return"number"===typeof A&&za(A)},kc=r(Math.sign)?Math.sign:function(A){A=Number(A);return 0===A||vb(A)?A:0>A?-1:1},Zc=function(A){A=Number(A);return-1>A||vb(A)?NaN:0===A||Infinity===A?A:-1===A?-Infinity:0===1+A-1?A:A*(G(1+A)/(1+A-1))},Hd=function(A){return"[object Arguments]"===ob(A)},Ae=function(A){return null!==
A&&"object"===typeof A&&"number"===typeof A.length&&0<=A.length&&"[object Array]"!==ob(A)&&"[object Function]"===ob(A.callee)},Id=Hd(arguments)?Hd:Ae,Ab={primitive:function(A){return null===A||"function"!==typeof A&&"object"!==typeof A},string:function(A){return"[object String]"===ob(A)},regex:function(A){return"[object RegExp]"===ob(A)},symbol:function(A){return"function"===typeof U.Symbol&&"symbol"===typeof A}},Fa=function(A,v,C){var y=A[v];Ga(A,v,C,!0);$a.preserveToString(A[v],y)},Fc="function"===
typeof Va&&"function"===typeof Va["for"]&&Ab.symbol(Va()),sc=Ab.symbol(Va.iterator)?Va.iterator:"_es6-shim iterator_";U.Set&&"function"===typeof(new U.Set)["@@iterator"]&&(sc="@@iterator");U.Reflect||Ga(U,"Reflect",{},!0);var Gc=U.Reflect,Jd=String,Kd="undefined"!==typeof document&&document?document.all:null,tc=null==Kd?function(A){return null==A}:function(A){return null==A&&A!==Kd},R={Call:function(A,v){var C=2<arguments.length?arguments[2]:[];if(!R.IsCallable(A))throw new TypeError(A+" is not a function");
return E(A,v,C)},RequireObjectCoercible:function(A,v){if(tc(A))throw new TypeError(v||"Cannot call method on "+A);return A},TypeIsObject:function(A){return void 0===A||null===A||!0===A||!1===A?!1:"function"===typeof A||"object"===typeof A||A===Kd},ToObject:function(A,v){return Object(R.RequireObjectCoercible(A,v))},IsCallable:r,IsConstructor:function(A){return R.IsCallable(A)},ToInt32:function(A){return R.ToNumber(A)>>0},ToUint32:function(A){return R.ToNumber(A)>>>0},ToNumber:function(A){if(Fc&&"[object Symbol]"===
ob(A))throw new TypeError("Cannot convert a Symbol value to a number");return+A},ToInteger:function(A){A=R.ToNumber(A);return vb(A)?0:0!==A&&ac(A)?(0<A?1:-1)*l(q(A)):A},ToLength:function(A){A=R.ToInteger(A);return 0>=A?0:A>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:A},SameValue:function(A,v){return A===v?0===A?1/A===1/v:!0:vb(A)&&vb(v)},SameValueZero:function(A,v){return A===v||vb(A)&&vb(v)},IsIterable:function(A){return R.TypeIsObject(A)&&("undefined"!==typeof A[sc]||Id(A))},GetIterator:function(A){if(Id(A))return new uc(A,
"value");var v=R.GetMethod(A,sc);if(!R.IsCallable(v))throw new TypeError("value is not an iterable");A=R.Call(v,A);if(!R.TypeIsObject(A))throw new TypeError("bad iterator");return A},GetMethod:function(A,v){A=R.ToObject(A)[v];if(!tc(A)){if(!R.IsCallable(A))throw new TypeError("Method not callable: "+v);return A}},IteratorComplete:function(A){return!!A.done},IteratorClose:function(A,v){var C=R.GetMethod(A,"return");if(void 0!==C){try{var y=R.Call(C,A)}catch(T){var J=T}if(!v){if(J)throw J;if(!R.TypeIsObject(y))throw new TypeError("Iterator's return method returned a non-object.");
}}},IteratorNext:function(A){var v=1<arguments.length?A.next(arguments[1]):A.next();if(!R.TypeIsObject(v))throw new TypeError("bad iterator");return v},IteratorStep:function(A){A=R.IteratorNext(A);return R.IteratorComplete(A)?!1:A},Construct:function(A,v,C,y){C="undefined"===typeof C?A:C;if(!y&&Gc.construct)return Gc.construct(A,v,C);y=C.prototype;R.TypeIsObject(y)||(y=Object.prototype);y=cb(y);A=R.Call(A,y,v);return R.TypeIsObject(A)?A:y},SpeciesConstructor:function(A,v){A=A.constructor;if(void 0===
A)return v;if(!R.TypeIsObject(A))throw new TypeError("Bad constructor");A=A[yc];if(tc(A))return v;if(!R.IsConstructor(A))throw new TypeError("Bad @@species");return A},CreateHTML:function(A,v,C,y){A=R.ToString(A);var J="<"+v;""!==C&&(y=R.ToString(y).replace(/"/g,"&quot;"),J+=" "+C+'="'+y+'"');return J+">"+A+"</"+v+">"},IsRegExp:function(A){if(!R.TypeIsObject(A))return!1;var v=A[Va.match];return"undefined"!==typeof v?!!v:Ab.regex(A)},ToString:function(A){if(Fc&&"[object Symbol]"===ob(A))throw new TypeError("Cannot convert a Symbol value to a number");
return Jd(A)}};if(ea&&Fc){var qd=function(A){if(Ab.symbol(Va[A]))return Va[A];var v=Va["for"]("Symbol."+A);Object.defineProperty(Va,A,{configurable:!1,enumerable:!1,writable:!1,value:v});return v};if(!Ab.symbol(Va.search)){var rd=qd("search"),Be=String.prototype.search;Ga(RegExp.prototype,rd,function(A){return R.Call(Be,A,[this])});Fa(String.prototype,"search",function(A){var v=R.RequireObjectCoercible(this);if(!tc(A)){var C=R.GetMethod(A,rd);if("undefined"!==typeof C)return R.Call(C,A,[v])}return R.Call(Be,
v,[R.ToString(A)])})}if(!Ab.symbol(Va.replace)){var dd=qd("replace"),ge=String.prototype.replace;Ga(RegExp.prototype,dd,function(A,v){return R.Call(ge,A,[this,v])});Fa(String.prototype,"replace",function(A,v){var C=R.RequireObjectCoercible(this);if(!tc(A)){var y=R.GetMethod(A,dd);if("undefined"!==typeof y)return R.Call(y,A,[C,v])}return R.Call(ge,C,[R.ToString(A),v])})}if(!Ab.symbol(Va.split)){var Wb=qd("split"),Oc=String.prototype.split;Ga(RegExp.prototype,Wb,function(A,v){return R.Call(Oc,A,[this,
v])});Fa(String.prototype,"split",function(A,v){var C=R.RequireObjectCoercible(this);if(!tc(A)){var y=R.GetMethod(A,Wb);if("undefined"!==typeof y)return R.Call(y,A,[C,v])}return R.Call(Oc,C,[R.ToString(A),v])})}var he=Ab.symbol(Va.match),wb=he&&function(){var A={};A[Va.match]=function(){return 42};return 42!=="a".match(A)}();if(!he||wb){var Pc=qd("match"),sd=String.prototype.match;Ga(RegExp.prototype,Pc,function(A){return R.Call(sd,A,[this])});Fa(String.prototype,"match",function(A){var v=R.RequireObjectCoercible(this);
if(!tc(A)){var C=R.GetMethod(A,Pc);if("undefined"!==typeof C)return R.Call(C,A,[v])}return R.Call(sd,v,[R.ToString(A)])})}}var ie=function(A,v,C){$a.preserveToString(v,A);Object.setPrototypeOf&&Object.setPrototypeOf(A,v);ea?fa(Object.getOwnPropertyNames(A),function(y){y in ja||C[y]||$a.proxy(A,y,v)}):fa(Object.keys(A),function(y){y in ja||C[y]||(v[y]=A[y])});v.prototype=A.prototype;$a.redefine(A.prototype,"constructor",v)},Ce=function(){return this},Hc=function(A){ea&&!Y(A,yc)&&$a.getter(A,yc,Ce)},
M=function(A,v){v=v||function(){return this};Ga(A,sc,v);!A[sc]&&Ab.symbol(sc)&&(A[sc]=v)},X=function(A,v,C){ea?Object.defineProperty(A,v,{configurable:!0,enumerable:!0,writable:!0,value:C}):A[v]=C;if(!R.SameValue(A[v],C))throw new TypeError("property is nonconfigurable");},Ca=function(A,v,C,y){if(!R.TypeIsObject(A))throw new TypeError("Constructor requires `new`: "+v.name);A=v.prototype;R.TypeIsObject(A)||(A=C);C=cb(A);for(var J in y)Y(y,J)&&Ga(C,J,y[J],!0);return C};if(String.fromCodePoint&&1!==
String.fromCodePoint.length){var zc=String.fromCodePoint;Fa(String,"fromCodePoint",function(A){return R.Call(zc,this,arguments)})}var De={fromCodePoint:function(A){for(var v=[],C,y=0,J=arguments.length;y<J;y++){C=Number(arguments[y]);if(!R.SameValue(C,R.ToInteger(C))||0>C||1114111<C)throw new RangeError("Invalid code point "+C);65536>C?Ib(v,String.fromCharCode(C)):(C-=65536,Ib(v,String.fromCharCode((C>>10)+55296)),Ib(v,String.fromCharCode(C%1024+56320)))}return zb(v,"")},raw:function(A){var v=R.ToObject(A,
"bad template");v=R.ToObject(v.raw,"bad raw value");var C=R.ToLength(v.length);if(0>=C)return"";for(var y=[],J=0,T;J<C;){T=R.ToString(J);T=R.ToString(v[T]);Ib(y,T);if(J+1>=C)break;T=J+1<arguments.length?arguments[J+1]:"";T=R.ToString(T);Ib(y,T);J+=1}return zb(y,"")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&Fa(String,"raw",De.raw);bb(String,De);var pb=function y(v,C){if(1>C)return"";if(C%2)return y(v,C-1)+v;v=y(v,C/2);return v+v},Qc={repeat:function(v){var C=R.ToString(R.RequireObjectCoercible(this));
v=R.ToInteger(v);if(0>v||Infinity<=v)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return pb(C,v)},startsWith:function(v){var C=R.ToString(R.RequireObjectCoercible(this));if(R.IsRegExp(v))throw new TypeError('Cannot call method "startsWith" with a regex');var y=R.ToString(v),J;1<arguments.length&&(J=arguments[1]);J=e(R.ToInteger(J),0);return Db(C,J,J+y.length)===y},endsWith:function(v){var C=R.ToString(R.RequireObjectCoercible(this));if(R.IsRegExp(v))throw new TypeError('Cannot call method "endsWith" with a regex');
var y=R.ToString(v),J=C.length,T;1<arguments.length&&(T=arguments[1]);T="undefined"===typeof T?J:R.ToInteger(T);J=g(e(T,0),J);return Db(C,J-y.length,J)===y},includes:function(v){if(R.IsRegExp(v))throw new TypeError('"includes" does not accept a RegExp');var C=R.ToString(v),y;1<arguments.length&&(y=arguments[1]);return-1!==Ha(this,C,y)},codePointAt:function(v){var C=R.ToString(R.RequireObjectCoercible(this)),y=R.ToInteger(v),J=C.length;if(0<=y&&y<J){v=C.charCodeAt(y);if(55296>v||56319<v||y+1===J)return v;
C=C.charCodeAt(y+1);return 56320>C||57343<C?v:1024*(v-55296)+(C-56320)+65536}}};String.prototype.includes&&!1!=="a".includes("a",Infinity)&&Fa(String.prototype,"includes",Qc.includes);if(String.prototype.startsWith&&String.prototype.endsWith){var Ee=ba(function(){return"/a/".startsWith(/a/)}),Fe=ka(function(){return!1==="abc".startsWith("a",Infinity)});Ee&&Fe||(Fa(String.prototype,"startsWith",Qc.startsWith),Fa(String.prototype,"endsWith",Qc.endsWith))}Fc&&(ka(function(){var v=/a/;v[Va.match]=!1;
return"/a/".startsWith(v)})||Fa(String.prototype,"startsWith",Qc.startsWith),ka(function(){var v=/a/;v[Va.match]=!1;return"/a/".endsWith(v)})||Fa(String.prototype,"endsWith",Qc.endsWith),ka(function(){var v=/a/;v[Va.match]=!1;return"/a/".includes(v)})||Fa(String.prototype,"includes",Qc.includes));bb(String.prototype,Qc);var gf=RegExp("(^[\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+)|([\t\n\v\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]+$)",
"g"),Ge=function(){return R.ToString(R.RequireObjectCoercible(this)).replace(gf,"")},td=RegExp("[\u0085\u200b\ufffe]","g"),He=/^[-+]0x[0-9a-f]+$/i;Ga(String.prototype,"trim",Ge,!0);var bc=function(v){return{value:v,done:0===arguments.length}},Ld=function(v){R.RequireObjectCoercible(v);this._s=R.ToString(v);this._i=0};Ld.prototype.next=function(){var v=this._s,C=this._i;if("undefined"===typeof v||C>=v.length)return this._s=void 0,bc();var y=v.charCodeAt(C);55296>y||56319<y||C+1===v.length?y=1:(y=v.charCodeAt(C+
1),y=56320>y||57343<y?1:2);this._i=C+y;return bc(v.substr(C,y))};M(Ld.prototype);M(String.prototype,function(){return new Ld(this)});var ud={from:function(v){var C;1<arguments.length&&(C=arguments[1]);var y;if("undefined"===typeof C)var J=!1;else{if(!R.IsCallable(C))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(y=arguments[2]);J=!0}var T;if("undefined"!==typeof(Id(v)||R.GetMethod(v,sc))){var ma=R.IsConstructor(this)?Object(new this):
[];var oa=R.GetIterator(v);for(T=0;;){var la=R.IteratorStep(oa);if(!1===la)break;la=la.value;try{J&&(la="undefined"===typeof y?C(la,T):I(C,y,la,T)),ma[T]=la}catch(Ka){throw R.IteratorClose(oa,!0),Ka;}T+=1}oa=T}else for(la=R.ToObject(v),oa=R.ToLength(la.length),ma=R.IsConstructor(this)?Object(new this(oa)):Array(oa),T=0;T<oa;++T){var wa=la[T];J&&(wa="undefined"===typeof y?C(wa,T):I(C,y,wa,T));X(ma,T,wa)}ma.length=oa;return ma},of:function(){for(var v=arguments.length,C=S(this)||!R.IsCallable(this)?
Array(v):R.Construct(this,[v]),y=0;y<v;++y)X(C,y,arguments[y]);C.length=v;return C}};bb(Array,ud);Hc(Array);var uc=function(v,C){this.i=0;this.array=v;this.kind=C};bb(uc.prototype,{next:function(){var v=this.i,C=this.array;if(!(this instanceof uc))throw new TypeError("Not an ArrayIterator");if("undefined"!==typeof C){var y=R.ToLength(C.length);if(v<y){y=this.kind;var J;"key"===y?J=v:"value"===y?J=C[v]:"entry"===y&&(J=[v,C[v]]);this.i=v+1;return bc(J)}}this.array=void 0;return bc()}});M(uc.prototype);
Array.of===ud.of||function(){var v=function(y){this.length=y};v.prototype=[];var C=Array.of.apply(v,[1,2]);return C instanceof v&&2===C.length}()||Fa(Array,"of",ud.of);var lc={copyWithin:function(v,C){var y=R.ToObject(this),J=R.ToLength(y.length),T=R.ToInteger(v),ma=R.ToInteger(C);T=0>T?e(J+T,0):g(T,J);ma=0>ma?e(J+ma,0):g(ma,J);var oa;2<arguments.length&&(oa=arguments[2]);oa="undefined"===typeof oa?J:R.ToInteger(oa);oa=0>oa?e(J+oa,0):g(oa,J);J=g(oa-ma,J-T);oa=1;ma<T&&T<ma+J&&(oa=-1,ma+=J-1,T+=J-1);
for(;0<J;)ma in y?y[T]=y[ma]:delete y[T],ma+=oa,T+=oa,--J;return y},fill:function(v){var C;1<arguments.length&&(C=arguments[1]);var y;2<arguments.length&&(y=arguments[2]);var J=R.ToObject(this),T=R.ToLength(J.length);C=R.ToInteger("undefined"===typeof C?0:C);y=R.ToInteger("undefined"===typeof y?T:y);C=0>C?e(T+C,0):g(C,T);for(y=0>y?T+y:y;C<T&&C<y;++C)J[C]=v;return J},find:function(v){var C=R.ToObject(this),y=R.ToLength(C.length);if(!R.IsCallable(v))throw new TypeError("Array#find: predicate must be a function");
for(var J=1<arguments.length?arguments[1]:null,T=0,ma;T<y;T++)if(ma=C[T],J){if(I(v,J,ma,T,C))return ma}else if(v(ma,T,C))return ma},findIndex:function(v){var C=R.ToObject(this),y=R.ToLength(C.length);if(!R.IsCallable(v))throw new TypeError("Array#findIndex: predicate must be a function");for(var J=1<arguments.length?arguments[1]:null,T=0;T<y;T++)if(J){if(I(v,J,C[T],T,C))return T}else if(v(C[T],T,C))return T;return-1},keys:function(){return new uc(this,"key")},values:function(){return new uc(this,
"value")},entries:function(){return new uc(this,"entry")}};Array.prototype.keys&&!R.IsCallable([1].keys().next)&&delete Array.prototype.keys;Array.prototype.entries&&!R.IsCallable([1].entries().next)&&delete Array.prototype.entries;Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[sc]&&(bb(Array.prototype,{values:Array.prototype[sc]}),Ab.symbol(Va.unscopables)&&(Array.prototype[Va.unscopables].values=!0));if(Z&&Array.prototype.values&&"values"!==Array.prototype.values.name){var ed=
Array.prototype.values;Fa(Array.prototype,"values",function(){return R.Call(ed,this,arguments)});Ga(Array.prototype,sc,Array.prototype.values,!0)}bb(Array.prototype,lc);0>1/[!0].indexOf(!0,-0)&&Ga(Array.prototype,"indexOf",function(v){var C=Hb(this,arguments);return 0===C&&0>1/C?0:C},!0);M(Array.prototype,function(){return this.values()});Object.getPrototypeOf&&M(Object.getPrototypeOf([].values()));var Md=function(){return ka(function(){return 0===Array.from({length:-1}).length})}(),Ie=function(){var v=
Array.from([0].entries());return 1===v.length&&S(v[0])&&0===v[0][0]&&0===v[0][1]}();Md&&Ie||Fa(Array,"from",ud.from);if(!function(){return ka(function(){return Array.from([0],void 0)})}()){var Nd=Array.from;Fa(Array,"from",function(v){return 1<arguments.length&&"undefined"!==typeof arguments[1]?R.Call(Nd,this,arguments):I(Nd,this,v)})}var $c=-(Math.pow(2,32)-1),Rc=function(v,C){var y={length:$c};y[C?(y.length>>>0)-1:0]=!0;return ka(function(){I(v,y,function(){throw new RangeError("should not reach here");
},[]);return!0})};if(!Rc(Array.prototype.forEach)){var Je=Array.prototype.forEach;Fa(Array.prototype,"forEach",function(v){return R.Call(Je,0<=this.length?this:[],arguments)})}if(!Rc(Array.prototype.map)){var fd=Array.prototype.map;Fa(Array.prototype,"map",function(v){return R.Call(fd,0<=this.length?this:[],arguments)})}if(!Rc(Array.prototype.filter)){var Od=Array.prototype.filter;Fa(Array.prototype,"filter",function(v){return R.Call(Od,0<=this.length?this:[],arguments)})}if(!Rc(Array.prototype.some)){var hf=
Array.prototype.some;Fa(Array.prototype,"some",function(v){return R.Call(hf,0<=this.length?this:[],arguments)})}if(!Rc(Array.prototype.every)){var jf=Array.prototype.every;Fa(Array.prototype,"every",function(v){return R.Call(jf,0<=this.length?this:[],arguments)})}if(!Rc(Array.prototype.reduce)){var Ke=Array.prototype.reduce;Fa(Array.prototype,"reduce",function(v){return R.Call(Ke,0<=this.length?this:[],arguments)})}if(!Rc(Array.prototype.reduceRight,!0)){var Le=Array.prototype.reduceRight;Fa(Array.prototype,
"reduceRight",function(v){return R.Call(Le,0<=this.length?this:[],arguments)})}var gd=8!==Number("0o10"),Me=2!==Number("0b10"),Ne=Za("\u0085\u200b\ufffe",function(v){return 0===Number(v+0+v)});if(gd||Me||Ne){var Ac=Number,cc=/^0b[01]+$/i,Pd=/^0o[0-7]+$/i,Qd=cc.test.bind(cc),kf=Pd.test.bind(Pd),Oe=function(v,C){if("function"===typeof v.valueOf&&(C=v.valueOf(),Ab.primitive(C))||"function"===typeof v.toString&&(C=v.toString(),Ab.primitive(C)))return C;throw new TypeError("No default value");},je=td.test.bind(td),
Pe=He.test.bind(He),Rd=function(){var v=function(C){var y=0<arguments.length?Ab.primitive(C)?C:Oe(C,"number"):0;if("string"===typeof y)if(y=R.Call(Ge,y),Qd(y))y=parseInt(Db(y,2),2);else if(kf(y))y=parseInt(Db(y,2),8);else if(je(y)||Pe(y))y=NaN;var J=this,T=ka(function(){Ac.prototype.valueOf.call(J);return!0});return J instanceof v&&!T?new Ac(y):Ac(y)};return v}();ie(Ac,Rd,{});bb(Rd,{NaN:Ac.NaN,MAX_VALUE:Ac.MAX_VALUE,MIN_VALUE:Ac.MIN_VALUE,NEGATIVE_INFINITY:Ac.NEGATIVE_INFINITY,POSITIVE_INFINITY:Ac.POSITIVE_INFINITY});
Number=Rd;$a.redefine(U,"Number",Rd)}var Qe=Math.pow(2,53)-1;bb(Number,{MAX_SAFE_INTEGER:Qe,MIN_SAFE_INTEGER:-Qe,EPSILON:2.220446049250313E-16,parseInt:U.parseInt,parseFloat:U.parseFloat,isFinite:ac,isInteger:function(v){return ac(v)&&R.ToInteger(v)===v},isSafeInteger:function(v){return Number.isInteger(v)&&q(v)<=Number.MAX_SAFE_INTEGER},isNaN:vb});Ga(Number,"parseInt",U.parseInt,Number.parseInt!==U.parseInt);1===[,1].find(function(){return!0})&&Fa(Array.prototype,"find",lc.find);0!==[,1].findIndex(function(){return!0})&&
Fa(Array.prototype,"findIndex",lc.findIndex);var Ic=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Sd=function(v,C){ea&&Ic(v,C)&&Object.defineProperty(v,C,{enumerable:!1})},hd=function(){var v=Number(this),C=arguments.length,y=C-v;y=Array(0>y?0:y);for(var J=v;J<C;++J)y[J-v]=arguments[J];return y},vd=function(v){return function(C,y){C[y]=v[y];return C}},Re=function(v,C){var y=aa(Object(C)),J;R.IsCallable(Object.getOwnPropertySymbols)&&(J=Ra(Object.getOwnPropertySymbols(Object(C)),
Ic(C)));return sa(Nb(y,J||[]),vd(C),v)},Se={assign:function(v,C){var y=R.ToObject(v,"Cannot convert undefined or null to object");return sa(R.Call(hd,1,arguments),Re,y)},is:function(v,C){return R.SameValue(v,C)}};Object.assign&&Object.preventExtensions&&function(){var v=Object.preventExtensions({1:2});try{Object.assign(v,"xy")}catch(C){return"y"===v[1]}}()&&Fa(Object,"assign",Se.assign);bb(Object,Se);if(ea){var Tb={setPrototypeOf:function(v,C){var y=function(T,ma){if(!R.TypeIsObject(T))throw new TypeError("cannot set prototype on a non-object");
if(null!==ma&&!R.TypeIsObject(ma))throw new TypeError("can only set prototype to an object or null"+ma);I(J,T,ma);return T};try{var J=v.getOwnPropertyDescriptor(v.prototype,C).set;I(J,{},null)}catch(T){if(v.prototype!=={}[C])return;J=function(ma){this[C]=ma};y.polyfill=y(y({},null),v.prototype)instanceof v}return y}(Object,"__proto__")};bb(Object,Tb)}Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&
function(){var v=Object.create(null),C=Object.getPrototypeOf,y=Object.setPrototypeOf;Object.getPrototypeOf=function(J){J=C(J);return J===v?null:J};Object.setPrototypeOf=function(J,T){return y(J,null===T?v:T)};Object.setPrototypeOf.polyfill=!1}();if(ba(function(){return Object.keys("foo")})){var Te=Object.keys;Fa(Object,"keys",function(v){return Te(R.ToObject(v))});aa=Object.keys}if(ba(function(){return Object.keys(/a/g)})){var Ue=Object.keys;Fa(Object,"keys",function(v){if(Ab.regex(v)){var C=[],y;
for(y in v)Y(v,y)&&Ib(C,y);return C}return Ue(v)});aa=Object.keys}if(Object.getOwnPropertyNames&&ba(function(){return Object.getOwnPropertyNames("foo")})){var Ve="object"===typeof window?Object.getOwnPropertyNames(window):[],We=Object.getOwnPropertyNames;Fa(Object,"getOwnPropertyNames",function(v){v=R.ToObject(v);if("[object Window]"===ob(v))try{return We(v)}catch(C){return Nb([],Ve)}return We(v)})}if(Object.getOwnPropertyDescriptor&&ba(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var lf=
Object.getOwnPropertyDescriptor;Fa(Object,"getOwnPropertyDescriptor",function(v,C){return lf(R.ToObject(v),C)})}if(Object.seal&&ba(function(){return Object.seal("foo")})){var id=Object.seal;Fa(Object,"seal",function(v){return R.TypeIsObject(v)?id(v):v})}if(Object.isSealed&&ba(function(){return Object.isSealed("foo")})){var db=Object.isSealed;Fa(Object,"isSealed",function(v){return R.TypeIsObject(v)?db(v):!0})}if(Object.freeze&&ba(function(){return Object.freeze("foo")})){var Bc=Object.freeze;Fa(Object,
"freeze",function(v){return R.TypeIsObject(v)?Bc(v):v})}if(Object.isFrozen&&ba(function(){return Object.isFrozen("foo")})){var Xa=Object.isFrozen;Fa(Object,"isFrozen",function(v){return R.TypeIsObject(v)?Xa(v):!0})}if(Object.preventExtensions&&ba(function(){return Object.preventExtensions("foo")})){var mc=Object.preventExtensions;Fa(Object,"preventExtensions",function(v){return R.TypeIsObject(v)?mc(v):v})}if(Object.isExtensible&&ba(function(){return Object.isExtensible("foo")})){var ke=Object.isExtensible;
Fa(Object,"isExtensible",function(v){return R.TypeIsObject(v)?ke(v):!1})}if(Object.getPrototypeOf&&ba(function(){return Object.getPrototypeOf("foo")})){var le=Object.getPrototypeOf;Fa(Object,"getPrototypeOf",function(v){return le(R.ToObject(v))})}var mf=ea&&function(){var v=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return v&&R.IsCallable(v.get)}();ea&&!mf&&$a.getter(RegExp.prototype,"flags",function(){if(!R.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");
var v="";this.global&&(v+="g");this.ignoreCase&&(v+="i");this.multiline&&(v+="m");this.unicode&&(v+="u");this.sticky&&(v+="y");return v});var Xe=ea&&ka(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),wd=Fc&&ea&&function(){var v=/./;v[Va.match]=!1;return RegExp(v)===v}(),lb=ka(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),Jc=lb&&ka(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!lb||!Jc){var me=RegExp.prototype.toString;
Ga(RegExp.prototype,"toString",function(){var v=R.RequireObjectCoercible(this);if(Ab.regex(v))return I(me,v);var C=Jd(v.source);v=Jd(v.flags);return"/"+C+"/"+v},!0);$a.preserveToString(RegExp.prototype.toString,me)}if(ea&&(!Xe||wd)){var xd=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,ne=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},Ye=function(){return this.source},Ze=R.IsCallable(ne.get)?ne.get:Ye,Td=RegExp,dc=function(){return function J(C,y){var T=R.IsRegExp(C);
return this instanceof J||!T||"undefined"!==typeof y||C.constructor!==J?Ab.regex(C)?(T=R.Call(Ze,C),C="undefined"===typeof y?R.Call(xd,C):y,new J(T,C)):new Td(C,y):C}}();ie(Td,dc,{$input:!0});RegExp=dc;$a.redefine(U,"RegExp",dc)}if(ea){var oe={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};fa(aa(oe),function(v){v in RegExp&&!(oe[v]in RegExp)&&$a.getter(RegExp,oe[v],function(){return RegExp[v]})})}Hc(RegExp);var Ud=1/Number.EPSILON,Vd=Math.pow(2,-23),nf=Math.pow(2,127)*
(2-Vd),pe=Math.pow(2,-126),Sc=Math.E,Eb=Math.LOG2E,Pb=Math.LOG10E,Na=Number.prototype.clz;delete Number.prototype.clz;var xb={acosh:function(v){var C=Number(v);if(vb(C)||1>v)return NaN;if(1===C)return 0;if(Infinity===C)return C;v=1/(C*C);if(2>C)return Zc(C-1+L(1-v)*C);C/=2;return Zc(C+L(1-v)*C-1)+1/Eb},asinh:function(v){var C=Number(v);if(0===C||!za(C))return C;v=q(C);var y=v*v;C=kc(C);return 1>v?C*Zc(v+y/(L(y+1)+1)):C*(Zc(v/2+L(1+1/y)*v/2-1)+1/Eb)},atanh:function(v){v=Number(v);if(0===v)return v;
if(-1===v)return-Infinity;if(1===v)return Infinity;if(vb(v)||-1>v||1<v)return NaN;var C=q(v);return kc(v)*Zc(2*C/(1-C))/2},cbrt:function(v){v=Number(v);if(0===v)return v;var C=0>v;C&&(v=-v);if(Infinity===v)var y=Infinity;else y=x(G(v)/3),y=(v/(y*y)+2*y)/3;return C?-y:y},clz32:function(v){v=R.ToUint32(Number(v));return 0===v?32:Na?R.Call(Na,v):31-l(G(v+.5)*Eb)},cosh:function(v){v=Number(v);if(0===v)return 1;if(vb(v))return NaN;if(!za(v))return Infinity;v=x(q(v)-1);return Sc/2*(v+1/(v*Sc*Sc))},expm1:function(v){v=
Number(v);if(-Infinity===v)return-1;if(!za(v)||0===v)return v;if(.5<q(v))return x(v)-1;for(var C=v,y=0,J=1;y+C!==y;)y+=C,J+=1,C*=v/J;return y},hypot:function(v,C){for(var y=0,J=0,T=0;T<arguments.length;++T){var ma=q(Number(arguments[T]));J<ma?(y*=J/ma*(J/ma),y+=1,J=ma):y+=0<ma?ma/J*(ma/J):ma}return Infinity===J?Infinity:J*L(y)},log2:function(v){return G(v)*Eb},log10:function(v){return G(v)*Pb},log1p:Zc,sign:kc,sinh:function(v){v=Number(v);if(!za(v)||0===v)return v;var C=q(v);if(1>C)return C=Math.expm1(C),
kc(v)*C*(1+1/(C+1))/2;C=x(C-1);return kc(v)*(C-1/(C*Sc*Sc))*(Sc/2)},tanh:function(v){v=Number(v);return vb(v)||0===v?v:20<=v?1:-20>=v?-1:(Math.expm1(v)-Math.expm1(-v))/(x(v)+x(-v))},trunc:function(v){v=Number(v);return 0>v?-l(-v):l(v)},imul:function(v,C){v=R.ToUint32(v);C=R.ToUint32(C);var y=v&65535,J=C&65535;return y*J+((v>>>16&65535)*J+y*(C>>>16&65535)<<16>>>0)|0},fround:function(v){var C=Number(v);if(0===C||Infinity===C||-Infinity===C||vb(C))return C;v=kc(C);C=q(C);if(C<pe)return v*(C/pe/Vd+Ud-
Ud)*pe*Vd;var y=(1+Vd/Number.EPSILON)*C;C=y-(y-C);return C>nf||vb(C)?Infinity*v:v*C}};bb(Math,xb);Ga(Math,"sinh",xb.sinh,Infinity===Math.sinh(710));Ga(Math,"cosh",xb.cosh,Infinity===Math.cosh(710));Ga(Math,"log1p",xb.log1p,-1E-17!==Math.log1p(-1E-17));Ga(Math,"asinh",xb.asinh,Math.asinh(-1E7)!==-Math.asinh(1E7));Ga(Math,"asinh",xb.asinh,Infinity===Math.asinh(1E300));Ga(Math,"atanh",xb.atanh,0===Math.atanh(1E-300));Ga(Math,"tanh",xb.tanh,-2E-17!==Math.tanh(-2E-17));Ga(Math,"acosh",xb.acosh,Infinity===
Math.acosh(Number.MAX_VALUE));Ga(Math,"acosh",xb.acosh,!(8>q(1-Math.acosh(1+Number.EPSILON)/Math.sqrt(2*Number.EPSILON))/Number.EPSILON));Ga(Math,"cbrt",xb.cbrt,!(8>q(1-Math.cbrt(1E-300)/1E-100)/Number.EPSILON));Ga(Math,"sinh",xb.sinh,-2E-17!==Math.sinh(-2E-17));var yd=Math.expm1(10);Ga(Math,"expm1",xb.expm1,22025.465794806718<yd||22025.465794806718>yd);Ga(Math,"hypot",xb.hypot,Infinity!==Math.hypot(Infinity,NaN));var jd=Math.round,$e=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(-.5+Number.EPSILON/
3.99),af=[Ud+1,2*Ud-1].every(function(v){return Math.round(v)===v});Ga(Math,"round",function(v){var C=l(v);return.5>v-C?C:-1===C?-0:C+1},!$e||!af);$a.preserveToString(Math.round,jd);var Wd=Math.imul;2!==Math.imul.length&&Fa(Math,"imul",function(v,C){return R.Call(Wd,Math,arguments)});var zd=function(){var v=U.setTimeout;if("function"===typeof v||"object"===typeof v){R.IsPromise=function(ra){return R.TypeIsObject(ra)&&"undefined"!==typeof ra._promise?!0:!1};var C=function(ra){if(!R.IsConstructor(ra))throw new TypeError("Bad promise constructor");
var xa=this;xa.resolve=void 0;xa.reject=void 0;xa.promise=new ra(function(ua,Ya){if(void 0!==xa.resolve||void 0!==xa.reject)throw new TypeError("Bad Promise implementation!");xa.resolve=ua;xa.reject=Ya});if(!R.IsCallable(xa.resolve)||!R.IsCallable(xa.reject))throw new TypeError("Bad promise constructor");},y;"undefined"!==typeof window&&R.IsCallable(window.postMessage)&&(y=function(){var ra=[];window.addEventListener("message",function(xa){xa.source===window&&"zero-timeout-message"===xa.data&&(xa.stopPropagation(),
0!==ra.length&&pd(ra)())},!0);return function(xa){Ib(ra,xa);window.postMessage("zero-timeout-message","*")}});var J=function(){var ra=U.Promise,xa=ra&&ra.resolve&&ra.resolve();return xa&&function(ua){return xa.then(ua)}},T=R.IsCallable(U.setImmediate)?U.setImmediate:"object"===typeof process&&process.nextTick?process.nextTick:J()||(R.IsCallable(y)?y():function(ra){v(ra,0)}),ma=function(ra){return ra},oa=function(ra){throw ra;},la={},wa=function(ra,xa,ua){T(function(){if(xa===la)ra(ua);else{try{var Ya=
ra(ua);var Pa=xa.resolve}catch(Da){Ya=Da,Pa=xa.reject}Pa(Ya)}})},Ka=function(ra,xa){var ua=ra._promise,Ya=ua.reactionLength;if(0<Ya&&(wa(ua.fulfillReactionHandler0,ua.reactionCapability0,xa),ua.fulfillReactionHandler0=void 0,ua.rejectReactions0=void 0,ua.reactionCapability0=void 0,1<Ya))for(var Pa=1,Da=0;Pa<Ya;Pa++,Da+=3)wa(ua[Da+0],ua[Da+2],xa),ra[Da+0]=void 0,ra[Da+1]=void 0,ra[Da+2]=void 0;ua.result=xa;ua.state=1;ua.reactionLength=0},ib=function(ra,xa){var ua=ra._promise,Ya=ua.reactionLength;if(0<
Ya&&(wa(ua.rejectReactionHandler0,ua.reactionCapability0,xa),ua.fulfillReactionHandler0=void 0,ua.rejectReactions0=void 0,ua.reactionCapability0=void 0,1<Ya))for(var Pa=1,Da=0;Pa<Ya;Pa++,Da+=3)wa(ua[Da+1],ua[Da+2],xa),ra[Da+0]=void 0,ra[Da+1]=void 0,ra[Da+2]=void 0;ua.result=xa;ua.state=2;ua.reactionLength=0},Kc=function(ra){var xa=!1;return{resolve:function(ua){if(!xa){xa=!0;if(ua===ra)return ib(ra,new TypeError("Self resolution"));if(!R.TypeIsObject(ua))return Ka(ra,ua);try{var Ya=ua.then}catch(Pa){return ib(ra,
Pa)}if(!R.IsCallable(Ya))return Ka(ra,ua);T(function(){var Pa=Ya,Da=Kc(ra),ec=Da.resolve;Da=Da.reject;try{Qb(Pa,ua,ec,Da)}catch(Lc){Da(Lc)}})}},reject:function(ua){if(!xa)return xa=!0,ib(ra,ua)}}},Qb=function(ra,xa,ua,Ya){ra===of?I(ra,xa,ua,Ya,la):I(ra,xa,ua,Ya)},Cc=function(){var ra=function(xa){if(!(this instanceof ra))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!R.IsCallable(xa))throw new TypeError("not a valid resolver");
var ua=Ca(this,ra,ad,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),Ya=Kc(ua),Pa=Ya.reject;try{xa(Ya.resolve,Pa)}catch(Da){Pa(Da)}return ua};return ra}();var ad=Cc.prototype;var pf=function(ra,xa,ua,Ya){var Pa=!1;return function(Da){Pa||(Pa=!0,xa[ra]=Da,0===--Ya.count&&(Da=ua.resolve,Da(xa)))}};bb(Cc,{all:function(ra){if(!R.TypeIsObject(this))throw new TypeError("Promise is not object");var xa=new C(this),
ua;try{var Ya=R.GetIterator(ra);ra=ua={iterator:Ya,done:!1};for(var Pa=ra.iterator,Da=[],ec={count:1},Lc,Tc,kd=0;;){try{Lc=R.IteratorStep(Pa);if(!1===Lc){ra.done=!0;break}Tc=Lc.value}catch(qe){throw ra.done=!0,qe;}Da[kd]=void 0;var re=this.resolve(Tc),qf=pf(kd,Da,xa,ec);ec.count+=1;Qb(re.then,re,qf,xa.reject);kd+=1}if(0===--ec.count){var se=xa.resolve;se(Da)}return xa.promise}catch(qe){Pa=qe;if(ua&&!ua.done)try{R.IteratorClose(Ya,!0)}catch(Uc){Pa=Uc}Ya=xa.reject;Ya(Pa);return xa.promise}},race:function(ra){if(!R.TypeIsObject(this))throw new TypeError("Promise is not object");
var xa=new C(this),ua;try{var Ya=R.GetIterator(ra);ra=ua={iterator:Ya,done:!1};for(var Pa=ra.iterator,Da,ec,Lc;;){try{Da=R.IteratorStep(Pa);if(!1===Da){ra.done=!0;break}ec=Da.value}catch(Tc){throw ra.done=!0,Tc;}Lc=this.resolve(ec);Qb(Lc.then,Lc,xa.resolve,xa.reject)}return xa.promise}catch(Tc){Pa=Tc;if(ua&&!ua.done)try{R.IteratorClose(Ya,!0)}catch(kd){Pa=kd}Ya=xa.reject;Ya(Pa);return xa.promise}},reject:function(ra){if(!R.TypeIsObject(this))throw new TypeError("Bad promise constructor");var xa=new C(this),
ua=xa.reject;ua(ra);return xa.promise},resolve:function(ra){if(!R.TypeIsObject(this))throw new TypeError("Bad promise constructor");if(R.IsPromise(ra)&&ra.constructor===this)return ra;var xa=new C(this),ua=xa.resolve;ua(ra);return xa.promise}});bb(ad,{"catch":function(ra){return this.then(null,ra)},then:function(ra,xa){if(!R.IsPromise(this))throw new TypeError("not a promise");var ua=R.SpeciesConstructor(this,Cc);ua=2<arguments.length&&arguments[2]===la&&ua===Cc?la:new C(ua);var Ya=R.IsCallable(ra)?
ra:ma,Pa=R.IsCallable(xa)?xa:oa,Da=this._promise;if(0===Da.state){if(0===Da.reactionLength)Da.fulfillReactionHandler0=Ya,Da.rejectReactionHandler0=Pa,Da.reactionCapability0=ua;else{var ec=3*(Da.reactionLength-1);Da[ec+0]=Ya;Da[ec+1]=Pa;Da[ec+2]=ua}Da.reactionLength+=1}else if(1===Da.state)Da=Da.result,wa(Ya,ua,Da);else if(2===Da.state)Da=Da.result,wa(Pa,ua,Da);else throw new TypeError("unexpected Promise state");return ua.promise}});la=new C(Cc);var of=ad.then;return Cc}}();U.Promise&&(delete U.Promise.accept,
delete U.Promise.defer,delete U.Promise.prototype.chain);if("function"===typeof zd){bb(U,{Promise:zd});var rf=gb(U.Promise,function(v){return v.resolve(42).then(function(){})instanceof v}),Xd=!ba(function(){return U.Promise.reject(42).then(null,5).then(null,ja)}),Ub=ba(function(){return U.Promise.call(3,ja)}),te=function(v){var C=v.resolve(5);C.constructor={};v=v.resolve(C);try{v.then(null,ja).then(null,ja)}catch(y){return!0}return C===v}(U.Promise),Ad=ea&&function(){var v=0,C=Object.defineProperty({},
"then",{get:function(){v+=1}});Promise.resolve(C);return 1===v}(),Vc=function y(C){var J=new Promise(C);C(3,function(){});this.then=J.then;this.constructor=y};Vc.prototype=Promise.prototype;Vc.all=Promise.all;var Bd=ka(function(){return!!Vc.all([1,2])});rf&&Xd&&Ub&&!te&&Ad&&!Bd||(Promise=zd,Fa(U,"Promise",zd));if(1!==Promise.all.length){var Yd=Promise.all;Fa(Promise,"all",function(C){return R.Call(Yd,this,arguments)})}if(1!==Promise.race.length){var Zd=Promise.race;Fa(Promise,"race",function(C){return R.Call(Zd,
this,arguments)})}if(1!==Promise.resolve.length){var qb=Promise.resolve;Fa(Promise,"resolve",function(C){return R.Call(qb,this,arguments)})}if(1!==Promise.reject.length){var mb=Promise.reject;Fa(Promise,"reject",function(C){return R.Call(mb,this,arguments)})}Sd(Promise,"all");Sd(Promise,"race");Sd(Promise,"resolve");Sd(Promise,"reject");Hc(Promise)}var Cd=function(v){var C=aa(sa(v,function(y,J){y[J]=!0;return y},{}));return v.join(":")===C.join(":")},Xb=Cd(["z","a","bb"]),Ob=Cd(["z",1,"a","3",2]);
if(ea){var O=function(v,C){return C||Xb?tc(v)?"^"+R.ToString(v):"string"===typeof v?"$"+v:"number"===typeof v?Ob?v:"n"+v:"boolean"===typeof v?"b"+v:null:null},hb=function(){return Object.create?Object.create(null):{}},jb=function(v,C,y){if(S(y)||Ab.string(y))fa(y,function(ma){if(!R.TypeIsObject(ma))throw new TypeError("Iterator value "+ma+" is not an entry object");C.set(ma[0],ma[1])});else if(y instanceof v)I(v.prototype.forEach,y,function(ma,oa){C.set(oa,ma)});else{if(!tc(y)){var J=C.set;if(!R.IsCallable(J))throw new TypeError("bad map");
var T=R.GetIterator(y)}if("undefined"!==typeof T)for(;;){v=R.IteratorStep(T);if(!1===v)break;v=v.value;try{if(!R.TypeIsObject(v))throw new TypeError("Iterator value "+v+" is not an entry object");I(J,C,v[0],v[1])}catch(ma){throw R.IteratorClose(T,!0),ma;}}}},H=function(v,C,y){if(S(y)||Ab.string(y))fa(y,function(ma){C.add(ma)});else if(y instanceof v)I(v.prototype.forEach,y,function(ma){C.add(ma)});else{if(!tc(y)){var J=C.add;if(!R.IsCallable(J))throw new TypeError("bad set");var T=R.GetIterator(y)}if("undefined"!==
typeof T)for(;;){v=R.IteratorStep(T);if(!1===v)break;v=v.value;try{I(J,C,v)}catch(ma){throw R.IteratorClose(T,!0),ma;}}}},fc={Map:function(){var v={},C=function(oa,la){this.key=oa;this.value=la;this.prev=this.next=null};C.prototype.isRemoved=function(){return this.key===v};var y=function(oa,la){if(!R.TypeIsObject(oa)||!oa._es6map)throw new TypeError("Method Map.prototype."+la+" called on incompatible receiver "+R.ToString(oa));},J=function(oa,la){y(oa,"[[MapIterator]]");this.i=this.head=oa._head;
this.kind=la};J.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var oa=this.i,la=this.kind,wa=this.head;if("undefined"===typeof this.i)return bc();for(;oa.isRemoved()&&oa!==wa;)oa=oa.prev;for(;oa.next!==wa;)if(oa=oa.next,!oa.isRemoved())return la="key"===la?oa.key:"value"===la?oa.value:[oa.key,oa.value],this.i=oa,bc(la);this.i=void 0;return bc()}};M(J.prototype);var T=function la(){if(!(this instanceof la))throw new TypeError('Constructor Map requires "new"');
if(this&&this._es6map)throw new TypeError("Bad construction");var wa=Ca(this,la,ma,{_es6map:!0,_head:null,_map:pa?new pa:null,_size:0,_storage:hb()}),Ka=new C(null,null);Ka.next=Ka.prev=Ka;wa._head=Ka;0<arguments.length&&jb(la,wa,arguments[0]);return wa};var ma=T.prototype;$a.getter(ma,"size",function(){if("undefined"===typeof this._size)throw new TypeError("size method called on incompatible Map");return this._size});bb(ma,{get:function(la){y(this,"get");var wa=O(la,!0);if(null!==wa){if(la=this._storage[wa])return la.value}else if(this._map){if(la=
ab.call(this._map,la))return la.value}else for(var Ka=wa=this._head;(Ka=Ka.next)!==wa;)if(R.SameValueZero(Ka.key,la))return Ka.value},has:function(la){y(this,"has");var wa=O(la,!0);if(null!==wa)return"undefined"!==typeof this._storage[wa];if(this._map)return qa.call(this._map,la);for(var Ka=wa=this._head;(Ka=Ka.next)!==wa;)if(R.SameValueZero(Ka.key,la))return!0;return!1},set:function(la,wa){y(this,"set");var Ka=this._head,ib=Ka,Kc=O(la,!0);if(null!==Kc){if("undefined"!==typeof this._storage[Kc])return this._storage[Kc].value=
wa,this;var Qb=this._storage[Kc]=new C(la,wa);ib=Ka.prev}else this._map&&(qa.call(this._map,la)?ab.call(this._map,la).value=wa:(Qb=new C(la,wa),yb.call(this._map,la,Qb),ib=Ka.prev));for(;(ib=ib.next)!==Ka;)if(R.SameValueZero(ib.key,la))return ib.value=wa,this;Qb=Qb||new C(la,wa);R.SameValue(-0,la)&&(Qb.key=0);Qb.next=this._head;Qb.prev=this._head.prev;Qb.prev.next=Qb;Qb.next.prev=Qb;this._size+=1;return this},"delete":function(la){y(this,"delete");var wa=this._head,Ka=wa,ib=O(la,!0);if(null!==ib){if("undefined"===
typeof this._storage[ib])return!1;Ka=this._storage[ib].prev;delete this._storage[ib]}else if(this._map){if(!qa.call(this._map,la))return!1;Ka=ab.call(this._map,la).prev;Ma.call(this._map,la)}for(;(Ka=Ka.next)!==wa;)if(R.SameValueZero(Ka.key,la))return Ka.key=v,Ka.value=v,Ka.prev.next=Ka.next,Ka.next.prev=Ka.prev,--this._size,!0;return!1},clear:function(){y(this,"clear");this._map=pa?new pa:null;this._size=0;this._storage=hb();for(var la=this._head,wa,Ka=la.next;(wa=Ka)!==la;)wa.key=v,wa.value=v,Ka=
wa.next,wa.next=wa.prev=la;la.next=la.prev=la},keys:function(){y(this,"keys");return new J(this,"key")},values:function(){y(this,"values");return new J(this,"value")},entries:function(){y(this,"entries");return new J(this,"key+value")},forEach:function(la){y(this,"forEach");for(var wa=1<arguments.length?arguments[1]:null,Ka=this.entries(),ib=Ka.next();!ib.done;ib=Ka.next())wa?I(la,wa,ib.value[1],ib.value[0],this):la(ib.value[1],ib.value[0],this)}});M(ma,ma.entries);return T}(),Set:function(){var v=
function(ma,oa){if(!R.TypeIsObject(ma)||!ma._es6set||"undefined"===typeof ma._storage)throw new TypeError("Set.prototype."+oa+" called on incompatible receiver "+R.ToString(ma));},C=function oa(){if(!(this instanceof oa))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var la=Ca(this,oa,y,{_es6set:!0,"[[SetData]]":null,_storage:hb()});if(!la._es6set)throw new TypeError("bad set");0<arguments.length&&H(oa,la,arguments[0]);return la};
var y=C.prototype;var J=function(oa){if(!oa["[[SetData]]"]){var la=new fc.Map;oa["[[SetData]]"]=la;fa(aa(oa._storage),function(wa){if("^null"===wa)wa=null;else if("^undefined"!==wa){var Ka=wa.charAt(0);wa="$"===Ka?Db(wa,1):"n"===Ka?+Db(wa,1):"b"===Ka?"btrue"===wa:+wa}else wa=void 0;la.set(wa,wa)});oa["[[SetData]]"]=la}oa._storage=null};$a.getter(C.prototype,"size",function(){v(this,"size");if(this._storage)return aa(this._storage).length;J(this);return this["[[SetData]]"].size});bb(C.prototype,{has:function(oa){v(this,
"has");var la;if(this._storage&&null!==(la=O(oa)))return!!this._storage[la];J(this);return this["[[SetData]]"].has(oa)},add:function(oa){v(this,"add");var la;if(this._storage&&null!==(la=O(oa)))return this._storage[la]=!0,this;J(this);this["[[SetData]]"].set(oa,oa);return this},"delete":function(oa){v(this,"delete");var la;if(this._storage&&null!==(la=O(oa)))return oa=Y(this._storage,la),delete this._storage[la]&&oa;J(this);return this["[[SetData]]"]["delete"](oa)},clear:function(){v(this,"clear");
this._storage&&(this._storage=hb());this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){v(this,"values");J(this);return new T(this["[[SetData]]"].values())},entries:function(){v(this,"entries");J(this);return new T(this["[[SetData]]"].entries())},forEach:function(oa){v(this,"forEach");var la=1<arguments.length?arguments[1]:null,wa=this;J(wa);this["[[SetData]]"].forEach(function(Ka,ib){la?I(oa,la,ib,ib,wa):oa(ib,ib,wa)})}});Ga(C.prototype,"keys",C.prototype.values,!0);M(C.prototype,
C.prototype.values);var T=function(oa){this.it=oa};T.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}};M(T.prototype);return C}()};U.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(U.Set=fc.Set);if(U.Map||U.Set){ka(function(){return 2===(new Map([[1,2]])).get(1)})||(U.Map=function C(){if(!(this instanceof C))throw new TypeError('Constructor Map requires "new"');
var y=new pa;0<arguments.length&&jb(C,y,arguments[0]);delete y.constructor;Object.setPrototypeOf(y,U.Map.prototype);return y},U.Map.prototype=cb(pa.prototype),Ga(U.Map.prototype,"constructor",U.Map,!0),$a.preserveToString(U.Map,pa));var $d=new Map,ae=function(){var v=new Map([[1,0],[2,0],[3,0],[4,0]]);v.set(-0,v);return v.get(0)===v&&v.get(-0)===v&&v.has(0)&&v.has(-0)}(),Dc=$d.set(1,2)===$d;ae&&Dc||Fa(Map.prototype,"set",function(v,C){I(yb,this,0===v?0:v,C);return this});ae||(bb(Map.prototype,{get:function(v){return I(ab,
this,0===v?0:v)},has:function(v){return I(qa,this,0===v?0:v)}},!0),$a.preserveToString(Map.prototype.get,ab),$a.preserveToString(Map.prototype.has,qa));var Dd=new Set,ld=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(v){v["delete"](0);v.add(-0);return!v.has(0)}(Dd),bf=Dd.add(1)===Dd;if(!ld||!bf){var md=Set.prototype.add;Set.prototype.add=function(v){I(md,this,0===v?0:v);return this};$a.preserveToString(Set.prototype.add,md)}if(!ld){var Mc=Set.prototype.has;Set.prototype.has=
function(v){return I(Mc,this,0===v?0:v)};$a.preserveToString(Set.prototype.has,Mc);var Ed=Set.prototype["delete"];Set.prototype["delete"]=function(v){return I(Ed,this,0===v?0:v)};$a.preserveToString(Set.prototype["delete"],Ed)}var Jb=gb(U.Map,function(v){var C=new v([]);C.set(42,42);return C instanceof v}),ue=Object.setPrototypeOf&&!Jb;try{var Fd=!(U.Map()instanceof U.Map)}catch(v){Fd=v instanceof TypeError}if(0!==U.Map.length||ue||!Fd)U.Map=function C(){if(!(this instanceof C))throw new TypeError('Constructor Map requires "new"');
var y=new pa;0<arguments.length&&jb(C,y,arguments[0]);delete y.constructor;Object.setPrototypeOf(y,C.prototype);return y},U.Map.prototype=pa.prototype,Ga(U.Map.prototype,"constructor",U.Map,!0),$a.preserveToString(U.Map,pa);var Sa=gb(U.Set,function(v){var C=new v([]);C.add(42,42);return C instanceof v}),sb=Object.setPrototypeOf&&!Sa;try{var ve=!(U.Set()instanceof U.Set)}catch(v){ve=v instanceof TypeError}if(0!==U.Set.length||sb||!ve){var be=U.Set;U.Set=function C(){if(!(this instanceof C))throw new TypeError('Constructor Set requires "new"');
var y=new be;0<arguments.length&&H(C,y,arguments[0]);delete y.constructor;Object.setPrototypeOf(y,C.prototype);return y};U.Set.prototype=be.prototype;Ga(U.Set.prototype,"constructor",U.Set,!0);$a.preserveToString(U.Set,be)}var Yb=new U.Map,Nc=!ka(function(){return Yb.keys().next().done});("function"!==typeof U.Map.prototype.clear||0!==(new U.Set).size||0!==Yb.size||"function"!==typeof U.Map.prototype.keys||"function"!==typeof U.Set.prototype.keys||"function"!==typeof U.Map.prototype.forEach||"function"!==
typeof U.Set.prototype.forEach||ca(U.Map)||ca(U.Set)||"function"!==typeof Yb.keys().next||Nc||!Jb)&&bb(U,{Map:fc.Map,Set:fc.Set},!0);U.Set.prototype.keys!==U.Set.prototype.values&&Ga(U.Set.prototype,"keys",U.Set.prototype.values,!0);M(Object.getPrototypeOf((new U.Map).keys()));M(Object.getPrototypeOf((new U.Set).keys()));if(Z&&"has"!==U.Set.prototype.has.name){var bd=U.Set.prototype.has;Fa(U.Set.prototype,"has",function(v){return I(bd,this,v)})}}bb(U,fc);Hc(U.Map);Hc(U.Set)}var gc=function(v){if(!R.TypeIsObject(v))throw new TypeError("target must be an object");
},Zb={apply:function(){return R.Call(R.Call,null,arguments)},construct:function(v,C){if(!R.IsConstructor(v))throw new TypeError("First argument must be a constructor.");var y=2<arguments.length?arguments[2]:v;if(!R.IsConstructor(y))throw new TypeError("new.target must be a constructor.");return R.Construct(v,C,y,"internal")},deleteProperty:function(v,C){gc(v);if(ea){var y=Object.getOwnPropertyDescriptor(v,C);if(y&&!y.configurable)return!1}return delete v[C]},has:function(v,C){gc(v);return C in v}};
Object.getOwnPropertyNames&&Object.assign(Zb,{ownKeys:function(v){gc(v);var C=Object.getOwnPropertyNames(v);R.IsCallable(Object.getOwnPropertySymbols)&&Cb(C,Object.getOwnPropertySymbols(v));return C}});Object.preventExtensions&&Object.assign(Zb,{isExtensible:function(v){gc(v);return Object.isExtensible(v)},preventExtensions:function(v){gc(v);return!ba(function(){return Object.preventExtensions(v)})}});if(ea){var cf=function(v,C,y){var J=Object.getOwnPropertyDescriptor(v,C);if(!J)return v=Object.getPrototypeOf(v),
null===v?void 0:cf(v,C,y);if("value"in J)return J.value;if(J.get)return R.Call(J.get,y)},n=function(v,C,y,J){var T=Object.getOwnPropertyDescriptor(v,C);if(!T){v=Object.getPrototypeOf(v);if(null!==v)return n(v,C,y,J);T={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in T?T.writable&&R.TypeIsObject(J)?Object.getOwnPropertyDescriptor(J,C)?Gc.defineProperty(J,C,{value:y}):Gc.defineProperty(J,C,{value:y,writable:!0,enumerable:!0,configurable:!0}):!1:T.set?(I(T.set,J,y),!0):!1};Object.assign(Zb,
{defineProperty:function(v,C,y){gc(v);return!ba(function(){return Object.defineProperty(v,C,y)})},getOwnPropertyDescriptor:function(v,C){gc(v);return Object.getOwnPropertyDescriptor(v,C)},get:function(v,C){gc(v);return cf(v,C,2<arguments.length?arguments[2]:v)},set:function(v,C,y){gc(v);return n(v,C,y,3<arguments.length?arguments[3]:v)}})}if(Object.getPrototypeOf){var we=Object.getPrototypeOf;Zb.getPrototypeOf=function(v){gc(v);return we(v)}}Object.setPrototypeOf&&Zb.getPrototypeOf&&Object.assign(Zb,
{setPrototypeOf:function(v,C){gc(v);if(null!==C&&!R.TypeIsObject(C))throw new TypeError("proto must be an object or null");if(C===Gc.getPrototypeOf(v))return!0;if(Gc.isExtensible&&!Gc.isExtensible(v))return!1;var y;a:{for(y=C;y;){if(v===y){y=!0;break a}y=Zb.getPrototypeOf(y)}y=!1}if(y)return!1;Object.setPrototypeOf(v,C);return!0}});var sf=function(v,C){R.IsCallable(U.Reflect[v])?ka(function(){U.Reflect[v](1);U.Reflect[v](NaN);U.Reflect[v](!0);return!0})&&Fa(U.Reflect,v,C):Ga(U.Reflect,v,C)};Object.keys(Zb).forEach(function(v){sf(v,
Zb[v])});var Gd=U.Reflect.getPrototypeOf;Z&&Gd&&"getPrototypeOf"!==Gd.name&&Fa(U.Reflect,"getPrototypeOf",function(v){return I(Gd,U.Reflect,v)});U.Reflect.setPrototypeOf&&ka(function(){U.Reflect.setPrototypeOf(1,{});return!0})&&Fa(U.Reflect,"setPrototypeOf",Zb.setPrototypeOf);U.Reflect.defineProperty&&(ka(function(){var v=!U.Reflect.defineProperty(1,"test",{value:1}),C="function"!==typeof Object.preventExtensions||!U.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return v&&C})||Fa(U.Reflect,
"defineProperty",Zb.defineProperty));U.Reflect.construct&&(ka(function(){var v=function(){};return U.Reflect.construct(function(){},[],v)instanceof v})||Fa(U.Reflect,"construct",Zb.construct));if("Invalid Date"!==String(new Date(NaN))){var tf=Date.prototype.toString;Fa(Date.prototype,"toString",function(){var v=+this;return v!==v?"Invalid Date":R.Call(tf,this)})}var df={anchor:function(v){return R.CreateHTML(this,"a","name",v)},big:function(){return R.CreateHTML(this,"big","","")},blink:function(){return R.CreateHTML(this,
"blink","","")},bold:function(){return R.CreateHTML(this,"b","","")},fixed:function(){return R.CreateHTML(this,"tt","","")},fontcolor:function(v){return R.CreateHTML(this,"font","color",v)},fontsize:function(v){return R.CreateHTML(this,"font","size",v)},italics:function(){return R.CreateHTML(this,"i","","")},link:function(v){return R.CreateHTML(this,"a","href",v)},small:function(){return R.CreateHTML(this,"small","","")},strike:function(){return R.CreateHTML(this,"strike","","")},sub:function(){return R.CreateHTML(this,
"sub","","")},sup:function(){return R.CreateHTML(this,"sup","","")}};fa(Object.keys(df),function(v){var C=String.prototype[v];if(R.IsCallable(C)){C=I(C,"",' " ');var y=Nb([],C.match(/"/g)).length;C=C!==C.toLowerCase()||2<y}else C=!0;C&&Fa(String.prototype,v,df[v])});var h=function(){if(!Fc)return!1;var v="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:null;if(!v)return!1;if("undefined"!==typeof v(Va())||"[null]"!==v([Va()]))return!0;var C={a:Va()};C[Va()]=!0;return"{}"!==
v(C)?!0:!1}(),Ta=ka(function(){return Fc?"{}"===JSON.stringify(Object(Va()))&&"[{}]"===JSON.stringify([Object(Va())]):!0});if(h||!Ta){var nc=JSON.stringify;Fa(JSON,"stringify",function(v){if("symbol"!==typeof v){var C;1<arguments.length&&(C=arguments[1]);var y=[v];if(S(C))y.push(C);else{var J=R.IsCallable(C)?C:null;y.push(function(T,ma){T=J?I(J,this,T,ma):ma;if("symbol"!==typeof T)return Ab.symbol(T)?vd({})(T):T})}2<arguments.length&&y.push(arguments[2]);return nc.apply(this,y)}})}return U});
var CindyJS=function(){function E(Z){if(0===S)return console.error("Waiting for "+Z+" after we finished waiting."),function(){};0>S&&(S=0);++S;return function(){--S;0>S&&console.error("Wait count mismatch: "+Z);if(0===S)for(var fa=0,sa=aa.length;fa<sa;)aa[fa++].startup()}}function I(Z){var fa=I.newInstance(Z);0>=S?fa.startup():!1!==Z.autostart&&aa.push(fa);return fa}var S=-1,aa=[];Math.sign||(Math.sign=function(Z){return(0<Z)-(0>Z)||+Z});"undefined"===typeof document||"undefined"===typeof window||
"undefined"===typeof document.addEventListener||"undefined"!==typeof window.cindyDontWait&&!0===window.cindyDontWait||document.addEventListener("DOMContentLoaded",E("DOMContentLoaded"));var ba=null,ka=null,ca={};I.getBaseDir=function(){if(null!==ba)return ba;for(var Z=document.getElementsByTagName("script"),fa=0;fa<Z.length;++fa){var sa=Z[fa],Ra=sa.src;if(Ra){var Za=/Cindy\.js$/.exec(Ra);if(Za)return ba=Ra.substr(0,Za.index),console.log("Will load extensions from "+ba),ka=sa,ba}}console.error("Could not find <script> tag for Cindy.js");
return ba=ka=!1};I.addNewScript=function(Z,fa){fa||console.error.bind(console);var sa=I.getBaseDir();if(!1===sa)return!1;fa=document.createElement("script");fa.src=sa+Z;Z=ka.nextSibling;sa=ka.parentElement;Z?sa.insertBefore(fa,Z):sa.appendChild(fa);return fa};I.loadScript=function(Z,fa,sa,Ra){for(var Za=String(Z).split("."),Ga=window;Za.length&&"object"===typeof Ga&&null!==Ga;)Ga=Ga[Za.shift()];if(Ga&&!Za.length)return sa(),!0;Ra||(Ra=console.error.bind(console));Za=ca[Z];if(!Za){Za=I.addNewScript(fa,
Ra);if(!1===Za)return Ra("Can't load additional components."),!1;ca[Z]=Za}Za.addEventListener("load",sa);Za.addEventListener("error",Ra);return null};I._autoLoadingPlugin={};I.autoLoadPlugin=function(Z,fa,sa){if(I._pluginRegistry[Z])return sa(),!0;var Ra=I._autoLoadingPlugin[Z];if(!Ra){fa||(fa=Z+"-plugin.js");Ra=I._autoLoadingPlugin[Z]=[];Z=I.addNewScript(fa);if(!1===Z)return!1;Z.addEventListener("error",console.error.bind(console))}Ra.push(sa);return null};var B={ctype:"undefined"};I.waitFor=E;I._pluginRegistry=
{};I.instances=[];I.registerPlugin=function(Z,fa,sa){if(1!==Z)return console.error("Plugin API version "+Z+" not supported"),!1;I._pluginRegistry[fa]=sa;(I._autoLoadingPlugin[fa]||[]).forEach(function(Ra){Ra()})};var ea=0;I.dumpState=function(Z){Z=I.instances[Z||0].saveState();console.log(JSON.stringify(Z))};I.debugState=function(Z){I.instances.map(function(fa){var sa=fa.config;sa=JSON.parse(JSON.stringify(sa));var Ra=fa.saveState();console.log(JSON.stringify(Ra));for(var Za in Ra)sa[Za]=Ra[Za];fa.shutdown();
return sa}).forEach(function(fa){I(fa)})};I.newInstance=function(Z){function fa(){mb.width=hb=mb.clientWidth;mb.height=jb=mb.clientHeight;qb=1;if(Yd||Zd)qb=Math.max(Yd?Yd/mb.width:0,Zd?Zd/mb.height:0),hb=qb*mb.clientWidth,jb=qb*mb.clientHeight;O.setTransform(1/qb,0,0,1/qb,0,0);P.setMat(25,0,0,25,250.5,250.5);if(Cd)for(var a=$jscomp.makeIterator(Cd),b=a.next();!b.done;b=a.next()){b=b.value;var c=Object.keys(b)[0];"scale"===c&&(Xd=b.scale,P[c](b.scale));if("translate"===c)P[c](b.translate[0],b.translate[1]);
"scaleAndOrigin"===c&&(Xd=b[c][0]/25,P[c].apply(null,b[c]));"visibleRect"===c&&(P[c].apply(null,b[c]),Xd=P.drawingstate.initialmatrix.a/25)}P.createnewbackup();P.greset();a=1;"undefined"!==typeof window&&window.devicePixelRatio&&(a=window.devicePixelRatio);b=O.webkitBackingStorePixelRatio||O.mozBackingStorePixelRatio||O.msBackingStorePixelRatio||O.oBackingStorePixelRatio||O.backingStorePixelRatio||1;a!==b&&(a/=b,mb.width=hb*a,mb.height=jb*a,O.scale(a,a))}function sa(a){if("canvas"!==a.tagName.toLowerCase()){var b=
a;for(mb=document.createElement("canvas");b.firstChild;)b.removeChild(b.firstChild)}else{mb=a;b=document.createElement("div");var c=null,d=null;Array.prototype.slice.call(mb.attributes).forEach(function(f){"width"===f.name?c=f.value:"height"===f.name?d=f.value:b.setAttributeNodeNS(mb.removeAttributeNode(f))});null===c||b.style.width||(b.style.width=c+"px");null===d||b.style.height||(b.style.height=d+"px");mb.parentNode.replaceChild(b,mb)}b.classList.add("CindyJS-widget");a=mb.style;a.position="absolute";
a.border="none";a.margin=a.padding=a.left=a.top="0px";a.width=a.height="100%";a="static";window.getComputedStyle&&(a=window.getComputedStyle(b).getPropertyValue("position"),a=String(a||"static"));"static"===a&&(b.style.position="relative");b.appendChild(mb);return mb}function Ra(){var a=Z.cinderella;if(!a||!a.version)return!1;for(var b=0;b<arguments.length;++b){var c=a.version[b],d=arguments[b];if(c!==d)return typeof c===typeof d&&c<d}return!1}function Za(){var a,b,c,d,f,k,m,p,u,w,z,D,F,K,V,Q,da,
W,na,ia,Ea,La,va,Ia;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ja){switch(Ja.nextAddress){case 1:ue=!0;if(0!==Fd)return Ja.return();a=Z;if(a.exclusive)for(ia=Eb.instances.length;0<ia;)Eb.instances[--ia].shutdown();void 0!==a.csconsole&&(Pb=a.csconsole);Pb=null===Pb?new pd:!0===Pb?new Cb:"string"===typeof Pb?new zb(Pb):"object"===typeof Pb&&"function"===typeof Pb.appendChild?new zb(Pb):new pd;Ob=[100,100];b=null;Cd=a.transform;a.ports&&0<a.ports.length&&(c=a.ports[0],(b=c.element)||
(b=document.getElementById(c.id)),b=sa(b),d=b.parentNode.style,"window"===c.fill?(d.width="100vw",d.height="100vh"):"parent"===c.fill?(d.width="100%",d.height="100%"):c.width&&c.height&&(d.width=c.width+"px",d.height=c.height+"px"),c.virtualwidth&&(Yd=c.virtualwidth),c.virtualheight&&(Zd=c.virtualheight),c.background&&(b.style.backgroundColor=c.background),void 0!==c.transform&&(Cd=c.transform),Xb(c.grid)&&0<c.grid&&(Ub=c.grid),Xb(c.tgrid)&&0<c.tgrid&&(te=c.tgrid),c.snap&&(Ad=!0),Number.isFinite(c.snapdistance)&&
(Vc=Math.max(c.snapdistance,0)),c.axes&&(Bd=!0));b||(b=a.canvas,b||"undefined"===typeof document||(b=document.getElementById(a.canvasname))&&(b=sa(b)));b&&(mb=b,O=b.getContext("2d"),fa(),O.setLineDash||(O.setLineDash=function(){}),(a.animation?a.animation.controls:a.animcontrols)&&r(a),a.animation&&Xb(a.animation.speed)&&(void 0===a.animation.accuracy&&Ra(2,9,1875)?$a(.5*a.animation.speed):$a(a.animation.speed)),a.animation&&Xb(a.animation.accuracy)&&(Wd=a.animation.accuracy));a.statusbar&&(ib="string"===
typeof a.statusbar?document.getElementById(a.statusbar):a.statusbar);f="move keydown keyup keytyped keytype mousedown mouseup mousedrag mousemove mouseclick multidown multiup multidrag init tick draw simulationstep simulationstart simulationstop ondrop xrdraw xrinputsourceschange xrselectstart xrselectend xrselect xrselecthold xrsqueezestart xrsqueezeend xrsqueeze xrsqueezehold".split(" ");k=a.scripts;m=null;"string"===typeof k&&0<=k.search(/\*/)&&(m=k);"object"!==typeof k&&(k=null);if(!(a.import&&
Array.isArray(a.import)&&0<a.import.length)){Ja.jumpTo(2);break}p="csinit";if(a.initscript)p=a.initscript;else if(m)p=m.replace(/\*/,"init");else return Ja.return();console.log("===== Importing CindyScript libraries to "+p+" =====");u="";w=$jscomp.makeIterator(a.import.reverse());z=w.next();case 3:if(z.done){Ja.jumpTo(5);break}D=z.value;if("string"!==typeof D){Ja.jumpTo(4);break}console.log("Loading "+D+" ...");F=-1==D.search(/.+\.cjs$/)?D+".cjs":D;Ja.setCatchFinallyBlocks(6);return Ja.yield(fetch(F),
8);case 8:K=Ja.yieldResult;if(200!==K.status){console.log("CAUTION! Import of "+D+" failed.");Ja.jumpTo(9);break}return Ja.yield(K.text(),10);case 10:V=Ja.yieldResult,Q=";"==V[V.length-1]?"":";",u=V+Q+"\n"+u,console.log(D+" loaded!");case 9:Ja.leaveTryBlock(4);break;case 6:if(da=Ja.enterCatchBlock(),"Failed to fetch"===da.message)console.log("CAUTION! Import of "+D+" failed."),console.log("This website seems to not run on a web server. CindyJS will continue without importing CindyScript libraries.");
else throw da;case 4:z=w.next();Ja.jumpTo(3);break;case 5:W=Ga(p),na=document.createTextNode(u),bb(W,na),console.log("===== Import of libraries to "+p+" finished ========");case 2:f.forEach(function(Oa){if(null!==k&&k[Oa])var Ba=k[Oa];else{Ba=Oa+"script";if(a[Ba])Ba=document.getElementById(a[Ba]);else if(m){if(Ba=document.getElementById(m.replace(/\*/,Oa)),!Ba)return}else return;Ba=Ba.text}Ba=zc(Ba,!1);"error"===Ba.ctype?console.error("Error compiling "+Oa+" script: "+Ba.message):Na[Oa]=De(Ba,Oa)});
Ra(2,9,1888)&&!Na.keydown&&(Na.keydown=Na.keytyped,Na.keytyped=Na.keytype,Na.keytype=void 0);Xb(a.grid)&&0<a.grid&&(Ub=a.grid);a.snap&&(Ad=!0);Number.isFinite(a.snapdistance)&&(Vc=Math.max(a.snapdistance,0));H={};ia=0;fc={};a.geometry||(a.geometry=[]);jf(a.geometry);a.behavior||(a.behavior=[]);"function"===typeof Sc&&Sc(a.behavior);for(Ea in a.images)La=ob(a.images[Ea],!1),La!==B&&(fc[Ea]=La);for(va in a.videos)Ia=ob(a.videos[va],!0),Ia!==B&&(fc[va]=Ia);Jb.canvas=b;if(a.oninit)a.oninit(Jb);Eb.instances.push(Jb);
Z.use&&Z.use.forEach(function(Oa){y.use$1([A.wrap(Oa)],{})});Uc.convexhull3d$1&&gb("QuickHull3D","QuickHull3D.js");(Uc.colorplot$1||Uc.colorplot$2||Uc.colorplot$3||Uc.colorplot$4)&&gb("CindyGL","CindyGL.js");(Uc.playtone$1||Uc.playmelody$1)&&gb("midi","midi-plugin.js");U();Ja.jumpToEnd()}})}function Ga(a){var b=document.getElementById(a);b||(b=document.createElement("script"),b.id=a,b.type="text/x-cindyscript",document.head.appendChild(b));return b}function bb(a,b){a.firstChild?a.insertBefore(b,a.firstChild):
a.appendChild(b)}function ob(a,b){if("string"===typeof a){if(b){var c=document.createElement("video");c.preload="auto";c.loop=!0;c.setAttribute("playsinline","");enableInlineVideo(c)}else c=new Image;c.src=a}else c=a;if(!c.tagName)return console.error("Not a valid image element",c),B;var d={img:c,width:NaN,height:NaN,ready:!0,live:!1,generation:0,whenReady:cb};a=c.tagName.toLowerCase();var f=[];if("img"===a)c.complete?(d.width=c.width,d.height=c.height):(d.ready=!1,c.addEventListener("load",function(){d.width=
c.width;d.height=c.height;d.ready=!0;d.whenReady=cb;f.forEach(cb);x()}),d.whenReady=f.push.bind(f));else if("video"===a)d.live=!0,c.readyState>=c.HAVE_METADATA?(d.width=c.videoWidth,d.height=c.videoHeight):(d.ready=!1,c.addEventListener("loadedmetadata",function(){d.width=c.videoWidth;d.height=c.videoHeight;d.ready=!0;d.whenReady=cb;f.forEach(cb);x()}),d.whenReady=f.push.bind(f));else if("canvas"===a)d.width=c.width,d.height=c.height;else return console.error("Not a valid image element",a,c),B;return{ctype:"image",
value:d}}function r(a){function b(D,F){var K=document.createElement("button"),V=document.createElement("img");K.appendChild(V);w.appendChild(K);ld(V,D);K.addEventListener("click",F);Dc[D]=function(Q){Q?K.classList.add("CindyJS-active"):K.classList.remove("CindyJS-active")}}function c(D){if(z){var F=p.getBoundingClientRect();$a(m*(D.clientX-F.left-p.clientLeft+.5)/F.width+f)}}var d=document.createElement("div");d.className="CindyJS-animcontrols";mb.parentNode.appendChild(d);var f=0,k=1,m=1;a.animation&&
a.animation.speedRange&&Xb(a.animation.speedRange[0])&&Xb(a.animation.speedRange[1])&&(f=a.animation.speedRange[0],k=a.animation.speedRange[1],m=k-f);var p=document.createElement("div");p.className="CindyJS-animspeed";d.appendChild(p);var u=document.createElement("div");p.appendChild(u);e(p,"mousedown",function(D){z=!0;c(D)});e(p,"mousemove",c);e(mb.parentNode,"mouseup",function(D){z=!1},!0);var w=document.createElement("div");w.className="CindyJS-animbuttons";d.appendChild(w);b("play",Ha);b("pause",
Hb);b("stop",Nb);Dc.stop(!0);Dd=function(D){D=(D-f)/m;D=Math.max(0,Math.min(1,D));D=.1*Math.round(1E3*D);u.style.width=D+"%"};var z=!1}function $a(a){$e=a;Dd&&Dd(a)}function cb(a){return a()}function gb(a,b,c){var d=null;Z.plugins&&(d=Z.plugins[a]);d||(d=Eb._pluginRegistry[a]);d?y.use$1([A.wrap(a)],{}):(++bf,Eb.autoLoadPlugin(a,b,function(){y.use$1([A.wrap(a)],{});U(c)}))}function U(a){0===--bf&&(a?x():(M(Na.init),(Z.animation||Z).autoplay&&Ha(),Jb.canvas&&g(Jb.canvas,Z)))}function za(){null!==md&&
(Fb.set(md.state),Object.keys(md.speeds).forEach(function(a){var b=H.csnames[a];"undefined"!==typeof b.behavior&&(a=md.speeds[a],b.behavior.vx=a[0],b.behavior.vy=a[1],b.behavior.vz=a[2],b.behavior.fx=0,b.behavior.fy=0,b.behavior.fz=0)}),Ue())}function Ha(){if(!xb){if(yd){var a=Wc.backup;a.set(Fb);for(var b={},c=$jscomp.makeIterator(H.points),d=c.next();!d.done;d=c.next())d=d.value,"undefined"!==typeof d.behavior&&(b[d.name]=[d.behavior.vx,d.behavior.vy,d.behavior.vz]);md={state:a,speeds:b};jd=0;yd=
!1;Dc.stop(!1)}else Dc.pause(!1);af=Date.now();Dc.play(!0);"function"===typeof Sc&&uf&&pe();xb=!0;M(Na.simulationstart);x()}}function Hb(){xb&&(Dc.play(!1),Dc.pause(!0),xb=!1)}function Nb(){yd||(xb?(M(Na.simulationstop),xb=!1,Dc.play(!1)):Dc.pause(!1),Dc.stop(!0),yd=!0,za())}function Db(){if(!Ed){Ed=!0;for(var a=Eb.instances.length;0<a;)if(Eb.instances[--a]===Jb){Eb.instances.splice(a,1);break}for(a=Mc.length;0<a;)try{Mc[--a]()}catch(b){console.error(b)}}}function Ib(a){this.in=function(b,c){console.log(b);
c?this.append(this.createTextNode("span","blue",b)):this.append(this.createTextNode("p","blue",b))};this.out=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.err=function(b,c){console.log(b);c?this.append(this.createTextNode("span","red",b)):this.append(this.createTextNode("p","red",b))};this.createTextNode=function(b,c,d){return"undefined"!==typeof document?(b=document.createElement(b),b.appendChild(document.createTextNode(d)),
b.style.color=c,b):d+"\n"}}function Cb(){var a=this,b=document.createElement("div");b.innerHTML='<div id="console" style="border-top: 1px solid #333333; bottom: 0px; position: absolute; width: 100%;"><div id="log" style="height: 150px; overflow-y: auto;"></div><input id="cmd" type="text" style="box-sizing: border-box; height: 30px; width: 100%;"></div>';document.body.appendChild(b);var c=document.getElementById("cmd");var d=document.getElementById("log");c.onkeydown=function(f){13===f.keyCode&&""!==
c.value&&(a.in(c.value),f=y.parse$1([A.wrap(c.value)],[]),f=M(f),console.log(qa(f)),"undefined"!==f.ctype&&Pb.out(qa(f)),c.value="",d.scrollTop=d.scrollHeight)};this.append=function(f){d.appendChild(f)};this.clear=function(){d.innerHTML=""}}function zb(a){var b=a;"string"===typeof a&&(b=document.getElementById(a));this.append=function(c){b.appendChild(c)};this.clear=function(){b.innerHTML=""}}function pd(){this.append=function(a){};this.clear=function(){}}function e(a,b,c,d){void 0===d&&(d=!1);Mc.push(function(){a.removeEventListener(b,
c,d)});a.addEventListener(b,c,d)}function g(a,b){function c(z,D){z=$jscomp.makeIterator(z.changedTouches);for(var F=z.next();!F.done;F=z.next()){var K=F.value;F=f(K.identifier);if(D||Nc[F]){var V=a.getBoundingClientRect();K=P.to(K.clientX-V.left-a.clientLeft+.5,K.clientY-V.top-a.clientTop+.5);Nc[F]=[K[0],K[1]]}}x()}function d(z){var D=a.getBoundingClientRect();z=P.to(z.clientX-D.left-a.clientLeft+.5,z.clientY-D.top-a.clientTop+.5);Sa.prevx=Sa.x;Sa.prevy=Sa.y;Sa.x=z[0];Sa.y=z[1];Ob[0]=Sa.x;Ob[1]=Sa.y;
x()}function f(z){if(bd.hasOwnProperty(z))return bd[z];var D=Object.values(bd);D=D.sort(function(V,Q){return V-Q});var F=!1,K;for(K in D)!F&&D[K]>(K|0)+1&&(bd[z]=(K|0)+1,F=!0);F||(bd[z]=D.length+1);return bd[z]}function k(z){var D=z.changedTouches;c(z,!1);for(var F=0;F<z.changedTouches.length;F++)Yb=f(z.changedTouches[F].identifier),pa(Yb),delete bd[z.changedTouches[F].identifier];F=!1;for(var K=0;K<D.length;K++)D[K].identifier===w&&(F=!0);F&&(w=-1,Sa.down=!1,sb=void 0,M(Na.mouseup),ed("mouseup"),
u||M(Na.mouseclick),x(),z.preventDefault())}var m=null,p=null,u=!1;"undefined"!==typeof MutationObserver&&(m=MutationObserver);m||"undefined"===typeof WebKitMutationObserver||(m=WebKitMutationObserver);m?(m=new m(function(z){document.body.contains(a)||Db()}),m.observe(document.documentElement,{childList:!0,subtree:!0}),Mc.push(function(){m.disconnect()})):(e(a,"DOMNodeRemovedFromDocument",Db),e(a,"DOMNodeRemoved",Db));if(!0===b.keylistener)e(document,"keydown",function(z){Y(z,Na.keydown);return!1}),
e(document,"keyup",function(z){Y(z,Na.keyup);return!1}),e(document,"keypress",function(z){Y(z,Na.keytyped);return!1});else if(Na.keydown||Na.keyup||Na.keytyped)a.setAttribute("tabindex","0"),e(a,"mousedown",function(){a.focus()}),e(a,"keydown",function(z){9!==z.keyCode&&(Y(z,Na.keydown),Na.keytyped||z.preventDefault())}),e(a,"keyup",function(z){Y(z,Na.keyup);z.preventDefault()}),e(a,"keypress",function(z){9!==z.keyCode&&(Y(z,Na.keytyped),z.preventDefault())});e(a,"mousedown",function(z){p=z;u=!1;
Sa.button=z.which;d(z);ja(0);M(Na.mousedown);ed("mousedown");Sa.down=!0;z.preventDefault()});e(a,"mouseup",function(z){Sa.down=!1;sb=void 0;M(Na.mouseup);pa(0);ed("mouseup");delete Nc[0];x();z.preventDefault()});e(a,"mousemove",function(z){d(z);Sa.down?(p&&(2<Math.abs(p.clientX-z.clientX)||2<Math.abs(p.clientY-z.clientY))&&(u=!0),M(Na.mousedrag),Nc[0]&&(Yb=0,M(Na.multidrag),Yb=0)):M(Na.mousemove);ed("mousemove");z.preventDefault()});e(a,"click",function(z){d(z);u||M(Na.mouseclick);z.preventDefault()});
e(a,"dragenter",function(z){z.preventDefault()});e(a,"dragover",function(z){z.preventDefault()});e(a,"drop",function(z){function D(va,Ia){function Ja(){Ba.readyState===XMLHttpRequest.DONE&&(200!==Ba.status?(console.error("GET request for "+va+" failed: "+(Ba.responseText||"(no error message)")),Q(Ia,B)):K(Ia,Ba.responseText))}var Oa=va.replace(/[?#][^]*/,"");Oa=Oa.replace(/[^]*\/([^\/])/,"$1");W[Ia]={type:"",name:Oa};var Ba=new XMLHttpRequest;Ba.onreadystatechange=function(){if(Ba.readyState===XMLHttpRequest.DONE)if(200!==
Ba.status)console.error("HEAD request for "+va+" failed: "+(Ba.responseText||"(no error message)")),Q(Ia,B);else{var Wa=Ba.getResponseHeader("Content-Type");W[Ia].type=Wa;/^image\//.test(Wa)?V(Ia,va):F(Wa)?(Ba=new XMLHttpRequest,Ba.onreadystatechange=Ja,Ba.open("GET",va),Ba.send()):Q(Ia,B)}};Ba.open("HEAD",va);Ba.send()}function F(va){va=va.replace(/;[^]*/,"");return/^text\//.test(va)?1:"application/json"===va?2:0}function K(va,Ia){switch(F(W[va].type)){case 1:Q(va,A.string(Ia));break;case 2:try{var Ja=
JSON.parse(Ia);var Oa=A.wrapJSON(Ja)}catch(Ba){console.error(Ba),Oa=B}Q(va,Oa);break;default:Q(va,B)}}function V(va,Ia){var Ja=new Image,Oa=!1;Ja.onload=function(){Oa||(Oa=!0,Q(va,ob(Ja,!1)))};Ja.onerror=function(Ba){Oa||(Oa=!0,console.error(Ba),Q(va,B))};Ja.src=Ia}function Q(va,Ia,Ja){na[va]=h.turnIntoCSList([Ia,A.string(Ja||Ia.ctype),A.string(W[va].type),A.string(W[va].name)]);0===--ia&&($d=h.turnIntoCSList(na),ae=La,M(Na.ondrop),ae=$d=B,x())}z.preventDefault();var da=z.dataTransfer,W=da.files,
na=Array(W.length),ia=W.length,Ea=z.currentTarget.getBoundingClientRect(),La=h.realVector(P.to(z.clientX-Ea.left-a.clientLeft+.5,z.clientY-Ea.top-a.clientTop+.5));if(0<W.length)Array.prototype.forEach.call(W,function(va,Ia){var Ja=new FileReader;F(va.type)?(Ja.onload=function(){K(Ia,Ja.result)},Ja.readAsText(va)):/^image\//.test(va.type)?(Ja.onload=function(){V(Ia,Ja.result)},Ja.readAsDataURL(va)):(console.log("Unknown MIME type: "+va.type),Q(Ia,B))});else if(z=da.getData("text/uri-list"))z=z.split("\n").filter(function(va){return!/^\s*(#|$)/.test(va)}),
ia=z.length,na=Array(ia),W=Array(ia),z.forEach(D)});var w=-1;e(a,"touchstart",function(z){c(z,!0);for(var D=0;D<z.changedTouches.length;D++)ja(f(z.changedTouches[D].identifier));-1===w&&(D=z.changedTouches,0!==D.length&&(w=D[0].identifier,d(z.targetTouches[0]),M(Na.mousedown),Sa.down=!0,p=z.targetTouches[0],u=!1,ed("mousedown"),z.preventDefault()))},!1);e(a,"touchmove",function(z){c(z,!1);for(var D=0;D<z.changedTouches.length;D++)Yb=f(z.changedTouches[D].identifier),M(Na.multidrag),Yb=0;D=z.changedTouches;
for(var F=!1,K=0;K<D.length;K++)D[K].identifier===w&&(F=!0);F&&(d(z.targetTouches[0]),Sa.down?(p&&(2<Math.abs(p.clientX-z.targetTouches[0].clientX)||2<Math.abs(p.clientY-z.targetTouches[0].clientY))&&(u=!0),Yb=f(w),M(Na.mousedrag)):M(Na.mousemove),ed("mousemove"),z.preventDefault())},!0);e(a,"touchend",k,!1);"undefined"!==typeof document&&document.body&&e(document.body,"touchcancel",k,!1);"undefined"!==typeof window&&e(window,"resize",function(){gc(function(){fa();x()})},!1);q(a.parentNode);x()}function l(a,
b){var c=document.createElement("div");c.setAttribute("style",b);a.appendChild(c);return c}function q(a){function b(){d.scrollLeft=d.scrollTop=f.scrollLeft=f.scrollTop=1E5}function c(){if(k!==a.clientWidth||m!==a.clientHeight)k=a.clientWidth,m=a.clientHeight,p||(p=!0,gc(function(){p=!1;fa();x()}));b()}if("undefined"!==typeof document){var d=l(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");l(d,"position: absolute; transition: 0s; left: 0; top: 0; width: 100000px; height: 100000px");
var f=l(a,"position: absolute; transition: 0s; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;");l(f,"position: absolute; transition: 0s; left: 0; top: 0; width: 200%; height: 200%");b();var k=a.clientWidth,m=a.clientHeight,p=!1;d.addEventListener("scroll",c);f.addEventListener("scroll",c)}}function x(){Zb||(Zb=gc(G))}function G(){Zb=null;if(!Ed){if(xb){var a=Date.now(),b=Math.min(50,a-af)*$e*rf;jd=a;a=jd+b;uf&&"undefined"!==typeof $b&&$b.tick(b);jd=a;xb&&
M(Na.tick)}L();xb&&x()}}function L(){P.reset();O.save();O.clearRect(0,0,hb,jb);var a=P.drawingstate.matrix,b,c;if(0!==Ub){O.beginPath();O.strokeStyle="rgba(0,0,0,0.1)";O.lineWidth=1;O.lineCap="butt";var d=Ub*a.a;for(b=Math.ceil(-a.tx/d);(c=b*d+a.tx)<hb;){if(b||!Bd)O.moveTo(c,0),O.lineTo(c,jb);b++}for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<jb;){if(b||!Bd)O.moveTo(0,c),O.lineTo(hb,c);b++}O.stroke()}if(0!==te){O.beginPath();O.strokeStyle="rgba(0,0,0,0.1)";O.lineWidth=1;O.lineCap="butt";d=te*a.a;var f=Math.sqrt(3);
var k=a.ty/f;var m=(jb+a.ty)/f;for(b=Math.ceil(-(a.tx+m)/d);(c=b*d+a.tx)+k<hb;)O.moveTo(c+k,0),O.lineTo(c+m,jb),b++;for(b=Math.ceil(-(a.tx-k)/d);(c=b*d+a.tx)-m<hb;)O.moveTo(c-k,0),O.lineTo(c-m,jb),b++;d*=.5*f;for(b=Math.floor(a.ty/d);(c=b*d-a.ty)<jb;){if(b||!Bd)O.moveTo(0,c),O.lineTo(hb,c);b++}O.stroke()}Bd&&(O.beginPath(),O.strokeStyle="rgba(0,0,0,0.2)",O.lineWidth=3,O.lineCap="butt",O.lineJoin="miter",O.miterLimit=10,O.beginPath(),O.moveTo(0,-a.ty),O.lineTo(hb-6,-a.ty),O.moveTo(hb-13,-5-a.ty),O.lineTo(hb-
3,-a.ty),O.lineTo(hb-13,5-a.ty),O.moveTo(a.tx,jb),O.lineTo(a.tx,6),O.moveTo(a.tx-5,13),O.lineTo(a.tx,3),O.lineTo(a.tx+5,13),O.stroke());Se();P.greset();Qe();for(a=0;a<H.polygons.length;a++)d=H.polygons[a],d.isshowing&&!1!==d.visible&&(k={color:d.color,alpha:d.alpha,fillcolor:d.fillcolor,fillalpha:d.fillalpha,size:d.size,lineJoin:A.string("miter"),fillrule:A.string(d.fillrule)},J.drawpolygon([d.vertices],k,"D",!0));for(a=0;a<H.conics.length;a++)H.conics[a].isArc?(d=H.conics[a],d.isshowing&&!1!==d.visible&&
(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,J.drawarc(d,k,d.filled?"F":"D"))):(d=H.conics[a],d.isshowing&&!1!==d.visible&&(k={},k.color=d.color,k.alpha=d.alpha,k.size=d.size,J.drawconic(d.matrix,k)));for(a=0;a<H.lines.length;a++)a:if(d=H.lines[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog))if("S"===d.kind)k={overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha,arrow:d.arrow,arrowsize:d.arrowsize,arrowposition:d.arrowposition,arrowshape:d.arrowshape,
arrowsides:d.arrowsides},0<=n.mult(d.startpos.value[2],n.conjugate(d.endpos.value[2])).value.real?(y.draw$2([d.startpos,d.endpos],k),d.labeled&&!d.tmp&&(k=d.printname||d.name||"S",m=h.scalmult(n.real(Math.sign(d.startpos.value[2].value.real)*Math.sign(d.endpos.value[2].value.real)),h.cross(d.startpos,d.endpos)),m={x:m.value[0].value.real,y:m.value[1].value.real},b=Math.sqrt(m.x*m.x+m.y*m.y),m={x:8*m.x/b-3,y:8*m.y/b-3},m=d.labelpos||m,b=N.makeColor(ub.textColor),c=t._helper.midpoint(t._helper.midpoint(d.startpos,
d.endpos),d.endpos),Pe(d,k,c,m,b))):(N.handleModifs(k,N.lineModifs),N.drawRaySegment(d.startpos,d.endpos));else if("end"===d.clip.value&&"Join"===d.type)b=H.csnames[d.args[0]],k=H.csnames[d.args[1]],y.draw$2([b.homog,k.homog],{overhang:d.overhang,dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha});else{if("inci"===d.clip.value){b=[1E6,0];k=[-1E6,0];c=[1E6,0];m=[-1E6,0];for(f=0;f<d.incidences.length;f++){var p=H.csnames[d.incidences[f]].homog,u=p.value[0],w=p.value[1],z=p.value[2];n._helper.isAlmostZero(z)||
(u=n.div(u,z),w=n.div(w,z),n._helper.isAlmostReal(u)&&n._helper.isAlmostReal(w)&&(u.value.real<b[0]&&(b=[u.value.real,p]),u.value.real>k[0]&&(k=[u.value.real,p]),w.value.real<c[0]&&(c=[w.value.real,p]),w.value.real>m[0]&&(m=[w.value.real,p])))}k[0]-b[0]>m[0]-c[0]?(b=b[1],k=k[1]):(b=c[1],k=m[1]);if(b!==k){y.draw$2([b,k],{dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha,overhang:d.overhang});break a}}y.draw$1([d.homog],{dashtype:d.dashtype,size:d.size,color:d.color,alpha:d.alpha})}for(a=
0;a<H.points.length;a++)if(d=H.points[a],d.isshowing&&!1!==d.visible&&h._helper.isAlmostReal(d.homog)&&(k=d.color,d.behavior&&(k=d.color),y.draw$1([d.homog],{size:d.size,color:k,alpha:d.alpha,noborder:d.noborder,border:d.border}),d.labeled&&!d.tmp)){m=d.printname||d.name||"P";b=d.labelpos||{x:3,y:3};c=N.makeColor(ub.textColor);if(!0===d.noborder.value||!1===d.border.value)c=k;Pe(d,m,d.homog,b,c)}for(a=0;a<H.texts.length;a++)Rd(H.texts[a]);if(H.ifs.length){if(eb.dirty||!A.deeplyEqual(eb.mat,P.drawingstate.matrix))t.IFS.updateParameters(),
eb.dirty=!1;eb.img&&O.drawImage(eb.img,0,0,hb,jb)}O.restore()}function Y(a,b){a=window.event?event:a;a=a.charCode?a.charCode:a.keyCode;ve=String.fromCharCode(a);be=a;M(b);x()}function ja(a){Yb=a;0===a&&(Nc[0]=Ob);M(Na.multidown);Yb=0}function pa(a){Yb=a;M(Na.multiup);delete Nc[a];Yb=0}function Ma(a){var b=a.value;a=b[0].value;var c=b[1].value;b=b[2].value;return h.turnIntoCSList([a[0],n.add(a[1],c[0]),n.add(a[2],b[0]),c[1],n.add(c[2],b[1]),b[2]])}function ab(a){var b=!0;return function(c,d){b&&(console.error("Operator "+
a+" is not supported yet."),b=!1);return B}}function qa(a,b){if("undefined"===typeof a)return"_??_";if(null===a)return"_???_";if("undefined"===a.ctype)return"___";if("number"===a.ctype)return n.niceprint(a);if("string"===a.ctype||"boolean"===a.ctype)return a.value;if("list"===a.ctype){b="[";for(var c=0;c<a.value.length;c++)b+=qa(M(a.value[c])),c!==a.value.length-1&&(b+=", ");return b+"]"}if("JSON"===a.ctype)try{return Ta.niceprint(a,b)}catch(d){return Ta._helper.handlePrintException(d)}return"dict"===
a.ctype?nc.niceprint(a):"function"===a.ctype?"FUNCTION":"infix"===a.ctype?"INFIX":"modifier"===a.ctype?a.key+"->"+qa(a.value):"shape"===a.ctype?a.type:"error"===a.ctype?"Error: "+a.message:"variable"===a.ctype?qa(T.getvar(a.name)):"geo"===a.ctype?a.value.name:"image"===a.ctype?"IMAGE":"_?_"}function yb(a,b){b="undefined"===a[0].ctype;var c="undefined"===a[1].ctype,d=M(a[1]);if(b||c)return B;"variable"===a[0].ctype?("list"===d.ctype&&(d.internal_usage=void 0),T.setvar(a[0].name,d)):"infix"===a[0].ctype?
"_"===a[0].oper?J.assigntake(a[0],d):pb("Can't use infix expression as lvalue"):"field"===a[0].ctype?J.assigndot(a[0],d):"userdata"===a[0].ctype?J.assigncolon(a[0],d):"function"===a[0].ctype&&"genList"===a[0].oper?"list"===d.ctype?J.assignlist(a[0].args,d.value):pb("Expected list in rhs of assignment"):pb("Left hand side of assignment is not a recognized lvalue");return d}function Va(a,b){b=M(a[0]);a=M(a[1]);if(b.ctype===a.ctype){if("number"===b.ctype)return A.bool(b.value.real===a.value.real&&b.value.imag===
a.value.imag);if("string"===b.ctype||"boolean"===b.ctype)return A.bool(b.value===a.value);if("list"===b.ctype)return h.equals(b,a);if("geo"===b.ctype||"JSON"===b.ctype)return A.bool(b.value===a.value)}return{ctype:"boolean",value:!1}}function yc(a,b){return A.not(Va(a,b))}function vb(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype?{ctype:"boolean",value:n._helper.isAlmostEqual(b,a)}:"string"===b.ctype&&"string"===a.ctype||"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",
value:b.value===a.value}:"list"===b.ctype&&"list"===a.ctype?h.almostequals(b,a):{ctype:"boolean",value:!1}}function ac(a,b){b=X(a[0]);a=X(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value&&a.value}:B}function kc(a,b){b=X(a[0]);a=X(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value||a.value}:B}function Zc(a,b){b=a[0];"void"!==b.ctype&&(b=X(b));a=X(a[1]);var c=A.add(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=A.withUsage(c,"Angle"));
return c}function Hd(a,b){b=a[0];"void"!==b.ctype&&(b=X(b));a=X(a[1]);var c=A.sub(b,a);"Angle"===b.usage&&"Angle"===a.usage&&(c=A.withUsage(c,"Angle"));return c}function Ae(a,b){b=X(a[0]);a=X(a[1]);var c=A.mult(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||b.usage||(c=A.withUsage(c,"Angle")):c=A.withUsage(c,"Angle");return c}function Id(a,b){b=X(a[0]);a=X(a[1]);"number"===a.ctype&&n._helper.isZero(a)&&pb("WARNING: Division by zero!");var c=A.div(b,a);"Angle"!==b.usage||a.usage?"Angle"!==a.usage||
b.usage||(c=A.withUsage(c,"Angle")):c=A.withUsage(c,"Angle");return c}function Ab(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.pow(b,a):B}function Fa(a,b){b=Ca(a[0]);a=Ca(a[1]);if(b!==B&&a!==B){var c=h.cross(b,a);"Point"===b.usage&&"Point"===a.usage&&(c=A.withUsage(c,"Line"));"Line"===b.usage&&"Line"===a.usage&&(c=A.withUsage(c,"Point"));return c}return B}function Fc(a){var b=a.length;if(0===b)return[];if(1===b)return[0];if(2===b)return a[0][0]+a[1][1]<=a[0][1]+a[1][0]?
[0,1]:[1,0];if(4<b)return sc(a);var c=la[b],d=Number.POSITIVE_INFINITY,f=c[0];c=$jscomp.makeIterator(c);for(var k=c.next();!k.done;k=c.next()){k=k.value;for(var m=0,p=0;p<b;++p)m+=a[p][k[p]];m<d&&(d=m,f=k)}return f}function sc(a){function b(){return{matched:-1,prev:-1,start:-1,cost:0,used:!1,leaf:!1}}function c(V){for(var Q=0;Q<k;++Q)0<z[V][Q]||w[Q].used||(w[Q].used=!0,c(w[Q].matched))}function d(V){for(var Q=0;Q<k;++Q)0<z[Q][V]||u[Q].used||(u[Q].used=!0,d(u[Q].matched))}var f=Math.abs,k=a.length,
m,p,u=Array(k),w=Array(k),z=Array(k);for(m=0;m<k;++m)z[m]=Array(k);for(m=0;m<k;++m)for(u[m]=b(),w[m]=b(),u[m].cost=a[m][0],p=1;p<k;++p)u[m].cost>a[m][p]&&(u[m].cost=a[m][p]);for(;;){for(m=0;m<k;++m)for(p=0;p<k;++p)z[m][p]=a[m][p]-u[m].cost-w[p].cost,z[m][p]<1E-14*(f(a[m][p])+f(u[m].cost)+f(w[p].cost))&&(z[m][p]=0);for(m=0;m<k;++m)u[m].matched=w[m].matched=-1;for(var D=0;;){for(m=0;m<k;++m)u[m].used=u[m].leaf=w[m].used=w[m].leaf=!1,-1===u[m].matched&&(u[m].start=m,u[m].used=u[m].leaf=!0,u[m].prev=
-1);for(var F=!1,K=!1;!K;){for(m=0;m<k;++m)if(u[m].leaf)for(u[m].leaf=!1,p=0;p<k;++p)if(!(w[p].used||0<z[m][p])&&u[m].matched!==p&&(w[p].prev=m,w[p].start=u[m].start,w[p].used=w[p].leaf=!0,-1===w[p].matched)){u[w[p].start].prev=p;F=!0;break}if(F)break;K=!0;for(p=0;p<k;++p)w[p].leaf&&(w[p].leaf=!1,m=w[p].matched,u[m].used||(u[m].prev=p,u[m].start=w[p].start,u[m].used=u[m].leaf=!0,K=!1))}if(!F)break;for(F=0;F<k;++F)if(-1===u[F].matched&&-1!==u[F].prev){p=u[F].prev;do m=w[p].prev,w[p].matched=m,u[m].matched=
p,p=u[m].prev;while(m!==F);++D}}if(D===k)break;for(m=0;m<k;++m)u[m].used=u[m].leaf=w[m].used=w[m].leaf=!1;for(m=0;m<k;++m)-1===u[m].matched&&c(m);for(p=0;p<k;++p)-1===w[p].matched&&d(p);for(m=0;m<k;++m)-1===u[m].matched||u[m].used||w[u[m].matched].used||(u[m].used=!0);D=Number.POSITIVE_INFINITY;for(m=0;m<k;++m)if(!u[m].used)for(p=0;p<k;++p)w[p].used||D>z[m][p]&&(D=z[m][p]);for(m=0;m<k;++m)u[m].used||(u[m].cost+=D),w[m].used&&(w[m].cost-=D)}a=Array(k);for(m=0;m<k;++m)p=u[m].matched,a[m]=p;return a}
function Gc(a,b){b=M(a[0]);a=X(a[1]);"string"!==b.ctype&&"JSON"!==b.ctype&&(b=h.asList(b));if("JSON"!==b.ctype&&"number"===a.ctype){a=Math.floor(a.value.real);0>a&&(a=b.value.length+a+1);if(0<a&&a<b.value.length+1)return"list"===b.ctype?b.value[a-1]:{ctype:"string",value:b.value.charAt(a-1)};pb("WARNING: Index out of range!");return B}if("JSON"===b.ctype){a=qa(a);if(qa.errorTypes.includes(a))return B;b=b.value[a];return void 0!==b&&b.ctype?b:B}if("list"===a.ctype){for(var c=[],d=0;d<a.value.length;d++){var f=
X(a.value[d]);c[d]=Gc([b,f],[])}return h.turnIntoCSList(c)}return B}function Jd(a,b){b=M(a[0]);a=M(a[1]);if("shape"===b.ctype&&"shape"===a.ctype)return J.shapeconcat(b,a);b=h.asList(b);a=h.asList(a);return"list"===b.ctype&&"list"===a.ctype?h.concat(b,a):B}function Kd(a,b){b=M(a[0]);a=M(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.set(h.common(b,a)):"shape"===b.ctype&&"shape"===a.ctype?J.shapecommon(b,a):B}function tc(a,b){b=M(a[0]);a=M(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.remove(b,
a):"shape"===b.ctype&&"shape"===a.ctype?J.shaperemove(b,a):B}function R(a,b){b=M(a[0]);a=M(a[1]);return"list"===b.ctype?h.append(b,a):B}function qd(a,b){b=M(a[0]);a=M(a[1]);return"list"===a.ctype?h.prepend(b,a):B}function rd(a,b){a|=0;b|=0;if(0===a&&0===b)return 0;for(;0!==b;){var c=a;a=b;b=c%b|0}return a}function Be(a){return 1===a?0:1}function dd(a,b,c){var d=b*b-4*a*c;0<=d?(d=Math.sqrt(d),0<b&&(d=-d),a=[[d-b,2*a],[2*c,d-b]]):a=null;b=a;if(null===b)return null;a=b[0][0]/b[0][1];b=b[1][0]/b[1][1];
return b<a?[b,a]:[a,b]}function ge(a,b,c,d,f,k,m,p){p=void 0===p?0:p;if(b.includes("\n")){var u=Infinity,w=-Infinity,z=Infinity,D=-Infinity;b.split("\n").forEach(function(K){K=ge(a,K,c,d,f,k);u>K.left&&(u=K.left);w<K.right&&(w=K.right);z>K.top&&(z=K.top);D<K.bottom&&(D=K.bottom);d+=m});return{left:u,right:w,top:z,bottom:D}}var F=a.measureText(b);p?(a.save(),a.translate(c,d),a.rotate(-p),a.fillText(b,-F.width*f,0),a.restore()):a.fillText(b,c-F.width*f,d);return{left:c-F.width*f,right:c+F.width*(1-
f),top:d-.84*k,bottom:d+.36*k}}function Wb(a){return"image"===a.ctype?a.value:"string"===a.ctype&&fc.hasOwnProperty(a.value)?fc[a.value].value:null}function Oc(a,b,c,d,f){var k=[];if(a.readPixels)k=a.readPixels(b,c,d,f);else{if(a.img.getContext){var m=a.img.getContext("2d");var p=m.getImageData(b,c,d,f).data}else try{ad||(ad=document.createElement("canvas")),ad.width=d,ad.height=f,m=ad.getContext("2d"),m.drawImage(a.img,b,c,d,f,0,0,d,f),p=m.getImageData(0,0,d,f).data}catch(w){console.log(w)}for(var u in p)k.push(p[u]/
255)}return k}function he(a){return a.replace(/[^A-Za-z0-9 \u0080-\uffff]/gi,"\\$&")}function wb(a,b,c){var d=a;b&&(d=d+" at "+b.row+":"+b.col);c&&(d=d+": \u2018"+c+"\u2019");d=Error(d);d.name="CindyScriptParseError";d.description=a;d.location=b;d.text=c;return d}function Pc(a){this.input=a;this.re=new RegExp(re,"g");for(var b=[],c=a.indexOf("\n")+1;c;)b.push(c),c=a.indexOf("\n",c)+1;b.push(a.length);this.bols=b;this.bol=this.pos=0;this.line=1}function sd(a){var b=a[a.length-2],c=a[a.length-3],d=
a[a.length-1];if(c){if(c.isSuperscript&&b.precedence<=c.precedence)throw wb("Operator not allowed after superscript",b.start,b.text);if(d){if(!b.op.infix)throw wb("Operator may not be used infix",b.start,b.text);}else if(!b.op.postfix)throw wb("Operator may not be used postfix",b.start,b.text);}else if(d){if(!b.op.prefix)throw wb("Operator may not be used prefix",b.start,b.text);}else if(!b.op.bare)throw wb("Operator without operands",b.start,b.text);b.ctype="infix";b.oper=b.op.sym;b.args=[c,d];a.splice(a.length-
3,3,b)}function ie(a,b,c,d){a.length&1||a.push(null);for(c=Pa[c];3<=a.length&&a[a.length-2].precedence<=c.precedence;)sd(a);a.push({op:c,precedence:c.precedence+(c.rassoc?1:0),start:b.start,end:b.end,text:b.text,rawtext:b.rawtext});c="";for(var f=b.text,k=0;k<f.length;++k)c+="0123456789+-".charAt(d.indexOf(f.charAt(k)));b.ctype="number";b.value={real:+c,imag:0};a.push(b);sd(a)}function Ce(a,b){var c=[],d="}"===b;a:for(;;){var f=a.next();switch(f.toktype){case "OP":var k=Pa[f.text];"_"!==k.sym||!c.length||
c.length&1||"OP"!==c[c.length-1].toktype||":="!==c[c.length-1].op.sym||(c.pop(),k=Pa[":=_"],f.text=k.sym);f.op=k;f.precedence=k.precedence;for(c.length&1||c.push(null);3<=c.length&&c[c.length-2].precedence<=f.precedence;)sd(c);k.rassoc&&f.precedence++;d&&":"===k.sym&&(f.jsonatom=!0,f.precedence=Pa[","].precedence,d=!1);"}"===b&&","===k.sym&&0<c.length&&c[c.length-1].jsonatom&&(d=!0);c.push(f);break;case "ID":f.ctype="variable";f.name=f.text;if(c.length&1)throw wb("Missing operator",f.start,f.text);
c.push(f);break;case "NUM":f.ctype="number";f.value={real:+f.text,imag:0};if(c.length&1)throw wb("Missing operator",f.start,f.text);c.push(f);break;case "STR":f.ctype="string";f.value=f.raw.substring(1,f.raw.length-1);if(c.length&1)throw wb("Missing operator",f.start,f.text);c.push(f);break;case "SUB":ie(c,f,"_","\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089\u208a\u208b");break;case "SUP":ie(c,f,"^","\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079\u207a\u207b");c[c.length-
1].isSuperscript=!0;break;case "BRA":k="[](){}||".indexOf(f.text);if(f.text===b||k&1)break a;var m="[](){}||".charAt(k+1);k=Ce(a,m);var p=k.closedBy;if(p.text!==m)throw wb("Opening "+f.text+" at "+f.start.row+":"+f.start.col+" closed by "+(p.text||"EOF")+" at "+p.start.row+":"+p.start.col);p=f.text+p.text;m=[];if(k=k.expr){for(;k&&"infix"===k.ctype&&","===k.oper;)m.push(k.args[0]),k=k.args[1];m.push(k)}if(c.length&1){if("{}"===p)throw wb("{\u2026} not yet defined for operators.",f.start);k=c[c.length-
1];if("variable"!==k.ctype)throw wb("Function name must be an identifier",k.start);if(2<c.length&&c[c.length-2].precedence<Da)throw wb("Function call in indexing construct must be enclosed in parentheses",f.start);k.ctype="function";f=k.args=[];p=k.modifs={};m=$jscomp.makeIterator(m);for(var u=m.next();!u.done;u=m.next())if((u=u.value)&&"infix"===u.ctype&&"->"===u.oper){var w=u.args[0];if("variable"!==w.ctype)throw wb("Modifier name must be an identifier",u.start);p[w.name]=u.args[1]}else f.push(u);
k.oper=k.name.toLowerCase()+"$"+k.args.length}else if("||"===p)if(1===m.length)c.push({ctype:"function",oper:"abs_infix",args:m,modifs:{}});else if(2===m.length)c.push({ctype:"function",oper:"dist_infix",args:m,modifs:{}});else throw wb("Don't support |\u2026| with "+m.length+" arguments",f.start);else"{}"===p?c.push({ctype:"function",oper:"genJSON",args:m,modifs:{}}):"[]"!==p&&1===m.length?c.push({ctype:"paren",args:m}):0===m.length?c.push({ctype:"list",value:[]}):c.push({ctype:"function",oper:"genList",
args:m,modifs:{}});break;case "EOF":break a}}for(c.length&1||c.push(null);3<=c.length;)sd(c);return{expr:c[0],closedBy:f}}function Hc(a){this.usedFunctions={};this.usedVariables={}}function M(a){if(void 0===a)return B;if("infix"===a.ctype)return a.impl(a.args,{},a);if("variable"===a.ctype)return M(T.getvar(a.name));if("function"===a.ctype)return xe.push(a),a=J.evaluate(a.oper,a.args,a.modifs),xe.pop(),a;if("void"===a.ctype)return B;if("field"===a.ctype){var b=M(a.obj);if("geo"===b.ctype){var c=Ta._helper.self;
Ta._helper.self=b;a=M(ma.getField(b.value,a.key));Ta._helper.self=c;return a}return"list"===b.ctype?(c=Ta._helper.self,Ta._helper.self=b,a=h.getField(b,a.key),Ta._helper.self=c,a):"JSON"===b.ctype?(c=Ta._helper.self,Ta._helper.self=b,a=M(Ta.getField(b,a.key)),Ta._helper.self=c,a):B}return"userdata"===a.ctype?(b=M(a.obj),a=A.string(qa(M(a.key))),"_?_"===a.value&&(a=B),"geo"===b.ctype?(c=Ta._helper.self,Ta._helper.self=b,a=M(ma.getuserData(b.value,a)),Ta._helper.self=c,a):"list"===b.ctype||"string"===
b.ctype?(c=Ta._helper.self,Ta._helper.self=b,a=M(ma.getuserData(b,a)),Ta._helper.self=c,a):"JSON"===b.ctype?(c=Ta._helper.self,Ta._helper.self=b,a=M(Ta.getField(b,a.value)),Ta._helper.self=c,a):B):a}function X(a){a=M(a);if("geo"===a.ctype){var b=a.value;if("P"===b.kind)return ma.getField(b,"xy");if("V"===b.kind)return b.value}return a}function Ca(a){a=M(a);if("geo"===a.ctype){var b=a.value;if("P"===b.kind||"L"===b.kind)return ma.getField(b,"homog")}return h._helper.isNumberVecN(a,3)?a:h._helper.isNumberVecN(a,
2)?(b=h.turnIntoCSList([a.value[0],a.value[1],n.real(1)]),a.usage&&(b=A.withUsage(b,a.usage)),b):B}function zc(a){var b=new Hc;b.usedFunctions=Uc;b.infixmap=C;a=b.parse(a);for(var c in b.usedVariables)T.create(c);return a}function De(a,b){return{ctype:"infix",args:[],impl:function(){xe=[{oper:b}];var c=M(a);xe=[];return c}}}function pb(a){Pb.err(a+xe.map(function(b){return"\n  at "+b.oper}).join("\n"))}function Qc(){this._path=[];this._defs=["<defs>"];this._imgcache=[];this._body=[];this._saveStack=
[""];this._clipIndex=0;this._stroke=this._fill="#000";this._strokeOpacity=this._fillOpacity=null;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.globalAlpha=1}function Ee(){this._body=[];this._yPos=this._xPos=NaN;this._extGState={Af255:"<< /ca 1 >>",As255:"<< /CA 1 >>"};this._objects=[["%PDF-1.4\n"]];this._offset=this._objects[0][0].length;this._nextIndex=5;this._imgcache=[];this._xobjects={};this._pathUsed=-1;this._fillAlpha=this._strokeAlpha=
this._globalAlpha=1;this.height=this.width=0;this.lineWidth=1;this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10}function Fe(a,b){var c=a.width,d=a.height,f=document.createElement("canvas");f.setAttribute("width",c);f.setAttribute("height",d);f.setAttribute("style","display:none;");var k=Jb.canvas;k.parentNode.insertBefore(f,k.nextSibling);try{return f.getContext("2d").drawImage(a,0,0,c,d),f.toDataURL(b||"image/png")}finally{f.parentNode.removeChild(f)}}function gf(a){a=a.replace(RegExp("[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/]+",
"g"),"");var b=new Uint8Array(3*a.length>>2),c,d;for(d=c=0;c+3<a.length;c+=4){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+2));var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+3));b[d++]=f<<2|k>>4;b[d++]=k<<4|m>>2;b[d++]=
m<<6|p}switch(a.length-c){case 0:break;case 2:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));b[d++]=f<<2|k>>4;break;case 3:f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+1));m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c+
2));b[d++]=f<<2|k>>4;b[d++]=k<<4|m>>2;break;default:throw Error("Malformed Base64 input: "+(a.length-c)+" chars left: "+a.substr(c));}if(d!==b.length)throw Error("Failed assertion: "+d+" should be "+b.length);return b}function Ge(a){function b(p){return(a[p]<<24|a[p+1]<<16|a[p+2]<<8|a[p+3])>>>0}if(57>a.length)throw Error("Too short to be a PNG file");if(2303741511!==b(0)||218765834!==b(4))throw Error("PNG signature missing");for(var c=[],d=8;d<a.length;){if(d+12>a.length)throw Error("Incomplete chunk at offset 0x"+
d.toString(16));var f=b(d);if(2147483648<=f)throw Error("Chunk too long");var k=d+12+f;if(k>a.length)throw Error("Incomplete chunk at offset 0x"+d.toString(16));var m=a.subarray(d+4,d+8);m=String.fromCharCode.apply(String,m);c.push({len:f,type:m,data:a.subarray(d+8,d+8+f),crc:b(d+8+f)});d=k}return c}function td(a,b){var c;if(c=/^rgba\(([0-9.]+), *([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],+c[4]);else if(c=/^rgb\(([0-9.]+), *([0-9.]+), *([0-9.]+)\)$/.exec(a))b(+c[1],+c[2],+c[3],
1);else throw Error("Can't handle color style "+a);}function He(a){var b=1;Object.keys(fc).forEach(function(c){var d=fc[c].value.img;if(void 0===d.cachedDataURL&&d.src)if("data:"===d.src.substr(0,5))d.cachedDataURL=d.src;else{++b;d.cachedDataURL=null;var f=new XMLHttpRequest;f.responseType="blob";f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200===f.status){var k=new FileReader;k.onloadend=function(){d.cachedDataURL=k.result;console.log("Cached data for image "+d.src);0===
--b&&a()};k.readAsDataURL(f.response)}else console.error("Failed to load "+d.src+": "+f.statusText),0===--b&&a()};f.open("GET",d.src,!0);f.send()}});0===--b&&a()}function bc(a,b,c){for(c||(c="0");a.length<b;)a=c+a;return a}function Ld(){null!==ye&&(window.URL.revokeObjectURL(ye),ye=null)}function ud(a){He(function(){var b=O;try{O=new a;O.width=hb;O.height=jb;L();var c=O.toBlob();ye=window.URL.createObjectURL(c);Bf(ye)}finally{O=b}})}function uc(a){var b=null,c=1E6;console.log("getElementAtMouse");
for(var d=$jscomp.makeIterator(H.gslp),f=d.next();!f.done;f=d.next())if(f=f.value,!f.pinned&&!1!==f.visible&&!0!==f.tmp){var k=void 0,m=void 0,p=void 0,u=P.drawingstate.matrix.sdet;if("P"===f.kind){p=h.normalizeZ(f.homog);if(!h._helper.isAlmostReal(p))continue;k=p.value[0].value.real-a.x;m=p.value[1].value.real-a.y;p=Math.sqrt(k*k+m*m);f.narrow&p>20/u&&(p=1E4)}else if("C"===f.kind)m=H.csnames[f.args[0]],p=0,"undefined"!==typeof f.radius&&(p=f.radius.value.real),k=n.div(m.homog.value[0],m.homog.value[2]).value.real,
m=n.div(m.homog.value[1],m.homog.value[2]).value.real,k-=a.x,m-=a.y,p=Math.sqrt(k*k+m*m)-p,m=k=0,0>p&&(p=-p),p+=30/u;else if("L"===f.kind||"S"===f.kind)k=f.homog,p=n,m=p.add(p.mult(k.value[0],p.conjugate(k.value[0])),p.mult(k.value[1],p.conjugate(k.value[1]))),m=h.scaldiv(p.sqrt(m),k),p=m.value[0].value.real*a.x+m.value[1].value.real*a.y+m.value[2].value.real,k=m.value[0].value.real*p,m=m.value[1].value.real*p,0>p&&(p=-p),p+=1;if(p<c+.2/u){c=p;b=f;var w={x:k,y:m}}}return null===b?null:{mover:b,offset:w,
prev:{x:a.x,y:a.y}}}function lc(){return"P"+Hf++}function ed(a){var b=ha[vf].actions;b[ce].event===a&&b[ce].do()&&(x(),ce===b.length-1?(hc=[],ce=Xc=0):ce++)}function Md(a){return a&&.5>Math.abs(a.offset.x)&&.5>Math.abs(a.offset.y)&&!a.mover.tmp}function Ie(a){return Md(a)&&("L"===a.mover.kind||"S"===a.mover.kind)}function Nd(a){sb={mover:a,offset:{x:0,y:0},prev:{x:Sa.x,y:Sa.y}}}function $c(){var a=uc(Sa);Md(a)&&"P"===a.mover.kind?hc[Xc]=a.mover:(hc[Xc]={type:"Free",name:lc(),labeled:!0,pos:[Ob[0],
Ob[1],1]},cc(hc[Xc]));Xc++}function Rc(){var a=uc(Sa);return Ie(a)?(hc[Xc]=a.mover,Xc++,!0):!1}function Je(){var a=uc(Sa);return Ie(a)||Md(a)&&"C"===a.mover.kind?(hc[Xc]=a.mover,Xc++,!0):!1}function fd(){var a=uc(Sa);if(Md(a)&&"P"===a.mover.kind){ze.args[1]=a.mover.name;a=$jscomp.makeIterator(H.gslp);for(var b=a.next();!b.done;b=a.next())b=b.value,!0===b.tmp&&Qd(b.name)}else for(a=$jscomp.makeIterator(H.gslp),b=a.next();!b.done;b=a.next())b=b.value,!0===b.tmp&&(b.tmp=!1)}function Od(a){var b={type:"Free",
name:lc(),labeled:!0,pos:[Ob[0],Ob[1],1],tmp:!0};b=cc(b);ze=cc({type:a,name:lc(),labeled:!0,args:[hc[0].name,b.name]});Nd(b)}function hf(a){for(var b in a)null!==a[b]&&(ub[b]=a[b])}function jf(a){Object.keys(t).forEach(function(b){var c=t[b];Ic(c.signature||"_helper"===b,b+" has no signature");void 0!==c.updatePosition&&void 0===c.stateSize&&(c.stateSize=0)});H.gslp=[];H.csnames={};H.points=[];H.lines=[];H.conics=[];H.texts=[];H.free=[];H.polygons=[];H.ifs=[];H.sets={points:[],lines:[],conics:[]};
a.forEach(function(b,c){Pd(b);try{Jc(b)}catch(d){console.error(d)}});Ze()}function Ke(a){"undefined"===typeof a.tracedim&&(a.tracedim=1);"undefined"===typeof a.tracelength&&(a.tracelength=100);"undefined"===typeof a.traceskip&&(a.traceskip=1);a._traces=Array(a.tracelength);a._traces_index=0;a._traces_tick=0}function Le(a){void 0===a.size&&(a.size=ub.pointSize);a.size=n.real(a.size);!a.movable||a.pinned?(a.color=h.realVector(a.color||ub.pointColor),a.color=h.scalmult(n.real(ub.dimDependent),a.color)):
a.color=h.realVector(a.color||ub.pointColor);void 0===a.alpha&&(a.alpha=ub.alpha);a.alpha=n.real(a.alpha);"boolean"!==typeof a.noborder&&(a.noborder=ub.noborder);a.noborder=A.bool(a.noborder);"boolean"!==typeof a.border&&(a.border=!ub.noborder);a.border=A.bool(a.border);a.drawtrace&&Ke(a)}function gd(a){void 0===a.size&&(a.size=ub.lineSize);a.size=n.real(a.size);a.color=h.realVector(a.color||ub.lineColor);void 0===a.alpha&&(a.alpha=ub.alpha);a.alpha=n.real(a.alpha);a.clip=A.string(a.clip||ub.clip);
void 0===a.overhang&&(a.overhang=ub.overhangLine);a.overhang=n.real(a.overhang);a.dashtype&&(a.dashtype=A.wrap(a.dashtype))}function Me(a){void 0===a.overhang&&(a.overhang=ub.overhangSeg);a.arrow&&(a.arrow=A.bool(a.arrow));a.arrowsize&&(a.arrowsize=n.real(a.arrowsize));a.arrowposition&&(a.arrowposition=n.real(a.arrowposition));a.arrowshape&&(a.arrowshape=A.string(a.arrowshape));a.arrowsides&&(a.arrowsides=A.string(a.arrowsides));gd(a);a.clip=A.string("end")}function Ne(a){a.size=void 0!==a.textsize?
a.textsize:ub.textsize;a.size=n.real(+a.size)}function Ac(a){a.filled=void 0!==a.filled?A.bool(a.filled):A.bool(!0);a.fillcolor=void 0===a.fillcolor?B:h.realVector(a.fillcolor);void 0===a.fillalpha&&(a.fillalpha=0);a.fillalpha=n.real(a.fillalpha);gd(a)}function cc(a,b){a=Pd(a);try{lb(a),Jc(a)}catch(c){console.error(c)}Ze();return"boolean"===typeof b&&b&&a.Duplicate?(b=a.Duplicate,console.log("duplication detected: removing "+a.name+" (type "+a.kind+") (duplicate of "+b.name+")."),Qd(a.name),b):a}
function Pd(a){if(void 0!==H.csnames[a.name]){console.log("Element name '"+a.name+"' already exists");var b=H.csnames[a.name];t[b.type].isMovable&&"P"===t[b.type].kind&&Tb(b,a.pos,"homog");return b}for(;de.hasOwnProperty(a.type);)a.type=de[a.type];if(b=wf[a.type]){var c=b(a),d=null;for(b=0;b<c.length;++b)d=cc(c[b]);return d}var f=t[a.type];c=!1;if(!f)return console.error(a),console.error("Operation "+a.type+" not implemented yet"),null;if("**"!==f.signature)if(!Array.isArray(f.signature)&&"*"===f.signature.charAt(1))c=
!0,a.args.forEach(function(k){if(H.csnames[k].kind!==f.signature.charAt(0))return console.error("Not all elements in set are of same type: "+a.name+" expects "+f.signature+" but "+k+" is of kind "+H.csnames[k].kind),"undefined"!==typeof window&&window.alert("Not all elements in set are of same type: "+a.name),null});else if(f.signature.length!==(a.args?a.args.length:0))return console.error("Wrong number of arguments for "+a.name+" of type "+a.type),"undefined"!==typeof window&&window.alert("Wrong number of arguments for "+
a.name),null;if(a.args)for(b=0;b<a.args.length;++b){if(!H.csnames.hasOwnProperty(a.args[b]))return console.log("Dropping "+a.name+" due to missing argument "+a.args[b]),null;if("**"!==f.signature&&!c&&(d=H.csnames[a.args[b]].kind,f.signature[b]!==d&&("S"!==d||"L"!==f.signature[b])))return window.alert("Wrong argument kind "+d+" as argument "+b+" to element "+a.name+" of type "+a.type),null}f.signatureConstraints&&!f.signatureConstraints(a)&&window.alert("signature constraints violated for element "+
a.name);H.gslp.push(a);H.csnames[a.name]=a;b=oc.length;a.kind=f.kind;a.stateIdx=b;b+=f.stateSize;a.incidences=[];a.isshowing=!0;a.movable=!1;f.isMovable&&(a.movable=!0,H.free.push(a));"P"===a.kind&&(H.points.push(a),Le(a));"L"===a.kind&&(H.lines.push(a),gd(a));"C"===a.kind&&(H.conics.push(a),gd(a));"S"===a.kind&&(H.lines.push(a),Me(a));"Text"===a.kind&&(H.texts.push(a),Ne(a));"Poly"===a.kind&&(H.polygons.push(a),Ac(a));"IFS"===a.kind&&H.ifs.push(a);/^[P|L|S|C]s$/.test(a.kind)&&H.sets[{P:"points",
L:"lines",S:"lines",C:"conics"}[a.kind[0]]].push(a);Sd(b);Fb=Ec=oc;nd=!0;f.initialize&&(ic=pc=a.stateIdx,a.param=f.initialize(a),Ic(pc===a.stateIdx+f.stateSize,"State fully initialized"));ic=pc=a.stateIdx;f.updatePosition(a,!1);Ic(ic===a.stateIdx+f.stateSize,"State fully consumed");Ic(pc===a.stateIdx+f.stateSize,"State fully updated");nd=!1;Fb=Wc.in;Fb.set(oc);Ec=Wc.out;je(a,f);ef={};return H.csnames[a.name]}function Qd(a){if(H.csnames.hasOwnProperty(a)){var b={};Object.keys(H.csnames).forEach(function(d){var f=
H.csnames[d];f.hasOwnProperty("args")&&f.args.forEach(function(k){b.hasOwnProperty(k)||(b[k]={});b[k][d]=!0})});var c=function(d,f){f[d]=!0;if(!b.hasOwnProperty(d))return f;for(var k in b[d])f[k]||c(k,f);return f};a=c(a,{});kf(a)}else console.log("removeElement: name "+a+"does not exist.")}function kf(a){var b=Object.keys(a),c=function(k,m){return function(p){return k[p.name]?!1:!0}},d={};b.forEach(function(k){H.csnames[k].incidences.forEach(function(m){d[m]||(H.csnames[m].incidences=H.csnames[m].incidences.filter(function(p){return!a[p]}),
d[m]=!0)})});"conics free gslp ifs lines points polygons texts".split(" ").map(function(k){H[k]=H[k].filter(c(a,k))});for(var f in H.sets)H.sets[f]=H.sets[f].filter(c(a,"set of "+f));b.forEach(function(k){delete H.csnames[k]});ef={}}function Oe(a,b){var c=H.csnames[b.args[0]].homog,d=H.csnames[b.args[1]].homog;b=a.homog;a=n.div(c.value[0],c.value[2]);c=n.div(c.value[1],c.value[2]);var f=n.div(d.value[0],d.value[2]);d=n.div(d.value[1],d.value[2]);var k=n.div(b.value[0],b.value[2]);b=n.div(b.value[1],
b.value[2]);return n._helper.isAlmostReal(a)&&n._helper.isAlmostReal(c)&&n._helper.isAlmostReal(f)&&n._helper.isAlmostReal(d)&&n._helper.isAlmostReal(k)&&n._helper.isAlmostReal(b)?(a=a.value.real,c=c.value.real,f=f.value.real,d=d.value.real,k=k.value.real,b=b.value.real,a=Math.sqrt((a-f)*(a-f)+(c-d)*(c-d))-Math.sqrt((a-k)*(a-k)+(c-b)*(c-b))-Math.sqrt((f-k)*(f-k)+(d-b)*(d-b)),1E-15>a*a):!1}function je(a,b){a.isshowing=!0;if(a.args)for(var c=0;c<a.args.length;c++)if(!H.csnames[a.args[c]].isshowing){a.isshowing=
!1;return}b.visiblecheck&&b.visiblecheck(a)}function Pe(a,b,c,d,f){var k=a.textsize||ub.textsize,m=!0===a.textbold,p=!0===a.textitalics,u=a.text_fontfamily||ub.fontFamily,w=d.x*d.x+d.y*d.y,z=1;0<w&&(z=1+a.size.value.real/Math.sqrt(w));a=a.alpha||n.real(ub.alpha);J.drawtext([c,A.wrap(b)],{xoffset:A.wrap(z*d.x),yoffset:A.wrap(z*d.y),size:A.wrap(k),bold:A.wrap(m),italics:A.wrap(p),family:A.wrap(u),color:f,alpha:a})}function Rd(a){a._bbox=null;if(a.isshowing&&!1!==a.visible){var b={size:a.size},c=a.homog,
d=a.text,f=t[a.type].getText;d=f?f(a):d.replace(/@[$#]"([^"\\]|\\.)*"/g,function(w){try{var z=JSON.parse(w.substring(2));var D=H.csnames[z];if(!D)return"?"}catch(F){return"?"}switch(w.charAt(1)){case "$":return D.printname||z;case "#":return"V"!==D.kind?"?":qa(D.value)}});f=null;if(a.html){var k=a._textCache||{text:!1},m=a.html,p=m.parentNode,u=p.parentNode;f=function(w,z,D,F,K){z/=qb;D/=qb;K=N.bold+N.italics+Math.round(K/qb*10)/10+"px "+N.family;k.invisible&&u.style.removeProperty("display");if(w!==
k.text||K!==k.font||z!==k.x||D!==k.y||F!==k.align){K!==k.font&&(m.style.font=K,m.style.lineHeight=ub.lineHeight);w!==k.text&&!1!==w&&!1===Qb(m,w,K)&&(w=!1);u.style.left=z+"px";u.style.top=D+"px";if(F||p.style.transform)p.style.transform="translateX("+-100*F+"%)";a._textCache={text:w,font:K,x:z,y:D,align:F}}}}d=A.string(d);a.dock&&(a.dock.to?c=H.csnames[a.dock.to].homog:Cf.hasOwnProperty(a.dock.corner)&&(c=y.screenbounds$0([],{}),c=c.value[Cf[a.dock.corner]]),b.offset=a.dock.offset);a.align&&(b.align=
A.string(a.align));c&&(a._bbox=J.drawtext([c,d],b,f))}else a.html&&(a.html.parentNode.parentNode.style.display="none",a._textCache={invisible:!0})}function Qe(){function a(){var u=p++/c._traces.length,w=c._traces[m];w&&(u*=d*u*u,y.draw$1([w],{size:n.real(f),color:c.color,alpha:n.real(u)}));f*=k}for(var b=0;b<H.points.length;b++){var c=H.points[b];if(c.drawtrace){c._traces_tick===c.traceskip?(c._traces[c._traces_index]=c.homog,c._traces_index=(c._traces_index+1)%c._traces.length,c._traces_tick=0):
c._traces_tick++;var d=c.alpha.value.real,f=c.size.value.real,k=1;1!==c.tracedim&&(f*=c.tracedim,k=Math.pow(c.tracedim,-1/c._traces.length));var m,p=0;for(m=c._traces_index;m<c._traces.length;++m)a();for(m=0;m<c._traces_index;++m)a()}}}function Ic(a,b){b="Assertion failed: "+b;if(!a)throw console.log(b),Db(),"undefined"!==typeof alert&&alert(b),Error(b);}function Sd(a){if(a!==oc.length){var b,c=xf.length;if(od.length<a*c){var d=2*a;od=new Float64Array(c*d)}else d=od.length/c|0;for(b=0;b<c;++b)Wc[xf[b]]=
od.subarray(b*d,b*d+a);a=oc;Fb=Wc.in;Ec=Wc.out;oc=Wc.good;oc.set(a)}}function hd(){oc.set(Fb);vc=!1;Ve(!1);for(var a=oc.length,b=Math.abs,c=0;c<a;c+=2)b(oc[c])>1E12*b(oc[c+1])&&(oc[c+1]=0)}function vd(){if(ee)vc=!0;else throw Df;}function Re(a,b,c,d,f){return A.add(d,A.mult(c,A.sub(f,d)))}function Se(){ya&&(ya.currentMouseAndScripts=[]);yf=!0;if(sb){var a=sb.mover,b=h.realVector([Sa.x+sb.offset.x,Sa.y+sb.offset.y,1]);Te(a,b,"mouse");sb.prev.x=Sa.x;sb.prev.y=Sa.y}M(Na.move);M(Na.draw);vc||hd();yf=
!1;ya&&(ya.fullLog.push(h.turnIntoCSList([h.turnIntoCSList(ya.currentMouseAndScripts)])),ya.length>ya.logLength&&ya.splice(0,ya.length-ya.logLength),ya.currentMouseAndScripts=null,ya.postMouseHooks.forEach(function(c){c()}))}function Tb(a,b,c){Te(a,b,c);yf||vc||hd()}function Te(a,b,c){ya&&ya.currentMouseAndScripts&&(ya.currentMover=[]);a===Ef?(Fb.set(oc),vc=!1):(Ef=a,hd());Ec.set(Fb);var d=1E4;var f=ef[a.name];if(!f){var k={},m=0;f=[];k[a.name]=a;for(var p=$jscomp.makeIterator(H.gslp),u=p.next();!u.done;u=
p.next()){u=u.value;var w=u.args;if(w){w=$jscomp.makeIterator(w);for(var z=w.next();!z.done;z=w.next())k.hasOwnProperty(z.value)&&(k[u.name]=u,f[m++]=u)}}ef[a.name]=f}k=-1;m=.9;var D;p=t[a.type];u=p.parameterPath||Re;ic=a.stateIdx;w=p.getParamFromState(a);ic=pc=a.stateIdx;z=p.getParamForInput(a,b,c);for(var F=k+m;k!==F;){var K=F*F,V=.5/(1+K);V=n.complex(2*F*V+.5,(1-K)*V);ee=k+.5*m<=k||0===d;0===d&&console.log("tracing limit Reached");K=!1;ya&&ya.currentMouseAndScripts&&(ya.currentStep=[]);try{ic=
pc=a.stateIdx;var Q=u(a,F,V,w,z);ya&&(ya.currentParam=Q);V=Ec;Ec=Fb;p.putParamToState(a,Q);Ec=V;pc=a.stateIdx;ya&&(ya.currentElement=a);p.updatePosition(a,!0);Ic(ic===a.stateIdx+p.stateSize,"State fully consumed");Ic(pc===a.stateIdx+p.stateSize,"State fully updated");for(D=0;D<f.length;++D){var da=f[D];var W=t[da.type];ic=pc=da.stateIdx;ya&&(ya.currentElement=da);W.updatePosition(da,!1);Ic(ic===da.stateIdx+W.stateSize,"State fully consumed");Ic(pc===da.stateIdx+W.stateSize,"State fully updated")}ya&&
(ya.currentElement=null);k=F;m*=1.25;F+=m;1<=F&&(F=1);Ec=Fb;Fb=V}catch(na){if(na!==Df)throw na;m*=.5;F=k+m;--d;K=!0}ya&&ya.currentMouseAndScripts&&(ya.currentMover.push(h.turnIntoCSList([h.turnIntoCSList(ya.currentStep),A.wrap(K),A.wrap(k),A.wrap(F),A.wrap(ya.currentParam)])),ya.currentStep=null,ya.currentParam=null)}Ve(vc);for(D=0;D<f.length;++D)da=f[D],W=t[da.type],je(da,W);ya&&ya.currentMouseAndScripts&&(ya.currentMouseAndScripts.push(h.turnIntoCSList([h.turnIntoCSList(ya.currentMover),A.wrap(vc),
A.wrap(a.name),b,A.wrap(c),w,z])),ya.currentMover=null)}function Ue(){hd();ee=!0;for(var a=$jscomp.makeIterator(H.gslp),b=a.next();!b.done;b=a.next()){b=b.value;var c=t[b.type];ic=pc=b.stateIdx;c.updatePosition(b,!1);je(b,c)}a=Ec;Ec=Fb;Fb=a;hd()}function Ve(a){var b=Z.tracingStateReport;"string"===typeof b&&(document.getElementById(b).textContent=a?"BAD":"GOOD")}function We(){return h.turnIntoCSList(ya.fullLog.slice())}function lf(a){var b=JSON.stringify(ya.fullLog);a=new Blob([b],{type:a?"application/octet-stream":
"application/json"});return window.URL.createObjectURL(a)}function id(){var a=ic;ic+=2;return n.complex(Fb[a],Fb[a+1])}function db(a){for(var b=Array(a),c=0;c<a;++c)b[c]=id();return h.turnIntoCSList(b)}function Bc(a){Ec[pc]=a.value.real;Ec[pc+1]=a.value.imag;pc+=2}function Xa(a){for(var b=0,c=a.value.length;b<c;++b)Bc(a.value[b])}function mc(a,b){var c=db(3),d=db(3);a=ke(a,b,c,d);Xa(a[0]);Xa(a[1]);return h.turnIntoCSList(a)}function ke(a,b,c,d){if(nd)return[a,b];var f=h.projectiveDistMinScal(c,a),
k=h.projectiveDistMinScal(c,b),m=h.projectiveDistMinScal(d,a),p=h.projectiveDistMinScal(d,b),u=h.projectiveDistMinScal(c,d),w=h.projectiveDistMinScal(a,b),z=f+p,D=k+m;if(z>D){var F=[b,a];z=D}else F=[a,b];D=function(){};if(ya&&ya.currentStep){var K=[ya.labelTracing2,A.wrap(ya.currentElement.name),h.turnIntoCSList(F),h.turnIntoCSList([c,d]),h.realMatrix([[f,k],[m,p]]),A.wrap(z),A.wrap(u),A.wrap(w),B];ya.currentStep.push(h.turnIntoCSList(K));D=function(V){ya.hasOwnProperty(V)||(ya[V]=A.wrap(V));K[K.length-
1]=ya[V]}}h._helper.isNaN(a)||h._helper.isNaN(b)?(D("Tracing failed due to NaNs."),vc=!0):u>3*z&&w>3*z?D("Normal case, everything all right."):1E-5>w?1E-5>u?D("Staying inside singularity."):(D("Moved into singularity."),vc=!0):1E-5>u?D("Moved out of singularity."):(ee?D("Reached refinement limit, giving up."):D("Need to refine."),vd());return F}function le(a,b,c,d){var f=db(3),k=db(3),m=db(3),p=db(3);a=mf(a,b,c,d,f,k,m,p);Xa(a[0]);Xa(a[1]);Xa(a[2]);Xa(a[3]);return h.turnIntoCSList(a)}function mf(a,
b,c,d,f,k,m,p){var u=function(){};f=[f,k,m,p];a=[a,b,c,d];if(nd)return a;k=0;d=Array(4);for(c=0;4>c;c++)for(d[c]=Array(4),p=0;4>p;p++)m=h.projectiveDistMinScal(f[c],a[p]),d[c][p]=m;m=Fc(d);b=Array(4);for(c=0;4>c;++c)b[c]=a[m[c]],k+=d[c][m[c]];var w=1*k,z=Infinity,D=Infinity;for(c=0;4>c;c++){if(h._helper.isNaN(a[c]))return u("Tracing failed due to NaNs."),vc=!0,b;for(p=c+1;4>p;p++)m=h.projectiveDistMinScal(f[c],f[p]),z>m&&(z=m),m=h.projectiveDistMinScal(b[c],b[p]),D>m&&(D=m)}if(ya&&ya.currentStep){var F=
[ya.labelTracing4,A.wrap(ya.currentElement.name),h.turnIntoCSList(b),h.turnIntoCSList(f),h.realMatrix(d),A.wrap(k),A.wrap(z),A.wrap(D),B];ya.currentStep.push(h.turnIntoCSList(F));u=function(K){ya.hasOwnProperty(K)||(ya[K]=A.wrap(K));F[F.length-1]=ya[K]}}z>w&&D>w||(1E-5>D?1E-5>z?u("Staying inside singularity."):(u("Moved into singularity."),vc=!0):1E-5>z?u("Moved out of singularity."):(ee?u("Reached refinement limit, giving up."):u("Need to refine."),vd()));return b}function Xe(a){var b=a.length,c,
d;if(nd){for(c=0;c<b;++c)ic+=2*a[c].value.length,Xa(a[c]);return a}var f=Array(b),k=Array(b),m=Array(b),p=99,u=99,w=Array(b);for(c=0;c<b;++c)f[c]=db(a[c].value.length),k[c]=h.normSquared(f[c]).value.real,m[c]=h.normSquared(a[c]).value.real,w[c]=Array(b);for(c=0;c<b;++c){for(d=0;d<b;++d){var z=h.sesquilinearproduct(f[c],a[d]).value;z=(z.real*z.real+z.imag*z.imag)/(k[c]*m[d]);w[c][d]=1-z}for(d=c+1;d<b;++d)z=h.sesquilinearproduct(f[c],f[d]).value,z=(z.real*z.real+z.imag*z.imag)/(k[c]*k[d]),p>1-z&&(p=
1-z),z=h.sesquilinearproduct(a[c],a[d]).value,z=(z.real*z.real+z.imag*z.imag)/(m[c]*m[d]),u>1-z&&(u=1-z)}z=Fc(w);d=Array(b);k=0;m=!1;for(c=0;c<b;++c){k+=w[c][z[c]];var D=d[c]=a[z[c]];Xa(D);m|=h._helper.isNaN(D)}m|=isNaN(k);a=function(){};if(ya&&ya.currentStep){var F=[ya.labelTracingSesq,A.wrap(ya.currentElement.name),h.turnIntoCSList(d),h.turnIntoCSList(f),h.realMatrix(w),A.wrap(k),A.wrap(p),A.wrap(u),B];ya.currentStep.push(h.turnIntoCSList(F));a=function(K){ya.hasOwnProperty(K)||(ya[K]=A.wrap(K));
F[F.length-1]=ya[K]}}m?(a("Tracing failed due to NaNs."),vc=!0):p>3*k&&u>3*k?a("Normal case, everything all right."):1E-5>u?1E-5>p?a("Staying inside singularity."):(a("Moved into singularity."),vc=!0):1E-5>p?a("Moved out of singularity."):(ee?a("Reached refinement limit, giving up."):a("Need to refine."),vd());return d}function wd(a,b){a=t._helper.flattenConicMatrix(a);b=t._helper.flattenConicMatrix(b);var c=db(6),d=db(6);b=ke(a,b,c,d);Xa(b[0]);Xa(b[1]);a=t._helper.buildConicMatrix(b[0].value);b=
t._helper.buildConicMatrix(b[1].value);return h.turnIntoCSList([a,b])}function lb(a){if(lb.hasOwnProperty(a.kind))lb[a.kind](a)}function Jc(a){Jc.hasOwnProperty(a.kind)&&(a.incidences=[],Jc[a.kind](a))}function me(a,b){return function(){a.incidences.push(b.name);b.incidences.push(a.name)}}function xd(a,b){return function(){a.Duplicate=b}}function ne(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident line "+b.name},apply:me(a,b),holds:function(){var c=
h.scaldiv(h.abs(a.homog),a.homog),d=h.scaldiv(h.abs(b.homog),b.homog);return n.abs(h.scalproduct(c,d)).value.real<n.epsbig}}}function Ye(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"point "+a.name+" incident conic "+b.name},apply:me(a,b),holds:function(){var c=A.mult(b.matrix,a.homog);c=A.mult(a.homog,c);c=n.abs(c);return c.value.real<n.epsbig}}}function Ze(){if(0!==Rb.length){Wc.prover.set(Fb);var a,b=function(){a={};Rb.forEach(function(u){var w;u.getInvolved().forEach(function(z){a[z.name]||
(a[z.name]=!0,w=c(z,{}),w.forEach(function(D){a[D]=!0}))})})},c=function(u,w){u.incidences.forEach(function(z){w[z]||(w[z]=!0,c(H.csnames[z],w))});return Object.keys(w)};b();var d=function(u){return u.holds()};Object.keys(a).forEach(function(u){u=H.csnames[u].args;"undefined"!==typeof u&&u.forEach(function(w){a[w]=!0})});for(var f,k=0;3>k;k++){for(var m in a){var p=H.csnames[m];!p.pinned&&t[p.type].isMovable&&(f=t[p.type].getRandomMove(p),Tb(p,f.value,f.type),Rb=Rb.filter(d))}b()}Fb.set(Wc.prover);
Ue();for(b=0;b<Rb.length;++b)Rb[b].apply();Rb=[]}}function Td(a,b,c){var d=document.createElement("div"),f=document.createElement("img");f.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAPoCAQAAAC1v1zVAAAAGklEQVR42u3BMQEAAADCoPVPbQ0PoAAAgHcDC7gAAVI8ZnwAAAAASUVORK5CYII=";d.className="CindyJS-baseline";d.appendChild(f);f=document.createElement("div");f.className="CindyJS-button";d.appendChild(f);for(var k=2;k<arguments.length;++k)f.appendChild(arguments[k]);mb.parentNode.appendChild(d);a.html=
arguments[arguments.length-1];Xb(a.fillalpha)||(a.fillalpha=1);a.fillcolor&&(a.html.style.backgroundColor=N.makeColor(a.fillcolor,a.fillalpha));Xb(a.alpha)||(a.alpha=1);a.color&&(a.html.style.color=N.makeColor(a.color,a.alpha));d=x;if(a.script){var m=zc(a.script);d=function(){M(m);x()}}c.addEventListener(b,d);!Z.keylistener&&(Na.keydown||Na.keyup||Na.keytyped)&&(c.addEventListener("keydown",function(p){9!==p.keyCode&&Y(p,Na.keydown)}),c.addEventListener("keyup",function(p){Y(p,Na.keyup)}),c.addEventListener("keypress",
function(p){9!==p.keyCode&&Y(p,Na.keytyped)}));t.Text.initialize(a)}function dc(){}function oe(a){if(!/^Select/.test(a.type)&&!t[a.type].isMovable)return null;var b=A.unwrap,c=n.add;switch(a.kind){case "P":case "L":case "Text":return b(a.homog);case "C":return a=a.matrix.value,{xx:b(a[0].value[0]),yy:b(a[1].value[1]),zz:b(a[2].value[2]),xy:b(c(a[0].value[1],a[1].value[0])),xz:b(c(a[0].value[2],a[2].value[0])),yz:b(c(a[1].value[2],a[2].value[1]))};default:return null}}function Ud(a){var b={};b.offset=
A.unwrap(a.offset);a.to&&(b.to=a.to);a.corner&&(b.corner=a.corner);return b}function Vd(a){var b={},c={pinned:!1,movable:!0};"P"===a.kind&&Le(c);"L"===a.kind&&gd(c);"C"===a.kind&&gd(c);"S"===a.kind&&Me(c);"Text"===a.kind&&Ne(c);"Poly"===a.kind&&Ac(c);If.forEach(function(f){if(a.hasOwnProperty(f)){var k=A.unwrap(a[f]),m=A.unwrap(c[f]);null!==k&&void 0!==k&&k!==m&&JSON.stringify(k)!==JSON.stringify(m)&&(b[f]=k)}});if("P"===a.kind&&(!a.movable||a.pinned)&&b.color){var d=n.real(1/ub.dimDependent);b.color=
A.unwrap(h.scalmult(d,a.color))}if(d=oe(a))b.pos=d;a.dock&&(b.dock=Ud(a.dock));return b}function nf(){var a=[];H.gslp.forEach(function(b){b.tmp||a.push(Vd(b))});return a}function pe(){qc.forEach(function(a){var b=(a.geo||[]).map(function(c){return H.csnames[c]});Qa[a.type].reset(a,b[0],b)})}function Sc(a){uf=0!==a.length;qc=[];Kb=[];zf=[];Qa.Environment.init({});a.forEach(function(b){b.behavior?(b.name&&(b.behavior.geo=[b.name]),b=b.behavior,b.gravity&&(b.gravity=-b.gravity)):c=b.geo;var c=(b.geo||
[]).map(function(k){return H.csnames[k]}),d=c[0],f=Qa[b.type];f?(f.init&&f.init(b,d,c),d&&(d.behavior=b,"Mass"===b.type?Kb.push(d):"Spring"===b.type&&zf.push(d)),qc.push(b)):(console.error(b),console.error("Behavior "+b.type+" not implemented yet"))})}var Eb=this,Pb,Na={},xb=!1,yd=!0,jd=0,$e=.5,af=0,Wd=10,zd=5/360,rf=.32/zd/1E3*2,Xd=1,Ub=0,te=0,Ad=!1,Vc=.2,Bd=!1,Yd=0,Zd=0,qb=1,mb,Cd,Xb=Number.isFinite||function(a){return"number"===typeof a&&isFinite(a)},Ob,O,hb,jb,H,fc,$d=B,ae=B,Dc={play:dc,pause:dc,
stop:dc},Dd=null,ld=function(a,b){var c=[];ld=function(k,m){c.push({img:k,id:m})};ld(a,b);var d=Eb.getBaseDir()+"images/Icons.svg",f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===XMLHttpRequest.DONE)if(200!==f.status)console.error("Failed to load CindyJS Icons.svg from "+d+": "+f.statusText);else{var k=f.responseXML,m=k.documentElement,p={},u;for(u=m.firstChild;u;u=w){var w=u.nextSibling;u.nodeType===Node.ELEMENT_NODE&&"http://www.w3.org/2000/svg"===u.namespaceURI&&"g"===u.localName.toLowerCase()&&
(m.removeChild(u),u.setAttribute("style","display:inline"),p[u.getAttribute("id")]=u)}var z=new XMLSerializer;ld=function(D,F){if(p.hasOwnProperty(F)){F=p[F];m.appendChild(F);try{var K=z.serializeToString(k)}finally{m.removeChild(F)}D.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(K)}};c.forEach(function(D){ld(D.img,D.id)});c=null}};f.responseType="document";f.open("GET",d);f.send()},bf=1,md=null,Mc=[],Ed=!1,Jb={config:Z,startup:Za,shutdown:Db,evokeCS:function(a){a=zc(a,!1);M(a);x()},
play:Ha,pause:Hb,stop:Nb,evalcs:function(a){return M(zc(a,!1))},parse:function(a){return zc(a)},niceprint:qa,canvas:null},ue=!1,Fd=0;Z.use&&Z.use.forEach(function(a){var b=null;Z.plugins&&(b=Z.plugins[a]);b||(b=Eb._pluginRegistry[a]);b||(++Fd,console.log("Loading script for plugin "+a),Eb.loadScript(a+"-plugin",a+"-plugin.js",function(){console.log("Successfully loaded plugin "+a);0===--Fd&&ue&&Za()},function(){console.error("Failed to auto-load plugin "+a);0===--Fd&&ue&&Za()}))});Cb.prototype=new Ib;
zb.prototype=new Ib;pd.prototype=new Ib;var Sa={},sb,ve="",be=0,Yb=0,Nc={},bd={};var gc=Z.isNode?process.nextTick:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,0)};var Zb=null,cf=[0,8,13,63,"g412441a"],n={_helper:{}};n._helper.roundingfactor=1E4;n._helper.angleroundingfactor=10;n._helper.niceround=function(a,b){return Math.round(a*b)/b};n.niceprint=function(a,
b){b=b||n._helper.roundingfactor;if("Angle"===a.usage)return n._helper.niceangle(a);var c=n._helper.niceround(a.value.real,b);a=n._helper.niceround(a.value.imag,b);return 0===a?""+c:0<a?""+c+" + i*"+a:""+c+" - i*"+-a};var we=Z.angleUnit||"\u00b0",sf=we.replace(/\s+/g,""),Gd=2*Math.PI,tf=1/Gd,df={rad:Gd,"\u00b0":360,deg:360,degree:360,gra:400,grad:400,turn:1,cyc:1,rev:1,rot:1,"\u03c0":2,pi:2,quad:4};n._helper.niceangle=function(a){var b=df[sf];if(!b)return n.niceprint(A.withUsage(a,null));if("function"===
typeof b)return b(a);a=n.niceprint(n.realmult(b*tf,a),200<b?n._helper.angleroundingfactor:null);return a.includes("i*")?"("+a+")"+we:a+we};n.complex=function(a,b){return{ctype:"number",value:{real:a,imag:b}}};n.real=function(a){return{ctype:"number",value:{real:a,imag:0}}};n.zero=n.real(0);n.one=n.real(1);n.infinity=n.complex(Infinity,Infinity);n.nan=n.complex(NaN,NaN);n._helper.input=function(a){return"object"===typeof a?n.complex(+a.r,+a.i):n.real(+a)};n.argmax=function(a,b){return a.value.real*
a.value.real+a.value.imag*a.value.imag<b.value.real*b.value.real+b.value.imag*b.value.imag?b:a};n.max=function(a,b){return{ctype:"number",value:{real:Math.max(a.value.real,b.value.real),imag:Math.max(a.value.imag,b.value.imag)}}};n.min=function(a,b){return{ctype:"number",value:{real:Math.min(a.value.real,b.value.real),imag:Math.min(a.value.imag,b.value.imag)}}};n.add=function(a,b){return{ctype:"number",value:{real:a.value.real+b.value.real,imag:a.value.imag+b.value.imag}}};n.sub=function(a,b){return{ctype:"number",
value:{real:a.value.real-b.value.real,imag:a.value.imag-b.value.imag}}};n.neg=function(a){return Object.assign({},a,{ctype:"number",value:{real:-a.value.real,imag:-a.value.imag}})};n.re=function(a){return{ctype:"number",value:{real:a.value.real,imag:0}}};n.im=function(a){return{ctype:"number",value:{real:a.value.imag,imag:0}}};n.conjugate=function(a){return{ctype:"number",value:{real:a.value.real,imag:-a.value.imag}}};n.round=function(a){return{ctype:"number",value:{real:Math.round(a.value.real),
imag:Math.round(a.value.imag)}}};n.ceil=function(a){return{ctype:"number",value:{real:Math.ceil(a.value.real),imag:Math.ceil(a.value.imag)}}};n.floor=function(a){return{ctype:"number",value:{real:Math.floor(a.value.real),imag:Math.floor(a.value.imag)}}};n.mult=function(a,b){return{ctype:"number",value:{real:a.value.real*b.value.real-a.value.imag*b.value.imag,imag:a.value.real*b.value.imag+a.value.imag*b.value.real}}};n.realmult=function(a,b){return{ctype:"number",value:{real:a*b.value.real,imag:a*
b.value.imag}}};n.multiMult=function(a){var b=a[0];if("number"!==b.ctype)return B;for(var c=1;c<a.length;c++){if("number"!==a[c].ctype)return B;b=n.mult(b,a[c])}return b};n.abs2=function(a){return{ctype:"number",value:{real:a.value.real*a.value.real+a.value.imag*a.value.imag,imag:0}}};n.abs=function(a){return n.sqrt(n.abs2(a))};n.inv=function(a){var b=a.value.real*a.value.real+a.value.imag*a.value.imag;return{ctype:"number",value:{real:a.value.real/b,imag:-a.value.imag/b}}};n.div=function(a,b){var c=
a.value.real;a=a.value.imag;var d=b.value.real;b=b.value.imag;var f=d*d+b*b;return{ctype:"number",value:{real:(c*d+a*b)/f,imag:(a*d-c*b)/f}}};n.eps=1E-10;n.epsbig=1E-6;n.snap=function(a){var b=a.value.real,c=a.value.imag;Math.floor(b+n.eps)!==Math.floor(b-n.eps)&&(b=Math.round(b));Math.floor(c+n.eps)!==Math.floor(c-n.eps)&&(c=Math.round(c));return Object.assign({},a,{ctype:"number",value:{real:b,imag:c}})};n.exp=function(a){var b=Math.exp(a.value.real);return{ctype:"number",value:{real:b*Math.cos(a.value.imag),
imag:b*Math.sin(a.value.imag)}}};n.cos=function(a){var b=a.value.real;a=a.value.imag;var c=Math.exp(a),d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:(f+c*Math.cos(b))/2,imag:(d+c*Math.sin(b))/2}}};n.sin=function(a){var b=a.value.real;a=a.value.imag;var c=Math.exp(a),d=c*Math.sin(-b),f=c*Math.cos(-b);c=Math.exp(-a);return{ctype:"number",value:{real:-(d-c*Math.sin(b))/2,imag:(f-c*Math.cos(b))/2}}};n.tan=function(a){var b=n.sin(a);a=n.cos(a);return n.div(b,a)};n.arccos=
function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.add(n.mult(n.log(a),n.complex(0,1)),n.real(.5*Math.PI));return A.withUsage(a,"Angle")};n.arcsin=function(a){var b=n.mult(a,n.neg(a));b=n.sqrt(n.add(n.real(1),b));a=n.add(n.mult(a,n.complex(0,1)),b);a=n.mult(n.log(a),n.complex(0,-1));return A.withUsage(a,"Angle")};n.arctan=function(a){var b=n.log(n.add(n.mult(a,n.complex(0,-1)),n.real(1)));a=n.log(n.add(n.mult(a,n.complex(0,1)),n.real(1)));b=n.mult(n.sub(b,
a),n.complex(0,.5));return A.withUsage(b,"Angle")};n.arctan2=function(a,b){if(void 0===b)var c=n.real(Math.atan2(a.value.imag,a.value.real));else n._helper.isReal(a)&&n._helper.isReal(b)?c=n.real(Math.atan2(b.value.real,a.value.real)):(c=n.add(a,n.mult(n.complex(0,1),b)),a=n.sqrt(n.add(n.mult(a,a),n.mult(b,b))),c=n.mult(n.complex(0,-1),n.log(n.div(c,a))));return A.withUsage(c,"Angle")};n.sqrt=function(a){var b=a.value.real,c=a.value.imag;a=Math.sqrt(Math.sqrt(b*b+c*c));b=Math.atan2(c,b);return{ctype:"number",
value:{real:a*Math.cos(b/2),imag:a*Math.sin(b/2)}}};n.powRealExponent=function(a,b){var c=a.value.real,d=a.value.imag;a=Math.pow(Math.sqrt(c*c+d*d),b);c=Math.atan2(d,c);return{ctype:"number",value:{real:a*Math.cos(c*b),imag:a*Math.sin(c*b)}}};n.powIntegerExponent=function(a,b){return 0>b?n.powIntegerExponent(n.inv(a),-b):0===b?n.one:0===b%2?n.powIntegerExponent(n.mult(a,a),b/2):1===b%2?n.mult(a,n.powIntegerExponent(n.mult(a,a),(b-1)/2)):B};n.log=function(a){var b=a.value.real;a=a.value.imag;var c=
Math.sqrt(b*b+a*a),d=Math.atan2(a,b);0>a&&(d+=2*Math.PI);0===a&&0>b&&(d=Math.PI);d>Math.PI&&(d-=2*Math.PI);return n.snap({ctype:"number",value:{real:Math.log(c),imag:d}})};n.pow=function(a,b){return n._helper.isZero(b)?n.one:n._helper.isZero(a)?n.zero:[a,b].every(n._helper.isReal)?n.real(Math.pow(a.value.real,b.value.real)):n._helper.isReal(b)?(b=b.value.real,Number.isInteger(b)?n.powIntegerExponent(a,b):n.powRealExponent(a,b)):n.exp(n.mult(n.log(a),b))};n.mod=function(a,b){var c=a.value.real,d=b.value.real,
f=a.value.imag,k=b.value.imag;c-=Math.floor(c/d)*d;f-=Math.floor(f/k)*k;0===d&&(c=0);0===k&&(f=0);return n.snap(Object.assign({},[a,b].every(function(m){return"Angle"===m.usage})&&{usage:"Angle"},{ctype:"number",value:{real:c,imag:f}}))};n._helper.seed="NO";n._helper.seedrandom=function(a){a-=Math.floor(a);n._helper.seed=.8*a+.1};n._helper.rand=function(){if("NO"===n._helper.seed)return Math.random();var a=n._helper.seed;a=1E3*Math.sin(1E3*a);a-=Math.floor(a);return n._helper.seed=a};n._helper.randnormal=
function(){var a=n._helper.rand(),b=n._helper.rand();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*b)};n._helper.isEqual=function(a,b){return a.value.real===b.value.real&&a.value.imag===b.value.imag};n._helper.isLessThan=function(a,b){return a.value.real<b.value.real||a.value.real===b.value.real&&a.value.imag<b.value.imag};n._helper.compare=function(a,b){return n._helper.isLessThan(a,b)?-1:n._helper.isEqual(a,b)?0:1};n._helper.isAlmostEqual=function(a,b,c){var d=n.eps;"undefined"!==typeof c&&
(d=c);c=a.value.real-b.value.real;a=a.value.imag-b.value.imag;return c<d&&c>-d&&a<d&&a>-d};n._helper.isZero=function(a){return 0===a.value.real&&0===a.value.imag};n._helper.isAlmostZero=function(a){var b=a.value.real;a=a.value.imag;return b<n.eps&&b>-n.eps&&a<n.eps&&a>-n.eps};n._helper.isReal=function(a){return 0===a.value.imag};n._helper.isAlmostReal=function(a){a=a.value.imag;return a<n.epsbig&&a>-n.epsbig};n._helper.isNaN=function(a){return isNaN(a.value.real)||isNaN(a.value.imag)};n._helper.isFinite=
function(a){return isFinite(a.value.real)&&isFinite(a.value.imag)};n._helper.isAlmostImag=function(a){a=a.value.real;return a<n.epsbig&&a>-n.epsbig};n._helper.z3a=n.complex(-.5,.5*Math.sqrt(3));n._helper.z3b=n.complex(-.5,-.5*Math.sqrt(3));n._helper.cub1={ctype:"list",value:[n.one,n.one,n.one]};n._helper.cub2={ctype:"list",value:[n._helper.z3a,n.one,n._helper.z3b]};n._helper.cub3={ctype:"list",value:[n._helper.z3b,n.one,n._helper.z3a]};n.solveCubic=function(a,b,c,d){a=n._helper.solveCubicHelper(a,
b,c,d);return[h.scalproduct(n._helper.cub1,a),h.scalproduct(n._helper.cub2,a),h.scalproduct(n._helper.cub3,a)]};n._helper.solveCubicHelper=function(a,b,c,d){var f=a.value.real;a=a.value.imag;var k=b.value.real;b=b.value.imag;var m=c.value.real,p=c.value.imag,u=d.value.real,w=d.value.imag,z=f*m-a*p;c=f*p+a*m;d=4*z-(k*k-b*b);var D=4*c-2*k*b,F=f*k-a*b,K=f*b+a*k,V=d*m-D*p-18*(F*u-K*w);D=d*p+D*m-18*(F*w+K*u);d=27*(f*f-a*a);var Q=54*a*f,da=d*u-Q*w,W=d*w+Q*u,na=k*k-b*b,ia=2*k*b,Ea=na*k-ia*b,La=na*b+ia*k,
va=da+4*Ea;Q=W+4*La;d=27*(V*m-D*p+va*u-Q*w);D=27*(V*p+D*m+va*w+Q*u);va=Math.sqrt(Math.sqrt(d*d+D*D));Q=Math.atan2(D,d);D=va*Math.sin(Q/2);d=va*Math.cos(Q/2);Ea=-2*Ea+9*(F*m-K*p)-da+(d*f-D*a);La=-2*La+9*(F*p+K*m)-W+(d*a+D*f);d=Math.exp(Math.log(Math.sqrt(Ea*Ea+La*La))/3);m=Math.atan2(La,Ea);Q=d*Math.sin(m/3);D=d*Math.cos(m/3);d*=d;m*=2;z=2*na-6*z;c=2*ia-6*c;ia=-1.5874010519681996*(k*D-b*Q);k=-1.5874010519681996*(k*Q+b*D);b=1.2599210498948732*d*Math.cos(m/3);m=1.2599210498948732*d*Math.sin(m/3);d=4.762203155904599*
(D*f-Q*a);D=4.762203155904599*(D*a+Q*f);f=d*d+D*D;Q=(-z*D+c*d)/f;z=(z*d+c*D)/f;c=Q;Q=(-ia*D+k*d)/f;ia=(ia*d+k*D)/f;k=Q;Q=(-b*D+m*d)/f;b=(b*d+m*D)/f;m=Q;return h.turnIntoCSList([n.complex(z,c),n.complex(ia,k),n.complex(b,m)])};n._helper.getRangeRand=function(a,b){return Math.random()*(b-a)+a};n.getRandReal=function(a,b){a=n._helper.getRangeRand(a,b);return n.real(a)};n.getRandComplex=function(a,b){var c=n._helper.getRangeRand(a,b);a=n._helper.getRangeRand(a,b);return n.complex(c,a)};var h={_helper:{},
turnIntoCSList:function(a){return{ctype:"list",value:a}}};h.EMPTY=h.turnIntoCSList([]);h.asList=function(a){return"list"===a.ctype?a:"number"===a.ctype||"boolean"===a.ctype||"geo"===a.ctype?h.turnIntoCSList([a]):h.EMPTY};h.realVector=function(a){for(var b=[],c=0;c<a.length;c++)b[c]={ctype:"number",value:{real:a[c],imag:0}};return{ctype:"list",value:b}};h._helper.unitvector=function(a,b){a=h.zerovector(a);a.value[Math.floor(b.value.real-1)]=n.real(1);return a};h.idMatrix=function(a){for(var b=h.zeromatrix(a,
a),c=n.real(1),d=0;d<a.value.real;d++)b.value[d].value[d]=c;return b};h._helper.flippedidMatrix=function(a){for(var b=h.zeromatrix(a,a),c=n.real(1),d=0;d<a.value.real;d++)b.value[d].value[a.value.real-d-1]=c;return b};h.println=function(a){for(var b=[],c=0;c<a.value.length;c++)if("number"===a.value[c].ctype)b[c]=n.niceprint(a.value[c]);else if("list"===a.value[c].ctype)h.println(a.value[c]);else return B;"number"===a.value[0].ctype&&console.log(b)};h.matrix=function(a){return h.turnIntoCSList(a.map(h.turnIntoCSList))};
h.realMatrix=function(a){for(var b=a.length,c=Array(b),d=0;d<b;d++)c[d]=h.realVector(a[d]);return h.turnIntoCSList(c)};h.ex=h.realVector([1,0,0]);h.ey=h.realVector([0,1,0]);h.ez=h.realVector([0,0,1]);h.linfty=h.realVector([0,0,1]);h.ii=h.turnIntoCSList([n.complex(1,0),n.complex(0,1),n.complex(0,0)]);h.jj=h.turnIntoCSList([n.complex(1,0),n.complex(0,-1),n.complex(0,0)]);h.fundDual=h.realMatrix([[1,0,0],[0,1,0],[0,0,0]]);h.fund=h.realMatrix([[0,0,0],[0,0,0],[0,0,1]]);h.sequence=function(a,b){b=Math.floor(b.value.real)+
1;var c=[];a=Math.ceil(a.value.real);for(var d=0;a<b;a++,d++)c[d]=n.real(a);return h.turnIntoCSList(c)};h.pairs=function(a){for(var b=[],c=0;c<a.value.length-1;c++)for(var d=c+1;d<a.value.length;d++)b.push({ctype:"list",value:[a.value[c],a.value[d]]});return{ctype:"list",value:b}};h.triples=function(a){for(var b=[],c=0;c<a.value.length-2;c++)for(var d=c+1;d<a.value.length-1;d++)for(var f=d+1;f<a.value.length;f++)b.push({ctype:"list",value:[a.value[c],a.value[d],a.value[f]]});return{ctype:"list",value:b}};
h.cycle=function(a){for(var b=[],c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};b.push({ctype:"list",value:[a.value[a.value.length-1],a.value[0]]});return{ctype:"list",value:b}};h.consecutive=function(a){for(var b=[],c=0;c<a.value.length-1;c++)b[c]={ctype:"list",value:[a.value[c],a.value[c+1]]};return{ctype:"list",value:b}};h.reverse=function(a){for(var b=Array(a.value.length),c=a.value.length-1,d=0;0<=c;c--,d++)b[d]=a.value[c];return{ctype:"list",value:b}};h.directproduct=
function(a,b){for(var c=[],d=0;d<a.value.length;d++)for(var f=0;f<b.value.length;f++)c.push({ctype:"list",value:[a.value[d],b.value[f]]});return{ctype:"list",value:c}};h.concat=function(a,b){for(var c=[],d=0;d<a.value.length;d++)c.push(a.value[d]);for(a=0;a<b.value.length;a++)c.push(b.value[a]);return{ctype:"list",value:c}};h.prepend=function(a,b){var c=[];c[0]=a;for(a=0;a<b.value.length;a++)c[a+1]=b.value[a];return{ctype:"list",value:c}};h.append=function(a,b){for(var c=[],d=0;d<a.value.length;d++)c[d]=
a.value[d];c.push(b);return{ctype:"list",value:c}};h.contains=function(a,b){a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())if(J.equals(c.value,b).value)return{ctype:"boolean",value:!0};return{ctype:"boolean",value:!1}};h.common=function(a,b){for(var c=[],d=0,f=0;f<a.value.length;f++){for(var k=!1,m=a.value[f],p=0;p<b.value.length;p++)k=k||J.equals(m,b.value[p]).value;k&&(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.remove=function(a,b){for(var c=[],d=0,f=0;f<a.value.length;f++){for(var k=
!1,m=a.value[f],p=0;p<b.value.length;p++)k=k||J.equals(m,b.value[p]).value;k||(c[d]=a.value[f],d++)}return{ctype:"list",value:c}};h.sort1=function(a){a=a.value.slice();a.sort(A.compare);return h.turnIntoCSList(a)};h._helper.isEqual=function(a,b){return h.equals(a,b).value};h._helper.isLessThan=function(a,b){for(var c=a.value.length,d=b.value.length,f=0;!(f>=c||f>=d)&&A.isEqual(a.value[f],b.value[f]);)f++;return f===c&&f<d?!0:f===d&&f<c||f===c&&f===d?!1:A.isLessThan(a.value[f],b.value[f])};h._helper.compare=
function(a,b){return h._helper.isLessThan(a,b)?-1:h._helper.isEqual(a,b)?0:1};h.equals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};for(var c=!0,d=0;d<a.value.length;d++){var f=a.value[d],k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.equals(f,k).value:c&&Va([f,k],[]).value}return{ctype:"boolean",value:c}};h.almostequals=function(a,b){if(a.value.length!==b.value.length)return{ctype:"boolean",value:!1};for(var c=!0,d=0;d<a.value.length;d++){var f=a.value[d],
k=b.value[d];c="list"===f.ctype&&"list"===k.ctype?c&&h.almostequals(f,k).value:c&&vb([f,k],[]).value}return{ctype:"boolean",value:c}};h._helper.isAlmostReal=function(a){var b=!0;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())c=c.value,b="list"===c.ctype?b&&h._helper.isAlmostReal(c):b&&n._helper.isAlmostReal(c);return b};h._helper.isAlmostZero=function(a){a=$jscomp.makeIterator(a.value);for(var b=a.next();!b.done;b=a.next())if(b=b.value,"list"===b.ctype){if(!h._helper.isAlmostZero(b))return!1}else if(!n._helper.isAlmostZero(b))return!1;
return!0};h._helper.isNaN=function(a){var b=!1;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())c=c.value,b="list"===c.ctype?b||h._helper.isNaN(c):b||n._helper.isNaN(c);return b};h.set=function(a){var b=[],c=0;a=a.value.slice();a.sort(A.compare);for(var d=0;d<a.length;d++)0!==d&&Va([b[b.length-1],a[d]],[]).value||(b[c]=a[d],c++);return{ctype:"list",value:b}};h.maxval=function(a){var b=n.zero;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())c=c.value,"number"===
c.ctype&&(b=n.argmax(b,c)),"list"===c.ctype&&(b=n.argmax(b,h.maxval(c)));return b};h.maxIndex=function(a,b,c){var d=0;void 0!==c&&(d=c);c=d;for(var f=b(a.value[d]).value.real;d<a.value.length;++d){var k=b(a.value[d]).value.real;k>f&&(c=d,f=k)}return c};h.normalizeMax=function(a){var b=n.inv(h.maxval(a));return n._helper.isFinite(b)?h.scalmult(b,a):a};h.normalizeZ=function(a){var b=n.inv(a.value[2]);return h.scalmult(b,a)};h.dehom=function(a){a=a.value.slice();var b=a.length-1,c=n.inv(a[b]);a.length=
b;for(var d=0;d<b;++d)a[d]=n.mult(c,a[d]);return h.turnIntoCSList(a)};h.normalizeAbs=function(a){var b=n.inv(h.abs(a));return h.scalmult(b,a)};h.max=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=[],d=0;d<a.value.length;d++)c[d]=A.max(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.min=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=[],d=0;d<a.value.length;d++)c[d]=A.min(a.value[d],b.value[d]);return{ctype:"list",value:c}};h.scaldiv=function(a,b){if("number"!==
a.ctype)return B;for(var c=[],d=0;d<b.value.length;d++){var f=b.value[d];c[d]="number"===f.ctype?A.div(f,a):"list"===f.ctype?h.scaldiv(a,f):B}return{ctype:"list",value:c}};h.scalmult=function(a,b){if("number"!==a.ctype)return B;for(var c=[],d=0;d<b.value.length;d++){var f=b.value[d];c[d]="number"===f.ctype?A.mult(f,a):"list"===f.ctype?h.scalmult(a,f):B}return{ctype:"list",value:c}};h.add=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=[],d=0;d<a.value.length;d++){var f=a.value[d],
k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?A.add(f,k):"list"===f.ctype&&"list"===k.ctype?h.add(f,k):B}return{ctype:"list",value:c}};h.sub=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=[],d=0;d<a.value.length;d++){var f=a.value[d],k=b.value[d];c[d]="number"===f.ctype&&"number"===k.ctype?n.sub(f,k):"list"===f.ctype&&"list"===k.ctype?h.sub(f,k):B}return{ctype:"list",value:c}};h.abs2=function(a){var b=0;a=$jscomp.makeIterator(a.value);for(var c=a.next();!c.done;c=a.next())if(c=
c.value,"number"===c.ctype)b+=n.abs2(c).value.real;else if("list"===c.ctype)b+=h.abs2(c).value.real;else return B;return{ctype:"number",value:{real:b,imag:0}}};h.abs=function(a){return n.sqrt(h.abs2(a))};h.normalizeMaxXX=function(a){for(var b=-1E4,c=n.real(1),d=0;d<a.value.length;d++){var f=n.abs(a.value[d]);f.value.real>b&&(c=a.value[d],b=f.value.real)}return h.scaldiv(c,a)};h.recursive=function(a,b){for(var c=[],d=0;d<a.value.length;d++){var f=X(a.value[d]);c[d]="number"===f.ctype?n[b](f):"list"===
f.ctype?h[b](f):B}return{ctype:"list",value:c}};h.re=function(a){return h.recursive(a,"re")};h.neg=function(a){return h.recursive(a,"neg")};h.im=function(a){return h.recursive(a,"im")};h.conjugate=function(a){return h.recursive(a,"conjugate")};h.transjugate=function(a){return h.transpose(h.conjugate(a))};h.round=function(a){return h.recursive(a,"round")};h.ceil=function(a){return h.recursive(a,"ceil")};h.floor=function(a){return h.recursive(a,"floor")};h._helper.colNumb=function(a){if("list"!==a.ctype)return-1;
for(var b=-1,c=0;c<a.value.length;c++){if("list"!==a.value[c].ctype)return-1;if(0===c)b=a.value[c].value.length;else if(b!==a.value[c].value.length)return-1}return b};h._helper.isNumberVecN=function(a,b){if("list"!==a.ctype||a.value.length!==b)return!1;for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return!1;return!0};h.isNumberVector=function(a){if("list"!==a.ctype)return{ctype:"boolean",value:!1};for(var b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",
value:!1};return{ctype:"boolean",value:!0}};h.isNumberVectorN=function(a,b){if("list"!==a.ctype)return{ctype:"boolean",value:!1};if(a.value)for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h.isNumberMatrix=function(a){if(-1===h._helper.colNumb(a))return{ctype:"boolean",value:!1};for(var b=0;b<a.value.length;b++)if(!h.isNumberVector(a.value[b]).value)return{ctype:"boolean",value:!1};return{ctype:"boolean",value:!0}};h._helper.isNumberMatrixMN=
function(a,b,c){return h.isNumberMatrix(a).value&&a.value.length===b&&a.value[0].value.length===c};h.scalproduct=function(a,b){if(a.value.length!==b.value.length)return B;for(var c={ctype:"number",value:{real:0,imag:0}},d=0;d<b.value.length;d++){var f=a.value[d],k=b.value[d];if("number"===f.ctype&&"number"===k.ctype)c=n.add(n.mult(f,k),c);else return B}return c};h.sesquilinearproduct=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=0,d=0,f=0;f<b.value.length;f++){var k=a.value[f].value,
m=b.value[f].value;c+=k.real*m.real+k.imag*m.imag;d+=k.real*m.imag-k.imag*m.real}return n.complex(c,d)};h.normSquared=function(a){for(var b=0,c=0;c<a.value.length;c++){var d=a.value[c].value;b+=d.real*d.real+d.imag*d.imag}return n.real(b)};h.productMV=function(a,b){if(a.value[0].value.length!==b.value.length)return B;for(var c=[],d=0;d<a.value.length;d++){for(var f={ctype:"number",value:{real:0,imag:0}},k=a.value[d],m=0;m<b.value.length;m++){var p=k.value[m],u=b.value[m];if("number"===p.ctype&&"number"===
u.ctype)f=n.add(n.mult(p,u),f);else return B}c[d]=f}return h.turnIntoCSList(c)};h.productVM=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=[],d=0;d<b.value[0].value.length;d++){for(var f={ctype:"number",value:{real:0,imag:0}},k=0;k<a.value.length;k++){var m=a.value[k],p=b.value[k].value[d];if("number"===m.ctype&&"number"===p.ctype)f=n.add(n.mult(m,p),f);else return B}c[d]=f}return h.turnIntoCSList(c)};h.productMM=function(a,b){if(a.value[0].value.length!==b.value.length)return B;
for(var c=[],d=0;d<a.value.length;d++){var f=h.productVM(a.value[d],b);c[d]=f}return h.turnIntoCSList(c)};h.mult=function(a,b){return a.value.length===b.value.length&&h.isNumberVector(a).value&&h.isNumberVector(b).value?h.scalproduct(a,b):h.isNumberMatrix(a).value&&b.value.length===a.value[0].value.length&&h.isNumberVector(b).value?h.productMV(a,b):h.isNumberMatrix(b).value&&a.value.length===b.value.length&&h.isNumberVector(a).value?h.productVM(a,b):h.isNumberMatrix(a).value&&h.isNumberMatrix(b).value&&
b.value.length===a.value[0].value.length?h.productMM(a,b):B};h.projectiveDistMinScal=function(a,b){var c=h.abs(a),d=h.abs(b);if(0===c.value.real||0===d.value.real)return 0;var f=h.conjugate(b);f=h.scalproduct(a,f);f=n._helper.isAlmostZero(f)?n.real(1):n.div(f,n.abs(f));a=h.scaldiv(c,a);b=h.scaldiv(d,b);b=h.scalmult(f,b);d=h.abs(h.add(a,b));b=h.abs(h.sub(a,b));return Math.min(d.value.real,b.value.real)};h.conicDist=function(a,b){a=Ma(a);b=Ma(b);return h.projectiveDistMinScal(a,b)};h.crossOperator=
function(a){var b=a.value[0],c=a.value[1];a=a.value[2];return h.turnIntoCSList([h.turnIntoCSList([n.zero,n.neg(a),c]),h.turnIntoCSList([a,n.zero,n.neg(b)]),h.turnIntoCSList([n.neg(c),b,n.zero])])};h.cross=function(a,b){var c=n.sub(n.mult(a.value[1],b.value[2]),n.mult(a.value[2],b.value[1])),d=n.sub(n.mult(a.value[2],b.value[0]),n.mult(a.value[0],b.value[2]));a=n.sub(n.mult(a.value[0],b.value[1]),n.mult(a.value[1],b.value[0]));return h.turnIntoCSList([c,d,a])};h.crossratio3harm=function(a,b,c,d,f){var k=
h.det3(a,c,f),m=h.det3(b,d,f);a=h.det3(a,d,f);b=h.det3(b,c,f);k=n.mult(k,m);m=n.mult(a,b);return h.turnIntoCSList([k,m])};h.crossratio3=function(a,b,c,d,f){a=h.crossratio3harm(a,b,c,d,f);return n.div(a.value[0],a.value[1])};h.veronese=function(a){var b=n.mult(a.value[0],a.value[0]),c=n.mult(a.value[1],a.value[1]),d=n.mult(a.value[2],a.value[2]),f=n.mult(a.value[0],a.value[1]),k=n.mult(a.value[0],a.value[2]);a=n.mult(a.value[1],a.value[2]);return h.turnIntoSCList([b,c,d,f,k,a])};h.matrixFromVeronese=
function(a){var b=a.value[0],c=a.value[1],d=a.value[2],f=n.realmult(.5,a.value[3]),k=n.realmult(.5,a.value[4]);a=n.realmult(.5,a.value[5]);return h.turnIntoCSList([h.turnIntoCSList([b,f,k]),h.turnIntoCSList([f,c,a]),h.turnIntoCSList([k,a,d])])};h.det2=function(a,b){var c=n.mult(a.value[0],b.value[1]);return c=n.sub(c,n.mult(a.value[1],b.value[0]))};h.det3=function(a,b,c){return n.complex(a.value[0].value.real*b.value[1].value.real*c.value[2].value.real-a.value[0].value.imag*b.value[1].value.imag*
c.value[2].value.real-a.value[0].value.imag*b.value[1].value.real*c.value[2].value.imag-a.value[0].value.real*b.value[1].value.imag*c.value[2].value.imag+a.value[2].value.real*b.value[0].value.real*c.value[1].value.real-a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.real-a.value[2].value.imag*b.value[0].value.real*c.value[1].value.imag-a.value[2].value.real*b.value[0].value.imag*c.value[1].value.imag+a.value[1].value.real*b.value[2].value.real*c.value[0].value.real-a.value[1].value.imag*
b.value[2].value.imag*c.value[0].value.real-a.value[1].value.imag*b.value[2].value.real*c.value[0].value.imag-a.value[1].value.real*b.value[2].value.imag*c.value[0].value.imag-a.value[0].value.real*b.value[2].value.real*c.value[1].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.real+a.value[0].value.imag*b.value[2].value.real*c.value[1].value.imag+a.value[0].value.real*b.value[2].value.imag*c.value[1].value.imag-a.value[2].value.real*b.value[1].value.real*c.value[0].value.real+
a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.real+a.value[2].value.imag*b.value[1].value.real*c.value[0].value.imag+a.value[2].value.real*b.value[1].value.imag*c.value[0].value.imag-a.value[1].value.real*b.value[0].value.real*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.real+a.value[1].value.imag*b.value[0].value.real*c.value[2].value.imag+a.value[1].value.real*b.value[0].value.imag*c.value[2].value.imag,-a.value[0].value.imag*b.value[1].value.imag*
c.value[2].value.imag+a.value[0].value.imag*b.value[1].value.real*c.value[2].value.real+a.value[0].value.real*b.value[1].value.real*c.value[2].value.imag+a.value[0].value.real*b.value[1].value.imag*c.value[2].value.real-a.value[2].value.imag*b.value[0].value.imag*c.value[1].value.imag+a.value[2].value.imag*b.value[0].value.real*c.value[1].value.real+a.value[2].value.real*b.value[0].value.real*c.value[1].value.imag+a.value[2].value.real*b.value[0].value.imag*c.value[1].value.real-a.value[1].value.imag*
b.value[2].value.imag*c.value[0].value.imag+a.value[1].value.imag*b.value[2].value.real*c.value[0].value.real+a.value[1].value.real*b.value[2].value.real*c.value[0].value.imag+a.value[1].value.real*b.value[2].value.imag*c.value[0].value.real+a.value[0].value.imag*b.value[2].value.imag*c.value[1].value.imag-a.value[0].value.imag*b.value[2].value.real*c.value[1].value.real-a.value[0].value.real*b.value[2].value.real*c.value[1].value.imag-a.value[0].value.real*b.value[2].value.imag*c.value[1].value.real+
a.value[2].value.imag*b.value[1].value.imag*c.value[0].value.imag-a.value[2].value.imag*b.value[1].value.real*c.value[0].value.real-a.value[2].value.real*b.value[1].value.real*c.value[0].value.imag-a.value[2].value.real*b.value[1].value.imag*c.value[0].value.real+a.value[1].value.imag*b.value[0].value.imag*c.value[2].value.imag-a.value[1].value.imag*b.value[0].value.real*c.value[2].value.real-a.value[1].value.real*b.value[0].value.real*c.value[2].value.imag-a.value[1].value.real*b.value[0].value.imag*
c.value[2].value.real)};h.det4m=function(a){var b=a.value,c=b[0].value,d=c[0].value,f=+d.real,k=+d.imag;d=c[1].value;var m=+d.real,p=+d.imag;d=c[2].value;var u=+d.real,w=+d.imag;d=c[3].value;var z=+d.real,D=+d.imag;c=b[1].value;d=c[0].value;var F=+d.real,K=+d.imag;d=c[1].value;var V=+d.real,Q=+d.imag;d=c[2].value;var da=+d.real,W=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;a=f*V-k*Q-m*F+p*K;var na=f*Q+k*V-m*K-p*F,ia=f*da-k*W-u*F+w*K,Ea=f*W+k*da-u*K-w*F,La=f*c-k*d-z*F+D*K,va=f*d+k*c-z*K-D*F,Ia=m*da-p*
W-u*V+w*Q,Ja=m*W+p*da-u*Q-w*V,Oa=m*c-p*d-z*V+D*Q,Ba=m*d+p*c-z*Q-D*V,Wa=u*c-w*d-z*da+D*W,fb=u*d+w*c-z*W-D*da;c=b[2].value;d=c[0].value;f=+d.real;k=+d.imag;d=c[1].value;m=+d.real;p=+d.imag;d=c[2].value;u=+d.real;w=+d.imag;d=c[3].value;z=+d.real;D=+d.imag;c=b[3].value;d=c[0].value;F=+d.real;K=+d.imag;d=c[1].value;V=+d.real;Q=+d.imag;d=c[2].value;da=+d.real;W=+d.imag;d=c[3].value;c=+d.real;d=+d.imag;b=f*V-k*Q-m*F+p*K;var Lb=f*Q+k*V-m*K-p*F,kb=f*da-k*W-u*F+w*K,Aa=f*W+k*da-u*K-w*F,rb=f*c-k*d-z*F+D*K;f=
f*d+k*c-z*K-D*F;k=m*da-p*W-u*V+w*Q;F=m*W+p*da-u*Q-w*V;K=m*c-p*d-z*V+D*Q;m=m*d+p*c-z*Q-D*V;p=u*c-w*d-z*da+D*W;u=u*d+w*c-z*W-D*da;return n.complex(a*p-na*u-ia*K+Ea*m+La*k-va*F+Ia*rb-Ja*f-Oa*kb+Ba*Aa+Wa*b-fb*Lb,a*u+na*p-ia*m-Ea*K+La*F+va*k+Ia*f+Ja*rb-Oa*Aa-Ba*kb+Wa*Lb+fb*b)};h.eucangle=function(a,b){var c=h.cross(a,h.linfty);a=h.cross(b,h.linfty);b=h.det3(h.ez,c,h.ii);c=h.det3(h.ez,c,h.jj);var d=h.det3(h.ez,a,h.ii);a=h.det3(h.ez,a,h.jj);b=n.div(n.mult(b,a),n.mult(d,c));b=n.log(b);return b=n.mult(b,n.complex(0,
.5))};h.zerovector=function(a){a=Math.floor(a.value.real);for(var b=Array(a),c=0;c<a;c++)b[c]=0;return h.realVector(b)};h.zeromatrix=function(a,b){a=Math.floor(a.value.real);for(var c=Array(a),d=0;d<a;d++)c[d]=h.zerovector(b);return h.turnIntoCSList(c)};h.vandermonde=function(a){for(var b=a.value.length,c=h.zeromatrix(b,b),d=0;d<b;d++)for(var f=0;f<b;f++)c.value[d].value[f]=n.pow(a.value[d],n.real(f-1));return c};h.transpose=function(a){for(var b=[],c=a.value[0].value.length,d=a.value.length,f=0;f<
c;f++){for(var k=[],m=0;m<d;m++)k[m]=a.value[m].value[f];b[f]=h.turnIntoCSList(k)}return h.turnIntoCSList(b)};h.column=function(a,b){var c=[],d=a.value.length;b=Math.floor(b.value.real-1);for(var f=0;f<d;f++)c[f]=a.value[f].value[b];return h.turnIntoCSList(c)};h.row=function(a,b){var c=[],d=a.value[0].value.length;b=Math.floor(b.value.real-1);for(var f=0;f<d;f++)c[f]=a.value[b].value[f];return h.turnIntoCSList(c)};h.adjoint2=function(a){var b=a.value[0].value[0],c=a.value[1].value[0],d=Array(2);d[0]=
h.turnIntoCSList([a.value[1].value[1],n.neg(a.value[0].value[1])]);d[1]=h.turnIntoCSList([n.neg(c),b]);return d=h.turnIntoCSList(d)};h.adjoint3=function(a){var b=a.value[0].value;var c=b[0].value;var d=c.real;var f=c.imag;c=b[1].value;var k=c.real;var m=c.imag;c=b[2].value;var p=c.real;var u=c.imag;b=a.value[1].value;c=b[0].value;var w=c.real;var z=c.imag;c=b[1].value;var D=c.real;var F=c.imag;c=b[2].value;var K=c.real;var V=c.imag;b=a.value[2].value;c=b[0].value;a=c.real;var Q=c.imag;c=b[1].value;
var da=c.real;var W=c.imag;c=b[2].value;b=c.real;c=c.imag;return{ctype:"list",value:[{ctype:"list",value:[{ctype:"number",value:{real:D*b-K*da-F*c+V*W,imag:D*c-K*W-da*V+b*F}},{ctype:"number",value:{real:-k*b+p*da+m*c-u*W,imag:-k*c+p*W+da*u-b*m}},{ctype:"number",value:{real:k*K-p*D-m*V+u*F,imag:k*V-p*F-D*u+K*m}}]},{ctype:"list",value:[{ctype:"number",value:{real:-w*b+K*a+z*c-V*Q,imag:-w*c+K*Q+a*V-b*z}},{ctype:"number",value:{real:d*b-p*a-f*c+u*Q,imag:d*c-p*Q-a*u+b*f}},{ctype:"number",value:{real:-d*
K+p*w+f*V-u*z,imag:-d*V+p*z+w*u-K*f}}]},{ctype:"list",value:[{ctype:"number",value:{real:w*da-D*a-z*W+F*Q,imag:w*W-D*Q-a*F+da*z}},{ctype:"number",value:{real:-d*da+k*a+f*W-m*Q,imag:-d*W+k*Q+a*m-da*f}},{ctype:"number",value:{real:d*D-k*w-f*F+m*z,imag:d*F-k*z-w*m+D*f}}]}]}};h.inverse=function(a){var b=a.value.length;if(b!==a.value[0].value.length)return console.log("Inverse works only for square matrices"),B;if(2===b)return h.scaldiv(h.det(a),h.adjoint2(a));if(3===b)return h.scaldiv(h.det(a),h.adjoint3(a));
b=h.LUdecomp(a);a=a.value.length;var c=n.real(0),d=n.real(1),f=h.zerovector(n.real(a));f.value[0]=d;for(var k=Array(a),m=0;m<a;m++)k[m]=h._helper.LUsolve(b,f),f.value[m]=c,f.value[m+1]=d;k=h.turnIntoCSList(k);return k=h.transpose(k)};h.linearsolve=function(a,b){return 2===a.value.length?h.linearsolveCramer2(a,b):3===a.value.length?h.linearsolveCramer3(a,b):h.LUsolve(a,b)};h.getDiag=function(a){if(a.value.length!==a.value[0].value.length)return B;for(var b=Array(a.value.length),c=0;c<a.value.length;c++)b[c]=
a.value[c].value[c];return h.turnIntoCSList(b)};h.getSubDiag=function(a){if(a.value.length!==a.value[0].value.length)return B;for(var b=Array(a.value.length-1),c=0;c<a.value.length-1;c++)b[c]=a.value[c+1].value[c];return h.turnIntoCSList(b)};h.eig2=function(a){var b=n.add(a.value[0].value[0],a.value[1].value[1]);a=h.det2(a.value[0],a.value[1]);var c=n.mult(b,b),d=b=n.mult(b,n.real(.5));a=n.sqrt(n.sub(n.div(c,n.real(4)),a));b=n.add(b,a);d=n.sub(d,a);return h.turnIntoCSList([b,d])};h.eig=function(a,
b){var c=b||!0,d=a,f=n.real(d.value.length);b=f.value.real;n.real(0);d=h._helper.QRIteration(d)[0];d=h.getDiag(d);d=h.sort1(d);f=h.idMatrix(f,f);var k=Array(b);k=h.turnIntoCSList(k);if(c){var m,p=0,u=!1;for(c=0;c<b;c++){if(u)var w=z.value[p];else{var z=d.value[c];z=h.sub(a,h.scalmult(z,f));z=h.nullSpace(z);w=z.value[0];void 0!==w&&(m=w)}void 0===w&&(w=m);1E-8>h.abs(w).value.real&&0===p&&(w=h._helper.inverseIteration(a,d.value[c]));k.value[c]=h._helper.isAlmostZeroVec(w)?w:h.scaldiv(h.abs(w),w);c<
b-1&&((u=1E-6>n.abs(n.sub(d.value[c],d.value[c+1])).value.real)?p++:p=0)}k=h.transpose(k)}return h.turnIntoCSList([d,k])};h._helper.isNormalMatrix=function(a){return 1E-10>h.abs(h.sub(a,h.transjugate(a))).value.real};h._helper.QRIteration=function(a,b){var c=n.real(a.value.length),d=c.value.real,f=c.value.real;n.real(0);h.idMatrix(c,c);var k=h.zeromatrix(c,c);c=h.idMatrix(c,c);var m=b?b:2500,p=0,u=Array(f);for(b=0;b<m;b++){var w=h._helper.getBlock(a,[f-2,f-1],[f-2,f-1]);var z=h.eig2(w);w=z.value[0];
z=z.value[1];h.abs(w);h.abs(z);var D=a.value[f-1].value[f-1];var F=n.abs(n.sub(D,w)).value.real;D=n.abs(n.sub(D,z)).value.real;z=F<D?w:z;w=h.idMatrix(n.real(f),n.real(f));z=h.scalmult(z,w);w=h.QRdecomp(h.sub(a,z));a=A.mult(w.R,w.Q);a=h.add(a,z);w.Q=h._helper.buildBlockMatrix(w.Q,h.idMatrix(n.real(p),n.real(p)));c=A.mult(c,w.Q);if(1E-48>n.abs2(a.value[a.value.length-1].value[a.value[0].value.length-2]).value.real&&1<f){u[d-p-1]=a.value[f-1].value[f-1];for(b=0;b<f;b++)k.value[f-1].value[b]=a.value[f-
1].value[b],k.value[b].value[f-1]=a.value[b].value[f-1];a=h._helper.getBlock(a,[0,f-2],[0,f-2]);p++;f--}if(1===f){k.value[0].value[0]=a.value[0].value[0];break}if(h._helper.isUpperTriangular(a)){for(b=0;b<f;b++)k.value[b].value[b]=a.value[b].value[b];break}}return[k,c]};h.rank=function(a,b){return h.RRQRdecomp(a,b).rank};h._helper.isAlmostZeroVec=function(a){for(var b=a.value.length,c=0;c<b;c++)if(!n._helper.isAlmostZero(a.value[c]))return!1;return!0};h._helper.isLowerTriangular=function(a){for(var b=
a.value.length,c=a.value[0].value.length,d=0;d<b;d++)for(var f=d+1;f<c;f++)if(!n._helper.isAlmostZero(a.value[d].value[f]))return!1;return!0};h._helper.isUpperTriangular=function(a){return h._helper.isLowerTriangular(h.transpose(a))};h._helper.isAlmostId=function(a){var b=a.value.length,c=n.real(b);if(b!==a.value[0].value.length)return!1;a=h.sub(a,h.idMatrix(c),c);for(c=0;c<b;c++)for(var d=0;d<b;d++)if(1E-16<n.abs(a.value[c].value[d]).value.real)return!1;return!0};h.nullSpace=function(a,b){var c=
a.value.length;b=h.RRQRdecomp(h.transjugate(a),b);a=h.transpose(b.Q);b=c-b.rank.value.real;var d=Array(b);a.value.reverse();for(var f,k=0;k<b;k++)f=a.value[k],d[k]=h.scaldiv(h.abs(f),f);d=h.turnIntoCSList(d);return 0<d.value.length?d:h.turnIntoCSList([h.zerovector(n.real(c))])};h._helper.isAlmostDiagonal=function(a){var b=a.value.length;n.real(b);n.real(0);if(b!==a.value[0].value.length)return!1;for(var c=0;c<b;c++)for(var d=0;d<b;d++)if(c!==d&&1E-16<n.abs(a.value[c].value[d]).value.real)return!1;
return!0};h._helper.inverseIteration=function(a,b){console.log("warning: code untested");for(var c=a.value.length,d=Array(c),f=0;f<c;f++)d[f]=2*Math.random()-.5;d=h.realVector(d);c=h.idMatrix(n.real(c),n.real(c));b=n.add(b,n.real(.1*Math.random()-.5));for(f=0;100>f;f++)d=h.scaldiv(h.abs(d),d),d=h.LUsolve(h.sub(a,h.scalmult(b,c)),JSON.parse(JSON.stringify(d)));return h.scaldiv(h.abs(d),d)};h._helper.toHessenberg=function(a){var b=JSON.parse(JSON.stringify(a)),c=b.value.length,d=n.real(c-1),f=n.real(c);
n.real(1);if(h._helper.isUpperTriangular(b))return[h.idMatrix(d,d),a];a=h.idMatrix(f,f);for(f=1;f<c-1;f++){var k=h.column(b,n.real(f));k.value=k.value.splice(f);var m=h.abs2(k).value.real;1E-16<m&&(k=h._helper.getHouseHolder(k),a=A.mult(a,k),b=A.mult(A.mult(k,b),k));d.value.real--}return[a,b]};h._helper.swapEl=function(a,b,c){if("[object Array]"===Object.prototype.toString.call(a)){var d=a[b];a[b]=a[c];a[c]=d}else"list"===a.ctype&&(d=a.value[b],a.value[b]=a.value[c],a.value[c]=d)};h.RRQRdecomp=function(a,
b){var c=Math.sqrt(n.eps);void 0!==b&&(c=.1*b.value.real);b=c*c;var d;c=a.value.length;var f=n.real(c),k=n.real(1),m=h._helper.unitvector(n.real(a.value.length),k),p=h.idMatrix(f,f),u=JSON.parse(JSON.stringify(a)),w=h.transpose(a);a=Array(c);for(d=0;d<c;d++)a[d]=h.abs2(w.value[d]);a=h.turnIntoCSList(a);w=Array(c);for(d=0;d<c;d++)w[d]=d;d=h.maxIndex(a,n.abs);for(var z=a.value[d],D=0,F=0;1E-16<n.abs2(z).value.real;F++){D++;h._helper.swapColumn(u,F,d);h._helper.swapEl(a,F,d);h._helper.swapEl(w,F,d);
d=h._helper.getBlock(u,[F],[F]);d=h.column(d,k);z=h.abs2(d).value.real;1E-8<z&&(d=h._helper.getHouseHolder(d),d=h._helper.buildBlockMatrix(h.idMatrix(n.real(F),n.real(F)),d),p=A.mult(p,h.transjugate(d)),u=A.mult(d,u));for(d=F+1;d<c;d++)a.value[d]=n.sub(a.value[d],n.mult(u.value[F].value[d],n.conjugate(u.value[F].value[d])));d=h.maxIndex(a,n.abs2,F+1);z=a.value[d];if(F+2===c){n.abs(z).value.real>b&&D++;break}f=n.sub(f,k);m.value=m.value.splice(0,m.value.length-1)}return{Q:p,R:u,P:h.turnIntoCSList(w),
rank:n.real(D)}};h._helper.getHouseHolder=function(a){var b=n.real(a.value.length);if(1E-16>h.abs2(a))return h.idMatrix(b,b);var c=n.real(1),d=h._helper.unitvector(n.real(a.value.length),c);var f=h._helper.QRgetAlpha(a,0);f=h.sub(a,h.scalmult(f,d));f=h.scaldiv(h.abs(f),f);a=n.div(h.sesquilinearproduct(a,f),h.sesquilinearproduct(f,a));b=h.idMatrix(b,b);return b=h.sub(b,h.scalmult(n.add(c,a),h._helper.transposeMult(f,h.conjugate(f))))};h._helper.reOrderbyPivots=function(a,b){var c=a.value.length.length;
a=h.transpose(a);c=Array(c);for(var d=0;d<b.length;d++)c[b[d]]=a.value[d];c=h.turnIntoCSList(c);return h.transpose(c)};h.QRdecomp=function(a){var b=a.value.length,c=n.real(b);if(h._helper.isUpperTriangular(a))return{Q:h.idMatrix(c,c),R:a};var d=n.real(1),f=h._helper.unitvector(n.real(a.value.length),d),k=h.idMatrix(c,c);a=JSON.parse(JSON.stringify(a));for(var m=0;;m++){var p=h._helper.getBlock(a,[m],[m]);p=h.column(p,d);var u=h.abs2(p).value.real;1E-8<u&&(p=h._helper.getHouseHolder(p),p=h._helper.buildBlockMatrix(h.idMatrix(n.real(m),
n.real(m)),p),k=A.mult(k,h.transjugate(p)),a=A.mult(p,a));if(m+2===b)break;c=n.sub(c,d);f.value=f.value.splice(0,f.value.length-1)}return{Q:k,R:a}};h._helper.swapColumn=function(a,b,c){for(var d,f=0;f<a.value.length;f++)d=a.value[f].value[b],a.value[f].value[b]=a.value[f].value[c],a.value[f].value[c]=d};h._helper.buildBlockMatrix=function(a,b){if(0===a.value.length)return b;if(0===b.value.length)return a;var c=a.value.length,d=a.value[0].value.length,f=d+b.value[0].value.length;f=h.zeromatrix(n.real(c+
b.value.length),n.real(f));for(var k=0;k<a.value.length;k++)for(var m=0;m<a.value[0].value.length;m++)f.value[k].value[m]=a.value[k].value[m];for(a=0;a<b.value.length;a++)for(k=0;k<b.value[0].value.length;k++)f.value[c+a].value[d+k]=b.value[a].value[k];return f};h._helper.getBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));var d=b[0],f=c[0];b=void 0===b[1]?a.value.length:b[1];c=void 0===c[1]?a.value[0].value.length:c[1];b++;c++;a.value=a.value.slice(d,b);for(d=0;d<a.value.length;d++)a.value[d].value=
a.value[d].value.slice(f,c);return a};h._helper.setBlock=function(a,b,c){a=JSON.parse(JSON.stringify(a));var d=c[0];c=c[1];for(var f=b.value.length,k=b.value[0].value.length,m=0;m<f;m++)for(var p=0;p<k;p++)a.value[d+m].value[c+p]=b.value[m].value[p];return a};h._helper.transposeMult=function(a,b){if(a.value.length!==b.value.length)return B;for(var c=a.value.length,d=Array(c),f=0;f<c;f++)d[f]=h.scalmult(a.value[f],b);return h.turnIntoCSList(d)};h._helper.QRgetAlpha=function(a,b){return 0>a.value[b].value.real?
h.abs(a):n.neg(h.abs(a))};h.LUdecomp=function(a){a=JSON.parse(JSON.stringify(a));var b,c,d=0,f=a.value.length,k=f-1,m=Array(f);for(c=0;c<f;++c){var p=c;var u=a.value[c];var w=n.abs(u.value[c]).value.real;for(b=c+1;b<f;++b){var z=n.abs(a.value[b].value[c]);w<z.value.real&&(w=z.value.real,p=b)}w<n.eps&&console.log("Warning: singular matrix!");m[c]=p;p!==c&&(a.value[c]=a.value[p],a.value[p]=u,u=a.value[c],d++);b=u.value[c];for(z=c+1;z<f;++z)a.value[z].value[c]=n.div(a.value[z].value[c],b);for(z=c+1;z<
f;++z){p=a.value[z];for(b=c+1;b<k;++b)p.value[b]=n.sub(p.value[b],n.mult(p.value[c],u.value[b])),++b,p.value[b]=n.sub(p.value[b],n.mult(p.value[c],u.value[b]));b===k&&(p.value[b]=n.sub(p.value[b],n.mult(p.value[c],u.value[b])))}}return{LU:a,P:m,TransPos:d}};h.LUsolve=function(a,b){a=h.LUdecomp(a);return h._helper.LUsolve(a,b)};h._helper.LUsolve=function(a,b){var c=JSON.parse(JSON.stringify(b));b=a.LU;var d=b.value.length,f=JSON.parse(JSON.stringify(c)),k=a.P;for(a=d-1;-1!==a;--a)f.value[a]=c.value[a];
for(a=0;a<d;++a){c=k[a];if(k[a]!==a){var m=f.value[a];f.value[a]=f.value[c];f.value[c]=m}m=b.value[a];for(c=0;c<a;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]))}for(a=d-1;0<=a;--a){m=b.value[a];for(c=a+1;c<d;++c)f.value[a]=n.sub(f.value[a],n.mult(f.value[c],m.value[c]));f.value[a]=n.div(f.value[a],m.value[a])}return f};h.linearsolveCramer2=function(a,b){var c=h.column(a,n.real(1)),d=h.column(a,n.real(2));a=h.det2(c,d);n._helper.isZero(a)&&console.log("A is not regular!");d=h.det2(b,
d);d=n.div(d,a);b=h.det2(c,b);b=n.div(b,a);return h.turnIntoCSList([d,b])};h.linearsolveCramer3=function(a,b){var c=h.column(a,n.real(1)),d=h.column(a,n.real(2)),f=h.column(a,n.real(3));a=h.det3(c,d,f);n._helper.isZero(a)&&console.log("A is not regular!");var k=h.det3(b,d,f);f=h.det3(c,b,f);b=h.det3(c,d,b);b=h.turnIntoCSList([k,f,b]);return b=h.scaldiv(a,b)};h.linearsolveCGNR=function(a,b){var c=h.transpose(a);a=A.mult(c,a);b=A.mult(c,b);return h.linearsolveCG(a,b)};h.linearsolveCG=function(a,b){var c;
var d=b;var f=b=h.sub(b,A.mult(a,b));for(var k=Math.ceil(1.2*a.value.length),m=0;m<k;){m++;var p=A.mult(a,f);var u=c=h.scalproduct(b,b);c=n.div(c,h.scalproduct(f,p));d=h.add(d,A.mult(c,f));b=h.sub(b,A.mult(c,p));if(h.abs(b).value.real<n.eps)break;c=h.scalproduct(b,b);c=n.div(c,u);f=h.add(b,A.mult(c,f))}m>=k&&console.log("CG did not converge");return d};h.det=function(a){if(1===a.value.length)return a.value[0].value[0];if(2===a.value.length)return h.det2(a.value[0],a.value[1]);if(3===a.value.length)return h.det3(a.value[0],
a.value[1],a.value[2]);if(4===a.value.length)return h.det4m(a);var b=a.value.length,c=n.real(1),d,f=JSON.parse(JSON.stringify(a));for(a=0;a<b-1;a++){var k=a;for(d=a+1;d<b;d++)n.abs(f.value[d].value[a]).value.real>n.abs(f.value[k].value[a]).value.real&&(k=d);k!==a&&(d=f.value[k],f.value[k]=f.value[a],f.value[a]=d,c=n.neg(c));var m=f.value[a];for(d=a+1;d<b;d++){var p=f.value[d];var u=n.div(p.value[a],m.value[a]);for(k=a+1;k<b-1;k+=2){var w=k+1;p.value[k]=n.sub(p.value[k],n.mult(m.value[k],u));p.value[w]=
n.sub(p.value[w],n.mult(m.value[w],u))}k!==b&&(p.value[k]=n.sub(p.value[k],n.mult(m.value[k],u)))}if(n._helper.isZero(m.value[a]))return n.real(0);c=n.mult(c,m.value[a])}return n.mult(c,f.value[a].value[a])};h.LUdet=function(a){a=h.LUdecomp(a);for(var b=a.LU,c=b.value.length,d=b.value[0].value[0],f=1;f<c;f++)d=n.mult(d,b.value[f].value[f]);1===a.TransPos%2&&(d=n.neg(d));return d};h.getField=function(a,b){if("homog"===b){if(h._helper.isNumberVecN(a,3))return a;if(h._helper.isNumberVecN(a,2))return h.turnIntoCSList([a.value[0],
a.value[1],n.real(1)])}if("xy"===b){if(h._helper.isNumberVecN(a,2))return a;if(h._helper.isNumberVecN(a,3))return h.turnIntoCSList([n.div(a.value[0],a.value[2]),n.div(a.value[1],a.value[2])])}if("x"===b&&h.isNumberVector(a)){var c=a.value.length;if(0<c&&3!==c)return a.value[0];if(3===c)return"Point"===a.usage?n.div(a.value[0],a.value[2]):a.value[0]}if("y"===b&&h.isNumberVector(a)){c=a.value.length;if(1<c&&3!==c)return a.value[1];if(3===c)return"Point"===a.usage?n.div(a.value[1],a.value[2]):a.value[1]}return"z"===
b&&h.isNumberVector(a)&&(c=a.value.length,2<c)?a.value[2]:B};h.nil=h.turnIntoCSList([]);h.ofGeos=function(a){return h.turnIntoCSList(a.map(function(b){return{ctype:"geo",value:b}}))};h._helper.isAlmostFarpoint=function(a){a=h.normalizeMax(a).value[2];return n.abs(a).value.real<n.eps};h.getRandRealVec3=function(a,b){var c=n.getRandReal;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};h.getRandComplexVec3=function(a,b){var c=n.getRandComplex;return h.turnIntoCSList([c(a,b),c(a,b),c(a,b)])};var Ta={_helper:{},
turnIntoCSJson:function(a){return{ctype:"JSON",value:a}}};Ta._helper.ShallowClone=function(a){var b;var c=Array.isArray(a)?[]:{};for(b in a){var d=a[b];c[b]=d}return c};Ta.getField=function(a,b){return a.value&&a.value[b]?a.value[b]:B};Ta.setField=function(a,b,c){"undefined"===c.ctype&&a[b]?delete a[b]:a[b]=c};Ta.GenFromUserDataEl=function(a){var b=a.key;a=a.value;if(!b||"string"!==b.ctype)return console.log("Error: JSON keys have to be strings."),B;if(a)return{key:b.value,val:M(a)};console.log("Warning: JSON object not defined.");
return{key:b.value,val:B}};Ta._helper.GenJSONAtom=function(a,b){return{ctype:"JSON",value:{key:A.string(a),value:b}}};Ta._helper.forall=function(a,b,c,d){var f="value";if(void 0!==d.iterator){d=M(d.iterator);var k=["key","value","pair"];"string"===d.ctype&&k.includes(d.value)&&(f=d.value)}if("value"===f)for(var m in a){T.setvar(b,a[m]);var p=M(c)}else if("key"===f)for(var u in a)T.setvar(b,A.string(u)),p=M(c);else for(var w in a)T.setvar(b,Ta._helper.GenJSONAtom(w,a[w])),p=M(c);return p};Ta._helper.niceprint=
function(a,b,c){return"JSON"===a.ctype?Ta.niceprint(a,b,c):qa(a)};Ta.niceprint=function(a,b,c){if(!c&&(c={printedWarning:!1,visitedMap:{}},c.visitedMap.tracker=new WeakMap,c.visitedMap.level=0,c.visitedMap.maxLevel=1E3,c.visitedMap.maxElVisit=5E3,b&&b.maxDepth)){var d=M(b.maxDepth);"number"===d.ctype&&(c.visitedMap.maxLevel=d.value.real)}var f=c.visitedMap;f.newLevel=!0;f.level+=1;return"{"+Object.keys(a.value).sort().map(function(k){var m=a.value[k];if(f.tracker.has(m)){if(f[m]>f.maxElVisit||f.level>
f.maxLevel)return c.printedWarning||(console.log("Warning: We visited a key-value pair very often or encountered a very deeply nested dictionary. Dictionary is probably cyclic. Output will be probably incomplete."),c.printedWarning=!0),k+":...";f.newLevel&&(f.tracker.set(m,f.tracker.get(m)+1),f.newLevel=!1)}else f.tracker.set(m,1);return k+":"+Ta._helper.niceprint(m,b,c)}).join(", ")+"}"};Ta._helper.handlePrintException=function(a){a instanceof RangeError?console.log("Warning: Dictionary string could not be generated! Probably large cyclic Dictionary!"):
a instanceof SyntaxError?console.log("Warning: Dictionary string could not be parsed!"):console.log("Warning: Dictionary printing failed!")};var nc={key:function(a){if("string"===a.ctype)return"s"+a.value.length+":"+a.value+";";if("number"===a.ctype)return"n"+a.value.real+","+a.value.imag+";";if("list"===a.ctype)return"l"+a.value.length+":"+a.value.map(nc.key).join(",")+";";if("boolean"===a.ctype)return"b"+a.value+";";if("dict"===a.ctype)return a=Object.keys(a.value).sort(),"d"+a.length+":"+a.join(",")+
";";"undefined"!==a.ctype&&Pb.err("Bad dictionary key: "+qa(a));return"undef"},create:function(){return{ctype:"dict",value:{}}},clone:function(a){var b=nc.create(),c;for(c in a.value)a.value.hasOwnProperty(c)&&(b.value[c]=a.value[c]);return b},put:function(a,b,c){a.value[nc.key(b)]={key:b,value:c}},get:function(a,b,c){return(a=a.value[nc.key(b)])?a.value:c},niceprint:function(a){return"{"+Object.keys(a.value).sort().map(function(b){b=a.value[b];return qa(b.key)+":"+qa(b.value)}).join(", ")+"}"}},
A={_helper:{},order:{undefined:0,boolean:1,number:2,term:3,atomic:4,variable:5,geo:6,string:7,list:8},string:function(a){return{ctype:"string",value:a}},bool:function(a){return{ctype:"boolean",value:a}},not:function(a){return A.bool(!a.value)},isLessThan:function(a,b){return-1===A.compare(a,b)},isEqual:function(a,b){return 0===A.compare(a,b)},compareResults:function(a,b){return A.compare(a.result,b.result)},compare:function(a,b){if(a.ctype!==b.ctype)return A.order[a.ctype]-A.order[b.ctype];if("number"===
a.ctype)return n._helper.compare(a,b);if("list"===a.ctype)return h._helper.compare(a,b);if("geo"===a.ctype)return a.value.name===b.value.name?0:a.value.name<b.value.name?-1:1;if("string"===a.ctype)return a.value===b.value?0:a.value<b.value?-1:1;if("boolean"===a.ctype)return a.value===b.value?0:!1===a.value?-1:1},add:function(a,b){return"void"===a.ctype&&"number"===b.ctype||"void"===a.ctype&&"list"===b.ctype?b:"number"===a.ctype&&"number"===b.ctype?n.add(a,b):"string"===a.ctype||"string"===b.ctype?
{ctype:"string",value:qa(a)+qa(b)}:"list"===a.ctype&&"list"===b.ctype?h.add(a,b):B},sub:function(a,b){return"void"===a.ctype&&"number"===b.ctype?n.neg(b):"void"===a.ctype&&"list"===b.ctype?h.neg(b):"number"===a.ctype&&"number"===b.ctype?n.sub(a,b):"list"===a.ctype&&"list"===b.ctype?h.sub(a,b):B},mult:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.mult(a,b):"number"===a.ctype&&"list"===b.ctype?h.scalmult(a,b):"list"===a.ctype&&"number"===b.ctype?h.scalmult(b,a):"list"===a.ctype&&"list"===
b.ctype?h.mult(a,b):B},div:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.div(a,b):"list"===a.ctype&&"number"===b.ctype?h.scaldiv(b,a):B},max:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.max(a,b):"list"===a.ctype&&"list"===b.ctype?h.max(a,b):B},min:function(a,b){return"number"===a.ctype&&"number"===b.ctype?n.min(a,b):"list"===a.ctype&&"list"===b.ctype?h.min(a,b):B},wrap:function(a){if("number"===typeof a)return n.real(a);if("object"===typeof a&&void 0!==a.length){for(var b=
[],c=0;c<a.length;c++)b[c]=A.wrap(a[c]);return h.turnIntoCSList(b)}return"string"===typeof a?{ctype:"string",value:a}:"boolean"===typeof a?{ctype:"boolean",value:a}:B},unwrap:function(a){if("object"!==typeof a||null===a)return a;if(Array.isArray(a))return a.map(A.unwrap);switch(a.ctype){case "string":case "boolean":return a.value;case "number":return 0===a.value.imag?a.value.real:{r:a.value.real,i:a.value.imag};case "list":return a.value.map(A.unwrap);default:return null}},withUsage:function(a,b){return{ctype:a.ctype,
value:a.value,usage:b}},wrapJSON:function(a){switch(typeof a){case "number":return n.real(a);case "string":return A.string(a);case "boolean":return A.bool(a);case "object":if(null===a)return B;if(Array.isArray(a))return h.turnIntoCSList(a.map(A.wrapJSON));var b=nc.create(),c;for(c in a)nc.put(b,A.string(c),A.wrapJSON(a[c]));return b;default:return console.log("Failed to convert "+typeof a+" to CindyJS data type"),B}},identity:function(a){return a},deeplyEqual:function(a,b){if("object"!==typeof a||
"object"!==typeof b||null===a||null===b)return a===b;var c=0,d;for(d in a)if(++c,!(d in b&&A.deeplyEqual(a[d],b[d])))return!1;for(d in b)--c;return 0===c}},v={},C={};C[":"]=ab(":");C["\u00b0"]=function(a,b){b=X(a[0]);return"number"===b.ctype&&"void"===a[1].ctype?A.withUsage(n.realmult(Math.PI/180,b),"Angle"):B};C._=Gc;C["^"]=Ab;C["\u221a"]=function(a,b){return"void"===a[0].ctype?y.sqrt$1([a[1]],b):B};C["*"]=Ae;C["\u00d7"]=Fa;C["/"]=Id;C["+"]=Zc;C["-"]=Hd;C["!"]=function(a,b){b=X(a[1]);return"void"===
a[0].ctype&&"boolean"===b.ctype?{ctype:"boolean",value:!b.value}:B};C["=="]=Va;C["~="]=vb;C["~<"]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<=-n.eps}:B};C["~>"]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>=n.eps}:B};C["=:="]=
ab("=:=");C[">="]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>=a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>=a.value}:B};C["<="]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<=a.value.real}:"string"===b.ctype&&"string"===
a.ctype?{ctype:"boolean",value:b.value<=a.value}:B};C["~>="]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real>-n.eps}:B};C["~<="]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real-a.value.real<n.eps}:B};C[">"]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===
b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real>a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value>a.value}:B};C["<"]=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype&&n._helper.isAlmostReal(b)&&n._helper.isAlmostReal(a)?{ctype:"boolean",value:b.value.real<a.value.real}:"string"===b.ctype&&"string"===a.ctype?{ctype:"boolean",value:b.value<a.value}:B};C["<>"]=yc;C["\u2208"]=
function(a,b){b=M(a[0]);a=M(a[1]);return"list"===a.ctype?h.contains(a,b):B};C["\u2209"]=function(a,b){b=M(a[0]);a=M(a[1]);return"list"===a.ctype?A.not(h.contains(a,b)):B};C["&"]=ac;C["%"]=kc;C["!="]=yc;C["~!="]=function(a,b){return A.not(vb(a,b))};C[".."]=function(a,b){b=M(a[0]);a=M(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.sequence(b,a):B};C["++"]=Jd;C["--"]=tc;C["~~"]=Kd;C[":>"]=R;C["<:"]=qd;C["="]=yb;C[":="]=function(a,b,c){b="undefined"===a[1].ctype;if("undefined"===a[0].ctype||b)return B;
if("function"===a[0].ctype){b=a[0].oper;var d=a[0].args;a=a[1];var f=1;if(v.hasOwnProperty(b)){f=v[b];if(f.definer===c)return B;f=f.generation+1}v[b]={oper:b,body:a,arglist:d,definer:c,generation:f}}else"variable"===a[0].ctype?T.setvar(a[0].name,a[1]):"field"===a[0].ctype?J.assigndotNoVal(a[0],a[1]):"userdata"===a[0].ctype&&J.assigncolonNoVal(a[0],a[1]);return B};C[":=_"]=function(a,b){if("void"!==a[1].ctype)return B;"function"===a[0].ctype&&delete v[a[0].oper];return B};C["::="]=ab("::=");C[";"]=
function(a,b){b="void"===a[0].ctype;var c="void"===a[1].ctype;if(b&&c)return B;if(!b&&c)return M(a[0]);b||c||M(a[0]);return c?B:M(a[1])};qa.errorTypes=["_?_","_??_","_???_","___"];var y={},J={evaluate:function(a,b,c){if(v.hasOwnProperty(a)){a=v[a];if(void 0===a)b=B;else{var d=[];for(c=0;c<a.arglist.length;c++)d[c]=M(b[c]);for(c=0;c<a.arglist.length;c++)T.newvar(a.arglist[c].name),T.setvar(a.arglist[c].name,d[c]);T.pushVstack("*");b=M(a.body);T.cleanVstack();for(c=0;c<a.arglist.length;c++)T.removevar(a.arglist[c].name)}return b}if(d=
y[a])return d(b,c);var f=a.lastIndexOf("$");if(-1!==f&&(f=a.substr(0,f),d=y[f]))return d(b,c);Pb.err("Called undefined function "+f+" (as "+a+")");return B},equals:function(a,b){return"number"===a.ctype&&"number"===b.ctype?{ctype:"boolean",value:a.value.real===b.value.real&&a.value.imag===b.value.imag}:"string"===a.ctype&&"string"===b.ctype||"boolean"===a.ctype&&"boolean"===b.ctype?{ctype:"boolean",value:a.value===b.value}:"list"===a.ctype&&"list"===b.ctype?h.equals(a,b):"geo"===a.ctype&&"geo"===
b.ctype||"JSON"===a.ctype&&"JSON"===b.ctype?{ctype:"boolean",value:a.value===b.value}:{ctype:"boolean",value:!1}}},T={};T.vars=function(){var a={pi:n.real(Math.PI),"\u03c0":n.real(Math.PI),i:n.complex(0,1),true:A.bool(!0),false:A.bool(!1),"#":B,nil:h.turnIntoCSList([]),newline:A.string("\n"),tab:A.string("\t")},b=[],c;for(c in a)b[c]=[a[c]];return b}();T.isVariable=function(a){return this.vars.hasOwnProperty(a)};T.create=function(a){if(this.vars.hasOwnProperty(a))return this.vars[a];var b=[null];
return this.vars[a]=b};T.newvar=function(a){a=this.vars[a];a.push(B);return a};T.removevar=function(a){var b=this.vars[a];0===b.length&&console.error("Removing non-existing "+a);b.pop();0===b.length&&console.warn("Removing last "+a)};T.setvar=function(a,b){var c=this.vars[a];0===c.length&&console.error("Setting non-existing variable "+a);void 0===b&&(console.error("Setting variable "+a+" to undefined value"),b=B);"undefined"===b.ctype?c[c.length-1]=b:(a=b,null===a&&(a=B),c[c.length-1]=a)};T.undefinedWarning=
{};T.getvar=function(a){var b=this.vars[a]||[];0===b.length&&console.error("Getting non-existing variable "+a);b=b[b.length-1];if(null===b){if(H.csnames.hasOwnProperty(a))return{ctype:"geo",value:H.csnames[a]};console&&console.log&&void 0===this.undefinedWarning[a]&&(this.undefinedWarning[a]=!0,console.log("Warning: Accessing undefined variable: "+a));return B}return b};T.dump=function(a){var b=this.vars[a];console.log("*** Dump "+a);for(a=0;a<b.length;a++)console.log(a+":> "+qa(b[a]))};T.vstack=
[];T.pushVstack=function(a){this.vstack.push(a)};T.popVstack=function(){this.vstack.pop()};T.cleanVstack=function(){for(var a=this.vstack;0<a.length&&"*"!==a[a.length-1];)this.removevar(a[a.length-1]),a.pop();0<a.length&&a.pop()};var ma={generalFields:{color:"color",colorhsb:"",size:"size",alpha:"alpha",fillcolor:"fillcolor",fillalpha:"fillalpha",isshowing:"isshowing",visible:"visible",name:"name",caption:"caption",trace:"",tracelength:"",selected:"",labeled:"labeled",labelled:"labeled"},getGeoField:function(a,
b){return"undefined"!==typeof H.csnames[a]?ma.getField(H.csnames[a],b):B},setGeoField:function(a,b,c){return"undefined"!==typeof H.csnames[a]?ma.setField(H.csnames[a],b,c):B},getField:function(a,b){if("P"===a.kind){if("xy"===b)return a=h.dehom(a.homog),A.withUsage(a,"Point");if("homog"===b)return A.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);if("y"===b)return n.div(a.homog.value[1],a.homog.value[2]);if("narrow"===b)return A.wrap(a.narrow)}if("L"===a.kind||
"S"===a.kind){if("homog"===b)return A.withUsage(a.homog,"Line");if("angle"===b)return a=h.eucangle(h.ey,a.homog),A.withUsage(a,"Angle");if("slope"===b)return n.neg(n.div(a.homog.value[0],a.homog.value[1]))}if("Tr"===a.kind&&"matrix"===b)return a.matrix;if("C"===a.kind){if("radius"===b){var c=a.matrix;a=c.value[0].value[0];var d=c.value[0].value[2];b=c.value[1].value[2];c=c.value[2].value[2];n.mult(a,a);d=n.div(d,a);b=n.div(b,a);a=n.div(c,a);return a=n.sqrt(n.sub(n.add(n.mult(d,d),n.mult(b,b)),a))}if("size"===
b)return a.size;if("matrix"===b)return a.matrix;if("center"===b)return a=t._helper.CenterOfConic(a.matrix),a=h.dehom(a),A.withUsage(a,"Point");if("dualMatrix"===b)return h.normalizeMax(h.adjoint3(a.matrix));if("narrow"===b)return A.wrap(a.narrow)}if("Text"===a.kind){if("pressed"===b)return a.checkbox?A.bool(a.checkbox.checked):A.bool(!1);if("xy"===b)return a=h.dehom(a.homog),A.withUsage(a,"Point");if("homog"===b)return A.withUsage(a.homog,"Point");if("x"===b)return n.div(a.homog.value[0],a.homog.value[2]);
if("y"===b)return n.div(a.homog.value[1],a.homog.value[2])}if("trace"===b)return A.bool(!!a.drawtrace);if("pinned"===b)return A.bool(!!a.pinned);if(ma.generalFields[b])return(a=a[ma.generalFields[b]])&&a.ctype?a:"object"!==typeof a?A.wrap(a):B;if(a.behavior){if("mass"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.mass);if("radius"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.radius);if("charge"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.charge);if("friction"===b&&"Mass"===
a.behavior.type)return n.real(a.behavior.friction);if("vx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vx);if("vy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.vy);if("v"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.vx,a.behavior.vy]);if("fx"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fx);if("fy"===b&&"Mass"===a.behavior.type)return n.real(a.behavior.fy);if("f"===b&&"Mass"===a.behavior.type)return h.realVector([a.behavior.fx,a.behavior.fy]);if("ldiff"===
b&&"Spring"===a.behavior.type)return n.real(a.behavior.ldiff)}b=t[a.type]["get_"+b];return"function"===typeof b?b(a):B},setField:function(a,b,c){"color"===b&&h._helper.isNumberVecN(c,3)&&(a.color=c);"size"===b&&"number"===c.ctype&&(a.size=c);"alpha"===b&&"number"===c.ctype&&(a.alpha=c);"fillcolor"===b&&h._helper.isNumberVecN(c,3)&&(a.fillcolor=c);"fillalpha"===b&&"number"===c.ctype&&(a.fillalpha=c);"visible"===b&&"boolean"===c.ctype&&(a.visible=c.value);"pinned"===b&&"boolean"===c.ctype&&(a.pinned=
c.value);"labeled"!==b&&"labelled"!==b||"boolean"!==c.ctype||(a.labeled=c.value);"printlabel"===b&&(a.printname=qa(c));"trace"===b&&"boolean"===c.ctype&&(c.value&&!a.drawtrace?(a.drawtrace=!0,Ke(a)):a.drawtrace=c.value);"P"===a.kind&&a.movable&&("xy"===b&&h._helper.isNumberVecN(c,2)&&Tb(a,h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]),"homog"),"xy"===b&&h._helper.isNumberVecN(c,3)&&Tb(a,c,"homog"),"x"===b&&"number"===c.ctype&&Tb(a,h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],
a.homog.value[2]]),"homog"),"y"===b&&"number"===c.ctype&&Tb(a,h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]),"homog"),"homog"===b&&h._helper.isNumberVecN(c,3)&&Tb(a,c,"homog"));"homog"===b&&"L"===a.kind&&a.movable&&h._helper.isNumberVecN(c,3)&&Tb(a,c,"homog");"Text"===a.kind&&("pressed"===b&&"boolean"===c.ctype&&a.checkbox&&(a.checkbox.checked=c.value),a.movable&&("xy"===b?h._helper.isNumberVecN(c,2)?a.homog=h.turnIntoCSList([c.value[0],c.value[1],n.real(1)]):h._helper.isNumberVecN(c,
3)&&(a.homog=c):"homog"===b&&h._helper.isNumberVecN(c,3)?a.homog=c:"x"===b&&"number"===c.ctype?a.homog=h.turnIntoCSList([n.mult(c,a.homog.value[2]),a.homog.value[1],a.homog.value[2]]):"y"===b&&"number"===c.ctype&&(a.homog=h.turnIntoCSList([a.homog.value[0],n.mult(c,a.homog.value[2]),a.homog.value[2]]))));a.behavior&&("mass"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"mass"===b&&"Sun"===a.behavior.type&&"number"===c.ctype&&(a.behavior.mass=c.value.real),"friction"===
b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.friction=c.value.real),"charge"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.charge=c.value.real),"radius"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.radius=c.value.real),"vx"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vx=c.value.real),"vy"===b&&"Mass"===a.behavior.type&&"number"===c.ctype&&(a.behavior.vy=c.value.real),"v"===b&&"Mass"===a.behavior.type&&h._helper.isNumberVecN(c,2)&&
(a.behavior.vx=c.value[0].value.real,a.behavior.vy=c.value[1].value.real));"narrow"===b&&["P","C"].includes(a.kind)&&("boolean"===c.ctype&&(a.narrow=c.value),"number"===c.ctype&&n._helper.isAlmostReal(c)&&(a.narrow=c.value.real));b=t[a.type]["set_"+b];if("function"===typeof b)return b(a,c)},getuserData:function(a,b){var c;"string"===b.ctype&&a.userData&&a.userData[b.value]&&(c=a.userData[b.value]);return c&&c.ctype?c:"object"!==typeof c?A.wrap(c):B},setuserData:function(a,b,c){b&&"string"===b.ctype&&
a&&c&&(a.userData||(a.userData={}),a.userData[b.value]=c)}};y.version$0=function(a,b){a=["CindyJS"].concat(cf);return h.turnIntoCSList(a.map(A.wrap))};y.clearconsole$0=function(a,b){Pb.clear()};y.err$1=function(a,b){b="";"variable"===a[0].ctype?(b=a[0].name,a=T.getvar(a[0].name)):a=a[0];a=b+" ===> "+qa(M(a));pb(a);return B};y.errc$1=function(a,b){"variable"===a[0].ctype?(b=M(T.getvar(a[0].name)),console.log(a[0].name+" ===> "+qa(b))):(b=M(a[0]),console.log(" ===> "+qa(b)));return B};y.print$1=function(a,
b){Pb.out(qa(M(a[0]),b),!0);return B};y.println$1=function(a,b){Pb.out(qa(M(a[0],b)));return B};y.assert$2=function(a,b){var c=M(a[0]);if("boolean"===c.ctype){if(!1===c.value)return y.println$1([a[1]],b)}else pb("Condition for assert is not boolean");return B};y.dump$1=function(a,b){console.log(JSON.stringify(a[0]));return B};y.repeat$2=function(a,b){return y.repeat$3([a[0],null,a[1]],b)};y.repeat$3=function(a,b){var c=X(a[0]),d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);if("number"!==
c.ctype)return B;c=Math.round(c.value.real);var f=1,k=1,m=c+1,p=!1,u=!1,w=!1;if(void 0!==b.start){var z=M(b.start);"number"===z.ctype&&(p=!0,k=z.value.real)}void 0!==b.step&&(z=M(b.step),"number"===z.ctype&&(w=!0,f=z.value.real));void 0!==b.stop&&(z=M(b.stop),"number"===z.ctype&&(u=!0,m=z.value.real));!p||u||w||(m=f*c+k);p||!u||w||(k=-f*(c-1)+m,m+=f);p||u||!w||(m=f*c+k);p&&u&&!w&&(f=(m-k)/(c-1),m+=f);p&&!u&&w&&(m=f*c+k);!p&&u&&w&&(k=-f*(c-1)+m,m+=f);p&&u&&w&&(m+=f);(k<=m&&0<f||k>=m&&0>f)&&p&&u&&w&&
(c=Math.floor((m-k)/f));T.newvar(d);b=B;for(m=0;m<c;m++)T.setvar(d,{ctype:"number",value:{real:m*f+k,imag:0}}),b=M(a[2]);T.removevar(d);return b};y.while$2=function(a,b){b=a[1];a=a[0];for(var c=M(a),d=B;"list"!==c.ctype&&c.value;)d=M(b),c=M(a);return d};y.apply$2=function(a,b){return y.apply$3([a[0],null,a[1]],b)};y.apply$3=function(a,b){return y.apply$4([a[0],a[1],null,a[2]],b)};y.apply$4=function(a,b){b=X(a[0]);if("list"!==b.ctype&&"JSON"!==b.ctype)return B;var c="#";null!==a[1]&&"variable"===a[1].ctype&&
(c=a[1].name);if(null!==a[2]&&"variable"===a[2].ctype){var d=a[2].name;T.newvar(d)}var f=b.value,k="list"===b.ctype?[]:{};T.newvar(c);if(void 0!==d){if("list"===b.ctype)for(var m=0;m<f.length;m++)T.setvar(d,n.real(m+1)),T.setvar(c,f[m]),k[m]=M(a[3]);else for(m in f)T.setvar(d,A.string(m)),T.setvar(c,f[m]),k[m]=M(a[3]);T.removevar(d)}else if("list"===b.ctype)for(k=[],d=0;d<f.length;d++)T.setvar(c,f[d]),k[d]=M(a[3]);else for(var p in f)T.setvar(c,f[p]),k[p]=M(a[3]);T.removevar(c);return"list"===b.ctype?
h.turnIntoCSList(k):Ta.turnIntoCSJson(k)};y.forall$2=function(a,b){return y.forall$3([a[0],null,a[1]],b)};y.forall$3=function(a,b){var c=X(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return B;var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);var f=c.value;T.newvar(d);if("list"===c.ctype)for(b=0;b<f.length;b++){T.setvar(d,f[b]);var k=M(a[2])}else k=Ta._helper.forall(f,d,a[2],b);T.removevar(d);return k};y.select$2=function(a,b){return y.select$3([a[0],null,a[1]],b)};y.select$3=function(a,
b){var c=X(a[0]);if("list"!==c.ctype&&"JSON"!==c.ctype)return B;b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);var d=c.value;T.newvar(b);if("list"===c.ctype){c=[];for(var f=0,k=0;k<d.length;k++){T.setvar(b,d[k]);var m=M(a[2]);"boolean"===m.ctype&&!0===m.value&&(c[f]=d[k],f++)}a={ctype:"list",value:c}}else{c={};for(f in d)T.setvar(b,d[f]),m=M(a[2]),"boolean"===m.ctype&&!0===m.value&&(c[f]=d[f]);a={ctype:"JSON",value:c}}T.removevar(b);return a};y.flatten$1=function(a,b){function c(d,f){return-1===
f||"list"!==d.ctype?d:[].concat.apply([],d.value.map(function(k){return c(k,f-1)}))}a=X(a[0]);if("list"!==a.ctype)return a;b=b.levels;void 0===b?b=1:(b=M(b),b="number"===b.ctype?b.value.real:"string"===b.ctype&&"all"===b.value?-2:1);return{ctype:"list",value:c(a,b)}};y.createvar$1=function(a,b){"variable"===a[0].ctype&&T.newvar(a[0].name);return B};y.local=function(a,b){for(b=0;b<a.length;b++)"variable"===a[b].ctype&&T.newvar(a[b].name);return B};y.removevar$1=function(a,b){b=M(a[0]);"variable"===
a[0].ctype&&T.removevar(a[0].name);return b};y.release=function(a,b){if(0===a.length)return B;b=M(a[a.length-1]);for(var c=0;c<a.length;c++)"variable"===a[c].ctype&&T.removevar(a[c].name);return b};y.regional=function(a,b){for(b=0;b<a.length;b++)if("variable"===a[b].ctype){var c=a[b].name;T.newvar(c);T.pushVstack(c)}return B};y.genList=function(a,b){return h.turnIntoCSList(a.map(M))};y.genJSON=function(a,b){b={};for(var c=0;c<a.length;c++){var d=Ta.GenFromUserDataEl(a[c]);d.key&&(b[d.key]=d.val)}return{ctype:"JSON",
value:b}};J.assigntake=function(a,b){var c=a.args[0],d=M(c);a=X(a.args[1]);var f=B;if("list"===d.ctype||"string"===d.ctype){var k=Math.floor(a.value.real);0>k&&(k=d.value.length+k+1);0<k&&k<=d.value.length&&("list"===d.ctype?(f="userData"===d.internal_usage?d.value:d.value.slice(),f[k-1]=M(b),f=h.turnIntoCSList(f),d.userData&&(f.userData=d.userData)):(f=d.value,f=f.substring(0,k-1)+qa(M(b))+f.substring(k,f.length),f=A.string(f)))}"JSON"===d.ctype&&(a=qa(a),qa.errorTypes.includes(a)||(f=Ta._helper.ShallowClone(d),
f.value[a]=M(b)));yb([c,f])};J.assigndot=function(a,b){var c=M(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&ma.setField(c.value,a,X(b));"JSON"===c.ctype&&"string"===typeof a&&Ta.setField(c.value,a,X(b));return B};J.assigndotNoVal=function(a,b){var c=M(a.obj);a=a.key;"geo"===c.ctype&&"string"===typeof a&&ma.setField(c.value,a,b);"JSON"===c.ctype&&"string"===typeof a&&Ta.setField(c.value,a,b);return B};J.assigncolon=function(a,b){var c=a.obj,d=M(c);a=A.string(qa(M(a.key)));"_?_"===a.value&&
(a=B);if("geo"===d.ctype&&a)ma.setuserData(d.value,a,X(b));else if("JSON"===d.ctype&&a)Ta.setField(d.value,a.value,X(b));else if("list"===d.ctype||"string"===d.ctype&&a){var f=Object.assign({},d);f.userData||(f.userData={});"userData"!==d.internal_usage&&(f.userData=Object.assign({},f.userData));b=X(b);"list"===b.ctype&&(b.internal_usage="userData");f.userData[a.value]=b;yb([c,f])}else a&&"string"===a.ctype?console.log("User data "+a.value+" can only be assigned to geo objects and lists, not to "+
d.ctype):console.log("Key is undefined");return B};J.assigncolonNoVal=function(a,b){var c=a.obj,d=M(c);a=A.string(qa(M(a.key)));"_?_"===a.value&&(a=B);if("geo"===d.ctype&&a)ma.setuserData(d.value,a,M(b));else if("JSON"===d.ctype&&a)Ta.setField(d.value,a.value,b);else if("list"===d.ctype||"string"===d.ctype&&a){var f={},k;for(k in d)f[k]=d[k];if(f.userData){d={};for(var m in f.userData)d[m]=f.userData[m];f.userData=d}else f.userData={};f.userData[a.value]=b;yb([c,f])}else a&&"string"===a.ctype?console.log("User data "+
a.value+" can only be assigned to geo objects and lists, not to "+d.ctype):console.log("Key is undefined");return B};y.keys$1=function(a,b){b=M(a[0]);var c=b.ctype;return"geo"===c||"list"===c||"JSON"===c?(a=[],(b="geo"===c?b.value.userData:"list"===c?b.userData:b.value)&&(a=Object.keys(b).map(A.string).sort()),h.turnIntoCSList(a)):B};y.values$1=function(a,b){a=M(a[0]);b=a.ctype;if("list"===b)return a;if("geo"===b||"JSON"===b){var c=[],d;(d="geo"===b?a.value.userData:a.value)&&(c=Object.keys(d).sort().map(function(f){return d[f]}));
return h.turnIntoCSList(c)}return B};J.assignlist=function(a,b){var c=a.length,d=b.length;d<c&&(c=d);for(d=0;d<c;d++)yb([a[d],b[d]],[])};y.if$2=function(a,b){return y.if$3(a,b)};y.if$3=function(a,b){b=X(a[0]);if("boolean"===b.ctype){if(!0===b.value)return M(a[1]);if(3===a.length)return M(a[2])}else"undefined"!==b.ctype&&pb("Condition for if is not boolean");return B};y.and$2=ac;y.or$2=kc;y.xor$2=function(a,b){b=X(a[0]);a=X(a[1]);return"boolean"===b.ctype&&"boolean"===a.ctype?{ctype:"boolean",value:b.value!==
a.value}:B};y.not$1=function(a,b){a=X(a[0]);return"boolean"===a.ctype?{ctype:"boolean",value:!a.value}:B};J.genericListMathGen=function(a,b,c){y[a+"$1"]=function(f,k){f=M(f[0]);if("list"!==f.ctype)return B;f=f.value;if(0===f.length)return c;k=f[0];for(var m=1;m<f.length;m++)k=b(k,f[m]);return k};var d=a+"$3";y[a+"$2"]=function(f,k){return y[d]([f[0],null,f[1]])};y[d]=function(f,k){k=X(f[0]);if("list"!==k.ctype)return B;k=k.value;if(0===k.length)return c;var m="#";null!==f[1]&&"variable"===f[1].ctype&&
(m=f[1].name);T.newvar(m);T.setvar(m,k[0]);for(var p=M(f[2]),u=1;u<k.length;u++){T.setvar(m,k[u]);var w=M(f[2]);p=b(p,w)}T.removevar(m);return p}};J.genericListMathGen("product",A.mult,n.real(1));J.genericListMathGen("sum",A.add,n.real(0));J.genericListMathGen("max",A.max,B);J.genericListMathGen("min",A.min,B);y.max$2=function(a,b){b=X(a[0]);if("list"===b.ctype)return y.max$3([b,null,a[1]]);a=X(a[1]);return y.max$1([h.turnIntoCSList([b,a])])};y.min$2=function(a,b){b=X(a[0]);if("list"===b.ctype)return y.min$3([b,
null,a[1]]);a=X(a[1]);return y.min$1([h.turnIntoCSList([b,a])])};y.add$2=Zc;y.sub$2=Hd;y.mult$2=Ae;y.div$2=Id;y.mod$2=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.mod(b,a):B};y.pow$2=Ab;y.exp$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.exp(a):B};y.sin$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.sin(a):B};y.sqrt$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.sqrt(a):B};J.laguerre=function(a,b,c){if("list"!==a.ctype)return B;var d=a.value.length-
1,f;for(f=0;f<=d;f++)if("number"!==a.value[f].ctype)return B;if("number"!==b.ctype)return B;for(var k=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],m,p,u,w=1;w<=c;w++){p=u=n.zero;m=a.value[d];for(f=d-1;0<=f;f--)u=n.add(p,n.mult(u,b)),p=n.add(m,n.mult(p,b)),m=n.add(a.value[f],n.mult(m,b));if(n._helper.isLessThan(n.abs(m),n.real(1E-14)))break;f=n.div(p,m);p=n.mult(f,f);m=n.sub(p,n.div(n.mult(n.real(2),u),m));u=n.sqrt(n.mult(n.real(d-1),n.sub(n.mult(n.real(d),m),p)));m=n.add(f,u);f=n.sub(f,
u);n._helper.isLessThan(n.abs(m),n.abs(f))&&(m=f);f=n._helper.isLessThan(n.real(1E-14),n.abs(m))?n.div(n.real(d),m):n.mult(n.add(n.abs(b),n.one),n.complex(Math.cos(w),Math.sin(w)));if(n._helper.isLessThan(n.abs(f),n.real(1E-14)))break;0===w%20&&w<c-19&&(f=n.mult(f,n.real(k[Math.floor(w/20)])));b=n.sub(b,f)}return b};J.quadratic_roots=function(a){if("list"!==a.ctype)return B;var b=a.value[2],c=a.value[1];a=a.value[0];if(n._helper.isZero(a))return[n.zero,n.neg(n.div(c,b))];var d=n.sqrt(n.sub(n.mult(c,
c),n.mult(n.real(4),n.mult(b,a))));0<=n.re(c)&&(d=n.neg(d));return[n.div(n.sub(d,c),n.mult(n.real(2),b)),n.div(n.mult(n.real(2),a),n.sub(d,c))]};J.roots=function(a){var b=[],c=a,d=a.value.length-1;if(0>=d)return h.turnIntoCSList([]);if(n._helper.isZero(a.value[d]))return b=J.roots(h.turnIntoCSList(a.value.slice(0,d))),h.append(b,n.infinity);if(1===d)b[0]=n.neg(n.div(a.value[0],a.value[1]));else if(2===d)b=J.quadratic_roots(a);else{for(var f=0;f<d-2;f++){b[f]=J.laguerre(a,n.zero,200);b[f]=J.laguerre(c,
b[f],1);var k=[];k[d-f]=a.value[d-f];for(var m=d-f;0<m;m--)k[m-1]=n.add(a.value[m-1],n.mult(k[m],b[f]));k.shift();a=h.turnIntoCSList(k)}a=J.quadratic_roots(a);b[d-2]=a[0];b[d-1]=a[1]}return h.turnIntoCSList(b)};y.roots$1=function(a,b){a=X(a[0]);if("list"===a.ctype){for(b=0;b<a.value.length;b++)if("number"!==a.value[b].ctype)return B;a=J.roots(a);return h.sort1(a)}return B};y.autodiff$3=function(a,b){b="x";if("function"===a[0].ctype){var c=v[a[0].oper].body;b=a[0].args[0].name}else if("function"===
typeof a[0].impl)c=a[0];else return pb("could not parse function"),B;var d=X(a[1]);a=X(a[2]);if(1>a.value.real)return pb("grade cant be < 1"),B;a=n.add(a,n.real(1));return Ua.autodiff(c,b,d,a)};y.cos$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.cos(a):B};y.tan$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.tan(a):B};y.arccos$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.arccos(a):B};y.arcsin$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.arcsin(a):B};y.arctan$1=function(a,
b){a=X(a[0]);return"number"===a.ctype?n.arctan(a):B};y.arctan2$2=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype?n.arctan2(b,a):B};y.arctan2$1=function(a,b){a=X(a[0]);if("list"===a.ctype&&2===a.value.length){if(a=a.value,"number"===a[0].ctype&&"number"===a[1].ctype)return y.arctan2$2(a,b)}else if("number"===a.ctype)return n.arctan2(a);return B};y.log$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.log(a):B};J.recursiveGen=function(a){var b=n[a],c=h[a];y[a+"$1"]=
function(d,f){d=X(d[0]);return"number"===d.ctype?b(d):"list"===d.ctype?c(d):B}};J.recursiveGen("im");J.recursiveGen("re");J.recursiveGen("conjugate");J.recursiveGen("round");J.recursiveGen("ceil");J.recursiveGen("floor");J.recursiveGen("abs");y.abs_infix=y.abs$1;y.random$0=function(a,b){return n.real(n._helper.rand())};y.random$1=function(a,b){a=X(a[0]);return"number"===a.ctype?n.complex(a.value.real*n._helper.rand(),a.value.imag*n._helper.rand()):B};y.seedrandom$1=function(a,b){a=X(a[0]);"number"===
a.ctype&&n._helper.seedrandom(a.value.real);return B};y.randomnormal$0=function(a,b){return n.real(n._helper.randnormal())};y.randominteger$1=function(a,b){b=X(a[0]);return"number"===b.ctype?(a=b.value.real|0,b=b.value.imag|0,a=a*n._helper.rand()|0,b=b*n._helper.rand()|0,n.complex(a,b)):B};y.randomint$1=y.randominteger$1;y.randombool$0=function(a,b){return.5<n._helper.rand()?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isreal$1=function(a,b){a=M(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)?
{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isinteger$1=function(a,b){a=M(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real===Math.floor(a.value.real)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.iseven$1=function(a,b){a=M(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&a.value.real/2===Math.floor(a.value.real/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isodd$1=function(a,b){a=M(a[0]);return"number"===a.ctype&&n._helper.isAlmostReal(a)&&
(a.value.real-1)/2===Math.floor((a.value.real-1)/2)?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.iscomplex$1=function(a,b){return"number"===M(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isstring$1=function(a,b){return"string"===M(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.islist$1=function(a,b){return"list"===M(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.ismatrix$1=function(a,b){a=M(a[0]);return-1!==h._helper.colNumb(a)?
{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.iscircle$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&"C"===a.value.kind&&"Circle"===a.value.matrix.usage?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isconic$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&"C"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isline$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&"L"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.ispoint$1=function(a,
b){a=M(a[0]);return"geo"===a.ctype&&"P"===a.value.kind?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isgeometric$1=function(a,b){return"geo"===M(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isnumbermatrix$1=function(a,b){a=M(a[0]);return h.isNumberMatrix(a)};y.isnumbervector$1=function(a,b){a=M(a[0]);return h.isNumberVector(a)};y.issun$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Sun"===a.value.behavior.type?{ctype:"boolean",value:!0}:
{ctype:"boolean",value:!1}};y.ismass$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Mass"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isspring$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Spring"===a.value.behavior.type?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};y.isbouncer$1=function(a,b){a=M(a[0]);return"geo"===a.ctype&&void 0!==a.value.behavior&&"Bouncer"===a.value.behavior.type?{ctype:"boolean",
value:!0}:{ctype:"boolean",value:!1}};y.isundefined$1=function(a,b){return"undefined"===M(a[0]).ctype?{ctype:"boolean",value:!0}:{ctype:"boolean",value:!1}};var oa={ArcBy3:"Arc",CenterOfConic:"Center",ConicBy1p4l:"Conic1P4L",ConicBy4p1l:"Conic4P1L",ConicBy5lines:"Conic5L",ConicBy2Foci1P:"ConicFoci",ConicFromPrincipalDirections:"ConicPrincipleDirs",Free:"FreePoint",PolarOfLine:"PolarLine",PolarOfPoint:"PolarPoint",PointOnSegment:"PointOnLine",Button:"Text",ToggleButton:"Text",TrReflectionL:"TrReflection",
TrReflectionP:"TrReflection",TrReflectionC:"TrReflection",TrTranslation:"TrProjection",TrSimilarity:"TrProjection",TrAffine:"TrProjection",TransformP:"Transform",TransformL:"Transform",TransformSegment:"Transform",TransformS:"Transform",TransformPolygon:"Transform",TransformArc:"Transform",TransformConic:"Transform",TransformC:"Transform",TrMoebiusP:"Transform",TrMoebiusL:"Transform",TrMoebiusSegment:"Transform",TrMoebiusS:"Transform",TrMoebiusPolygon:"Transform",TrMoebiusArc:"Transform",TrMoebiusCircle:"Transform",
TrMoebiusC:"Transform",TrInverseMoebius:"TrInverse",Perp:"Orthogonal",Para:"Parallel",AngleBisector:"AngularBisector",IntersectLC:"IntersectionConicLine",IntersectCirCir:"IntersectionCircleCircle",OtherPointOnCircle:"PointOnCircle"};y.algorithm$1=function(a,b){a=M(a[0]);if("geo"===a.ctype){a=a.value;var c=a.type;b=X(b.compatibility);"string"===b.ctype&&/^cinderella$/i.test(b.value)&&(/^Select/.test(c)&&(a=H.csnames[a.args[0]],c=a.type),oa.hasOwnProperty(c)?c=oa[c]:"CircleMr"===c&&(c=a.pinned?"CircleByFixedRadius":
"CircleByRadius"));return A.string(c)}return B};y.inputs$1=function(a,b){a=M(a[0]);if("geo"===a.ctype){a=a.value;b=a.type;var c=[];a.args&&(c=a.args.map(function(d){return{ctype:"geo",value:H.csnames[d]}}));if(/^Select/.test(b)||t[b].isMovable)switch(a.kind){case "P":case "L":c.push(a.homog);break;case "C":c.push(a.matrix)}return h.turnIntoCSList(c)}return B};y.moveto$2=function(a,b){b=M(a[0]);a=X(a[1]);"geo"===b.ctype&&(b=b.value,h._helper.isNumberVecN(a,2)?ma.setField(b,"xy",a):h._helper.isNumberVecN(a,
3)&&ma.setField(b,"homog",a));return B};y.continuefromhere$0=function(a,b){hd();return B};y.matrixrowcolumn$1=function(a,b){a=M(a[0]);return-1!==h._helper.colNumb(a)?h.realVector([a.value.length,a.value[0].value.length]):B};y.rowmatrix$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.turnIntoCSList([a]):B};y.columnmatrix$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.turnIntoCSList(a.value.map(function(c){return h.turnIntoCSList([c])})):B};y.submatrix$3=function(a,b){b=M(a[0]);var c=M(a[1]);
a=M(a[2]);if("list"===b.ctype&&"number"===c.ctype&&"number"===a.ctype){var d=Math.round(c.value.real);a=Math.round(a.value.real);b=b.value.slice();0<a&&a<=b.length&&b.splice(a-1,1);var f=!0;b=b.map(function(k){if("list"!==k.ctype)f=!1;else return k=k.value.slice(),0<d&&d<=k.length&&k.splice(d-1,1),h.turnIntoCSList(k)});return f?h.turnIntoCSList(b):B}return B};y.complex$1=function(a,b){var c=X(a[0]);if("list"===c.ctype&&h.isNumberVector(c)){if(2===c.value.length)return a=c.value[0],b=c.value[1],n.complex(a.value.real-
b.value.imag,b.value.real+a.value.imag);if(3===c.value.length)return a=c.value[0],b=c.value[1],c=c.value[2],a=n.div(a,c),b=n.div(b,c),n.complex(a.value.real-b.value.imag,b.value.real+a.value.imag)}return B};y.gauss$1=function(a,b){a=X(a[0]);return"number"===a.ctype?h.realVector([a.value.real,a.value.imag]):B};y.cross$2=Fa;y.crossratio$4=function(a,b){b=M(a[0]);var c=M(a[1]),d=M(a[2]);a=M(a[3]);var f=Ca(b),k=Ca(c),m=Ca(d),p=Ca(a);return f!==B&&k!==B&&m!==B&&p!==B?h.crossratio3(f,k,m,p,h.ii):"number"===
b.ctype&&"number"===c.ctype&&"number"===d.ctype&&"number"===a.ctype?n.div(n.mult(n.sub(b,d),n.sub(c,a)),n.mult(n.sub(b,a),n.sub(c,d))):B};y.para$2=function(a,b){b=X(a[0]);var c=X(a[1]);a=Ca(b);var d=Ca(c);if(b!==B&&c!==B){c=c.usage;var f=a,k=d;if("Line"===b.usage||"Point"===c)f=d,k=a;b=h.cross(h.cross(h.linfty,k),f);return A.withUsage(b,"Line")}return B};y.perp$2=function(a,b){b=X(a[0]);var c=X(a[1]);a=Ca(b);var d=Ca(c);if(b!==B&&c!==B){var f=c.usage||d.usage;c=a;var k=d;if("Line"===(b.usage||a.usage)||
"Point"===f)c=d,k=a;b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);b=h.cross(b,c);return A.withUsage(b,"Line")}return B};y.perp$1=function(a,b){a=X(a[0]);return h._helper.isNumberVecN(a,2)?h.turnIntoCSList([n.neg(a.value[1]),a.value[0]]):B};y.parallel$2=y.para$2;y.perpendicular$2=y.perp$2;y.perpendicular$1=y.perp$1;y.meet$2=function(a,b){b=Ca(a[0]);a=Ca(a[1]);return b!==B&&a!==B?(a=h.cross(b,a),A.withUsage(a,"Point")):B};y.join$2=function(a,b){b=Ca(a[0]);a=Ca(a[1]);return b!==B&&a!==B?(a=h.cross(b,
a),A.withUsage(a,"Line")):B};y.dist$2=function(a,b){b=X(a[0]);a=X(a[1]);a=Hd([b,a],[]);return y.abs$1([a],[])};y.dist_infix=y.dist$2;y.point$1=function(a,b){a=M(a[0]);return h._helper.isNumberVecN(a,3)||h._helper.isNumberVecN(a,2)?A.withUsage(a,"Point"):a};y.line$1=function(a,b){a=M(a[0]);return h._helper.isNumberVecN(a,3)?A.withUsage(a,"Line"):a};y.det$3=function(a,b){b=Ca(a[0]);var c=Ca(a[1]);a=Ca(a[2]);if(b!==B&&c!==B&&a!==B)return h.det3(b,c,a)};y.det$1=function(a,b){a=X(a[0]);return"list"===
a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.det(a):B};y.eig$1=function(a,b){a=X(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a):B};y.eigenvalues$1=function(a,b){a=X(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a,!1).value[0]:B};y.rank$1=function(a,b){a=X(a[0]);if("list"===a.ctype){var c=h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return h.rank(a,b.precision)}return B};y.kernel$1=function(a,
b){a=X(a[0]);if("list"===a.ctype){var c=h._helper.colNumb(a);if(-1!==c&&c===a.value.length)return b=h.nullSpace(a,b.precision),h.transpose(b)}return B};y.eigenvectors$1=function(a,b){a=X(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.eig(a).value[1]:B};y.area$3=function(a,b){b=Ca(a[0]);var c=Ca(a[1]);a=Ca(a[2]);if(b!==B&&c!==B&&a!==B){var d=b.value[2],f=c.value[2],k=a.value[2];if(!n._helper.isAlmostZero(d)&&!n._helper.isAlmostZero(f)&&!n._helper.isAlmostZero(k))return b=
h.scaldiv(d,b),c=h.scaldiv(f,c),a=h.scaldiv(k,a),b=h.det3(b,c,a),n.realmult(.5,b)}return B};y.inverse$1=function(a,b){a=X(a[0]);return"list"===a.ctype&&(b=h._helper.colNumb(a),-1!==b&&b===a.value.length)?h.inverse(a):B};y.linearsolve$2=function(a,b){b=X(a[0]);a=X(a[1]);if("list"===b.ctype){var c=h._helper.colNumb(b);if(-1!==c&&c===b.value.length&&h._helper.isNumberVecN(a,c))return h.linearsolve(b,a)}return B};var la=[[[]],[[0]],[[0,1],[1,0]],[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],[[0,1,
2,3],[0,1,3,2],[0,2,1,3],[0,2,3,1],[0,3,1,2],[0,3,2,1],[1,0,2,3],[1,0,3,2],[1,2,0,3],[1,2,3,0],[1,3,0,2],[1,3,2,0],[2,0,1,3],[2,0,3,1],[2,1,0,3],[2,1,3,0],[2,3,0,1],[2,3,1,0],[3,0,1,2],[3,0,2,1],[3,1,0,2],[3,1,2,0],[3,2,0,1],[3,2,1,0]]];y.mincostmatching$1=function(a,b){var c=M(a[0]);if(h.isNumberMatrix(c).value){a=c.value.length;b=h._helper.colNumb(c);var d=a<b?b:a,f,k,m=Array(d);for(f=0;f<d;++f)for(m[f]=Array(d),k=0;k<d;++k)m[f][k]=f<a&&k<b?c.value[f].value[k].value.real:0;c=Fc(m);d=Array(a);for(f=
0;f<a;++f)k=c[f],d[f]=k<b?n.real(k+1):n.real(0);return h.turnIntoCSList(d)}return B};y.take$2=Gc;y.length$1=function(a,b){a=M(a[0]);return"list"===a.ctype||"string"===a.ctype?n.real(a.value.length):B};y.pairs$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.pairs(a):B};y.triples$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.triples(a):B};y.cycle$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.cycle(a):B};y.consecutive$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.consecutive(a):B};
y.reverse$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.reverse(a):"string"===a.ctype?(a=Array.from(a.value).reverse().join(""),A.string(a)):B};y.directproduct$2=function(a,b){b=M(a[0]);a=M(a[1]);return"list"===b.ctype&&"list"===a.ctype?h.directproduct(b,a):B};y.concat$2=Jd;y.common$2=Kd;y.remove$2=tc;y.append$2=R;y.prepend$2=qd;y.contains$2=function(a,b){b=M(a[0]);a=M(a[1]);return"list"===b.ctype?h.contains(b,a):B};y.sort$2=function(a,b){return y.sort$3([a[0],null,a[1]],b)};y.sort$3=function(a,
b){var c=X(a[0]);if("list"!==c.ctype)return B;b="#";null!==a[1]&&"variable"===a[1].ctype&&(b=a[1].name);c=c.value;var d=[];T.newvar(b);var f;for(f=0;f<c.length;f++)T.setvar(b,c[f]),d[f]={val:c[f],result:M(a[2])};T.removevar(b);d.sort(A.compareResults);a=[];for(f=0;f<c.length;f++)a[f]=d[f].val;return{ctype:"list",value:a}};y.sort$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.sort1(a):B};y.set$1=function(a,b){a=M(a[0]);return"list"===a.ctype?h.set(a):B};y.combinations$2=function(a,b){function c(F,
K){F===f?z.push(h.turnIntoCSList(D.slice())):K<k&&(D[F]=d.value[K],c(F+1,K+1),c(F,K+1))}var d=M(a[0]);a=M(a[1]);if("number"===a.ctype){var f=a.value.real|0;if("number"===d.ctype){var k=d.value.real|0;k-f<f&&(f=k-f);if(0>f)return n.real(0);if(0===f)return n.real(1);if(1===f)return d;for(var m=b=a=1;m<=f;++m){var p=k-f+m|0,u=m|0,w=rd(p,u)|0;p=p/w|0;u=u/w|0;w=rd(a,u)|0;a=a/w|0;u=u/w|0;w=rd(p,b)|0;p=p/w|0;b=b/w|0;a=a*p|0;b=b*u|0}return n.real(a/b)}if("list"===d.ctype){k=d.value.length;if(0>f||f>k)return h.turnIntoCSList([]);
if(0===f)return h.turnIntoCSList([h.turnIntoCSList([])]);if(f===k)return h.turnIntoCSList([d]);var z=[];var D=Array(f);c(0,0);return h.turnIntoCSList(z)}}return B};y.zeromatrix$2=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===b.ctype&&"number"===a.ctype?h.zeromatrix(b,a):B};y.zerovector$1=function(a,b){a=X(a[0]);return"number"===a.ctype?h.zerovector(a):B};y.transpose$1=function(a,b){a=X(a[0]);return"list"===a.ctype&&-1!==h._helper.colNumb(a)?h.transpose(a):B};y.row$2=function(a,b){b=X(a[0]);a=
X(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.row(b,a):B};y.column$2=function(a,b){b=X(a[0]);a=X(a[1]);return"number"===a.ctype&&"list"===b.ctype&&-1!==h._helper.colNumb(b)?h.column(b,a):B};y.dict$0=function(a,b){a=nc.create();for(var c in b)b.hasOwnProperty(c)&&nc.put(a,A.string(c),M(b[c]));return a};y.put$3=function(a,b){b=M(a[0]);var c=M(a[1]);a=M(a[2]);return"dict"===b.ctype?(b=nc.clone(b),nc.put(b,c,a),b):B};y.get$2=function(a,b){b=M(a[0]);a=M(a[1]);return"dict"===
b.ctype?nc.get(b,a,B):B};y.red$1=function(a,b){a=M(a[0]);return"number"===a.ctype?h.realVector([Math.min(1,Math.max(0,a.value.real)),0,0]):B};y.green$1=function(a,b){a=M(a[0]);return"number"===a.ctype?h.realVector([0,Math.min(1,Math.max(0,a.value.real)),0]):B};y.blue$1=function(a,b){a=M(a[0]);return"number"===a.ctype?h.realVector([0,0,Math.min(1,Math.max(0,a.value.real))]):B};y.gray$1=function(a,b){a=M(a[0]);return"number"===a.ctype?(a=Math.min(1,Math.max(0,a.value.real)),h.realVector([a,a,a])):B};
y.grey$1=y.gray$1;J.HSVtoRGB=function(a,b,c){a&&void 0===b&&void 0===c&&(b=a.s,c=a.v,a=a.h);var d=Math.floor(6*a);var f=6*a-d;a=c*(1-b);var k=c*(1-f*b);b=c*(1-(1-f)*b);switch(d%6){case 0:var m=c;var p=b;var u=a;break;case 1:m=k;p=c;u=a;break;case 2:m=a;p=c;u=b;break;case 3:m=a;p=k;u=c;break;case 4:m=b;p=a;u=c;break;case 5:m=c,p=a,u=k}return h.realVector([m,p,u])};y.hue$1=function(a,b){a=M(a[0]);return"number"===a.ctype?(a=a.value.real,a-=Math.floor(a),J.HSVtoRGB(a,1,1)):B};J.shapeconvert=function(a){if("circle"===
a.type){var b=a.value.value[0];b=A.div(b,b.value[2]);var c=b.value[0].value.real,d=b.value[1].value.real;a=a.value.value[1].value.real;var f=Array(125);var k=2*Math.PI/125;for(b=0;125>b;b++)f[b]={X:c+Math.cos(b*k)*a,Y:d+Math.sin(b*k)*a};return[f]}if("polygon"===a.type){c=[];for(b=0;b<a.value.length;b++){d=a.value[b];f=[];for(k=0;k<d.length;k++)f[k]={X:d[k].X,Y:d[k].Y};c[b]=f}return c}};J.shapeop=function(a,b,c){a=J.shapeconvert(a);var d=J.shapeconvert(b);ClipperLib.JS.ScaleUpPaths(a,1E3);ClipperLib.JS.ScaleUpPaths(d,
1E3);b=new ClipperLib.Clipper;b.AddPaths(a,ClipperLib.PolyType.ptSubject,!0);b.AddPaths(d,ClipperLib.PolyType.ptClip,!0);d=a=ClipperLib.PolyFillType.pftNonZero;var f=new ClipperLib.Paths;b.Execute(c,f,a,d);ClipperLib.JS.ScaleDownPaths(f,1E3);return{ctype:"shape",type:"polygon",value:f}};J.shapecommon=function(a,b){return J.shapeop(a,b,ClipperLib.ClipType.ctIntersection)};J.shaperemove=function(a,b){return J.shapeop(a,b,ClipperLib.ClipType.ctDifference)};J.shapeconcat=function(a,b){return J.shapeop(a,
b,ClipperLib.ClipType.ctUnion)};y.key$0=function(a,b){return{ctype:"string",value:ve}};y.keycode$0=function(a,b){return n.real(be)};y.mouse$0=function(a,b){return b.id?(a=M(b.id),"number"===a.ctype&&(a=a.value.real,Nc[a])?h.realVector(Nc[a]):B):h.realVector(Ob)};y.mover$0=function(a,b){return sb&&sb.mover?{ctype:"geo",value:sb.mover}:B};y.multiid$0=function(a,b){return n.real(Yb)};y.multiidlist$0=function(a,b){a=[];for(var c in Nc)a.push(c);return h.realVector(a)};y.translate$1=function(a,b){a=X(a[0]);
"list"===a.ctype&&h.isNumberVector(a)&&2===a.value.length&&P.translate(a.value[0].value.real,a.value[1].value.real);return B};y.rotate$1=function(a,b){a=X(a[0]);"number"===a.ctype&&P.rotate(a.value.real);return B};y.scale$1=function(a,b){a=X(a[0]);"number"===a.ctype&&P.scale(a.value.real);return B};y.greset$0=function(a,b){a=cd.stack.length;P.greset();for(b=0;b<a;b++)O.restore();return B};y.gsave$0=function(a,b){P.gsave();O.save();return B};y.grestore$0=function(a,b){P.grestore();O.restore();return B};
y.color$1=function(a,b){a=X(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&P.setcolor(a);return B};y.linecolor$1=function(a,b){a=X(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&P.setlinecolor(a);return B};y.pointcolor$1=function(a,b){a=X(a[0]);"list"===a.ctype&&h.isNumberVector(a).value&&P.setpointcolor(a);return B};y.alpha$1=function(a,b){a=X(a[0]);"number"===a.ctype&&P.setalpha(a);return B};y.pointsize$1=function(a,b){a=X(a[0]);"number"===a.ctype&&P.setpointsize(a);return B};y.linesize$1=
function(a,b){a=X(a[0]);"number"===a.ctype&&P.setlinesize(a);return B};y.textsize$1=function(a,b){a=X(a[0]);"number"===a.ctype&&P.settextsize(a);return B};y.playanimation$0=function(a,b){Ha();return B};y.pauseanimation$0=function(a,b){Hb();return B};y.stopanimation$0=function(a,b){Nb();return B};y.text$1=function(a,b){a=X(a[0]);return A.string(qa(a))};y.replace$3=function(a,b){var c=M(a[0]);b=M(a[1]);a=M(a[2]);if("string"===c.ctype&&"string"===b.ctype&&"string"===a.ctype)return c=c.value,b=b.value.replace(/[^A-Za-z0-9]/g,
"\\$&"),a=a.value.replace(/\$/g,"$$$$"),c=c.replace(new RegExp(b,"g"),a),{ctype:"string",value:c}};y.replace$2=function(a,b){function c(p,u,w){var z="";d=m=-1;for(var D=0;D<u.length;D++){var F=u[D][0],K=p.indexOf(F,w);-1!==K&&(-1===m?(z=F,m=K,d=D):K<m&&(z=F,m=K,d=D))}return z}var d;b=M(a[0]);var f=M(a[1]);if("string"===b.ctype&&"list"===f.ctype){a=b.value;b=[];f=$jscomp.makeIterator(f.value);for(var k=f.next();!k.done;k=f.next())k=k.value,"list"===k.ctype&&2===k.value.length&&"string"===k.value[0].ctype&&
"string"===k.value[1].ctype&&(b[b.length]=[k.value[0].value,k.value[1].value]);var m=-1;for(f=c(a,b,0);-1!==m;)a=a.substring(0,m)+b[d][1]+a.substring(m+f.length,a.length),f=m+b[d][1].length,f=c(a,b,f);return{ctype:"string",value:a}}return B};y.substring$3=function(a,b){b=M(a[0]);var c=X(a[1]);a=X(a[2]);return"string"===b.ctype&&"number"===c.ctype&&"number"===a.ctype?{ctype:"string",value:b.value.substring(Math.floor(c.value.real),Math.floor(a.value.real))}:B};y.tokenize$2=function(a,b){var c=M(a[0]);
a=M(a[1]);if("string"===c.ctype&&"string"===a.ctype)return y.tokenize$2([c,h.turnIntoCSList([a])],b);if("string"===c.ctype&&"list"===a.ctype){c=c.value;if(0===a.value.length){a=!0;if(void 0!==b.autoconvert){var d=M(b.autoconvert);"boolean"===d.ctype&&(a=d.value)}return a&&""!==c&&(a=Number(c),!isNaN(a))?n.real(a):A.string(c)}d=a.value[0];var f=h.turnIntoCSList(a.value.slice(1));c=c.split(d.value);return h.turnIntoCSList(c.map(function(k){return y.tokenize$2([A.string(k),f],b)}))}return B};y.indexof$2=
function(a,b){b=M(a[0]);a=M(a[1]);return"string"===b.ctype&&"string"===a.ctype?(a=b.value.indexOf(a.value),n.real(a+1)):B};y.indexof$3=function(a,b){b=M(a[0]);var c=M(a[1]);a=M(a[2]);return"string"===b.ctype&&"string"===c.ctype&&"number"===a.ctype?(a=b.value.indexOf(c.value,Math.round(a.value.real)-1),n.real(a+1)):B};y.parse$1=function(a,b){a=M(a[0]);return"string"===a.ctype?(a=zc(a.value),M(a)):B};y.unicode$1=function(a,b){a=M(a[0]);var c=16;b.base&&(b=M(b.base),"number"===b.ctype&&(c=b.value.real));
if("string"===a.ctype)b=parseInt(a.value,c);else if("number"===a.ctype)b=a.value.real;else return B;"undefined"!==typeof String.fromCodePoint?b=String.fromCodePoint(b):65535>=b?b=String.fromCharCode(b):(b-=65536,b=String.fromCharCode((b>>10)+55296,(b&1023)+56320));return A.string(b)};y.international$1=function(a,b){return y.international$2([a[0],null],b)};y.international$2=function(a,b){b=M(a[0]);if("string"!==b.ctype)return B;var c=(Z.translations||{})[Z.language||"en"]||{};if(!c.hasOwnProperty(b.value))return b;
var d=c[b.value];if("string"===typeof d)return A.string(d);if(null===a[1])return b;a=M(a[1]);a="number"===a.ctype?a.value.real:0;a=(c._pluralFormFunction||Be)(a);return a<d.length?A.string(d[a]):b};y.currentlanguage$0=function(a,b){return A.string(Z.language||"en")};J.basismap=function(a,b,c,d){var f=h.turnIntoCSList([a,b,c]);f=h.adjoint3(h.transpose(f));d=A.mult(f,d);f=h.turnIntoCSList([A.mult(d.value[0],a),A.mult(d.value[1],b),A.mult(d.value[2],c)]);return h.transpose(f)};y.map$8=function(a,b){b=
Ca(a[0]);var c=Ca(a[1]),d=Ca(a[2]),f=Ca(a[3]),k=Ca(a[4]),m=Ca(a[5]),p=Ca(a[6]);a=Ca(a[7]);return k!==B&&m!==B&&p!==B&&a!==B&&b!==B&&c!==B&&d!==B&&f!==B?(a=J.basismap(k,m,p,a),b=J.basismap(b,c,d,f),b=A.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};y.map$6=function(a,b){b=Ca(a[0]);var c=Ca(a[1]),d=Ca(a[2]),f=h.realVector([0,0,1]),k=h.cross,m=k(k(d,k(f,k(b,c))),k(c,k(f,k(b,d)))),p=Ca(a[3]),u=Ca(a[4]);a=Ca(a[5]);f=k(k(a,k(f,k(p,u))),k(u,k(f,k(p,a))));return p!==B&&u!==B&&a!==B&&f!==B&&b!==B&&c!==B&&d!==
B&&m!==B?(p=J.basismap(p,u,a,f),b=J.basismap(b,c,d,m),b=A.mult(p,h.adjoint3(b)),h.normalizeMax(b)):B};y.map$4=function(a,b){b=h.ii;var c=h.jj,d=Ca(a[0]),f=Ca(a[1]),k=Ca(a[2]);a=Ca(a[3]);return k!==B&&a!==B&&d!==B&&f!==B?(a=J.basismap(k,a,b,c),b=J.basismap(d,f,b,c),b=A.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};y.map$2=function(a,b){b=h.ii;var c=h.jj,d=Ca(a[0]),f=A.add(h.realVector([1,0,0]),d);a=Ca(a[1]);var k=A.add(h.realVector([1,0,0]),a);return a!==B&&k!==B&&d!==B&&f!==B?(a=J.basismap(a,k,b,c),
b=J.basismap(d,f,b,c),b=A.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};y.pointreflect$1=function(a,b){b=h.ii;var c=h.jj;a=Ca(a[0]);var d=A.add(h.realVector([1,0,0]),a),f=A.add(h.realVector([-1,0,0]),a);return f!==B&&a!==B&&d!==B?(f=J.basismap(a,f,b,c),b=J.basismap(a,d,b,c),b=A.mult(f,h.adjoint3(b)),h.normalizeMax(b)):B};y.linereflect$1=function(a,b){b=h.ii;var c=h.jj;a=Ca(a[0]);var d=h.realVector([Math.random(),Math.random(),Math.random()]),f=h.realVector([Math.random(),Math.random(),Math.random()]);
d=h.cross(d,a);f=h.cross(f,a);return a!==B&&d!==B?(a=J.basismap(d,f,b,c),b=J.basismap(d,f,c,b),b=A.mult(a,h.adjoint3(b)),h.normalizeMax(b)):B};J.extractPointVec=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=ma.getField(c,"x"),b.y=ma.getField(c,"y"),b.z=n.real(1),b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a,b.y=c,b.z=n.real(1),b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],
d=d[2],"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(b.x=n.div(a,d),b.y=n.div(c,d),b.z=n.real(1),b.ok=!0));return b};y.polygon$1=function(a,b){a=M(a[0]);if("list"===a.ctype){b=[];for(var c=0;c<a.value.length;c++){var d=J.extractPoint(a.value[c]);if(!d.ok)return B;b[c]={X:d.x,Y:d.y}}return{ctype:"shape",type:"polygon",value:[b]}}return B};y.circle$2=function(a,b){b=X(a[0]);a=X(a[1]);b=J.extractPointVec(b);if(!b.ok||"number"!==a.ctype)return B;b=h.turnIntoCSList([b.x,b.y,b.z]);return{ctype:"shape",
type:"circle",value:h.turnIntoCSList([b,a])}};y.screen$0=function(a,b){var c=P.drawingstate.initialmatrix;a=function(d,f){d-=c.tx;f+=c.ty;return{X:(d*c.d-f*c.b)/c.det,Y:-(-d*c.c+f*c.a)/c.det}};return{ctype:"shape",type:"polygon",value:[[a(0,0),a(hb,0),a(hb,jb),a(0,jb)]]}};y.halfplane$2=function(a,b){b=X(a[0]);a=X(a[1]);var c=Ca(b),d=Ca(a);if(b!==B&&a!==B){var f=a.usage;a=c;var k=d;if("Line"===b.usage||"Point"===f)a=d,k=c;b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);b=h.cross(b,a);k=h.cross(k,
b);k=A.div(k,k.value[2]);a=A.div(a,a.value[2]);a=h.sub(a,k);b=h.abs(a);a=A.div(a,b);b=k.value[0].value.real;k=k.value[1].value.real;c=1E3*a.value[0].value.real;a=1E3*a.value[1].value.real;return{ctype:"shape",type:"polygon",value:[[{X:b+a/2,Y:k-c/2},{X:b+a/2+c,Y:k-c/2+a},{X:b-a/2+c,Y:k+c/2+a},{X:b-a/2,Y:k+c/2}]]}}return B};y.element$1=function(a,b){a=M(a[0]);return"string"===a.ctype&&H.csnames.hasOwnProperty(a.value)?{ctype:"geo",value:H.csnames[a.value]}:B};J.all$1=function(a,b){a=M(a[0]);return"geo"===
a.ctype&&a.value.incidences?h.ofGeos(a.value.incidences.map(function(c){return H.csnames[c]}).filter(b)):h.nil};y.allpoints$0=function(a,b){return h.ofGeos(H.points)};y.allpoints$1=function(a,b){return J.all$1(a,function(c){return"P"===c.kind})};y.allmasses$0=function(a,b){return h.ofGeos(Kb)};y.allmasses$1=function(a,b){return J.all$1(a,function(c){return"P"===c.kind&&c.behavior&&"Mass"===c.behavior.type})};y.allsprings$0=function(a,b){return h.ofGeos(zf)};y.allsprings$1=function(a,b){return J.all$1(a,
function(c){return"S"===c.kind&&c.behavior&&"Spring"===c.behavior.type})};y.alllines$0=function(a,b){return h.ofGeos(H.lines)};y.alllines$1=function(a,b){return J.all$1(a,function(c){return"L"===c.kind||"S"===c.kind})};y.allsegments$0=function(a,b){return h.ofGeos(H.lines.filter(function(c){return"S"===c.kind}))};y.allsegments$1=function(a,b){return J.all$1(a,function(c){return"S"===c.kind})};y.allconics$0=function(a,b){return h.ofGeos(H.conics)};y.allconics$1=function(a,b){return J.all$1(a,function(c){return"C"===
c.kind})};y.allcircles$0=function(a,b){return h.ofGeos(H.conics.filter(function(c){return"Circle"===c.matrix.usage}))};y.allcircles$1=function(a,b){return J.all$1(a,function(c){return"C"===c.kind&&"Circle"===c.matrix.usage})};y.allelements$0=function(a,b){return h.ofGeos(H.gslp)};y.allelements$1=function(a,b){return J.all$1(a,function(c){return!0})};y.elementsatmouse$0=function(a,b){var c=h.realVector([Ob[0],Ob[1],1]),d=function(p){if(n._helper.isAlmostZero(p.value[2]))return Infinity;p=h.normalizeZ(p);
return h.abs(h.sub(p,c)).value.real},f=function(p){p=h.turnIntoCSList([p.value[0],p.value[1],n.zero]);return h.normalizeMax(h.cross(c,p))},k=function(p){var u=A.mult(p.matrix,c);u=f(u);p=t._helper.IntersectLC(u,p.matrix).map(function(w){return d(w)});return.5>Math.min(p[0],p[1])};a=H.points.filter(function(p){return.5>d(p.homog)});b=H.lines.filter(function(p){var u=f(p.homog);u=h.normalizeMax(h.cross(p.homog,u));if((u=.5>d(u))&&"S"===p.kind){var w=p.homog;w=h.turnIntoCSList([w.value[0],w.value[1],
n.zero]);p=h.crossratio3(p.farpoint,p.startpos,p.endpos,c,w).value.real;if(0>p||1<p)u=!1}return u});var m=H.conics.filter(function(p){var u=k(p);if(u&&p.isArc){var w=h.crossratio3harm(p.startPoint,p.endPoint,p.viaPoint,c,h.ii);p=w.value[0];w=w.value[1];n._helper.isAlmostZero(p)?(p=n.div(p,w),w=n.real(1)):(w=n.div(w,p),p=n.real(1));var z=h.abs(h.turnIntoCSList([w,p]));p=n.div(p,z);w=n.div(w,z);w=n.mult(w,p);0>p.value.real&&(w=n.neg(w));0>w.value.real&&(u=!1)}return u});a=a.concat(b,m);return h.ofGeos(a)};
y.incidences$1=y.allelements$1;y.createpoint$2=function(a,b){b=M(a[0]);a=Ca(a[1]);return"string"!==b.ctype?(pb("Name must be a string"),B):"list"!==a.ctype&&h.isNumberVector(a)?(pb("Position must be a number vector"),B):{ctype:"geo",value:Pd({name:b.value,type:"Free",labeled:!0,pos:a})}};y.create$3=function(a,b){var c=M(a[0]),d=M(a[1]),f=M(a[2]);a={};for(var k in b)a[k]=X(b[k]);if("string"===c.ctype)k=c.value;else{if("list"!==c.ctype)return pb("Names must be a string or a list of strings"),B;if(1!==
c.value.length){k=A.string(c.value.map(function(w){return w.value}).join("__"));f=y.create$3([k,d,f],a);var m=[];if(f!==B)for(d=A.string(f.value.kind.replace(/^(.*)s$/,"Select$1")),f=h.turnIntoCSList([A.string(f.value.name)]),b=0;b<c.value.length;++b)a.index=n.real(b+1),m.push(y.create$3([c.value[b],d,f],a));return h.turnIntoCSList(m)}if("string"!==c.value[0].ctype)return pb("Element of names list must be a string"),B;k=c.value[0].value}if("string"!==d.ctype)return pb("Type must be a string"),B;if("list"!==
f.ctype)return pb("Arguments must be a list"),B;if(!t.hasOwnProperty(d.value)&&!de.hasOwnProperty(d.value)&&!wf.hasOwnProperty(d.value))return pb("Invalid geometric operation: '"+d.value+"'"),B;c=[];var p=null;for(b=0;b<f.value.length;b++){var u=f.value[b];if("string"===u.ctype)c.push(u.value);else if("geo"===u.ctype)c.push(u.value.name);else if(p=Ca(u),p===B)return pb("Unknown argument type"),B}f={name:k,type:d.value,labeled:!0};p&&(f.pos=p);0<c.length&&(f.args=c);for(m in a)f[m]=A.unwrap(a[m]);
return{ctype:"geo",value:cc(f,!0)}};y.create$2=function(a,b){function c(u){function w(F){H.csnames[F]||(z=F)}var z=!1,D;if("P"===u)for(D=0;26>D&!z;D++)8!==D&&9!==D&&w(String.fromCharCode(65+D));else if("L"===u||"S"===u)for(D=0;26>D&!z;D++)8!==D&&9!==D&&w(String.fromCharCode(97+D));for(D=0;!z;D++)w(u+D);return z}var d=M(a[0]);a=M(a[1]);var f={};for(k in b)f[k]=X(b[k]);if(!t.hasOwnProperty(d.value)&&!de.hasOwnProperty(d.value)&&!wf.hasOwnProperty(d.value))return pb("Invalid geometric operation: '"+
d.value+"'"),B;for(;de.hasOwnProperty(d.value);)d.value=de[d.value];var k=t[d.value];b=A.string(c(k.kind));if(a.value.length>k.signature.length){var m="Operation "+d.value+" requieres only "+k.signature.length+" argument"+(1===k.signature.length?"":"s")+" ("+a.value.length+" argument"+(1===a.value.length?"":"s")+" given) to create "+b.value+". Ignoring the last arguments.";if(!f.pos){var p=Ca(a.value[a.value.length-1]);p!==B&&(m+=" Use the last argument as modifier `pos`.",f.pos=p)}pb(m);a=h.turnIntoCSList(a.value.slice(0,
k.signature.length))}k=y.create$3([b,d,a],f);if(k!==B&&"s"===k.value.kind[1]&&k.value.results){d=A.string("Select"+k.value.kind[0]);a=h.turnIntoCSList([A.string(k.value.name)]);if(f.pos)return b=A.string(c(k.value.kind[0])),y.create$3([b,d,a],f);m=[];for(p=0;p<k.value.results.value.length;p++)f.index=n.real(p+1),b=A.string(c(k.value.kind[0])),m.push(y.create$3([b,d,a],f));return h.turnIntoCSList(m)}k.isDuplicate&&delete k.isDuplicate;return k};Ta._helper.self=B;y.self$0=function(a,b){return Ta._helper.self};
y.eval$1=function(a,b){Object.entries(b).forEach(function(c){var d=$jscomp.makeIterator(c);c=d.next().value;d=d.next().value;d=M(d);T.newvar(c);T.setvar(c,d)});T.pushVstack("*");a=M(a[0]);T.cleanVstack();Object.entries(b).forEach(function(c){c=$jscomp.makeIterator(c);var d=c.next().value;c.next();T.removevar(d)});return a};y.javascript$1=function(a,b){a=M(a[0]);"string"===a.ctype&&(new Function(a.value)).call(Jb);return B};y.use$1=function(a,b){function c(f,k,m){y[f.toLowerCase()+"$"+k]=m}a=M(a[0]);
if("string"===a.ctype){a=a.value;var d;Z.plugins&&(d=Z.plugins[a]);d||(d=Eb._pluginRegistry[a]);if(d)return d({instance:Jb,config:Z,nada:B,evaluate:M,cscompiled:Na,extractPoint:J.extractPoint,evaluateAndVal:X,defineFunction:c,addShutdownHook:Mc.push.bind(Mc),addAutoCleaningEventListener:e,getVariable:T.getvar.bind(T),getInitialMatrix:function(){return P.drawingstate.initialmatrix},setTextRenderer:function(f,k){Kc=f;k&&(Qb=k)},getImage:function(f,k){"string"===typeof f&&(f=A.string(f));f=Wb(f);if(!f)return null;
!k&&f.cdyUpdate&&f.cdyUpdate();return f},getMyfunction:function(f){return v.hasOwnProperty(f)?v[f]:null},scheduleUpdate:x}),{ctype:"boolean",value:!0};pb("Plugin "+a+" not found");return{ctype:"boolean",value:!1}}return B};y.format$2=function(a,b){function c(u,w){u=u.toFixed(p);do{var z=u;u=u.substring(0,u.length-1)}while(w&&""!==u&&"-"!==u&&+u===+z);w=""+z;b.delimiter&&"string"===b.delimiter.ctype&&(w=w.replace(".",b.delimiter.value));return w}function d(u,w){if("number"===u.ctype){var z=c(u.value.real,
k);var D=c(u.value.imag,k);u=Math.abs(u.value.imag)<Math.pow(10,-w)?z:"-"===D.substring(0,1)?z+" - i*"+D.substring(1):z+" + i*"+D;return{ctype:"string",value:u}}return"list"===u.ctype?{ctype:"list",value:u.value.map(d)}:{ctype:"string",value:qa(u).toString()}}var f=X(a[0]);a=X(a[1]);var k=!0;if(b.truncate){var m=M(b.truncate);"boolean"===m.ctype&&(k=m.value)}if(("number"===f.ctype||"list"===f.ctype)&&"number"===a.ctype){var p=Math.max(0,Math.min(20,Math.round(a.value.real)));return d(f,p)}return B};
Date.now||(Date.now=function(){return(new Date).getTime()});var wa=0;y.timestamp$0=function(a,b){return n.real(Date.now())};y.seconds$0=function(a,b){return n.real((Date.now()-wa)/1E3)};y.resetclock$0=function(a,b){wa=Date.now();return B};y.time$0=function(a,b){a=new Date;return h.realVector([a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()])};y.date$0=function(a,b){a=new Date;return h.realVector([a.getFullYear(),a.getMonth()+1,a.getDate()])};y.simulationtime$0=function(a,b){return n.real(jd*
zd)};y.settimeout$2=function(a,b){function c(){M(d);x()}b=M(a[0]);var d=a[1];"number"===b.ctype&&"undefined"!==typeof window&&window.setTimeout(c,1E3*b.value.real);return B};J.formatForWebGL=function(a){return a.toFixed(10)};y.generateWebGL$2=function(a,b){var c=J.formatForWebGL;b=a[0];a=M(a[1]);console.log(a);if("list"!==a.ctype)return B;for(var d=[],f=0;f<a.value.length;f++)"string"===a.value[f].ctype&&d.push(a.value[f].value);console.log("***********");console.log(d);a=J.plotvars(b);console.log(a);
a.includes("a")||a.includes("b")||a.includes("c")||a.includes("d")||a.includes("e")||a.includes("f")||(b=X(b));if("number"===b.ctype)return{ctype:"string",value:"vec2("+c(b.value.real)+","+c(b.value.imag)+")"};if("variable"===b.ctype)return{ctype:"string",value:b.name};if("string"===b.ctype||"void"===b.ctype)return b;if(2===b.args.length&&("infix"===b.ctype||"function"===b.ctype)){c=y.compileToWebGL$1([b.args[0]],{});a=y.compileToWebGL$1([b.args[1]],{});if("+"===b.oper||"add"===b.oper)return void 0===
c.value||"void"===c.ctype?{ctype:"string",value:a.value}:{ctype:"string",value:"addc("+c.value+","+a.value+")"};if("*"===b.oper||"mult"===b.oper)return{ctype:"string",value:"multc("+c.value+","+a.value+")"};if("/"===b.oper||"div"===b.oper)return{ctype:"string",value:"divc("+c.value+","+a.value+")"};if("-"===b.oper||"sub"===b.oper)return void 0===c.value||"void"===c.ctype?{ctype:"string",value:"negc("+a.value+")"}:{ctype:"string",value:"subc("+c.value+","+a.value+")"};if("^"===b.oper||"pow"===b.oper)return{ctype:"string",
value:"powc("+c.value+","+a.value+")"}}if("function"===b.ctype&&1===b.args.length){c=y.compileToWebGL$1([b.args[0]],{});if("sin$1"===b.oper)return{ctype:"string",value:"sinc("+c.value+")"};if("cos$1"===b.oper)return{ctype:"string",value:"cosc("+c.value+")"};if("tan$1"===b.oper)return{ctype:"string",value:"tanc("+c.value+")"};if("exp$1"===b.oper)return{ctype:"string",value:"expc("+c.value+")"};if("log$1"===b.oper)return{ctype:"string",value:"logc("+c.value+")"};if("arctan$1"===b.oper)return{ctype:"string",
value:"arctanc("+c.value+")"};if("arcsin$1"===b.oper)return{ctype:"string",value:"arcsinc("+c.value+")"};if("arccos$1"===b.oper)return{ctype:"string",value:"arccosc("+c.value+")"};if("sqrt$1"===b.oper)return{ctype:"string",value:"sqrtc("+c.value+")"}}return B};y.compileToWebGL$1=function(a,b){b=J.formatForWebGL;a=a[0];var c=J.plotvars(a);c.includes("a")||c.includes("b")||c.includes("c")||c.includes("d")||c.includes("e")||c.includes("f")||(a=X(a));if("number"===a.ctype)return{ctype:"string",value:"vec2("+
b(a.value.real)+","+b(a.value.imag)+")"};if("variable"===a.ctype)return{ctype:"string",value:a.name};if("string"===a.ctype||"void"===a.ctype)return a;if(2===a.args.length&&("infix"===a.ctype||"function"===a.ctype)){b=y.compileToWebGL$1([a.args[0]],{});c=y.compileToWebGL$1([a.args[1]],{});if("+"===a.oper||"add"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:c.value}:{ctype:"string",value:"addc("+b.value+","+c.value+")"};if("*"===a.oper||"mult"===a.oper)return{ctype:"string",
value:"multc("+b.value+","+c.value+")"};if("/"===a.oper||"div"===a.oper)return{ctype:"string",value:"divc("+b.value+","+c.value+")"};if("-"===a.oper||"sub"===a.oper)return void 0===b.value||"void"===b.ctype?{ctype:"string",value:"negc("+c.value+")"}:{ctype:"string",value:"subc("+b.value+","+c.value+")"};if("^"===a.oper||"pow"===a.oper)return{ctype:"string",value:"powc("+b.value+","+c.value+")"}}if("function"===a.ctype&&1===a.args.length){b=y.compileToWebGL$1([a.args[0]],{});if("sin$1"===a.oper)return{ctype:"string",
value:"sinc("+b.value+")"};if("cos$1"===a.oper)return{ctype:"string",value:"cosc("+b.value+")"};if("tan$1"===a.oper)return{ctype:"string",value:"tanc("+b.value+")"};if("exp$1"===a.oper)return{ctype:"string",value:"expc("+b.value+")"};if("log$1"===a.oper)return{ctype:"string",value:"logc("+b.value+")"};if("arctan$1"===a.oper)return{ctype:"string",value:"arctanc("+b.value+")"};if("arcsin$1"===a.oper)return{ctype:"string",value:"arcsinc("+b.value+")"};if("arccos$1"===a.oper)return{ctype:"string$1",value:"arccosc("+
b.value+")"};if("sqrt$1"===a.oper)return{ctype:"string",value:"sqrtc("+b.value+")"}}return B};y.setsimulationspeed$1=function(a,b){a=X(a[0]);"number"===a.ctype&&$a(a.value.real);return B};y.setsimulationaccuracy$1=function(a,b){a=X(a[0]);"number"===a.ctype&&"undefined"!==typeof Qa&&"undefined"!==typeof Qa.env&&(Qa.env.accuracy=Math.max(1,a.value.real|0));return B};y.setsimulationquality$1=function(a,b){a=X(a[0]);"number"===a.ctype&&"undefined"!==typeof Qa&&"undefined"!==typeof Qa.env&&(a=a.value.real,
0===a&&(Qa.env.errorbound=.01,Qa.env.lowestdeltat=1E-5,Qa.env.slowdownfactor=2),1===a&&(Qa.env.errorbound=.001,Qa.env.lowestdeltat=1E-7,Qa.env.slowdownfactor=2),2===a&&(Qa.env.errorbound=1E-5,Qa.env.lowestdeltat=1E-10,Qa.env.slowdownfactor=4),3===a&&(Qa.env.errorbound=1E-6,Qa.env.lowestdeltat=1E-12,Qa.env.slowdownfactor=4));return B};var Ka=null,ib=null;y.createtool$3=function(a,b){var c="left",d="top",f=null;if(b.space){var k=M(b.space);"number"===k.ctype&&(f=k.value.real/2)}var m=null;b.toolbar&&
(k=M(b.toolbar),"string"===k.ctype&&((m=document.getElementById(k.value))||console.warn("Element #"+k.value+" not found")));if(!m){if(b.reference&&(k=M(b.reference),"string"===k.ctype))switch(k.value){case "UR":c="right";break;case "LL":d="bottom";break;case "LR":c="right",d="bottom"}m=document.createElement("div");m.className="CindyJS-toolbar";mb.parentNode.appendChild(m);k=M(a[1]);var p=M(a[2]);"number"===k.ctype&&(m.style[c]=k.value.real+"px");"number"===p.ctype&&(m.style[d]=p.value.real+"px");
null!==f&&(m.style.margin=-f+"px")}a=M(a[0]);if("string"===a.ctype)a=[[a.value]];else if("list"===a.ctype)a=a.value.map(function(z){return"string"===z.ctype?[z.value]:"list"===z.ctype?z.value.map(function(D){return"string"===D.ctype?D.value:null}):[null]});else return pb("Name must be a string or a list of strings"),B;if(b.flipped&&(k=M(b.flipped),"boolean"===k.ctype&&k.value)){pb("Flipping");var u=0;b=a.length;a.forEach(function(z){z.length>u&&(u=z.length)});k=[];for(p=0;p<u;++p){k[p]=[];for(var w=
0;w<b;++w)k[p][w]=a[w][p]||null}a=k}"bottom"===d&&a.reverse();a.forEach(function(z){"right"===c&&z.reverse();var D=document.createElement("div");m.appendChild(D);z.forEach(function(F){function K(){Ka&&Ka.classList.remove("CindyJS-active");Ka=Q;Q.classList.add("CindyJS-active");vf=F;var da=ha[vf].actions;ib&&(ib.textContent=da[0].tooltip||"");hc=[];ce=Xc=0}ha.hasOwnProperty(F)||(pb("Tool '"+F+"' not implemented yet."),F=null);if(null===F){var V=document.createElement("span");V.className="CindyJS-spacer";
D.appendChild(V)}else{var Q=document.createElement("button");V=document.createElement("img");V.src=Eb.getBaseDir()+"images/"+F+".png";Q.appendChild(V);Q.addEventListener("click",K);Ka||K();null!==f&&(Q.style.margin=f+"px");D.appendChild(Q)}})});return B};y.dropped$0=function(){return $d};y.droppoint$0=function(){return ae};y.parsecsv$1=function(a,b){var c=!0,d=X(b.autoconvert);"boolean"===d.ctype&&(c=d.value);d=null;b=X(b.delimiter);"string"===b.ctype&&/^[^"\r\n]$/.test(b.value)&&(d=b.value);a=X(a[0]);
if("string"!==a.ctype)return pb("CSV data is not a string"),B;a=a.value;b='(?:"((?:[^"]+|"")*)"|([^]*?))(\r\n|(,)|[\r\n]|$)';d&&(d=d.replace(/[^A-Za-z0-9]/g,"\\$&").replace(/\$/g,"$$$$"),b=b.replace(/,/g,d));b=new RegExp(b,"g");d=[];for(var f=[],k=null;b.lastIndex<a.length;){var m=b.exec(a),p=m[2];"string"===typeof m[1]&&(p=m[1].replace(/""/g,'"'));p=c?/^[Tt]rue$/.test(p)?A.bool(!0):/^[Ff]alse$/.test(p)?A.bool(!1):/^[\-+]?([0-9]+(\.[0-9]*)?|\.[0-9]+|Infinity)$/.test(p)?n.real(Number(p)):A.string(p):
A.string(p);d.push(p);m[4]&&b.lastIndex===a.length&&(d.push(A.string("")),m={});if(!m[4]){null===k&&(k=d.length);if(k<d.length)for(k=d.length,m=0;m<f.length;++m)for(p=f[m].length;p<k;++p)f[m][p]=B;else if(k>d.length)for(m=d.length;m<k;++m)d[m]=B;f.push(d);d=[]}}return h.turnIntoCSList(f.map(h.turnIntoCSList))};y.load$2=function(a,b){return y.load$3([a[0],null,a[1]],b)};y.load$3=function(a,b){function c(){if(k.readyState===XMLHttpRequest.DONE){if(200===k.status)var m=A.string(String(k.responseText));
else pb("Failed to load "+f+": "+k.statusText),m=B;T.newvar(d);T.setvar(d,m);M(a[2]);T.removevar(d);x()}}var d="#";null!==a[1]&&"variable"===a[1].ctype&&(d=a[1].name);b=X(a[0]);var f=null,k=null;"string"===b.ctype&&/^https?:\/\//.test(b.value)&&(f=b.value);return null!==f?(k=new XMLHttpRequest,k.onreadystatechange=c,k.open("GET",f),k.send(),A.bool(!0)):B};y.removeelement$1=function(a,b){a=M(a[0]);"geo"===a.ctype?Qd(a.value.name):console.log("argument of removeelement is undefined or not of type <geo>")};
y.guess$1=function(a,b){function c(u){if((u=jc.doPSLQ([u,1,Math.PI*Math.E],15))&&0===u[2])return[Math.round(u[0]),Math.round(u[1])]}function d(u){if(n._helper.isAlmostZero(u))return"0";if(!n._helper.isAlmostReal(u)){var w=u.value.real,z=u.value.imag,D=c(w),F=c(w*w+z*z);if(D&&F){w=-D[0]*F[0];var K=-D[1]*F[0]*2,V=D[0]*F[1];D=k(-K,2*w);F=K*K-4*V*w;u=m(F);F/=u*u;F=u===2*w?"+i*sqrt("+-F+")":u===-2*w?"+i*sqrt("+-F+")":"+i*"+k(u,2*w).substring(1)+"*sqrt("+-F+")";u="-"+F.substring(1);K=Math.abs((K*K-4*V*
w)/(4*w*w));w=Math.sqrt(K);K=-Math.sqrt(K);if("+0"===D||"-0"===D)D="";z=Math.abs(z-w)<Math.abs(z-K)?D+F:D+u;z.startsWith("+")&&(z=z.substring(1))}else z=qa(u);return z}var Q=jc.doPSLQ([Math.PI,u.value.real,1],15);z=""+u.value.real;V=w="";var da=K=1E4;D=1E5;if(Q&&3E3>(D=f(Q))){w=u.value.real;K=Q[0];F=-Q[1];Q=Q[2];var W="";if(0!==K){var na=Math.round(K);var ia=Math.round(F);W=k(na,ia)+"*pi"}na="";0!==Q&&(na=Math.round(Q),ia=Math.round(F),na=k(na,ia));p=Math.abs(w-(Q/F+Math.PI*K/F));w=na+W;""===w?w=
"0":w.startsWith("+")&&(w=w.substring(1));K=p}W=jc.doPSLQ([u.value.real*u.value.real,u.value.real,1],15);F=1E5;if(W&&9E3>(F=10+f(W))){u=u.value.real;da=W[0];Q=W[1];W=W[2];na=Math.round(da);ia=Math.round(Q);var Ea=Math.round(W);V=k(-ia,2*na);ia=ia*ia-4*Ea*na;Ea=m(ia);ia/=Ea*Ea;na=Ea===2*na?"+sqrt("+ia+")":Ea===-2*na?"-sqrt("+ia+")":k(Ea,2*na)+"*sqrt("+ia+")";ia=-Q/(2*da);W=Math.abs((Q*Q-4*W*da)/(4*da*da));na="+"+na.substring(1);da="-"+na.substring(1);Q=ia+Math.sqrt(W);W=ia-Math.sqrt(W);if("+0"===V||
"-0"===V)V="";Math.abs(u-Q)<Math.abs(u-W)?(p=Math.abs(u-Q),u=V+na):(p=Math.abs(u-W),u=V+da);u.startsWith("+")&&(u=u.substring(1));V=u;da=p}D<F&&1E-12>K&&(z=w);F<D&&1E-12>da&&(z=V);return z}function f(u){var w=Math.abs(u[0]);Math.abs(u[1])>w&&(w=Math.abs(u[1]));Math.abs(u[2])>w&&(w=Math.abs(u[2]));return w}function k(u,w){var z="+";0>u*w&&(u=Math.abs(u),w=Math.abs(w),z="-");var D=rd(u,w);u/=D;w/=D;0>u&&0>w&&(u=-u,w=-w);return 1===w?z+u:z+u+"/"+w}function m(u){for(var w=3E3;0<w;w--)if(0===u%(w*w))return w;
return 1}var p=0;a=X(a[0]);return"number"===a.ctype&&n._helper.isFinite(a)?(a=void 0===d(a)?"no guess":d(a),A.string(a)):B};J.extractPoint=function(a){var b={ok:!1};if("geo"===a.ctype){var c=a.value;if("P"===c.kind)return b.x=ma.getField(c,"x").value.real,b.y=ma.getField(c,"y").value.real,b.ok=!0,b}if("list"!==a.ctype)return b;var d=a.value;if(2===d.length&&(a=d[0],c=d[1],"number"===a.ctype&&"number"===c.ctype))return b.x=a.value.real,b.y=c.value.real,b.ok=!0,b;3===d.length&&(a=d[0],c=d[1],d=d[2],
"number"===a.ctype&&"number"===c.ctype&&"number"===d.ctype&&(a=n.div(a,d),c=n.div(c,d),b.x=a.value.real,b.y=c.value.real,b.ok=!0));return b};y.draw$1=function(a,b){a=X(a[0]);if("shape"===a.ctype)J.drawshape(a,b);else if("Line"===a.usage)N.handleModifs(b,N.lineModifs),N.drawline(a);else{var c=J.extractPoint(a);if(!c.ok){if("undefined"!==typeof a.value&&2===a.value.length)return y.draw$2(a.value,b);return}null!==b&&N.handleModifs(b,N.pointModifs);N.drawpoint(c)}return B};y.draw$2=function(a,b){var c=
X(a[0]);a=X(a[1]);c=J.extractPoint(c);a=J.extractPoint(a);if(!c.ok||!a.ok)return B;null!==b&&N.handleModifs(b,N.lineModifs);N.drawsegcore(c,a);return B};y.drawcircle$2=function(a,b){return J.drawcircle(a,b,"D")};J.arcHelper=function(a){var b={};b.startPoint=Ca(a[0]);b.viaPoint=Ca(a[1]);b.endPoint=Ca(a[2]);return b};y.fillcircle$2=function(a,b){return J.drawcircle(a,b,"F")};y.drawarc$3=function(a,b){a=J.arcHelper(a);return J.drawarc(a,b,"D")};y.fillarc$3=function(a,b){a=J.arcHelper(a);return J.drawarc(a,
b,"F")};J.drawarc=function(a,b,c){var d=a.startPoint,f=a.viaPoint;a=a.endPoint;if(!h._helper.isAlmostReal(h.turnIntoCSList([d,f,a])))return B;N.handleModifs(b,N.conicModifs);N.preDrawCurve();b=h.det3(d,f,a);if(1E-12<Math.abs(b.value.real)){b=t._helper.ConicBy5(null,d,f,a,h.ii,h.jj);var k=t._helper.CenterOfConic(b);k=h.normalizeMax(k);b=n.real(0);var m=h.turnIntoCSList([h.turnIntoCSList([k.value[2],b,n.neg(k.value[0])]),h.turnIntoCSList([b,k.value[2],n.neg(k.value[1])]),h.turnIntoCSList([b,b,k.value[2]])]);
b=h.normalizeZ(A.mult(m,d));h.normalizeZ(A.mult(m,f));m=h.normalizeZ(A.mult(m,a));b=-Math.atan2(b.value[1].value.real,b.value[0].value.real);m=-Math.atan2(m.value[1].value.real,m.value[0].value.real);k=h.normalizeZ(k);d=h.normalizeZ(d);f=h.normalizeZ(f);a=h.normalizeZ(a);var p=h.abs(h.sub(d,k)),u=[k.value[0].value.real,k.value[1].value.real];k=P.drawingstate.matrix;var w=u[0]*k.a-u[1]*k.b+k.tx;u=u[0]*k.c-u[1]*k.d-k.ty;d=0<h.det3(d,f,a).value.real;O.save();O.beginPath();O.translate(w,u);O.arc(0,0,
p.value.real*k.sdet,b,m,d);"F"===c&&(O.fillStyle=N.lineColor,O.closePath(),O.fill());"D"===c&&O.stroke();O.restore()}else{if("D"!==c)return B;c=J.extractPoint(d);b=J.extractPoint(f);m=J.extractPoint(a);if(!c.ok||!b.ok||!m.ok)return B;p=(c.x-m.x)*(c.x-m.x)+(c.y-m.y)*(c.y-m.y);k=(m.x-b.x)*(m.x-b.x)+(m.y-b.y)*(m.y-b.y);if(1E-12>(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)||1E-12>p||1E-12>k)return B;0>h.crossratio3(d,a,f,h.cross(h.cross(d,f),h.linfty),h.ii).value.real?N.drawsegcore(c,m):N.drawRaySegment(d,
a)}return B};J.drawcircle=function(a,b,c){var d=X(a[0]);a=X(a[1]);var f=J.extractPoint(d);if(!f.ok||"number"!==a.ctype||!n._helper.isAlmostReal(a))return B;d=P.drawingstate.matrix;var k=f.x*d.a-f.y*d.b+d.tx;f=f.x*d.c-f.y*d.d-d.ty;N.handleModifs(b,N.conicModifs);N.preDrawCurve();O.lineJoin="miter";O.beginPath();O.arc(k,f,Math.abs(a.value.real)*d.sdet,0,2*Math.PI);O.closePath();"D"===c&&O.stroke();"F"===c&&(O.fillStyle=N.lineColor,O.fill());"C"===c&&O.clip();return B};y.drawconic$1=function(a,b){a=
X(a[0]);if("list"!==a.ctype||3!==a.value.length&&6!==a.value.length)return console.error("could not parse conic"),B;if(6===a.value.length){for(var c=0;6>c;c++)if("number"!==a.value[c].ctype)return console.error("could not parse conic"),B;var d=n.real(.5);c=a.value[0];var f=a.value[2];f=n.mult(f,d);var k=a.value[1],m=a.value[3];m=n.mult(m,d);var p=a.value[4];p=n.mult(p,d);a=a.value[5];a=h.turnIntoCSList([h.turnIntoCSList([c,f,m]),h.turnIntoCSList([f,k,p]),h.turnIntoCSList([m,p,a])])}else{if(!h.isNumberMatrix(a).value||
3!==a.value.length||3!==a.value[0].value.length)return B;c=h.transpose(a);h.equals(a,c).value||(a=h.add(c,a))}return J.drawconic(a,b)};J.drawconic=function(a,b){function c(Aa,rb){Aa=(u*Aa+w*rb+z)*Aa+(D*rb+F)*rb+K;return 0<=Aa?1:0>Aa?-1:NaN}function d(Aa){Ba.next=Aa;Aa.prev=Ba;return Ba=Aa}function f(Aa,rb,Sb,Mb){return{a:Aa,b1:rb,b2:Sb,vertical:!0,index:Mb,sign:function(Gb){return c(Aa,Gb)},mkp:function(Gb){return{x:Aa,y:Gb}},sol:dd(D,w*Aa+F,(u*Aa+z)*Aa+K),discr:function(){return dd(ia,-2*da,V)},
tpt:function(Gb){return{x:Gb,y:-.5*(w*Gb+F)/D}}}}function k(Aa,rb,Sb,Mb){return{a:Aa,b1:rb,b2:Sb,vertical:!1,index:Mb,sign:function(Gb){return c(Gb,Aa)},mkp:function(Gb){return{x:Gb,y:Aa}},sol:dd(u,w*Aa+z,(D*Aa+F)*Aa+K),discr:function(){return dd(ia,-2*na,W)},tpt:function(Gb){return{x:-.5*(w*Gb+z)/u,y:Gb}}}}function m(Aa){var rb=Math.min(Aa.b1,Aa.b2),Sb=Math.max(Aa.b1,Aa.b2),Mb=Aa.sign(rb),Gb=Aa.sign(Sb);if(!isFinite(Mb*Gb))return!1;var nb=Aa.sol;if(Mb!==Gb){if(null===nb)return!1;var tb=.5*(nb[0]+
nb[1]);tb>rb&&tb<Sb?(rb=Aa.sign(tb),tb=nb[rb===Gb?0:1]):(Mb=.5*(rb+Sb),tb=nb[Math.abs(Mb-nb[0])<Math.abs(Mb-nb[1])?0:1]);Oa.push(d(Aa.mkp(tb)))}else{if(null===nb){if(0>=Ea)return!0;nb=Aa.discr();if(null===nb)return!0;Aa=Aa.tpt(nb[Aa.index]);Aa.x>=La&&Aa.x<=Ia&&Aa.y>=va&&Aa.y<=Ja&&d(Aa);return!0}tb=.5*(nb[0]+nb[1]);if(!(tb>rb&&tb<Sb))return!0;rb=Aa.sign(tb);if(rb===Mb||isNaN(rb))return!0;Aa.b1>Aa.b2&&(nb=[nb[1],nb[0]]);Oa.push(d(Aa.mkp(nb[0])));Oa.push(d(Aa.mkp(nb[1])))}return!0}function p(Aa,rb,Sb,
Mb,Gb){var nb=rb-Mb,tb=Sb-Aa,rc=Aa*Mb-rb*Sb,Vb=da*nb+na*tb+ia*rc;if(1E-14>Math.abs(Vb))return O.lineTo(Sb,Mb);var fe=(V*nb+Q*tb+da*rc)/Vb;nb=(Q*nb+W*tb+na*rc)/Vb;if(!isFinite(fe)||!isFinite(nb)||.04>Math.abs(Aa*nb+fe*Mb+Sb*rb-Sb*nb-fe*rb-Aa*Mb))return O.lineTo(Sb,Mb);do if(!(10<Gb)){rc=.5*(Aa+Sb);tb=.5*(rb+Mb);var wc=fe-rc;Vb=nb-tb;if(!(.04>wc*wc+Vb*Vb)){var Ff=u*wc*wc+w*wc*Vb+D*Vb*Vb,Af=2*u*wc*rc+w*(wc*tb+Vb*rc)+2*D*Vb*tb+z*wc+F*Vb,Gf=(u*rc+w*tb+z)*rc+(D*tb+F)*tb+K,Yc=dd(Ff,Af,Gf);Yc||(Yc=[-.5*Af/
Ff,-2*Gf/Af]);if(0<Yc[0])Yc=Yc[0];else if(0<=Yc[1])Yc=Yc[1];else break;wc=rc+Yc*wc;Vb=tb+Yc*Vb;rc=wc-.5*(fe+rc);tb=Vb-.5*(nb+tb);if(!(.04>rc*rc+tb*tb)){p(Aa,rb,wc,Vb,Gb+1);p(wc,Vb,Sb,Mb,Gb+1);return}}}while(0);O.quadraticCurveTo(fe,nb,Sb,Mb)}N.handleModifs(b,N.conicModifs);if(0!==N.lsize&&(N.preDrawCurve(),a=h.normalizeMax(a),h._helper.isAlmostReal(a))){b=P.toMat();a=h.mult(h.transpose(b),a);a=h.mult(a,b);a=h.normalizeMax(a);var u=a.value[0].value[0].value.real,w=2*a.value[0].value[1].value.real,
z=2*a.value[0].value[2].value.real,D=a.value[1].value[1].value.real,F=2*a.value[1].value[2].value.real,K=a.value[2].value[2].value.real,V=4*K*D-F*F,Q=F*z-2*K*w,da=F*w-2*D*z,W=4*K*u-z*z,na=z*w-2*F*u,ia=4*D*u-w*w,Ea=ia;a=D*W+w*Q+u*V-K*ia;0>a&&(u=-u,w=-w,z=-z,D=-D,F=-F,K=-K,a=-a);a=N.lsize;var La=-a,va=-a,Ia=hb+a,Ja=jb+a,Oa=[],Ba=a={};if(m(f(La,va,Ja,0))&&m(k(Ja,La,Ia,1))&&m(f(Ia,Ja,va,1))&&m(k(va,Ia,La,0))&&Ba!==a){Ba.next=a.next;a.next.prev=Ba;O.beginPath();if(0===Oa.length){var Wa=Ba;O.moveTo(Wa.x,
Wa.y);do{var fb=Wa.next;p(Wa.x,Wa.y,fb.x,fb.y,0);Wa=fb}while(Wa!==Ba);O.closePath()}b=1===c(La,va)?0:1;if(4===Oa.length){var Lb=0;for(a=0;2>a;++a){Wa=Oa[a];fb=Oa[a+2];var kb=fb.x-Wa.x;Wa=fb.y-Wa.y;Wa=(u*kb+w*Wa)*kb+D*Wa*Wa;Math.abs(Wa)>Math.abs(Lb)&&(Lb=Wa)}if(isNaN(Lb))return;0<=Lb&&(b=1-b)}for(a=b;a<Oa.length;a+=2)for(Wa=Oa[a],b=Oa[(a+1)%Oa.length],O.moveTo(Wa.x,Wa.y),fb=Wa.next;Wa!==b;fb=(Wa=fb).next)p(Wa.x,Wa.y,fb.x,fb.y,0);O.stroke()}}};y.drawall$1=function(a,b){a=M(a[0]);if("list"===a.ctype)for(N.handleModifs(b,
N.pointAndLineModifs),b=0;b<a.value.length;b++)y.draw$1([a.value[b]],null);return B};y.connect$1=function(a,b){return J.drawpolygon(a,b,"D",!1)};y.drawpoly$1=function(a,b){return J.drawpolygon(a,b,"D",!0)};y.fillpoly$1=function(a,b){return J.drawpolygon(a,b,"F",!0)};y.drawpolygon$1=function(a,b){return J.drawpolygon(a,b,"D",!0)};y.fillpolygon$1=function(a,b){return J.drawpolygon(a,b,"F",!0)};J.drawpolygon=function(a,b,c,d){function f(){for(var u=$jscomp.makeIterator(p.value),w=u.next();!w.done;w=
u.next()){w=w.value;var z;for(z=0;z<w.length;z++){var D=w[z],F=D.X*m.a-D.Y*m.b+m.tx;D=D.X*m.c-D.Y*m.d-m.ty;0===z?O.moveTo(F,D):O.lineTo(F,D)}O.closePath()}}function k(){var u;for(u=0;u<p.value.length;u++){var w=J.extractPoint(p.value[u]);if(!w.ok)return;var z=w.x*m.a-w.y*m.b+m.tx;w=w.x*m.c-w.y*m.d-m.ty;0===u?O.moveTo(z,w):O.lineTo(z,w)}d&&O.closePath()}N.handleModifs(b,d?N.conicModifs:N.lineModifs);N.preDrawCurve();var m=P.drawingstate.matrix,p=M(a[0]);O.beginPath();"list"===p.ctype&&k();"shape"===
p.ctype&&f();"D"===c&&(N.fillColor&&(O.fillStyle=N.fillColor,O.fill(N.fillrule)),O.stroke());"F"===c&&(O.fillStyle=N.lineColor,O.fill(N.fillrule));"C"===c&&O.clip();return B};var Kc=ge,Qb=function(a,b,c){if(b.includes("\n"))for(b=b.split("\n"),a.textContent=b[0],c=1;c<b.length;++c)a.appendChild(document.createElement("br")),a.appendChild(document.createTextNode(b[c]));else a.textContent=b};J.drawtext=function(a,b,c){var d=X(a[0]);a=M(a[1]);var f=J.extractPoint(d);if(!f.ok)return null;N.handleModifs(b,
N.textModifs);b=P.drawingstate.textsize;null===b&&(b=ub.textsize);null!==N.size&&(b=N.size);O.fillStyle=N.textColor;var k=P.drawingstate.matrix;d=f.x*k.a-f.y*k.b+k.tx+N.xOffset;f=f.x*k.c-f.y*k.d-k.ty-N.yOffset;a=qa(a);Eb._pluginRegistry.katex||"string"!==typeof a||3<=a.split("$").length&&gb("katex","katex-plugin.js",!0);O.font=N.bold+N.italics+Math.round(10*b)/10+"px "+N.family;return c?c(a,d,f,N.align,b):Kc(O,a,d,f,N.align,b,b*ub.lineHeight,N.angle)};y.drawtext$2=function(a,b){J.drawtext(a,b,null);
return B};y.drawtable$2=function(a,b){var c=X(a[0]);a=X(a[1]);var d=J.extractPoint(c);if(!d.ok||"list"!==a.ctype)return B;c=a.value;a=c.length;var f=-1,k;for(k=0;k<a;++k)"list"===c[k].ctype&&c[k].value.length>f&&(f=c[k].value.length);-1===f?(c=c.map(function(K){return[K]}),f=1):c=c.map(function(K){return h.asList(K).value});var m=100,p=null,u=!0,w=P.drawingstate.textcolor;N.handleModifs(b,{size:!0,color:function(K){h._helper.isNumberVecN(K,3)&&(w=N.makeColor([K.value[0].value.real,K.value[1].value.real,
K.value[2].value.real]))},alpha:!0,bold:!0,italics:!0,family:!0,align:!0,xoffset:!0,yoffset:!0,offset:!0,width:function(K){"number"===K.ctype&&(m=K.value.real)},height:function(K){"number"===K.ctype&&(p=K.value.real)},border:function(K){"boolean"===K.ctype&&(u=K.value)}});k=P.drawingstate.textsize;null===k&&(k=ub.textsize);null!==N.size&&(k=N.size);null===p&&(p=1.6*k);O.font=N.bold+N.italics+Math.round(10*k)/10+"px "+N.family;k=P.drawingstate.matrix;var z=f*m,D=a*p;b=d.x*k.a-d.y*k.b+k.tx+N.xOffset;
var F=d.x*k.c-d.y*k.d-k.ty-N.yOffset-D;if(u){N.preDrawCurve();O.strokeStyle=N.lineColor;O.beginPath();for(k=1;k<a;++k)O.moveTo(b,F+k*p),O.lineTo(b+z,F+k*p);for(d=1;d<f;++d)O.moveTo(b+d*m,F),O.lineTo(b+d*m,F+D);O.stroke();O.lineWidth=N.lsize+1;O.beginPath();O.rect(b,F,z,D);O.stroke()}b+=N.align*m+(1-2*N.align)*p*.3;F+=.7*p;O.fillStyle=w;for(k=0;k<a;++k)for(d=0;d<f;++d)z=qa(c[k][d]),Kc(O,z,b+d*m,F+k*p,N.align);return B};J.drawshape=function(a,b){return"polygon"===a.type?J.drawpolygon([a],b,"D",1):"circle"===
a.type?J.drawcircle([a.value.value[0],a.value.value[1]],b,"D"):B};J.fillshape=function(a,b){return"polygon"===a.type?J.drawpolygon([a],b,"F",1):"circle"===a.type?J.drawcircle([a.value.value[0],a.value.value[1]],b,"F"):B};J.clipshape=function(a,b){return"polygon"===a.type?J.drawpolygon([a],b,"C",1):"circle"===a.type?J.drawcircle([a.value.value[0],a.value.value[1]],b,"C"):B};y.fill$1=function(a,b){a=M(a[0]);return"shape"===a.ctype?J.fillshape(a,b):B};y.clip$1=function(a,b){var c=M(a[0]);return"shape"===
c.ctype?J.clipshape(c,b):"list"===c.ctype?(a=y.polygon$1(a,[]),y.clip$1([a],[])):B};y.plot$1=function(a,b){return y.plot$2([a[0],null],b)};y.plot$2=function(a,b){function c(ia){return"number"===ia.ctype&&n._helper.isAlmostReal(ia)}function d(ia,Ea,La,va,Ia){p++;Ea=+Ea.value.real;Ia=+va.value.real;va=Ea*Q.a-Ia*Q.b+Q.tx;Ea=Ea*Q.c-Ia*Q.d-Q.ty;ia=+ia.value.real;Ia=+La.value.real;La=ia*Q.a-Ia*Q.b+Q.tx;ia=ia*Q.c-Ia*Q.d-Q.ty;u?(O.lineTo(La,ia),O.lineTo(va,Ea)):(O.beginPath(),O.moveTo(La,ia),O.lineTo(va,
Ea),u=!0)}function f(ia,Ea,La,va,Ia){var Ja=c(La),Oa=c(va);if(.001>Ia)!k&&u&&(O.stroke(),u=!1);else if(Ja||Oa){var Ba=n.real((ia.value.real+Ea.value.real)/2);T.setvar(V,Ba);var Wa=M(K),fb=c(Wa);if(Ja&&Oa&&fb){var Lb=La.value.real;Oa=Wa.value.real;fb=va.value.real;if(Ja=1>Math.abs(Lb+fb-2*Oa)/m){var kb=n.real((ia.value.real+Ba.value.real)/2);T.setvar(V,kb);kb=M(K);var Aa=n.real((Ba.value.real+Ea.value.real)/2);T.setvar(V,Aa);Aa=M(K);Lb=Math.abs(Lb+Oa-2*kb.value.real)/m;Oa=Math.abs(Oa+fb-2*Aa.value.real)/
m;Ja=Ja&&1>Lb&&1>Oa}Ja?(d(ia,Ba,La,Wa,Ia/2),d(Ba,Ea,Wa,va,Ia/2)):(f(ia,Ba,La,Wa,Ia/2),f(Ba,Ea,Wa,va,Ia/2))}else f(ia,Ba,La,Wa,Ia/2),f(Ba,Ea,Wa,va,Ia/2)}}var k=!1,m=.2/Xd,p=0,u=!1,w=-10,z=10,D=.1,F=1E3,K=a[0];if(null!==a[1]&&"variable"===a[1].ctype)var V=a[1].name;else a=J.plotvars(K),V="#",a.includes("t")&&(V="t"),a.includes("z")&&(V="z"),a.includes("y")&&(V="y"),a.includes("x")&&(V="x");T.newvar(V);var Q=P.drawingstate.matrix;N.handleModifs(b,{color:!0,alpha:!0,size:!0,dashpattern:!0,dashtype:!0,
dashing:!0,lineCap:!0,lineJoin:!0,miterLimit:!0,connect:function(ia){"boolean"===ia.ctype&&(k=ia.value)},start:function(ia){"number"===ia.ctype&&(w=ia.value.real)},stop:function(ia){"number"===ia.ctype&&(z=ia.value.real)},steps:function(ia){"number"===ia.ctype&&(F=ia.value.real)}});O.strokeStyle=N.lineColor;O.lineWidth=N.lsize;u=!1;b=n.real(14.32);T.setvar(V,b);var da=M(K);if("number"!==da.ctype){if(h.isNumberVector(da).value&&2===da.value.length){u=!1;D=(z-w)/F;for(b=w;b<z;b+=D){T.setvar(V,n.real(b));
var W=M(K);if(h.isNumberVector(W).value&&2===W.value.length){var na=+W.value[0].value.real;W=+W.value[1].value.real;a=na*Q.a-W*Q.b+Q.tx;na=na*Q.c-W*Q.d-Q.ty;u?O.lineTo(a,na):(O.beginPath(),O.moveTo(a,na),u=!0)}}O.stroke();T.removevar(V)}return B}for(a=w;a<z+D;a+=D)b=n.real(a),T.setvar(V,b),da=M(K),b.value.real>w&&f(na,b,W,da,D),na=b,W=da;T.removevar(V);u&&O.stroke();return B};y.plotX$1=function(a,b){a=a[0];var c=J.plotvars(a);b="#";c.includes("t")&&(b="t");c.includes("z")&&(b="z");c.includes("y")&&
(b="y");c.includes("x")&&(b="x");T.newvar(b);c=P.drawingstate.matrix;O.fillStyle=P.drawingstate.linecolor;O.lineWidth=1;O.lineCap=N.lineCap;O.lineJoin=N.lineJoin;O.miterLimit=N.miterLimit;for(var d=!1,f=-10;10>f;f+=.01){T.setvar(b,n.real(f));var k=M(a);if("number"===k.ctype){var m=+k.value.real;k=f*c.a-m*c.b+c.tx;m=f*c.c-m*c.d-c.ty;d?O.lineTo(k,m):(O.beginPath(),O.moveTo(k,m),d=!0)}}O.stroke();T.removevar(b);return B};J.plotvars=function(a){function b(p,u){var w={},z;for(z=p.length-1;0<=z;--z)w[p[z]]=
p[z];for(z=u.length-1;0<=z;--z)w[u[z]]=u[z];p=[];for(var D in w)w.hasOwnProperty(D)&&p.push(w[D]);return p}function c(p,u){for(var w=0;w<p.length;w++)p[w]===u&&(p.splice(w,1),w--);return p}var d;if("variable"===a.ctype)return[a.name];if("infix"===a.ctype){var f=J.plotvars(a.args[0]);a=J.plotvars(a.args[1]);return b(f,a)}if("list"===a.ctype){var k=a.value;var m=[];for(d=0;d<k.length;d++)f=J.plotvars(k[d]),m=b(m,f);return m}if("function"===a.ctype){k=a.args;m=[];for(d=0;d<k.length;d++)f=J.plotvars(k[d]),
m=b(m,f);"apply"!==a.oper&&"select"!==a.oper&&"forall"!==a.oper&&"sum"!==a.oper&&"product"!==a.oper&&"repeat"!==a.oper&&"min"!==a.oper&&"max"!==a.oper&&"sort"!==a.oper||"variable"!==a.args[1].ctype||(m=c(m,a.args[1].name));return m}return[]};y.clrscr$0=function(a,b){"undefined"!==typeof hb&&"undefined"!==typeof jb&&O.clearRect(0,0,hb,jb);return B};y.repaint$0=function(a,b){x();return B};y.screenbounds$0=function(a,b){a=A.withUsage(h.realVector(P.to(0,0)),"Point");b=A.withUsage(h.realVector(P.to(mb.clientWidth,
0)),"Point");var c=A.withUsage(h.realVector(P.to(mb.clientWidth,mb.clientHeight)),"Point"),d=A.withUsage(h.realVector(P.to(0,mb.clientHeight)),"Point");return h.turnIntoCSList([a,b,c,d])};y.createimage$3=function(a,b){b=M(a[0]);var c=X(a[1]);a=X(a[2]);if("number"!==c.ctype||"number"!==a.ctype||"string"!==b.ctype)return B;var d=document.createElement("canvas");d.id=b.value;d.width=c.value.real;d.height=a.value.real;d.style.display="none";document.body.appendChild(d);fc[b.value]=ob(d,!1);return B};
y.clearimage$1=function(a,b){a=M(a[0]);if("string"!==a.ctype&&"image"!==a.ctype)return B;a=Wb(a);if(!a)return B;b=a.img;if("undefined"===typeof b||null===b)return B;var c=a.width,d=a.height;b.getContext("2d").clearRect(0,0,c,d);a.generation++;return B};y.canvas$4=function(a,b){var c=X(a[0]),d=X(a[1]);b=M(a[2]);a=a[3];var f=J.extractPoint(c),k=J.extractPoint(d);if(!f.ok||!k.ok||"string"!==b.ctype&&"image"!==b.ctype)return B;b=Wb(b);if(!b||!b.img.getContext)return B;d=b.img;var m=b.width;c=b.height;
var p=k.x-f.x,u=k.y-f.y,w=f.x-u*c/m,z=f.y+p*c/m;u=k.x-u*c/m;p=k.y+p*c/m;k=P.from(f.x,f.y,1);w=P.from(w,z,1);u=P.from(u,p,1);f=k[0]*qb;z=k[1]*qb;p=w[0]*qb;var D=w[1]*qb,F=u[0]*qb,K=u[1]*qb;w=m*(z-D)/((f-p)*(z-K)-(f-F)*(z-D));m=m*(f-p)/((z-D)*(f-F)-(z-K)*(f-p));u=-w*f-m*z;k=(c*(z-K)-c*(z-D))/((f-p)*(z-K)-(f-F)*(z-D));p=(c*(f-F)-c*(f-p))/((z-D)*(f-F)-(z-K)*(f-p));c=c-k*f-p*z;d=d.getContext("2d");f=O;O=d;O.save();O.transform(w,k,m,p,u,c);b.generation++;M(a);O.restore();O=f};y.canvas$5=function(a,b){var c=
X(a[0]),d=X(a[1]),f=X(a[2]);b=M(a[3]);a=a[4];c=J.extractPoint(c);var k=J.extractPoint(d),m=J.extractPoint(f);if(!c.ok||!k.ok||!m.ok||"string"!==b.ctype&&"image"!==b.ctype)return B;b=Wb(b);if(!b||!b.img.getContext)return B;f=b.img;var p=b.width;d=b.height;var u=P.from(c.x,c.y,1),w=P.from(k.x,k.y,1);k=P.from(m.x,m.y,1);c=u[0]*qb;m=u[1]*qb;var z=w[0]*qb,D=w[1]*qb,F=k[0]*qb,K=k[1]*qb;k=((0-p)*(m-K)-0*(m-D))/((c-z)*(m-K)-(c-F)*(m-D));p=((0-p)*(c-F)-0*(c-z))/((m-D)*(c-F)-(m-K)*(c-z));w=-(k*c)-p*m;u=((d-
d)*(m-K)-(d-0)*(m-D))/((c-z)*(m-K)-(c-F)*(m-D));z=((d-d)*(c-F)-(d-0)*(c-z))/((m-D)*(c-F)-(m-K)*(c-z));d=d-u*c-z*m;f=f.getContext("2d");c=O;O=f;O.save();O.transform(k,u,p,z,w,d);b.generation++;M(a);O.restore();O=c};y.screenresolution$0=function(a,b){return n.real(P.drawingstate.matrix.a)};y.layer$1=function(a,b){};y.imagesize$1=function(a,b){a=Wb(X(a[0]));b=function(c){return"number"===typeof c&&Number.isFinite(c)};return void 0!=a&&b(a.width)&&b(a.height)?h.realVector([+a.width,+a.height]):B};y.imageready$1=
function(a,b){a=Wb(X(a[0]));return A.bool(!(!a||!a.ready))};y.drawimage$2=function(a,b){function c(){var u=1,w=1,z=1,D=1,F=0,K=1,V=J.extractPoint(f);if(!V.ok)return B;k=Wb(k);if(!k)return B;O.save();if(void 0!==b.angle){var Q=M(b.angle);"number"===Q.ctype&&(F=Q.value.real)}void 0!==b.rotation&&(Q=M(b.rotation),"number"===Q.ctype&&(F=Q.value.real));void 0!==b.scale&&(Q=X(b.scale),"number"===Q.ctype&&(w=u=Q.value.real),h.isNumberVector(Q).value&&2===Q.value.length&&(u=Q.value[0].value.real,w=Q.value[1].value.real));
void 0!==b.scalex&&(Q=M(b.scalex),"number"===Q.ctype&&(u=Q.value.real));void 0!==b.scaley&&(Q=M(b.scaley),"number"===Q.ctype&&(w=Q.value.real));void 0!==b.flipx&&(Q=M(b.flipx),"boolean"===Q.ctype&&Q.value&&(z=-1));void 0!==b.flipy&&(Q=M(b.flipy),"boolean"===Q.ctype&&Q.value&&(D=-1));void 0!==b.alpha&&(Q=M(b.alpha),"number"===Q.ctype&&(K=Q.value.real));O.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(Q=M(b.interpolate),"boolean"===Q.ctype&&(O.imageSmoothingEnabled=Q.value));var da=P.drawingstate.matrix,
W=P.drawingstate.initialmatrix,na=k.width,ia=k.height;Q=V.x*da.a-V.y*da.b+da.tx;var Ea=V.x*da.c-V.y*da.d-da.ty,La=(V.x+1)*da.a-V.y*da.b+da.tx-Q;da=(V.x+1)*da.c-V.y*da.d-da.ty-Ea;var va=(V.x+1)*W.a-V.y*W.b+W.tx-(V.x*W.a-V.y*W.b+W.tx);W=(V.x+1)*W.c-V.y*W.d-W.ty-(V.x*W.c-V.y*W.d-W.ty);V=Math.sqrt(La*La+da*da)/Math.sqrt(va*va+W*W);La=-Math.atan2(La,da)+Math.atan2(va,W);da=P.drawingstate.matrix.sdet/72;u*=da;w*=da;1!==K&&(O.globalAlpha=K);O.translate(Q,Ea);O.scale(u*z*V,w*D*V);O.rotate(F+La);O.translate(-Q,
-Ea);O.translate(-na/2,-ia/2);u=k;u.drawTo?u.drawTo(O,Q,Ea):O.drawImage(u.img,Q,Ea);O.globalAlpha=1;O.restore()}function d(){var u=1,w=1,z=1,D=1,F=J.extractPoint(f),K=J.extractPoint(m);if(!F.ok||!K.ok)return B;k=Wb(k);if(!k)return B;var V=k.width,Q=k.height;if(0===p){var da={};da.x=F.x-(K.y-F.y);da.y=F.y+(K.x-F.x);D=Q/V}else if(da=J.extractPoint(p),!F.ok)return B;O.save();if(void 0!==b.alpha){var W=M(b.alpha);"number"===W.ctype&&(u=W.value.real)}void 0!==b.aspect&&(W=M(b.aspect),"number"===W.ctype&&
(D=W.value.real));void 0!==b.flipx&&(W=M(b.flipx),"boolean"===W.ctype&&W.value&&(w=-1));void 0!==b.flipy&&(W=M(b.flipy),"boolean"===W.ctype&&W.value&&(z=-1));O.imageSmoothingEnabled=!0;void 0!==b.interpolate&&(W=M(b.interpolate),"boolean"===W.ctype&&(O.imageSmoothingEnabled=W.value));W=P.drawingstate.matrix;1!==u&&(O.globalAlpha=u);u=F.x*W.a-F.y*W.b+W.tx;F=F.x*W.c-F.y*W.d-W.ty;O.transform(K.x*W.a-K.y*W.b+W.tx-u,K.x*W.c-K.y*W.d-W.ty-F,da.x*W.a-da.y*W.b+W.tx-u,da.x*W.c-da.y*W.d-W.ty-F,u,F);O.scale(1/
V,-1/Q*D);O.translate(V/2,-Q/2);O.scale(w,z);O.translate(-V/2,Q/2);O.translate(0,-Q);w=k;w.drawTo?w.drawTo(O,0,0):O.drawImage(w.img,0,0);O.globalAlpha=1;O.restore()}if(2===a.length){var f=X(a[0]);var k=X(a[1]);return c()}if(3===a.length){f=X(a[0]);var m=X(a[1]);var p=0;k=X(a[2]);return d()}return 4===a.length?(f=X(a[0]),m=X(a[1]),p=X(a[2]),k=X(a[3]),d()):B};y.drawimage$3=y.drawimage$2;y.drawimage$4=y.drawimage$2;y.allimages$0=function(){var a=[];Object.keys(fc).forEach(function(b){a.push({ctype:"string",
value:b})});return h.turnIntoCSList(a)};var Cc={};y.cameravideo$0=function(a,b){function c(m){return{video:{width:m,advanced:[{width:{max:m,min:m}},{width:{ideal:m}}]},audio:!1}}a=!0;var d={};void 0!==b.resolution&&(b=M(b.resolution),"string"===b.ctype&&"maximal"===b.value?a=!0:"number"===b.ctype?(a=!1,d=c(b.value.real)):h._helper.isNumberVecN(b,2)&&(a=!1,d=c(b.value[0].value.real),b=b.value[1].value.real,10>b||!Number.isInteger(b)?(d.video.aspectRatio=b,d.video.advanced[0].aspectRatio={min:b,max:b},
d.video.advanced[1].aspectRatio={ideal:b}):(d.video.height=b,d.video.advanced[0].height={min:b,max:b},d.video.advanced[1].height={ideal:b})));a&&(d=[320,640,1024,1280,1920,2560],d=d.map(function(m){return{width:{min:m}}}),d={video:{width:16E3,height:9E3,advanced:d},audio:!1});a=JSON.stringify(d);if(Cc[a])return Cc[a];b=null;var f=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia;f?b=function(m,p){navigator.mediaDevices.getUserMedia(d).then(m,p)}:(f=navigator.getUserMedia||navigator.webkitGetUserMedia||
navigator.mozGetUserMedia||navigator.msGetUserMedia)&&(b=function(m,p){f.call(navigator,d,m,p)});if(!b)return console.warn("getUserMedia call not supported"),Cc[a]=B;var k=document.createElement("video");k.autoplay=!0;Cc[a]=ob(k,!0);console.log("Opening stream.");b(function(m){k.srcObject=m;k.setAttribute("autoplay","");k.setAttribute("muted","");k.setAttribute("playsinline","");k.play();k.addEventListener("loadeddata",Ha)},function(m){console.error("Could not get user video:",String(m),m)});return Cc[a]};
y.playvideo$1=function(a,b){a=Wb(X(a[0]));a.live&&a.img.play&&a.img.play();return B};y.pausevideo$1=function(a,b){a=Wb(X(a[0]));a.live&&a.img.pause&&a.img.pause();return B};var ad;y.imagergba$3=function(a,b){b=Wb(X(a[0]));var c=X(a[1]);a=X(a[2]);if(!b||"number"!==c.ctype||"number"!==a.ctype||!b.ready)return B;c=Math.round(c.value.real);a=Math.round(a.value.real);if(!Xb(c)||!Xb(a))return B;a=Oc(b,c,a,1,1);return h.realVector([255*a[0],255*a[1],255*a[2],a[3]])};y.imagergb$3=y.imagergba$3;y.imagergba$4=
function(a,b){var c=Wb(X(a[2]));if(!c||!c.ready)return B;var d=c.width,f=c.height,k=Ca(a[0]),m=Ca(a[1]),p=Ca(h.realVector([0,f,1]));d=Ca(h.realVector([d,f,1]));if(k===B||m===B||u===B)return B;u=h.ii;f=h.jj;p=J.basismap(p,d,u,f);k=J.basismap(k,m,f,u);var u=Ca(a[3]);f=J.extractPoint(A.mult(p,A.mult(h.adjoint3(k),u)));if(f.ok)if(a=c.width,k=c.height,m=!0,p=!1,void 0!==b.interpolate&&(u=M(b.interpolate),"boolean"===u.ctype&&(m=u.value)),void 0!==b.repeat&&(u=M(b.repeat),"boolean"===u.ctype&&(p=u.value)),
m&&(f.x-=.5,f.y-=.5),p&&(f.x=(f.x%a+a)%a,f.y=(f.y%k+k)%k),u=Math.floor(f.x),d=Math.floor(f.y),Xb(u)&&Xb(d)){b=[0,0,0,0];if(m){m=f.x-u;f=f.y-d;var w=Oc(c,u,d,2,2);if(p){if(u===a-1||d===k-1){p=Oc(c,(u+1)%a,d,1,1);var z=Oc(c,u,(d+1)%k,1,1);c=Oc(c,(u+1)%a,(d+1)%k,1,1);w=w.slice(0,4).concat(p,z,c)}}else{if(-1===u||u===a-1)m=Math.round(m);if(-1===d||d===k-1)f=Math.round(f)}for(c=0;4>c;c++)b[c]=(1-f)*((1-m)*w[c]+m*w[c+4])+f*((1-m)*w[c+8]+m*w[c+12])}else b=Oc(c,u,d,1,1);c=h.realVector(b)}else c=B;else c=
B;return c};y.imagergb$4=function(a,b){a=y.imagergba$4(a,b);return a===B?B:h.turnIntoCSList(a.value.slice(0,3))};y.readpixels$1=function(a,b){a=Wb(X(a[0]));a=Oc(a,0,0,a.width,a.height);b=[];for(var c=0;c+3<a.length;c+=4)b.push(h.turnIntoCSList([n.real(a[c+0]),n.real(a[c+1]),n.real(a[c+2]),n.real(a[c+3])]));return h.turnIntoCSList(b)};"use strict";var pf=[{key:[":"],field:["."],deg:["\u00b0"],take:["_"]},{functionCall:!0},{rassoc:!0,pow:["^"],sqrt:["\u221a"]},{mul:["*","\u2062","\u22c5","\u00b7"],
cross:["\u00d7"],div:["/","\u00f7","\u2215","\u2236"]},{add:["+"],sub:["-","\u2212"],neg:["!","\u00ac"]},{seq:[".."]},{eq:["==","\u225f"],ne:["!=","<>","\u2260"],lt:["<"],gt:[">"],le:["<=","\u2264","\u2266"],ge:[">=","\u2265","\u2267"],aeq:["~=","\u2248"],ane:["~!=","\u2249"],alt:["~<","\u2a89"],agt:["~>","\u2a8a"],ale:["~<=","\u2a85"],age:["~>=","\u2a86"],in:["\u2208"],nin:["\u2209"]},{and:["&","\u2227"],or:["%","\u2228"]},{rassoc:!0,prepend:["<:"]},{concat:["++","\u222a"],remove:["--","\u2216"],
common:["~~","\u2229"],append:[":>"]},{rassoc:!0,assign:["="],define:[":="],undefine:[":=_"],bdefine:["::="]},{seq:[";"]},{modif:["->","\u2192"]},{rassoc:!0,list:[","]}],of=["+","-"],ra=["!","\u221a"],xa=["\u00b0",":=_"],ua=[";",","],Ya=[],Pa={},Da;(function(){var a=0;pf.forEach(function(b){a+=2;var c=!!b.rassoc;b.functionCall&&(Da=a);for(var d in b){var f=b[d];if("boolean"!==typeof f){var k={name:d,sym:f[0],symbols:f,rassoc:c,precedence:a,prefix:!1,postfix:!1,infix:!0,bare:!1};f=$jscomp.makeIterator(f);
for(var m=f.next();!m.done;m=f.next()){m=m.value;if(Pa.hasOwnProperty(m))throw Error("Duplicate operator: "+m);Pa[m]=k;Ya.push(m)}}}});of.forEach(function(b){Pa[b].prefix=!0});ra.forEach(function(b){Pa[b].prefix=!0;Pa[b].infix=!1});xa.forEach(function(b){Pa[b].postfix=!0;Pa[b].infix=!1});ua.forEach(function(b){Pa[b].prefix=!0;Pa[b].postfix=!0;Pa[b].infix=!0;Pa[b].bare=!0})})();Ya.sort(function(a,b){return b.length-a.length});var ec="(?:[\u207a\u207b] )?[\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079](?: [\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079])*".replace(/ /g,
"[ \t]*"),Lc="(?:[\u208a\u208b] )?[\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089](?: [\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089])*".replace(/ /g,"[ \t]*"),Tc=function(a,b,c){var d,f=0,k="(?:[",m=b.length;for(d=0;d<m;++d){var p=b.charCodeAt(d);55296<=p?(k+="]|"+b.charAt(d)+"[",f=56320):(k+=String.fromCharCode(p=f=a[p-32]+f),f+=a[b.charCodeAt(++d)-32],f!==p&&(f!==p+1&&(k+="-"),k+=String.fromCharCode(f)))}return k+"]|["+c+"][\udc00-\udfff])"}([2,0,106,3,4,1,6,5,7,11,
17,8,12,21,9,22,30,10,15,24,25,16,13,42,46,14,18,19,29,37,27,28,35,26,32,36,40,43,47,53,20,48,50,56,33,34,39,51,52,55,63,64,65,68,85,23,31,38,45,49,105,59,66,69,72,88,102,114,117,128,157,191,41,44,54,60,67,70,71,73,74,75,76,80,81,82,83,84,86,87,89,93,94,98,99,107,108,116,122,130,132,134,138,160,165,185,195,196,255,268,277,310,332,339,362,365,390,449,457,470,512,513,541,568,582,619,673,726,768,820,921,991,1164,2684,6581,8453,11171,20949],"T4(4I!)!'!&/ 0 \u0096')2$+! !\u0083$ %## !(!   ! ; u \u0086.\u0088 =#!+YoA& 87C% } !5%+%) #!*! <0a,!4B1%'!&-'!1!$!33`HsG$!;!+.52'(#%#- & !$#$!*!9%  2%H''%#- & % % %B# !H *+   - & % $$!;!5%3!,(#%#- & % $$!X%  5!:! '$  #$% ! %$%$ $)W!G(   / 2$!> &%C(   / . $$!L! %5%;(   D#!*!* 4'&*$W + !#&]F %6&]% !#% !#!(# &   ! !#% # %1!#$ !/#L!S( @?$\u00817-!*''#$!$%+ ',6!:= !&!#7 \u0090 ##& ! ##D ##B ##& ! ##9 K ##^Y2*V#'$\u009d#5 4&p((+, #2*2*2,  5OC!'!Uy.D !&_)0J<#$,E'4Q/1Pv!|8:&K<9%)E>@7 )@\u0080# #$%1gT\u008e#'#=#'#( ! ! ! 0#P & !$  &$##'',&  &d!9!*,b!'!#. !$$(! ! ! # 1##&$'!G%\u00a58 8 \u0084(#$%6= !&!#Q+!*/1& & & & & & & &t!\u0097%E$&%'V(  z #&D${:Aj2\u0099\u00a6q\u00a9E\u00a4UZ#\u008d$2)%-8*0#_J+#b#M#(S1   # /0O2[R'$! !6>)/A?+8<!*$ .)$ D3  (-/$!$[ !$%#$#! !4 #1+ 6'#'#'1& & 7 .)c0\u00a86/'I\u00a7\u0093#\\N&6$&! . , $ ! % % \u007fM\u0092;R#Gh)d$ \u0085=4(4,a$'#'#'# \ud800!) 4 : % 9#6@\u0082\u0094?$IIX*5 ((=)<#@'(\ud801!f~N.Of\u008f1-)(\ud802!'#! E %$!#/)/10^: %)-)4nQ(%T!5#   AZ?$?C( >?G)-):9*\ud803!`KJ9J\ud804#PriL3>@7M$!6F2#/! !C* 3V& ! # 9 .+8N(#%#- & % $$!;!6$\ud805eF-% !\u008987#=F-!k7x4\ud806\u0087RB!\u0095K\ud808!\u00a2\ud809e\u008a\ud80d!8\ud811!\u009c\ud81a!\u009b+0c<;F*#BH&:\ud81b\u00a0U,!l,\ud82c!%\ud82f!\"&,$++.\ud835!w m %#!#%## ) ! & S ##( & > # $ !$& \u0091#3 3 0 3 0 3 0 3 0 3 (\ud83a!\u008b\ud83b\u0098# A % !#! . # ! !(!'! ! !   % !#! ! ! ! ! % !## & # # ! . 5&  $ 5\ud869!\u009f7\u008c\ud86d!\u00a1,g\ud86e!<#\u00a3\ud873!\u009e\ud87e!\u009a",
"\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872"),kd=("#(?: [1-9])?|(?:'|"+Tc+")(?: (?:[0-9']|"+Tc+"))*").replace(/ /g,"[ \t]*"),re=["([ \t\n\r]+)|(//.*)|(/\\*)","("+("(?:[0-9](?: [0-9])*(?: \\.(?! \\.)(?:(?! "+kd+")|(?= (?: [Ee](?: [+-])?(?: [0-9])+)))(?: [0-9])*)?|\\.(?: [0-9])+)(?: [Ee](?: [+-])?(?: [0-9])+)?").replace(/ /g,"[ \t]*")+")","("+Ya.map(he).join("|")+")","("+"[](){}||".split("").map(he).join("|")+")","("+Lc+")","("+ec+")","("+kd+")",'("[^"]*")|($)'].join("|"),qf=new RegExp("[ \t]*".replace(/\*$/,
"+"),"g"),se="ANY WS COMMENT START_COMMENT NUM OP BRA SUB SUP ID STR EOF".split(" ");(function(){var a=(new RegExp(re,"g")).exec("");if(a.hasOwnProperty(se.length))throw Error("RE has more groups than expected");if(!a.hasOwnProperty(se.length-1))throw Error("RE has fewer groups than expected");})();Pc.prototype.advanceBy=function(a){this.advanceTo(this.pos+a)};Pc.prototype.advanceTo=function(a){for(this.pos=a;this.bols[0]<=a;)this.bol=this.bols.shift(),this.line++};Pc.prototype.curPos=function(){return{row:this.line,
col:this.pos-this.bol,pos:this.pos}};Pc.prototype.nextInternal=function(){var a=this.re.exec(this.input);if(a.index!==this.pos)throw wb("Invalid token",this.curPos(),this.input.substring(this.pos,a.index));var b=this.curPos();this.advanceBy(a[0].length);var c=this.curPos(),d;for(d=1;null==a[d];++d);return{start:b,end:c,raw:a[0],text:a[0].replace(qf,""),toktype:se[d]}};Pc.prototype.next=function(){do{var a=this.nextInternal();if("START_COMMENT"===a.toktype){var b=/\*\/|\/\*/g;b.lastIndex=a.start.pos+
2;for(var c=1,d;0<c;)if(d=b.exec(this.input))"/*"===d[0]?++c:--c;else throw wb("Unterminated comment",a.start,a.text);this.re.lastIndex=b.lastIndex;this.advanceTo(b.lastIndex);a.end=this.curPos();a.raw=this.input.substring(a.start.pos,a.end.pos);a.text=a.raw;a.toktype="COMMENT"}}while("WS"===a.toktype||"COMMENT"===a.toktype);return a};var qe={ctype:"void"};Hc.prototype.postprocess=function(a){if(null===a)return qe;if(a){if("infix"===a.ctype)if(":="===a.oper){var b=a.args[0];"function"===b.ctype&&
b.args.forEach(function(d){if(null===d||"variable"!==d.ctype)throw wb("Function argument must be an identifier",d.start||a.start);})}else if(","===a.oper)throw wb("comma may only be used to delimit list elements",a.start);a.args&&(a.args=a.args.map(this.postprocess,this));if(a.modifs)for(var c in a.modifs)a.modifs[c]=this.postprocess(a.modifs[c]);if("paren"===a.ctype)return a.args[0];if("infix"===a.ctype){if("."===a.oper){if(!a.args[1]||"variable"!==a.args[1].ctype)throw wb("Field name must be identifier",
a.start,a.text);a.ctype="field";a.obj=a.args[0];a.key=a.args[1].name;delete a.args}if(":"===a.oper){if(a.jsonatom){if(!a.args[1])throw wb("JSON: Value undefined",a.start,a.text);a.ctype="jsonatom";a.key=a.args[0];a.value=a.args[1];delete a.jsonatom}else{if(!a.args[1])throw wb("UserData: Key undefined",a.start,a.text);a.ctype="userdata";a.obj=a.args[0];a.key=a.args[1]}delete a.args}this.infixmap&&(a.impl=this.infixmap[a.oper])}else"variable"===a.ctype?this.usedVariables[a.name]=!0:"function"===a.ctype&&
(this.usedFunctions[a.oper]=!0)}if("infix"===a.ctype)return{ctype:"infix",oper:String(a.oper),args:[a.args[0],a.args[1]],impl:a.impl};if("variable"===a.ctype)return{ctype:"variable",name:String(a.name)};if("number"===a.ctype)return{ctype:"number",value:{real:+a.value.real,imag:+a.value.imag}};if("string"===a.ctype)return{ctype:"string",value:String(a.value)};if("list"===a.ctype)return{ctype:"list",value:a.value};if("function"===a.ctype)return{ctype:"function",oper:String(a.oper),args:a.args,modifs:a.modifs};
if("field"===a.ctype)return{ctype:"field",obj:a.obj,key:String(a.key)};if("userdata"===a.ctype)return{ctype:"userdata",obj:a.obj,key:a.key};if("jsonatom"===a.ctype)return{ctype:"jsonatom",key:a.key,value:a.value};throw Error("Unsupported AST node of type "+a.ctype);};Hc.prototype.parse=function(a){try{var b=Ce(new Pc(a));if("EOF"!==b.closedBy.toktype)throw wb("Closing bracket never opened.",b.closedBy.start,b.closedBy.text);return this.postprocess(b.expr)}catch(c){return c.ctype="error",c}};"undefined"!==
typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports.Parser=Hc,module.exports.Tokenizer=Pc,module.exports.unicodeLetters=Tc,module.exports.parse=function(a){return(new Hc).parse(a)});var Uc={},xe=[],ta={lines:{},audioCtx:null,getAudioContext:function(){if(this.audioCtx)return this.audioCtx;window.AudioContext||window.webkitAudioContext?this.audioCtx=new (window.AudioContext||window.webkitAudioContext):console.warn("Web Audio API not supported in this browser");
return this.audioCtx},handleModif:function(a,b,c){if(void 0!==a){if(a=M(a),a.ctype===b){if("number"===a.ctype)return a.value.real;if("list"===a.ctype){b=a.value;a=[];for(c=0;c<b.length;c++)a[c]=b[c].value.real;return a}return a.value}}else return c},handleLineModif:function(a,b){return void 0!==a?(a=M(a),qa(a)):b},getBufferNode:function(a,b){var c=this.getAudioContext();if(b*c.sampleRate>a.length){for(var d=[],f=0,k=0;f<c.sampleRate*b;f++,k++)k>a.length&&(k=0),d[f]=a[k];a=d}b=new Float32Array(a);
a=c.createBuffer(1,b.length,c.sampleRate);a.copyToChannel(b,0);c=c.createBufferSource();c.buffer=a;return c},createMonoOscillator:function(a,b){var c=this.getAudioContext().createOscillator();if(0!==b){var d=new Float32Array(2),f=new Float32Array(2);d[1]=Math.sin(b);f[1]=Math.cos(b);b=this.getAudioContext().createPeriodicWave(d,f,{disableNormalization:!0});c.setPeriodicWave(b)}else c.type="sine";c.mono=!0;c.frequency.setValueAtTime(a,this.audioCtx.currentTime);return c},createWaveOscillator:function(a,
b,c){for(var d=this.getAudioContext().createOscillator(),f=new Float32Array(b.length+1),k=new Float32Array(b.length+1),m=0;m<b.length;m++)k[m+1]=b[m]*Math.cos(c[m]),f[m+1]=b[m]*Math.sin(c[m]);b=this.getAudioContext().createPeriodicWave(f,k,{disableNormalization:!0});d.setPeriodicWave(b);d.frequency.setValueAtTime(a,this.audioCtx.currentTime);return d},cleanup:function(){for(var a in this.lines)if("sin"===this.lines[a].lineType)if(this.lines[a].oscNodes.every(function(c){return!c.oscNode.isplaying}))delete this.lines[a];
else for(var b=0;b<this.lines[a].oscNodes.length;b++)this.lines[a].oscNodes[b]&&!this.lines[a].oscNodes[b].oscNode.isplaying&&delete this.lines[a].oscNodes[b]},registerInput:function(a){a.cnt?a.cnt++:a.cnt=1},deregisterInput:function(a){a.cnt&&a.cnt--},hasRegisteredInput:function(a){return a.cnt&&0!==a.cnt},playOscillator:function(a,b,c,d,f,k){var m=this.getAudioContext(),p=m.createGain();p.gain.setValueAtTime(0,m.currentTime);a.connect(p);p.connect(b);ta.registerInput(b);a.start(0);a.isplaying=!0;
a.onended=function(){this.isplaying=!1;p.disconnect();ta.deregisterInput(b);ta.hasRegisteredInput(b)||(b.disconnect(),b.panNode&&b.panNode.disconnect());ta.cleanup()};p.gain.linearRampToValueAtTime(c,m.currentTime+d);0<=f&&(p.gain.setValueAtTime(c,m.currentTime+d+f),p.gain.linearRampToValueAtTime(0,m.currentTime+d+f+k),this.triggerStop(a,f+d+k));return{oscNode:a,gainNode:p}},softStop:function(a,b){var c=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(c.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,
c.currentTime);a.gainNode.gain.linearRampToValueAtTime(0,c.currentTime+b);this.triggerStop(a.oscNode,b)},extendDuration:function(a,b,c){var d=this.getAudioContext();a.gainNode.gain.cancelScheduledValues(d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime);a.gainNode.gain.setValueAtTime(a.gainNode.gain.value,d.currentTime+b);a.gainNode.gain.linearRampToValueAtTime(0,d.currentTime+b+c);this.triggerStop(a.oscNode,b+c)},triggerStop:function(a,b){a.timeoutId&&clearTimeout(a.timeoutId);
a.timeoutId=setTimeout(function(){a.stop(0)},1E3*b+10)}},xc=function(a){this.audioCtx=a;this.lineType="sin";this.oscNodes=[]};xc.prototype.handleModif=function(a,b,c,d){if("phaseshift"===b)d=this.handlePhaseshiftModif(a.phaseshift,this.harmonics.length);else if(void 0!==a[b]&&(a=M(a[b]),a.ctype===c))if("number"===a.ctype)d=a.value.real;else if("list"===a.ctype){c=a.value;a=[];for(d=0;d<c.length;d++)a[d]=c[d].value.real;d=a}else d=a.value;return this[b]=d};xc.prototype.handlePhaseshiftModif=function(a,
b){this.phaseshift=Array(b).fill(0);if(void 0!==a)if(a=M(a),"list"===a.ctype)for(b=a.value,a=0;a<b.length;a++)this.phaseshift[a]=b[a].value.real;else if("number"===a.ctype)for(var c=0;c<b;c++)this.phaseshift[c]=(c+1)*a.value.real;return this.phaseshift};xc.prototype.cleanparameters=function(a){this.partials.length<this.harmonics.length&&(this.partials=Array(this.harmonics.length).fill(1),a.partials&&console.warn("Ignore partials because the given length does not match with the length of harmonics"));
this.phaseshift.length<this.harmonics.length&&(this.phaseshift=Array(this.harmonics.length).fill(0),a.phaseshift&&console.warn("Ignore phaseshift because the given length does not match with the length of harmonics"));this.precompute&=this.partials.every(function(b){return 1E-8>Math.abs(b-1)});0<this.damp&&(this.duration=Math.min(this.duration,6/this.damp))};xc.prototype.panit=function(){0===this.pan||this.masterGain.panNode||(this.masterGain.disconnect(this.audioCtx.destination),this.masterGain.panNode=
this.audioCtx.createStereoPanner(),this.masterGain.connect(this.masterGain.panNode),this.masterGain.panNode.connect(this.audioCtx.destination));this.masterGain.panNode&&this.masterGain.panNode.pan.setValueAtTime(this.pan,this.audioCtx.currentTime)};xc.prototype.dampit=function(){this.masterGain.gain.cancelScheduledValues(this.audioCtx.currentTime);this.masterGain.gain.setValueAtTime(this.masterGain.gain.value,this.audioCtx.currentTime);0<this.damp?this.masterGain.gain.setTargetAtTime(0,this.audioCtx.currentTime+
this.attack,1/this.damp):0>this.damp&&this.masterGain.gain.setTargetAtTime(1,this.audioCtx.currentTime+this.attack,-this.damp)};xc.prototype.startOscillators=function(){if(this.precompute)this.oscNodes[0]=ta.playOscillator(ta.createWaveOscillator(this.freq,this.harmonics,this.phaseshift),this.masterGain,1,this.attack,this.duration,this.release);else for(var a=0;a<this.harmonics.length;a++)this.oscNodes[a]=ta.playOscillator(ta.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),
this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)};xc.prototype.stopOscillators=function(){for(var a in this.oscNodes)ta.softStop(this.oscNodes[a],this.release),delete this.oscNodes[a]};xc.prototype.stop=function(){this.stopOscillators()};xc.prototype.updateFrequencyAndGain=function(){if(this.precompute)this.harmonicsdidnotchange()&&this.oscNodes[0]&&this.oscNodes[0].oscNode.isplaying&&!this.oscNodes[0].oscNode.mono?(this.oscNodes[0].oscNode.frequency.setValueAtTime(this.freq,
this.audioCtx.currentTime),ta.extendDuration(this.oscNodes[0],this.duration,this.release)):(this.stopOscillators(),this.startOscillators());else{for(var a=0;a<this.harmonics.length;a++)0<this.harmonics[a]&&(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&this.oscNodes[a].oscNode.mono?(this.oscNodes[a].oscNode.frequency.setValueAtTime(this.partials[a]*(a+1)*this.freq,this.audioCtx.currentTime),this.oscNodes[a].gainNode.gain.setValueAtTime(this.harmonics[a],this.audioCtx.currentTime),ta.extendDuration(this.oscNodes[a],
this.duration,this.release)):(this.oscNodes[a]&&this.oscNodes[a].oscNode.isplaying&&!this.oscNodes[a].oscNode.mono&&ta.softStop(this.oscNodes[a],this.release),this.oscNodes[a]=ta.playOscillator(ta.createMonoOscillator(this.partials[a]*(a+1)*this.freq,this.phaseshift[a]),this.masterGain,this.harmonics[a],this.attack,this.duration,this.release)));for(var b in this.oscNodes)this.harmonics[b]||(ta.softStop(this.oscNodes[b],this.release),delete this.oscNodes[b])}};xc.prototype.generateNewMasterGain=function(a){this.masterGain=
this.audioCtx.createGain();this.masterGain.connect(this.audioCtx.destination);this.masterGain.gain.setValueAtTime(a,this.audioCtx.currentTime)};xc.prototype.harmonicsdidnotchange=function(){if(this.lastharmonics){var a=1&this.lastharmonics.length===this.harmonics.length;for(var b in this.harmonics)a&&(a&=this.harmonics[b]===this.lastharmonics[b])}else a=!1;return a};xc.prototype.evokeplaysin=function(a,b,c){this.cleanparameters(c);if(0===this.duration)return this.stop(),B;a||b&&0!==this.damp?(b&&
!a&&this.stopOscillators(),this.generateNewMasterGain(this.amp),this.startOscillators()):(this.masterGain||this.generateNewMasterGain(this.amp),this.updateFrequencyAndGain());this.panit();this.dampit();this.lastharmonics=this.harmonics};y.stopsound$0=function(){if(ta.audioCtx){for(var a in ta.lines)ta.lines[a].stop(),delete ta.lines[a];ta.audioCtx.close();ta.audioCtx=null}};y.playsin$1=function(a,b){var c=ta.getAudioContext(),d=ta.handleLineModif(b.line,"0"),f=!1;ta.lines[d]&&"sin"===ta.lines[d].lineType||
(ta.lines[d]&&ta.lines[d].stop(),ta.lines[d]=new xc(c),f=!0);c=ta.lines[d];c.freq=M(a[0]).value.real;c.handleModif(b,"amp","number",.5);c.handleModif(b,"damp","number",0);c.handleModif(b,"duration","number",ta.handleModif(b.stop,"number",1));c.handleModif(b,"harmonics","list",[1]);c.handleModif(b,"partials","list",[1]);c.handleModif(b,"attack","number",.01);c.handleModif(b,"release","number",.01);c.handleModif(b,"pan","number",0);c.handleModif(b,"precompute","boolean",!1);c.handleModif(b,"phaseshift",
"phaseshift",Array(c.harmonics.length).fill(0));a=ta.handleModif(b.restart,"boolean",!0);c.evokeplaysin(f,a,b);return B};y.playsin$0=function(a,b){if(void 0!==b.line&&(a=ta.handleLineModif(b.line,"0"),a=ta.lines[a])){a.handleModif(b,"freq","number",a.freq);a.handleModif(b,"amp","number",a.amp);a.handleModif(b,"damp","number",a.damp);a.handleModif(b,"duration","number",ta.handleModif(b.stop,"number",a.duration));a.handleModif(b,"harmonics","list",a.harmonics);a.handleModif(b,"partials","list",a.partials);
a.handleModif(b,"attack","number",a.attack);a.handleModif(b,"release","number",a.release);a.handleModif(b,"pan","number",a.pan);a.handleModif(b,"precompute","boolean",a.precompute);a.handleModif(b,"phaseshift","phaseshift",a.phaseshift);var c=ta.handleModif(b.restart,"boolean",!1);a.evokeplaysin(!1,c,b)}return B};y.playfunction$1=function(a,b){var c=ta.getAudioContext(),d=a[0];a=function(Q){var da=[];for(da.push(Q);0!==da.length;){Q=da.pop();if("variable"===Q.ctype&&M(Q)===B&&["x","y","t"].includes(Q.name))return Q.name;
if(Q.args)for(var W in Q.args)da.push(Q.args[W])}return B}(d);a!==B&&T.newvar(a);var f=ta.handleLineModif(b.line,"0"),k=ta.handleModif(b.start,"number",0),m=ta.handleModif(b.amp,"number",.5),p=ta.handleModif(b.damp,"number",0);ta.handleModif(b.stop,"number",1);var u=ta.handleModif(b.duration,"number",1),w=ta.handleModif(b.attack,"number",.01),z=ta.handleModif(b.release,"number",.01),D=ta.handleModif(b.export,"boolean",!1),F=ta.handleModif(b.silent,"boolean",!1);b=[];for(var K=0;K<c.sampleRate*u;K++){a!==
B&&T.setvar(a,n.real(K/c.sampleRate));var V=M(d);b[K]=V.value.real*m*Math.exp(-p*K/c.sampleRate)}F||(ta.lines[f]&&"function"===ta.lines[f].lineType?(d=ta.lines[f],d.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+z),d.bufferNode.stop(c.currentTime+z),d.bufferNode=ta.getBufferNode(b,u),d.bufferNode.connect(d.masterGain),d.bufferNode.start(k+z),d.masterGain.gain.linearRampToValueAtTime(m,c.currentTime+z+w)):(ta.lines[f]&&ta.lines[f].stop(),ta.lines[f]={lineType:"function",bufferNode:ta.getBufferNode(b,
u),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},u=ta.lines[f],u.masterGain.gain.setValueAtTime(0,c.currentTime),u.masterGain.connect(c.destination),u.bufferNode.connect(u.masterGain),u.bufferNode.start(k),u.masterGain.gain.linearRampToValueAtTime(m,c.currentTime+w)));a!==B&&T.removevar(a);return D?b:B};y.playwave$1=function(a,b){var c=ta.getAudioContext(),d=M(a[0]),f=ta.handleLineModif(b.line,"0");a=ta.handleModif(b.amp,"number",.5);ta.handleModif(b.damp,"number",0);var k=ta.handleModif(b.duration,
"number",1),m=ta.handleModif(b.attack,"number",.01),p=ta.handleModif(b.release,"number",.01);b=ta.handleModif(b.start,"number",0);if("list"!==d.ctype)return B;ta.lines[f]&&"wave"===ta.lines[f].lineType?(f=ta.lines[f],f.masterGain.gain.linearRampToValueAtTime(0,c.currentTime+p),f.bufferNode.stop(c.currentTime+p),f.bufferNode=ta.getBufferNode(A.unwrap(d),k),f.bufferNode.connect(f.masterGain),f.bufferNode.start(b+p),f.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+p+m)):(ta.lines[f]&&ta.lines[f].stop(),
ta.lines[f]={lineType:"wave",bufferNode:ta.getBufferNode(A.unwrap(d),k),masterGain:c.createGain(),stop:function(){this.bufferNode.stop()}},d=ta.lines[f],d.masterGain.gain.setValueAtTime(0,c.currentTime),d.masterGain.connect(c.destination),d.bufferNode.connect(d.masterGain),d.bufferNode.start(0),d.masterGain.gain.linearRampToValueAtTime(a,c.currentTime+m));return B};var Ua={printArr:function(a){for(var b=a.value.length,c=[],d=[],f=!1,k=0;k<b;k++)c[k]=a.value[k].value.real,d[k]=a.value[k].value.imag,
0!==d[k]&&(f=!0);console.log(c);f&&console.log(d)},zero:function(a){for(var b=[],c=n.real(0),d=0;d<a.value.real;d++)b[d]=c;return h.turnIntoCSList(b)},number:function(a,b){b=Ua.zero(b);b.value[0]=a;return b},variable:function(a,b){b=Ua.zero(b);b.value[0]=a;b.value[1]=n.real(1);return b},add:function(a,b){return h.add(a,b)},sub:function(a,b){return h.sub(a,b)},mult:function(a,b){if(a.value.length!==b.value.length)return console.error("dims don't fit return nada"),B;for(var c=a.value.length,d=Ua.zero(n.real(c)),
f=n.real(0),k=0;k<c;k++){for(var m=0;m<=k;m++)f=n.add(f,n.mult(a.value[m],b.value[k-m]));d.value[k]=f;f=n.real(0)}return d},pow:function(a,b){if(0>b.value.real||b.value.real!==Math.floor(b.value.real))return Ua.root(a,b);for(var c=a,d=1;d<b.value.real;d++)c=Ua.mult(c,a);return c},root:function(a,b){var c=n.real(0),d=n.real(1),f=n.add(d,b),k=a.value.length,m=Ua.zero(n.real(k));m.value[0]=n.pow(a.value[0],b);var p=c;for(b=1;b<k;b++){var u=n.real(b);for(var w=1;w<=b;w++){var z=n.mult(f,n.real(w));z=
n.div(z,u);z=n.sub(z,d);z=n.mult(z,a.value[w]);z=n.mult(z,m.value[b-w]);p=n.add(p,z)}p=n.div(p,a.value[0]);m.value[b]=p;p=c}return m},findFirstNoneZero:function(a,b,c){for(var d=Infinity,f=Infinity,k=c;k<a.value.length;k++)if(1E-12<n.abs2(a.value[k]).value.real){d=k;break}for(a=c;a<b.value.length;a++)if(1E-12<n.abs2(b.value[a]).value.real){f=a;break}return[d,f]},div:function(a,b){if(a.value.length!==b.value.length)return console.log("dims don't fit - return nada"),B;for(var c=a.value.length,d=n.real(0),
f=Ua.zero(n.real(c)),k=d,m,p=0;p<c;p++){m=Ua.findFirstNoneZero(a,b,p);p<m[0]&&m[0]===m[1]&&Infinity!==m[0]&&(a.value.splice(p,m[0]),b.value.splice(p,m[0]),f.value.splice(p,m[0]),c-=m[0]);m=a.value[p];for(var u=0;u<p;u++)k=n.add(k,n.mult(f.value[u],b.value[p-u]));m=n.sub(m,k);m=n.div(m,b.value[0]);f.value[p]=m;k=d}return f},exp:function(a){var b=n.real(0),c=a.value.length,d=Ua.zero(n.real(c)),f=b;d.value[0]=n.exp(a.value[0]);for(var k=1;k<c;k++){for(var m=1;m<=k;m++){var p=n.mult(n.real(m),a.value[m]);
p=n.mult(p,d.value[k-m]);f=n.add(f,p)}d.value[k]=n.div(f,n.real(k));f=b}return d},log:function(a){var b=n.real(0),c=a.value.length,d=Ua.zero(n.real(c));d.value[0]=n.log(a.value[0]);for(var f=b,k,m,p=1;p<c;p++){k=a.value[p];for(var u=1;u<p;u++)m=n.mult(n.real(u),d.value[u]),m=n.mult(m,a.value[p-u]),f=n.add(f,m);f=n.div(f,n.real(p));k=n.sub(k,f);k=n.div(k,a.value[0]);d.value[p]=k;f=b}return d},sincos:function(a){var b=n.real(0),c=a.value.length,d=Ua.zero(n.real(c)),f=Ua.zero(n.real(c));d.value[0]=n.sin(a.value[0]);
f.value[0]=n.cos(a.value[0]);for(var k=b,m=b,p,u,w,z=1;z<c;z++){w=n.real(z);for(var D=1;D<=z;D++)u=n.mult(n.real(D),a.value[D]),p=n.mult(u,f.value[z-D]),u=n.mult(u,d.value[z-D]),m=n.add(m,p),k=n.add(k,u);m=n.div(m,w);k=n.div(k,n.neg(w));d.value[z]=m;f.value[z]=k;k=m=b}Ua.sinsave=d;Ua.cossave=f;return[d,f]},sin:function(a){return Ua.sincos(a)[0]},cos:function(a){return Ua.sincos(a)[1]},faculty:function(a){var b=[];b[0]=n.real(1);for(var c=1,d=1;d<=a.value.real;d++)c*=d,b[d]=n.real(c);return b=h.turnIntoCSList(b)},
diff:function(a,b,c,d){if("variable"===a.ctype)var f=a.name!==b?Ua.number(M(a),d):Ua.variable(c,d);else if("number"===a.ctype)f=Ua.number(a,d);else{if("infix"===a.ctype){if("*"===a.oper)return Ua.mult(Ua.diff(a.args[0],b,c,d),Ua.diff(a.args[1],b,c,d));if("^"===a.oper)return Ua.pow(Ua.diff(a.args[0],b,c,d),Ua.diff(a.args[1],b,c,d).value[0]);if("/"===a.oper)return Ua.div(Ua.diff(a.args[0],b,c,d),Ua.diff(a.args[1],b,c,d));if("+"===a.oper)return Ua.add(Ua.diff(a.args[0],b,c,d),Ua.diff(a.args[1],b,c,d));
if("-"===a.oper)return Ua.sub(Ua.diff(a.args[0],b,c,d),Ua.diff(a.args[1],b,c,d));console.log("infix not found",a.oper);return B}if("function"===a.ctype){if("exp$1"===a.oper)return Ua.exp(Ua.diff(a.args[0],b,c,d));if("log$1"===a.oper)return Ua.log(Ua.diff(a.args[0],b,c,d));if("sin$1"===a.oper)return Ua.sin(Ua.diff(a.args[0],b,c,d));if("cos$1"===a.oper)return Ua.cos(Ua.diff(a.args[0],b,c,d))}else return console.log("ctype not found",a.ctype),B}return f},adevaluate:function(a,b,c,d){a=Ua.diff(a,b,c,
d);d=Ua.faculty(d);for(b=2;b<a.value.length;b++)a.value[b]=n.mult(a.value[b],d.value[b]);return a},autodiff:function(a,b,c,d){for(var f=[],k=c.value.length,m,p=0;p<k;p++)m=Ua.adevaluate(a,b,c.value[p],d),f[p]=m;return f=h.turnIntoCSList(f)}},N={handleModifs:function(a,b){N.dashing&&N.unSetDash();N.colorraw=null;N.fillcolorraw=null;N.fillrule="nonzero";N.size=null;0>=N.psize&&(N.psize=0);0>=N.lsize&&(N.lsize=0);N.overhang=1;N.dashing=!1;N.isArrow=!1;N.arrowSides="==>";N.arrowposition=1;N.headlen=10;
N.arrowShape=N.arrowShapes.line;N.alpha=P.drawingstate.alpha;N.fillalpha=0;N.bold="";N.italics="";N.family="sans-serif";N.align=0;N.angle=0;N.xOffset=0;N.yOffset=0;N.lineCap="round";N.lineJoin="round";N.miterLimit=10;N.noborder=!1;var c,d;for(c in a){var f=a[c];f&&((d=b[c])?(!0===d&&(d=N.modifHandlers[c]),d(M(f))):console.log("Modifier not supported: "+c))}null!==N.size?N.psize=N.lsize=N.size:(N.psize=P.drawingstate.pointsize,N.lsize=P.drawingstate.linesize);N.dashing&&N.dashing(N.lsize);null!==N.colorraw?
N.pointColor=N.lineColor=N.textColor=N.makeColor(N.colorraw):1===N.alpha?(N.pointColor=P.drawingstate.pointcolor,N.lineColor=P.drawingstate.linecolor,N.textColor=P.drawingstate.textcolor):(N.pointColor=N.makeColor(P.drawingstate.pointcolorraw),N.lineColor=N.makeColor(P.drawingstate.linecolorraw),N.textColor=N.makeColor(P.drawingstate.textcolorraw));N.black=1===N.alpha?"rgb(0,0,0)":"rgba(0,0,0,"+N.alpha+")";N.fillColor=N.fillcolorraw&&0<N.fillalpha?N.makeColor(N.fillcolorraw,N.fillalpha):null},modifHandlers:{size:function(a){"number"===
a.ctype&&(N.size=a.value.real,0>N.size&&(N.size=0),1E3<N.size&&(N.size=1E3))},color:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.colorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},fillcolor:function(a){h.isNumberVector(a).value&&3===a.value.length&&(N.fillcolorraw=[a.value[0].value.real,a.value[1].value.real,a.value[2].value.real])},alpha:function(a){"number"===a.ctype&&(N.alpha=a.value.real)},fillalpha:function(a){"number"===a.ctype&&(N.fillalpha=a.value.real)},
dashpattern:function(a){if("list"===a.ctype){for(var b=[],c=0,d=0;c<a.value.length;c++)"number"===a.value[c].ctype&&(b[d++]=a.value[c].value.real);N.dashing=N.setDash.bind(null,b)}},dashtype:function(a){if("number"===a.ctype)a=Math.floor(a.value.real);else if("string"===a.ctype)a=a.value;else return;if(a=N.dashTypes[a])N.dashing=N.setDash.bind(null,a)},dashing:function(a){"number"===a.ctype&&(a=Math.floor(a.value.real),N.dashing=N.setDash.bind(null,[2*a,a]))},overhang:function(a){"number"===a.ctype&&
(N.overhang=N.overhang*a.value.real+(1-N.overhang)*(1-a.value.real))},arrow:function(a){"boolean"===a.ctype?N.isArrow=a.value:console.error("arrow needs to be of type boolean")},arrowshape:function(a){"string"!==a.ctype?console.error("arrowshape needs to be of type string"):N.arrowShapes.hasOwnProperty(a.value)?(N.arrowShape=N.arrowShapes[a.value],N.isArrow=!0,N.arrowShape.deprecated&&(console.log("arrowshape "+a.value+" is deprecated, use "+N.arrowShape.deprecated+" instead."),N.arrowShape.deprecated=
null)):(a=Object.keys(N.arrowShapes),a.sort(),a=a.join(", "),console.error("arrowshape needs to be one of "+a))},arrowsides:function(a){"string"!==a.ctype?console.error("arrowsides is not of type string"):"==>"!==a.value&&"<==>"!==a.value&&"<=="!==a.value?console.error("arrowsides is unknows"):(N.arrowSides=a.value,N.isArrow=!0)},arrowposition:function(a){"number"!==a.ctype?console.error("arrowposition is not of type number"):0>a.value.real?console.error("arrowposition has to be positive"):1<a.value.real?
N.overhang=N.overhang*a.value.real+(1-N.overhang)*(1-a.value.real):(N.arrowposition=a.value.real,N.isArrow=!0)},arrowsize:function(a){"number"!==a.ctype?console.error("arrowsize is not of type number"):0>a.value.real?console.error("arrowsize has to be positive"):N.headlen*=a.value.real},bold:function(a){"boolean"===a.ctype&&a.value&&(N.bold="bold ")},italics:function(a){"boolean"===a.ctype&&a.value&&(N.italics="italic ")},family:function(a){"string"===a.ctype&&(N.family=a.value)},align:function(a){"string"===
a.ctype&&(a=a.value,"left"===a&&(N.align=0),"right"===a&&(N.align=1),"mid"===a||"center"===a)&&(N.align=.5)},angle:function(a){"number"===a.ctype&&(N.angle=a.value.real)},xoffset:function(a){"number"===a.ctype&&(N.xOffset=a.value.real)},yoffset:function(a){"number"===a.ctype&&(N.yOffset=a.value.real)},offset:function(a){"list"===a.ctype&&2===a.value.length&&"number"===a.value[0].ctype&&"number"===a.value[1].ctype&&(N.xOffset=a.value[0].value.real,N.yOffset=a.value[1].value.real)},lineCap:function(a){"string"!==
a.ctype||"round"!==a.value&&"square"!==a.value&&"butt"!==a.value||(N.lineCap=a.value)},lineJoin:function(a){"string"!==a.ctype||"round"!==a.value&&"bevel"!==a.value&&"miter"!==a.value||(N.lineJoin=a.value)},fillrule:function(a){"string"!==a.ctype||"nonzero"!==a.value&&"evenodd"!==a.value||(N.fillrule=a.value)},miterLimit:function(a){"number"===a.ctype&&0<a.value.real&&(N.miterLimit=Math.round(a.value.real))},noborder:function(a){"boolean"===a.ctype?N.noborder=a.value:console.error("noborder needs to be of type boolean")},
border:function(a){"boolean"===a.ctype?N.noborder=!a.value:console.error("border needs to be of type boolean")}},lineModifs:{size:!0,color:!0,alpha:!0,dashpattern:!0,dashtype:!0,dashing:!0,overhang:!0,arrow:!0,arrowshape:!0,arrowsides:!0,arrowposition:!0,arrowsize:!0,lineCap:!0,lineJoin:!0,miterLimit:!0},pointModifs:{size:!0,color:!0,alpha:!0,noborder:!0,border:!0}};N.pointAndLineModifs=N.lineModifs;N.conicModifs={size:!0,color:!0,alpha:!0,dashing:!0,dashpattern:!0,dashtype:!0,fillcolor:!0,fillrule:!0,
fillalpha:!0,lineCap:!0,lineJoin:!0,miterLimit:!0};N.textModifs={size:!0,color:!0,alpha:!0,bold:!0,italics:!0,family:!0,align:!0,angle:!0,xoffset:!0,yoffset:!0,offset:!0};N.makeColor=function(a,b){void 0===b&&(b=N.alpha);return"rgba("+Math.floor(255*a[0])+","+Math.floor(255*a[1])+","+Math.floor(255*a[2])+","+b+")"};N.preDrawCurve=function(){O.lineWidth=N.lsize;O.lineCap=N.lineCap;O.lineJoin=N.lineJoin;O.mozFillRule=N.fillrule;O.fillrule=N.fillrule;O.miterLimit=N.miterLimit;O.strokeStyle=N.lineColor};
N.arrowShapes={default:{close:!1,fill:!1,ratio:1,deprecated:"line"},line:{close:!1,fill:!1,ratio:1},empty:{close:!0,fill:!1,ratio:1},hollow:{close:!0,fill:!1,ratio:1,deprecated:"empty"},full:{close:!0,fill:!0,ratio:1},jet:{close:!0,fill:!0,ratio:1.5},delta:{close:!0,fill:!0,ratio:1.5,deprecated:"jet"}};N.clipSegment=function(a,b){var c=b.x-a.x,d=b.y-a.y,f=N.clipLineCore(-d,c,a.x*b.y-b.x*a.y);if(2!==f.length)return[];var k=f[0];f=f[1];var m=1/(c*c+d*d),p=((k.x-a.x)*c+(k.y-a.y)*d)*m;c=((f.x-a.x)*c+
(f.y-a.y)*d)*m;0>p&&(k=a);1<p&&(k=b);0>c&&(f=a);1<c&&(f=b);return k===f?[]:[k,f]};N.drawsegcore=function(a,b){function c(F,K,V,Q){var da=F-Q*z+.5*D,W=K-Q*D-.5*z,na=F-Q*z-.5*D;Q=K-Q*D+.5*z;O.beginPath();N.arrowShape.fill&&(O.lineWidth=N.lsize/2);O.moveTo(da,W);O.lineTo(F,K);O.lineTo(na,Q);N.arrowShape.close&&(O.fillStyle=N.lineColor,O.lineTo(F-V*z,K-V*D),O.closePath(),N.arrowShape.fill&&O.fill());O.stroke()}var d=P.drawingstate.matrix,f=a.x*d.a-a.y*d.b+d.tx,k=a.x*d.c-a.y*d.d-d.ty,m=b.x*d.a-b.y*d.b+
d.tx,p=b.x*d.c-b.y*d.d-d.ty,u=N.overhang,w=1-u;b=u*f+w*m;d=u*k+w*p;a=u*m+w*f;u=u*p+w*k;if(0>b||b>hb||0>d||d>jb||0>a||a>hb||0>u||u>jb){u=N.clipSegment({x:b,y:d},{x:a,y:u});if(2!==u.length||.01>N.lsize)return;b=u[0].x;d=u[0].y;a=u[1].x;u=u[1].y}N.preDrawCurve();if(!N.isArrow||f===k&&m===p).01>N.lsize||(O.beginPath(),O.moveTo(b,d),O.lineTo(a,u),O.stroke());else{f=m-f;k=p-k;m=N.headlen/Math.sqrt(f*f+k*k);var z=f*m,D=k*m;p=N.arrowposition;w=1-p;f=p*b+w*a;k=p*d+w*u;m=p*a+w*b;p=p*u+w*d;w=N.arrowSides;O.beginPath();
N.arrowShape.close?("<==>"===w||"<=="===w?(1>N.arrowposition&&(O.moveTo(b,d),O.lineTo(f,k)),O.moveTo(f+z,k+D)):O.moveTo(b,d),"==>"===w||"<==>"===w?(O.lineTo(m-z,p-D),1>N.arrowposition&&(O.moveTo(m,p),O.lineTo(a,u))):O.lineTo(a,u)):(O.moveTo(b,d),O.lineTo(a,u));O.stroke();"==>"!==w&&"<==>"!==w||c(m,p,1,N.arrowShape.ratio);"<=="!==w&&"<==>"!==w||c(f,k,-1,-N.arrowShape.ratio)}};N.drawpoint=function(a){var b=P.drawingstate.matrix,c=a.x*b.a-a.y*b.b+b.tx;a=a.x*b.c-a.y*b.d-b.ty;O.lineWidth=.3*N.psize;O.beginPath();
O.arc(c,a,N.psize,0,2*Math.PI);O.fillStyle=N.pointColor;O.fill();N.noborder||(O.beginPath(),O.arc(c,a,1.15*N.psize,0,2*Math.PI),O.fillStyle=N.black,O.strokeStyle=N.black,O.stroke())};N.clipLineCore=function(a,b,c){var d=Math.SQRT1_2*N.lsize,f=0-d,k=hb+d,m=0-d;d=jb+d;var p=0>f*a+m*b+c,u=0>k*a+m*b+c,w=0>f*a+d*b+c,z=0>k*a+d*b+c,D=[];p!==u&&D.push({x:(-c-b*m)/a,y:m});u!==z&&D.push({x:k,y:(-c-a*k)/b});w!==z&&D.push({x:(-c-b*d)/a,y:d});p!==w&&D.push({x:f,y:(-c-a*f)/b});return D};N.clipLine=function(a){a=
h.normalizeMax(h.productVM(a,P.toMat()));return N.clipLineCore(a.value[0].value.real,a.value[1].value.real,a.value[2].value.real)};N.drawline=function(a){h._helper.isAlmostReal(a)&&(a=N.clipLine(a),2===a.length&&.01<=N.lsize&&(N.preDrawCurve(),O.beginPath(),O.moveTo(a[0].x,a[0].y),O.lineTo(a[1].x,a[1].y),O.stroke()))};N.drawRaySegment=function(a,b){a=J.extractPoint(a);b=J.extractPoint(b);if(a.ok&&b.ok){var c=a.x-b.x,d=a.y-b.y,f=25E3/P.drawingstate.matrix.sdet/Math.sqrt(c*c+d*d);c*=f;d*=f;N.drawsegcore(a,
{x:a.x+c,y:a.y+d});N.drawsegcore(b,{x:b.x-c,y:b.y-d})}};N.dashTypes={solid:[],dashed:[10,10],tightdash:[10,4],dotted:[1,3],dashdot:[10,5,1,5],"dashvalue.solid":[],"dashvalue.dashed":[10,10],"dashvalue.tightdash":[10,4],"dashvalue.dotted":[1,3],"dashvalue.dashdot":[10,5,1,5],0:[],1:[10,10],2:[10,4],3:[1,3],4:[10,5,1,5]};N.setDash=function(a,b){b=Math.sqrt(b);a=a.slice();for(var c=0;c<a.length;c++)a[c]*=b;O.webkitLineDash=a;O.setLineDash(a);O.mozDash=a};N.unSetDash=function(){O.webkitLineDash=[];O.setLineDash([]);
O.mozDash=[]};Qc.prototype={set fillStyle(a){var b=this;td(a,function(c,d,f,k){b._fill="#"+bc(c.toString(16),2)+bc(d.toString(16),2)+bc(f.toString(16),2);b._fillOpacity=255===k?null:k})},set strokeStyle(a){var b=this;td(a,function(c,d,f,k){b._stroke="#"+bc(c.toString(16),2)+bc(d.toString(16),2)+bc(f.toString(16),2);b._strokeOpacity=255===k?null:k})},clearRect:function(){},beginPath:function(){this._path=[]},_pathcmd:function(){this._path.push.apply(this._path,arguments)},closePath:function(){this._pathcmd("Z")},
moveTo:function(a,b){this._pathcmd("M",a,b)},lineTo:function(a,b){this._pathcmd("L",a,b)},bezierCurveTo:function(a,b,c,d,f,k){this._pathcmd("C",a,b,c,d,f,k)},quadraticCurveTo:function(a,b,c,d){this._pathcmd("Q",a,b,c,d)},arc:function(a,b,c,d,f,k){var m=c*Math.cos(d)+a,p=c*Math.sin(d)+b,u=c*Math.cos(f)+a,w=c*Math.sin(f)+b;f=k?d-f:f-d;f>=2*Math.PI?this._pathcmd(this._path.length?"L":"M",m,p,"A",c,c,0,0,k?1:0,a-c*Math.cos(d),b-c*Math.sin(d),"A",c,c,0,0,k?1:0,m,p):this._pathcmd(this._path.length?"L":
"M",m,p,"A",c,c,0,f>Math.PI?1:0,k?1:0,u,w)},rect:function(a,b,c,d){this._pathcmd("M",a,b,"h",c,"v",d,"h",-c,"z")},_cmd:function(a){1!==this.globalAlpha?(this._body.push('<g opacity="'+this.globalAlpha+'">'),this._body.push(a),this._body.push("</g>")):this._body.push(a)},_attrs:function(a){var b="",c;for(c in a)null!==a[c]&&(b+=" "+c+'="'+a[c]+'"');return b},fill:function(){this._cmd("<path"+this._attrs({d:this._path.join(" "),fill:this._fill,"fill-opacity":this._fillOpacity})+"/>")},stroke:function(){this._cmd("<path"+
this._attrs({d:this._path.join(" "),stroke:this._stroke,"stroke-opacity":this._strokeOpacity,"stroke-width":this.lineWidth,"stroke-linecap":this.lineCap,"stroke-linejoin":this.lineJoin,"stroke-miterlimit":"miter"===this.lineJoin?this.miterLimit:null})+"/>")},clip:function(){++this._clipIndex;this._body.push('<clipPath id="clip'+this._clipIndex+'"><path d="'+this._path.join(" ")+'"/></clipPath>','<g clip-path="url(#clip'+this._clipIndex+')">');this._saveStack[this._saveStack.length-1]+="</g>"},save:function(){this._saveStack.push("")},
restore:function(){this._body.push(this._saveStack.pop());0===this._saveStack.length&&this._saveStack.push("")},_transform:function(a){this._body.push('<g transform="'+a+'">');this._saveStack[this._saveStack.length-1]+="</g>"},translate:function(a,b){this._transform("translate("+a+" "+b+")")},rotate:function(a){this._transform("rotate("+Math.PI/180*a+")")},scale:function(a,b){this._transform("scale("+a+" "+b+")")},transform:function(a,b,c,d,f,k){this._transform("matrix("+[a,b,c,d,f,k].join(" ")+")")},
drawImage:function(a,b,c){if(3!==arguments.length)throw Error("SvgWriterContext only supports 3-argument version of drawImage");var d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;var f=a.cachedDataURL?a.cachedDataURL:Fe(a);this._defs.push('<image id="img'+d+'" x="0" y="0" width="'+a.width+'" height="'+a.height+'" xlink:href="'+f+'"/>');this._imgcache.push(a)}this._cmd('<use x="'+b+'" y="'+c+'" xlink:href="#img'+d+'"/>')},toBlob:function(){for(;1<this._saveStack.length||""!==this._saveStack[0];)this.restore();
var a='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+this.width+'px" height="'+this.height+'px">\n'+this._defs.join("\n")+'\n</defs>\n<g stroke="none" fill="none">\n'+this._body.join("\n")+"\n</g>\n</svg>\n";return new Blob([a],{type:"image/svg+xml"})}};Ee.prototype={_cmd:function(){this._body.push(Array.prototype.join.call(arguments," "))},_setAlpha:function(a,b,c){var d=Math.round(255*
a*this._globalAlpha);b+=d;this._extGState[b]="<< /"+c+" "+d/255+" >>";this._cmd("/"+b,"gs");return a},set globalAlpha(a){this._globalAlpha=a;this._setAlpha(this._strokeAlpha,"As","CA");this._setAlpha(this._fillAlpha,"Af","ca")},set fillStyle(a){var b=this;td(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"rg");b._setAlpha(b._fillAlpha=k,"Af","ca")})},set strokeStyle(a){var b=this;td(a,function(c,d,f,k){b._cmd(c/255,d/255,f/255,"RG");b._setAlpha(b._strokeAlpha=k,"As","CA")})},set lineWidth(a){this._cmd(a,
"w")},set lineCap(a){this._cmd({butt:0,round:1,square:2}[a],"J")},set lineJoin(a){this._cmd({miter:0,round:1,bevel:2}[a],"j")},set miterLimit(a){this._cmd(a,"M")},clearRect:function(){},beginPath:function(){this._pathUsed=!1},closePath:function(){this._cmd("h")},moveTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"m")},lineTo:function(a,b){this._cmd(this._xPos=a,this._yPos=-b,"l")},bezierCurveTo:function(a,b,c,d,f,k){this._cmd(a,-b,c,-d,this._xPos=f,this._yPos=-k,"c")},quadraticCurveTo:function(a,
b,c,d){this.bezierCurveTo((2*a+this._xPos)/3,(2*b-this._yPos)/3,(c+2*a)/3,(d+2*b)/3,c,d)},_kappa:.5522847498307935,arc:function(a,b,c,d,f,k){if(0===d&&f===2*Math.PI)d=this._kappa*c,this.moveTo(a+c,b),this.bezierCurveTo(a+c,b+d,a+d,b+c,a,b+c),this.bezierCurveTo(a-d,b+c,a-c,b+d,a-c,b),this.bezierCurveTo(a-c,b-d,a-d,b-c,a,b-c),this.bezierCurveTo(a+d,b-c,a+c,b-d,a+c,b);else throw Error("PdfWriterContext.arc only supports full circles");},rect:function(a,b,c,d){this._cmd(a,-b,c,-d,"re")},_usePath:function(a){if(this._pathUsed){var b=
this._body[this._pathUsed],c={"S + f":"B","f + S":"B","W n + S":"W S","W n + f":"W f","S + W n":"W S","f + W n":"W f","B + W n":"W B","W S + f":"W B","W f + S":"W B"}[b+" + "+a];if(!c)throw Error("Don't know how to combine '"+b+"' and '"+a+"'");this._body.splice(this._pathUsed,1);a=c}this._pathUsed=this._body.length;this._cmd(a)},fill:function(){this._usePath("f")},stroke:function(){this._usePath("S")},clip:function(){this._usePath("W n")},save:function(){this._cmd("q")},restore:function(){this._cmd("Q")},
translate:function(a,b){this.transform(1,0,0,1,a,b)},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);this.transform(b,a,-a,b,0,0)},scale:function(a,b){this.transform(a,0,0,b,0,0)},transform:function(a,b,c,d,f,k){this._cmd(a,-b,-c,d,f,-k,"cm")},_png:function(a){if("data:image/png;base64,"!==a.substr(0,22))return{error:"Not a base64-encoded PNG file"};a=gf(a.substr(22));var b=Ge(a);console.log("PNG chunks:",b.map(function(na){return na.type}));if("IHDR"!==b[0].type)throw Error("Image does not start with an IHDR");
var c=b[0].data;a=(c[0]<<24|c[1]<<16|c[2]<<8|c[3])>>>0;var d=(c[4]<<24|c[5]<<16|c[6]<<8|c[7])>>>0,f=c[8],k=c[9],m=0===(k&2),p=0!==(k&4),u=c[10],w=c[11];c=c[12];if(0!==u)throw Error("Unsupported PNG compression method: "+u);if(0!==w)throw Error("Unsupported PNG filter method: "+w);if(0!==c)return{error:"Interlaced image not supported"};if(0!==(k&1))return{error:"Indexed PNG image not supported"};w=null;k=m?1:3;u=b.filter(function(na){return"IDAT"===na.type}).map(function(na){return na.data});if(p){p=
window.pako;w=new p.Inflate;for(b=0;b<u.length;++b)w.push(u[b],b+1===u.length);if(w.err)throw Error(w.err);w=w.result;c=f>>>3;if(w.length!==d*(a*(k+1)*c+1))throw Error("Data length mismatch");var z=k*c;u=new Uint8Array(d*(a*z+1));for(var D=new Uint8Array(d*(a*c+1)),F=0,K=0,V=0,Q=0;Q<d;++Q){u[K++]=D[V++]=w[F++];for(var da=0;da<a;++da){for(b=0;b<z;++b)u[K++]=w[F++];for(b=0;b<c;++b)D[V++]=w[F++]}}if(F!==w.length||K!==u.length||V!==D.length)throw Error("Seems we garbled our index computation somehow");
D=p.deflate(D);w=this._strm({Type:"/XObject",Subtype:"/Image",Width:a,Height:d,ColorSpace:"/DeviceGray",BitsPerComponent:f,Filter:"/FlateDecode",DecodeParms:this._dict({Predictor:15,Colors:1,BitsPerComponent:f,Columns:a})},D).ref;u=[p.deflate(u)]}var W=0;u.forEach(function(na){W+=na.length});return this._obj([this._dict({Type:"/XObject",Subtype:"/Image",Name:"/img"+this._imgcache.length,Width:a,Height:d,ColorSpace:m?"/DeviceGray":"/DeviceRGB",SMask:w,BitsPerComponent:f,Length:W,Filter:"/FlateDecode",
DecodeParms:this._dict({Predictor:15,Colors:k,BitsPerComponent:f,Columns:a})}),"\nstream\n"].concat(u,["\nendstream"]))},drawImage:function(a,b,c){if(3!==arguments.length)throw Error("PdfWriterContext only supports 3-argument version of drawImage");var d=this._imgcache.indexOf(a);if(-1===d){d=this._imgcache.length;this._imgcache.push(a);var f=this._png(a.cachedDataURL||"");f.hasOwnProperty("error")&&(f=this._png(Fe(a)));if(f.hasOwnProperty("error"))throw Error(f.error);this._xobjects["img"+d]=f.ref}this._cmd("q");
this._setAlpha(1,"Af","ca");this._cmd(a.width,0,0,a.height,b,-c-a.height,"cm");this._cmd("/img"+d,"Do");this._cmd("Q")},_dict:function(a){var b="<<",c;for(c in a)b+=" /"+c+" "+a[c];return b+" >>"},_obj:function(a,b){b||(b=this._nextIndex++);Array.isArray(a)||(a=[this._dict(a)]);a.index=b;a.ref=b+" 0 R";a.offset=this._offset;var c=0;a.unshift(b+" 0 obj\n");a.push("\nendobj\n");for(b=0;b<a.length;++b)c+=a[b].length;this._offset+=c;this._objects.push(a);return a},_strm:function(a,b,c){a.Length=b.length;
return this._obj([this._dict(a),"\nstream\n",b,"\nendstream"],c)},toBlob:function(){var a="["+[0,-this.height,this.width,0].join(" ")+"]";this._obj({Type:"/Catalog",Pages:"2 0 R"},1);this._obj({Type:"/Pages",Kids:"[3 0 R]",Count:1},2);this._obj({Type:"/Page",Parent:"2 0 R",MediaBox:a,Contents:"4 0 R",Resources:this._dict({ProcSet:"[/PDF /Text /ImageB /ImageC /ImageI]",XObject:this._dict(this._xobjects),ExtGState:this._dict(this._extGState)})},3);var b=this._body.join("\n"),c=new Uint8Array(b.length);
for(a=0;a<b.length;++a)c[a]=b.charCodeAt(a)&255;b=window.pako.deflate(c);this._strm({Filter:"/FlateDecode"},b,4);b=this._objects;var d=[];for(a=1;a<b.length;++a)d[b[a].index]=b[a];c="xref\n0 "+d.length+"\n";for(a=0;a<d.length;++a)c=d[a]?c+(bc(String(d[a].offset),10)+" 00000 n \n"):c+"0000000000 65535 f \n";a="trailer\n"+this._dict({Size:d.length,Root:"1 0 R"})+"\nstartxref\n"+this._offset+"\n%%EOF\n";b=Array.prototype.concat.apply([],b);b.push(c,a);return new Blob(b,{type:"application/pdf"})}};var ye=
null;Mc.push(Ld);Jb.exportSVG=function(){ud(Qc)};Jb.exportPDF=function(){Eb.loadScript("pako","pako.min.js",function(){ud(Ee)})};Jb.exportPNG=function(){Bf(O.canvas.toDataURL())};var Bf=function(a){var b=document.createElement("a");document.body.appendChild(b);b.style="display: none";b.href=a;b.download="CindyJSExport";b.click();setTimeout(function(){document.body.removeChild(b);Ld()},100)},vf="Move",ze,hc=[],Xc=0,Hf=0,ce=0,ha={Delete:{}};ha.Delete.actions=[];ha.Delete.actions[0]={};ha.Delete.actions[0].event=
"mousedown";ha.Delete.actions[0].tooltip="...";ha.Delete.actions[0].do=function(){sb=uc(Sa);null!==sb&&Qd(sb.mover.name);return!0};ha.Move={};ha.Move.actions=[];ha.Move.actions[0]={};ha.Move.actions[0].event="mousedown";ha.Move.actions[0].tooltip="Move free elements by dragging the mouse";ha.Move.actions[0].do=function(){var a=null;for(var b=1E6,c,d=$jscomp.makeIterator(H.free),f=d.next();!f.done;f=d.next())if(f=f.value,!f.pinned&&!1!==f.visible&&!0!==f.tmp){var k=P.drawingstate.matrix.sdet;if("P"===
f.kind){var m=h.normalizeZ(f.homog);if(!h._helper.isAlmostReal(m))continue;var p=m.value[0].value.real-Sa.x;m=m.value[1].value.real-Sa.y;var u=Math.sqrt(p*p+m*m);if(f.narrow&&u>("number"===typeof f.narrow?f.narrow:20)/k)continue}else if("C"===f.kind){m=h.normalizeZ(H.csnames[f.args[0]].homog);p=f.radius;if(!h._helper.isAlmostReal(m)||!n._helper.isAlmostReal(p))continue;u=m.value[0].value.real;var w=m.value[1].value.real;m=Sa.x-u;var z=Sa.y-w,D=Math.sqrt(m*m+z*z);if(0===D)continue;w+=z/D*p.value.real;
p=u+m/D*p.value.real-Sa.x;m=w-Sa.y;u=Math.sqrt(p*p+m*m);u+=30/k;if(f.narrow&&u>(("number"===typeof f.narrow?f.narrow:20)+30)/k)continue}else if("L"===f.kind)p=f.homog,u=n,m=u.add(u.mult(p.value[0],u.conjugate(p.value[0])),u.mult(p.value[1],u.conjugate(p.value[1]))),m=h.scaldiv(u.sqrt(m),p),u=m.value[0].value.real*Sa.x+m.value[1].value.real*Sa.y+m.value[2].value.real,p=-m.value[0].value.real*u,m=-m.value[1].value.real*u,0>u&&(u=-u),u+=25/k;else if("Text"===f.kind){if(!f.homog||f.dock||!f._bbox)continue;
m=P.from(Sa.x,Sa.y,1);p=Math.max(0,m[0]-f._bbox.right,f._bbox.left-m[0]);m=Math.max(0,m[1]-f._bbox.bottom,f._bbox.top-m[1]);u=Math.sqrt(p*p+m*m);if(20<u)continue;u/=k;m=h.normalizeZ(f.homog);if(!h._helper.isAlmostReal(m))continue;p=m.value[0].value.real-Sa.x;m=m.value[1].value.real-Sa.y}else continue;u<b+.2/k&&(b=u,a=f,c={x:p,y:m})}console.log("Moving "+(a?a.name:"nothing"));a=null===a?null:{mover:a,offset:c,prev:{x:Sa.x,y:Sa.y}};sb=a;return!0};ha.Point={};ha.Point.actions=[];ha.Point.actions[0]=
{};ha.Point.actions[0].event="mousedown";ha.Point.actions[0].tooltip="Add a single point with the mouse";ha.Point.actions[0].do=function(){cc({type:"Free",name:lc(),labeled:!0,pos:[Ob[0],Ob[1],1]});return!0};ha.Mid={};ha.Mid.actions=[];ha.Mid.actions[0]={};ha.Mid.actions[0].event="mousedown";ha.Mid.actions[0].tooltip="Construct two points and their midpoint by dragging";ha.Mid.actions[0].do=function(){$c();return!0};ha.Mid.actions[1]={};ha.Mid.actions[1].event="mousemove";ha.Mid.actions[1].do=function(){Od("Mid");
return!0};ha.Mid.actions[2]={};ha.Mid.actions[2].event="mouseup";ha.Mid.actions[2].do=function(){fd();return!0};ha.Circle={};ha.Circle.actions=[];ha.Circle.actions[0]={};ha.Circle.actions[0].event="mousedown";ha.Circle.actions[0].tooltip="Construct two points and a circle by dragging the mouse";ha.Circle.actions[0].do=function(){$c();return!0};ha.Circle.actions[1]={};ha.Circle.actions[1].event="mousemove";ha.Circle.actions[1].do=function(){Od("CircleMP");return!0};ha.Circle.actions[2]={};ha.Circle.actions[2].event=
"mouseup";ha.Circle.actions[2].do=function(){fd();return!0};ha.Compass={};ha.Compass.actions=[];ha.Compass.actions[0]={};ha.Compass.actions[0].event="mousedown";ha.Compass.actions[0].tooltip="...";ha.Compass.actions[0].do=function(){$c();return!0};ha.Compass.actions[1]={};ha.Compass.actions[1].event="mousedown";ha.Compass.actions[1].tooltip="...";ha.Compass.actions[1].do=function(){$c();return!0};ha.Compass.actions[2]={};ha.Compass.actions[2].event="mousedown";ha.Compass.actions[2].tooltip="...";
ha.Compass.actions[2].do=function(){$c();cc({type:"Compass",name:lc(),labeled:!0,args:[hc[0].name,hc[1].name,hc[2].name]});return!0};ha.Line={};ha.Line.actions=[];ha.Line.actions[0]={};ha.Line.actions[0].event="mousedown";ha.Line.actions[0].tooltip="Construct two points and their connecting line by dragging the mouse";ha.Line.actions[0].do=function(){$c();return!0};ha.Line.actions[1]={};ha.Line.actions[1].event="mousemove";ha.Line.actions[1].do=function(){Od("Join");return!0};ha.Line.actions[2]={};
ha.Line.actions[2].event="mouseup";ha.Line.actions[2].do=function(){fd();return!0};ha.Segment={};ha.Segment.actions=[];ha.Segment.actions[0]={};ha.Segment.actions[0].event="mousedown";ha.Segment.actions[0].tooltip="Draw a segment by dragging the mouse";ha.Segment.actions[0].do=function(){$c();return!0};ha.Segment.actions[1]={};ha.Segment.actions[1].event="mousemove";ha.Segment.actions[1].do=function(){Od("Segment");return!0};ha.Segment.actions[2]={};ha.Segment.actions[2].event="mouseup";ha.Segment.actions[2].do=
function(){fd();return!0};ha.Parallel={};ha.Parallel.actions=[];ha.Parallel.actions[0]={};ha.Parallel.actions[0].event="mousedown";ha.Parallel.actions[0].tooltip="Construct a parallel line by dragging a line";ha.Parallel.actions[0].do=function(){return Rc()};ha.Parallel.actions[1]={};ha.Parallel.actions[1].event="mousemove";ha.Parallel.actions[1].do=function(){var a={type:"Free",name:lc(),labeled:!0,pos:[Ob[0],Ob[1],1],tmp:!0};a=cc(a);ze=cc({type:"Para",name:lc(),labeled:!0,args:[hc[0].name,a.name]});
Nd(a);return!0};ha.Parallel.actions[2]={};ha.Parallel.actions[2].event="mouseup";ha.Parallel.actions[2].do=function(){fd();return!0};ha.Orthogonal={};ha.Orthogonal.actions=[];ha.Orthogonal.actions[0]={};ha.Orthogonal.actions[0].event="mousedown";ha.Orthogonal.actions[0].tooltip="Construct a orthogonal line by dragging a line";ha.Orthogonal.actions[0].do=function(){if(Rc()){var a={type:"Free",name:lc(),labeled:!0,pos:[Ob[0],Ob[1],1],tmp:!0};a=cc(a);ze=cc({type:"Perp",name:lc(),labeled:!0,args:[hc[0].name,
a.name]});Nd(a);return!0}return!1};ha.Orthogonal.actions[1]={};ha.Orthogonal.actions[1].event="mouseup";ha.Orthogonal.actions[1].do=function(){fd();return!0};ha.Intersection={};ha.Intersection.actions=[];ha.Intersection.actions[0]={};ha.Intersection.actions[0].event="mousedown";ha.Intersection.actions[0].tooltip="Select two elements to define their intersection";ha.Intersection.actions[0].do=function(){return Je()};ha.Intersection.actions[1]={};ha.Intersection.actions[1].event="mousedown";ha.Intersection.actions[1].do=
function(){return Je()?(ze=cc({type:"Meet",name:lc(),labeled:!0,args:[hc[0].name,hc[1].name]}),!0):!1};var Bb=function(a){a?(this._e=[],this._e[0]=a[0][0],this._e[1]=a[1][0],this._e[2]=a[2][0],this._e[3]=a[0][1],this._e[4]=a[1][1],this._e[5]=a[2][1],this._e[6]=a[0][2],this._e[7]=a[1][2],this._e[8]=a[2][2]):this._e=[1,0,0,0,1,0,0,0,1]};Bb.prototype.clone=function(){var a=[].concat($jscomp.arrayFromIterable(this._e)),b=new Bb;b.set(a);return b};Bb.prototype.get=function(a){return this._e[a]};Bb.prototype.getRow=
function(a){var b=this._e;return[b[a],b[3+a],b[6+a]]};Bb.prototype.set=function(a,b){1===arguments.length&&(this._e=a);2===arguments.length&&(this._e[a]=b)};Bb.prototype.exchange=function(a,b){var c=$jscomp.makeIterator([this._e[b],this._e[a]]);this._e[a]=c.next().value;this._e[b]=c.next().value};Bb.prototype.inverse=function(){var a=this._e,b=-a[2]*a[4]*a[6]+a[1]*a[5]*a[6]+a[2]*a[3]*a[7]-a[0]*a[5]*a[7]-a[1]*a[3]*a[8]+a[0]*a[4]*a[8];a=[-a[4]*a[7]+a[4]*a[8],a[5]*a[6]-a[3]*a[8],-a[4]*a[6]+a[3]*a[7],
a[2]*a[7]-a[1]*a[8],-a[2]*a[6]+a[0]*a[8],a[1]*a[6]-a[0]*a[7],-a[2]*a[4]+a[1]*a[5],a[2]*a[3]-a[0]*a[5],-a[1]*a[3]+a[0]*a[4]];1E-10>Math.abs(b)&&console.log("PSLQ: inverting singular matrix!");this._e=a.map(function(c){return c/b});return this};Bb.prototype.swRow=function(a,b){for(var c=0;9>c;)this.exchange(c+a,c+b),c+=3};Bb.prototype.swCol=function(a,b){for(var c=0;3>c;++c)this.exchange(3*a+c,3*b+c)};Bb.mult=function(a,b,c){a=[a.get(0)*b.get(0)+a.get(3)*b.get(1)+a.get(6)*b.get(2),a.get(1)*b.get(0)+
a.get(4)*b.get(1)+a.get(7)*b.get(2),a.get(2)*b.get(0)+a.get(5)*b.get(1)+a.get(8)*b.get(2),a.get(0)*b.get(3)+a.get(3)*b.get(4)+a.get(6)*b.get(5),a.get(1)*b.get(3)+a.get(4)*b.get(4)+a.get(7)*b.get(5),a.get(2)*b.get(3)+a.get(5)*b.get(4)+a.get(8)*b.get(5),a.get(0)*b.get(6)+a.get(3)*b.get(7)+a.get(6)*b.get(8),a.get(1)*b.get(6)+a.get(4)*b.get(7)+a.get(7)*b.get(8),a.get(2)*b.get(6)+a.get(5)*b.get(7)+a.get(8)*b.get(8)];c.set(a)};Bb.prototype.getString=function(){var a=this._e;return"/"+a[0]+"\t "+a[3]+"\t "+
a[6]+"\\\n|"+a[1]+"\t "+a[4]+"\t "+a[7]+"|\n\\"+a[2]+"\t "+a[5]+"\t "+a[8]+"/\n"};Bb.prototype.transpose=function(){this.exchange(1,3);this.exchange(2,6);this.exchange(5,7);return this};Bb.VMmult=function(a,b,c){c[0]=b.get(0)*a[0]+b.get(1)*a[1]+b.get(2)*a[2];c[1]=b.get(3)*a[0]+b.get(4)*a[1]+b.get(5)*a[2];c[2]=b.get(6)*a[0]+b.get(7)*a[1]+b.get(8)*a[2]};var jc=function(){};jc.dot=function(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d]*b[d];return c};jc.scale=function(a,b){for(var c=0;c<a.length;++c)a[c]*=
b};jc.maxIndex=function(a){for(var b=0,c=1;c<a.length;++c)a[c]>a[b]&&(b=c);return b};jc.hermiteReduce=function(a){for(var b=[[1,0,0],[0,1,0],[0,0,1]],c=a.length,d=a.map(function(u){return[].concat($jscomp.arrayFromIterable(u))}),f,k=1;k<c;k++)for(var m=k-1;0<=m;m--){f=Math.round(a[k][m]/a[m][m]);for(var p=0;p<=m;p++)d[k][p]-=f*d[m][p];for(p=0;p<c;p++)b[k][p]-=f*b[m][p]}for(c=0;3>c;c++)a[c]=d[c];return new Bb(b)};jc.doPSLQ=function(a,b){for(var c=a.length,d=[],f=[],k=0;k<c;++k){d[k]=a[k]/Math.sqrt(jc.dot(a,
a));for(var m=0,p=k;p<c;++p)m+=Math.pow(a[p],2);f[k]=Math.sqrt(m)}jc.scale(f,1/f[0]);k=new Bb;a=new Bb;m=[];for(p=0;p<c;p++)m[p]=[];for(p=0;p<c;++p)for(var u=0;u<c-1;++u)m[p][u]=p>u?-d[p]*d[u]/f[u]/f[u+1]:p===u?f[p+1]/f[p]:0;p=jc.hermiteReduce(m);u=p.clone().inverse().transpose();Bb.VMmult(d,u,d);Bb.mult(p,k,k);Bb.mult(a,u,a);for(f=0;f<jc.MAX_ITER;++f){u=[m[0][0],m[1][1]];p=0;Math.pow(this.GAMMA,2)*Math.abs(u[1])>Math.pow(this.GAMMA,1)*Math.abs(u[0])&&(p=1);var w=u=0,z=0;p<c-2&&(u=m[p+1][p],w=m[p+
1][p+1],z=Math.sqrt(Math.pow(u,2)+Math.pow(w,2)));var D=d[p];d[p]=d[p+1];d[p+1]=D;D=[].concat($jscomp.arrayFromIterable(m[p]));m[p]=m[p+1];m[p+1]=D;k.swRow(p,p+1);a.swCol(p,p+1);D=Array(2);for(var F=0;3>F;F++)D[F]=[];if(p<c-2){for(F=0;F<c-1;++F)for(var K=0;K<c-1;++K)D[F][K]=F===p&&K===p?u/z:F===p&&K===p+1?-w/z:F===p+1&&K===p?w/z:F===p+1&&K===p+1?u/z:F===K&&K!==p||F===K&&K!==p+1?1:0;m=[[m[0][0]*D[0][0]+m[0][1]*D[1][0],m[0][0]*D[0][1]+m[0][1]*D[1][1]],[m[1][0]*D[0][0]+m[1][1]*D[1][0],m[1][0]*D[0][1]+
m[1][1]*D[1][1]],[m[2][0]*D[0][0]+m[2][1]*D[1][0],m[2][0]*D[0][1]+m[2][1]*D[1][1]]]}p=jc.hermiteReduce(m);u=p.clone().inverse().transpose();Bb.VMmult(d,u,d);Bb.mult(p,k,k);Bb.mult(a,u,a);p=[d[0],d[1],d[2],m[0][0],m[1][1]];for(u=0;u<p.length;++u)if(Math.abs(p[u])<=Math.pow(10,-b+5)){a.transpose();for(b=0;b<d.length;++b)d[b]=-Math.abs(d[b]);return a.getRow(jc.maxIndex(d))}}};$jscomp.global.Object.defineProperties(jc,{MAX_ITER:{configurable:!0,enumerable:!0,get:function(){return 20}},GAMMA:{configurable:!0,
enumerable:!0,get:function(){return 2/Math.sqrt(3)}}});var cd={},P={drawingstate:{}};P.drawingstate.linecolor="rgb(0,0,255)";P.drawingstate.linecolorraw=[0,0,1];P.drawingstate.pointcolor="rgb(0,255,0)";P.drawingstate.pointcolorraw=[0,1,0];P.drawingstate.textcolor="rgb(0,0,0)";P.drawingstate.textcolorraw=[0,0,0];P.drawingstate.alpha=1;P.drawingstate.pointsize=4;P.drawingstate.linesize=1;P.drawingstate.textsize=null;P.drawingstate.matrix={};P.drawingstate.matrix.a=25;P.drawingstate.matrix.b=0;P.drawingstate.matrix.c=
0;P.drawingstate.matrix.d=25;P.drawingstate.matrix.tx=250.5;P.drawingstate.matrix.ty=250.5;P.drawingstate.matrix.det=P.drawingstate.matrix.a*P.drawingstate.matrix.d-P.drawingstate.matrix.b*P.drawingstate.matrix.c;P.drawingstate.matrix.sdet=Math.sqrt(P.drawingstate.matrix.det);P.drawingstate.initialmatrix={};P.drawingstate.initialmatrix.a=P.drawingstate.matrix.a;P.drawingstate.initialmatrix.b=P.drawingstate.matrix.b;P.drawingstate.initialmatrix.c=P.drawingstate.matrix.c;P.drawingstate.initialmatrix.d=
P.drawingstate.matrix.d;P.drawingstate.initialmatrix.tx=P.drawingstate.matrix.tx;P.drawingstate.initialmatrix.ty=P.drawingstate.matrix.ty;P.drawingstate.initialmatrix.det=P.drawingstate.matrix.det;P.drawingstate.initialmatrix.sdet=P.drawingstate.matrix.sdet;P.clone=function(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)b[c]=P.clone(a[c]);return b};cd.backup=P.clone(P.drawingstate);cd.stack=[];P.clone(P.drawingstate);P.reset=function(){P.drawingstate.matrix.a=P.drawingstate.initialmatrix.a;
P.drawingstate.matrix.b=P.drawingstate.initialmatrix.b;P.drawingstate.matrix.c=P.drawingstate.initialmatrix.c;P.drawingstate.matrix.d=P.drawingstate.initialmatrix.d;P.drawingstate.matrix.tx=P.drawingstate.initialmatrix.tx;P.drawingstate.matrix.ty=P.drawingstate.initialmatrix.ty;P.drawingstate.matrix.det=P.drawingstate.initialmatrix.det;P.drawingstate.matrix.sdet=P.drawingstate.initialmatrix.sdet};P.from=function(a,b,c){a/=c;b/=c;c=P.drawingstate.matrix;return[(a*c.a-b*c.b+c.tx)/qb,(a*c.c-b*c.d-c.ty)/
qb]};P.to=function(a,b){var c=P.drawingstate.matrix;a=a*qb-c.tx;b=b*qb+c.ty;return[(a*c.d-b*c.b)/c.det,-(-a*c.c+b*c.a)/c.det,1]};P.toMat=function(){var a=P.drawingstate.matrix;return h.realMatrix([[a.d,-a.b,-a.tx*a.d-a.ty*a.b],[a.c,-a.a,-a.tx*a.c-a.ty*a.a],[0,0,a.det]])};P.dumpTrafo=function(){function a(c){return Math.round(1E3*c)/1E3}var b=P.drawingstate.matrix;console.log("a:"+a(b.a)+" b:"+a(b.b)+" c:"+a(b.c)+" d:"+a(b.d)+" tx:"+a(b.ty)+" ty:"+a(b.tx))};P.setMat=function(a,b,c,d,f,k){var m=P.drawingstate.matrix;
m.a=a;m.b=b;m.c=c;m.d=d;m.tx=f;m.ty=k;m.det=a*d-b*c;m.sdet=Math.sqrt(m.det)};P.scaleAndOrigin=function(a,b,c){P.setMat(a,0,0,a,b,c)};P.visibleRect=function(a,b,c,d){var f=c-a,k=b-d;f=hb*k<jb*f?hb/f:jb/k;P.setMat(f,0,0,f,(hb-f*(a+c))/2,(jb-f*(b+d))/2)};P.applyMat=function(a,b,c,d,f,k){var m=P.drawingstate.matrix;P.setMat(m.a*a+m.c*b,m.b*a+m.d*b,m.a*c+m.c*d,m.b*c+m.d*d,m.a*f+m.c*k+m.tx,m.b*f+m.d*k+m.ty)};P.translate=function(a,b){P.applyMat(1,0,0,1,a,b)};P.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);
P.applyMat(b,a,-a,b,0,0)};P.scale=function(a){P.applyMat(a,0,0,a,0,0)};P.gsave=function(){cd.stack.push(P.clone(P.drawingstate))};P.grestore=function(){0!==cd.stack.length&&(P.drawingstate=cd.stack.pop())};P.greset=function(){P.drawingstate=P.clone(cd.backup);P.drawingstate.matrix.ty-=jb;P.drawingstate.initialmatrix.ty-=jb;cd.stack=[]};P.createnewbackup=function(){P.drawingstate.initialmatrix.a=P.drawingstate.matrix.a;P.drawingstate.initialmatrix.b=P.drawingstate.matrix.b;P.drawingstate.initialmatrix.c=
P.drawingstate.matrix.c;P.drawingstate.initialmatrix.d=P.drawingstate.matrix.d;P.drawingstate.initialmatrix.tx=P.drawingstate.matrix.tx;P.drawingstate.initialmatrix.ty=P.drawingstate.matrix.ty;P.drawingstate.initialmatrix.det=P.drawingstate.matrix.det;P.drawingstate.initialmatrix.sdet=P.drawingstate.matrix.sdet;cd.backup=P.clone(P.drawingstate)};P.makecolor=function(a,b,c){a=Math.floor(255*a);b=Math.floor(255*b);c=Math.floor(255*c);return 1===P.drawingstate.alpha?"rgb("+a+","+b+","+c+")":"rgba("+
a+","+b+","+c+","+P.drawingstate.alpha+")"};P.setcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.linecolor=P.drawingstate.pointcolor=P.makecolor(b,c,a);P.drawingstate.linecolorraw=P.drawingstate.pointcolorraw=[b,c,a]};P.setlinecolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.linecolor=P.makecolor(b,c,a);P.drawingstate.linecolorraw=[b,c,a]};P.settextcolor=function(a){var b=a.value[0].value.real,
c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.textcolor=P.makecolor(b,c,a);P.drawingstate.textcolorraw=[b,c,a]};P.setpointcolor=function(a){var b=a.value[0].value.real,c=a.value[1].value.real;a=a.value[2].value.real;P.drawingstate.pointcolor=P.makecolor(b,c,a);P.drawingstate.pointcolorraw=[b,c,a]};P.setalpha=function(a){P.drawingstate.alpha=a.value.real;P.drawingstate.linecolor=P.makecolor(P.drawingstate.linecolorraw[0],P.drawingstate.linecolorraw[1],P.drawingstate.linecolorraw[2]);
P.drawingstate.pointcolor=P.makecolor(P.drawingstate.pointcolorraw[0],P.drawingstate.pointcolorraw[1],P.drawingstate.pointcolorraw[2]);P.drawingstate.textcolor=P.makecolor(P.drawingstate.textcolorraw[0],P.drawingstate.textcolorraw[1],P.drawingstate.textcolorraw[2])};P.setpointsize=function(a){P.drawingstate.pointsize=a.value.real};P.setlinesize=function(a){P.drawingstate.linesize=a.value.real};P.settextsize=function(a){P.drawingstate.textsize=a.value.real};var ub={clip:"none",pointColor:[1,0,0],lineColor:[0,
0,1],pointSize:5,lineSize:1,alpha:1,overhangLine:1,overhangSeg:1,dimDependent:.7,fontFamily:"sans-serif",textColor:[0,0,0],textsize:20,noborder:!1,lineHeight:1.45};Z.defaultAppearance&&hf(Z.defaultAppearance);var ef={},Cf={UL:0,UR:1,LR:2,LL:3},xf=["in","out","good","backup","prover"],od=new Float64Array(0),Wc={};xf.forEach(function(a){Wc[a]=od});var Fb=od,Ec=od,oc=od,ic,pc,nd,vc,ee,yf=!1,Df={toString:function(){return"RefineException"}},Ef=null,ya=null;Z.enableTraceLog&&(ya={logLength:Infinity,fullLog:[],
currentMouseAndScripts:null,currentMover:null,currentStep:null,currentElement:null,currentParam:null,labelTracing2:A.wrap("tracing2"),labelTracing4:A.wrap("tracing4"),labelTracingSesq:A.wrap("tracingSesq"),postMouseHooks:[]},"number"===typeof Z.enableTraceLog&&(ya.logLength=Z.enableTraceLog),Jb.getTraceLog=We,Jb.formatTraceLog=lf,Jb.addTraceHook=ya.postMouseHooks.push.bind(ya.postMouseHooks));mc.stateSize=12;le.stateSize=24;wd.stateSize=24;var Rb=[];lb._helper={};lb._helper.duplicatePPLL=function(a,
b){return{getInvolved:function(){return[a,b]},toString:function(){return{P:"point",L:"line"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:xd(a,b),holds:function(){return h.projectiveDistMinScal(a.homog,b.homog)<n.epsbig}}};lb._helper.duplicatePsLs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return{Ps:"point set",Ls:"line set"}[a.kind]+" "+a.name+" is duplicate of "+b.name},apply:xd(a,b),holds:function(){return lb._helper.isSetEq(a.results.value,b.results.value,
h.projectiveDistMinScal)}}};lb._helper.duplicateCC=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic "+a.name+" is duplicate of "+b.name},apply:xd(a,b),holds:function(){return h.conicDist(a.matrix,b.matrix)<n.epsbig}}};lb._helper.duplicateCs=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Conic set"+a.name+" is duplicate of "+b.name},apply:xd(a,b),holds:function(){return lb._helper.isSetEq(a.results,b.results,h.conicDist)}}};
lb._helper.duplicateSS=function(a,b){return{getInvolved:function(){return[a,b]},toString:function(){return"Segment "+a.name+" is duplicate of "+b.name},apply:xd(a,b),holds:function(){var c=a.startpos,d=a.endpos,f=b.startpos,k=b.endpos,m=h.projectiveDistMinScal(c,f);m+=h.projectiveDistMinScal(d,k);d=h.projectiveDistMinScal(d,f);d+=h.projectiveDistMinScal(c,k);return Math.min(m,d)<n.epsbig}}};lb.P=function(a){H.points.forEach(function(b){a.name!==b.name&&(b=lb._helper.duplicatePPLL(a,b),b.holds()&&
Rb.push(b))})};lb.Ps=function(a){H.sets.points.forEach(function(b){a.name!==b.name&&(b=lb._helper.duplicatePsLs(a,b),b.holds()&&Rb.push(b))})};lb.Ls=function(a){H.sets.lines.forEach(function(b){a.name!==b.name&&(b=lb._helper.duplicatePsLs(a,b),b.holds()&&Rb.push(b))})};lb.Cs=function(a){H.sets.conics.forEach(function(b){a.name!==b.name&&(b=lb._helper.duplicateCs(a,b),b.holds()&&Rb.push(b))})};lb.L=function(a){H.lines.forEach(function(b){a.name!==b.name&&a.kind===b.kind&&(b=lb._helper.duplicatePPLL(a,
b),b.holds()&&Rb.push(b))})};lb.S=function(a){H.lines.forEach(function(b){a.name!==b.name&&"S"===b.kind&&(b=lb._helper.duplicateSS(a,b),b.holds()&&Rb.push(b))})};lb.C=function(a){H.conics.forEach(function(b){a.name!==b.name&&(b=lb._helper.duplicateCC(a,b),b.holds()&&Rb.push(b))})};lb._helper.isSetEq=function(a,b,c){a=a.slice();b=b.slice();if(a.length!==b.length)return!1;if(0===a.length&&0===b.length)return!0;var d=a.shift(),f=b.reduce(function(k,m,p,u){return c(m,d)<c(u[k],d)?p:k},0);return c(b[f],
d)<n.epsbig?(b.splice(f,1),lb._helper.isSetEq(a,b,c)):!1};Jc.P=function(a){H.lines.forEach(function(b){b=ne(a,b);b.holds()&&Rb.push(b)});H.conics.forEach(function(b){b=Ye(a,b);b.holds()&&Rb.push(b)})};Jc.L=function(a){H.points.forEach(function(b){b=ne(b,a);b.holds()&&Rb.push(b)})};Jc.S=Jc.L;Jc.C=function(a){H.points.forEach(function(b){b=Ye(b,a);b.holds()&&Rb.push(b)})};var t={_helper:{},RandomLine:{}};t.RandomLine.kind="L";t.RandomLine.signature=[];t.RandomLine.updatePosition=function(a){a.homog=
h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t._helper.getRandMove=function(a){a=a.homog;var b=h.getRandComplexVec3(-.05,.05);return{type:"homog",value:h.add(a,b)}};t._helper.getRandPointMove=function(a){a=h.normalizeMax(a.homog);var b=a.value[2],c=n.abs(b).value.real,d=n.real(0);c<n.eps&&(d=n.getRandComplex(-.05,.05),b=n.real(1));c=h.turnIntoCSList([n.getRandComplex(-.1,.1),n.getRandComplex(-.1,.1),d]);b=h.scalmult(b,
c);b=h.add(a,b);return{type:"homog",value:b}};t.FreeLine={};t.FreeLine.kind="L";t.FreeLine.signature=[];t.FreeLine.isMovable=!0;t.FreeLine.initialize=function(a){a=t._helper.initializeLine(a);Xa(a)};t.FreeLine.getParamForInput=function(a,b,c){"mouse"===c?(a=h.cross(b,h.ez),a=h.cross(a,b)):a="homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(a)};t.FreeLine.getParamFromState=function(a){return db(3)};t.FreeLine.putParamToState=function(a,b){Xa(b)};t.FreeLine.updatePosition=
function(a){var b=db(3);Xa(b);a.homog=A.withUsage(b,"Line")};t.FreeLine.getRandomMove=t._helper.getRandMove;t.FreeLine.stateSize=6;t.RandomPoint={};t.RandomPoint.kind="P";t.RandomPoint.signature=[];t.RandomPoint.updatePosition=function(a){a.homog=h.realVector([100*Math.random(),100*Math.random(),100*Math.random()]);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Point")};t.Join={};t.Join.kind="L";t.Join.signature=["P","P"];t.Join.updatePosition=function(a){a.homog=h.cross(H.csnames[a.args[0]].homog,
H.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t.Segment={};t.Segment.kind="S";t.Segment.signature=["P","P"];t.Segment.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]];t.Segment.setSegmentPos(a,h.cross(b.homog,c.homog),h.scalmult(c.homog.value[2],b.homog),h.scalmult(b.homog.value[2],c.homog))};t.Segment.setSegmentPos=function(a,b,c,d){b=h.normalizeMax(b);a.homog=A.withUsage(b,"Line");b=h.turnIntoCSList([c,d]);b=h.normalizeMax(b);
a.startpos=b.value[0];a.endpos=b.value[1];a.farpoint=h.sub(a.startpos,a.endpos);a.farpoint=h.sub(a.startpos,a.endpos)};t.Meet={};t.Meet.kind="P";t.Meet.signature=["L","L"];t.Meet.updatePosition=function(a){a.homog=h.cross(H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Point")};t.Meet.visiblecheck=function(a){var b=!0,c=H.csnames[a.args[0]],d=H.csnames[a.args[1]];"S"===c.kind&&(b=Oe(a,c));b&&"S"===d.kind&&(b=Oe(a,d));a.isshowing=
b};t._helper.midpoint=function(a,b){return h.normalizeMax(h.add(h.scalmult(b.value[2],a),h.scalmult(a.value[2],b)))};t.Mid={};t.Mid.kind="P";t.Mid.signature=["P","P"];t.Mid.updatePosition=function(a){var b=t._helper.midpoint(H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog);a.homog=A.withUsage(b,"Point")};t.Perp={};t.Perp.kind="L";t.Perp.signature=["L","P"];t.Perp.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog;b=h.turnIntoCSList([b.value[0],b.value[1],
n.zero]);a.homog=h.cross(b,c);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t.Para={};t.Para.kind="L";t.Para.signature=["L","P"];t.Para.updatePosition=function(a){var b=H.csnames[a.args[1]].homog;a.homog=h.cross(h.cross(h.linfty,H.csnames[a.args[0]].homog),b);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t.Horizontal={};t.Horizontal.kind="L";t.Horizontal.signature=["P"];t.Horizontal.updatePosition=function(a){a.homog=h.cross(h.ex,H.csnames[a.args[0]].homog);
a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t.HorizontalLine={};t.HorizontalLine.kind="L";t.HorizontalLine.signature=[];t.HorizontalLine.isMovable=!0;t.HorizontalLine.initialize=function(a){a=t._helper.initializeLine(a);a=h.turnIntoCSList([n.zero,a.value[1],a.value[2]]);a=h.normalizeMax(a);Xa(a)};t.HorizontalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=h.cross(b,h.ex);else if("homog"===c){if(0!==b.value[0].real||0!==b.value[0].imag)b=h.turnIntoCSList([n.zero,b.value[1],
b.value[2]])}else b=h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};t.HorizontalLine.getParamFromState=function(a){return db(3)};t.HorizontalLine.putParamToState=function(a,b){Xa(b)};t.HorizontalLine.updatePosition=function(a){var b=db(3);Xa(b);a.homog=A.withUsage(b,"Line")};t.HorizontalLine.getRandomMove=t._helper.getRandMove;t.HorizontalLine.stateSize=6;t.Vertical={};t.Vertical.kind="L";t.Vertical.signature=["P"];t.Vertical.updatePosition=function(a){a.homog=h.cross(h.ey,H.csnames[a.args[0]].homog);
a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t.VerticalLine={};t.VerticalLine.kind="L";t.VerticalLine.signature=[];t.VerticalLine.isMovable=!0;t.VerticalLine.initialize=function(a){a=t._helper.initializeLine(a);a=h.turnIntoCSList([a.value[0],n.zero,a.value[2]]);a=h.normalizeMax(a);Xa(a)};t.VerticalLine.getParamForInput=function(a,b,c){if("mouse"===c)b=h.cross(b,h.ey);else if("homog"===c){if(0!==b.value[1].real||0!==b.value[1].imag)b=h.turnIntoCSList([b.value[0],n.zero,b.value[2]])}else b=
h.turnIntoCSList([n.zero,n.zero,n.zero]);return h.normalizeMax(b)};t.VerticalLine.getParamFromState=function(a){return db(3)};t.VerticalLine.putParamToState=function(a,b){Xa(b)};t.VerticalLine.updatePosition=function(a){var b=db(3);Xa(b);a.homog=A.withUsage(b,"Line")};t.VerticalLine.getRandomMove=t._helper.getRandMove;t.VerticalLine.stateSize=6;t.LineByFixedAngle={};t.LineByFixedAngle.kind="L";t.LineByFixedAngle.signature=["L","P"];t.LineByFixedAngle.initialize=function(a){var b=n._helper.input(a.angle),
c=n.cos(b);b=n.sin(b);a.rot=h.turnIntoCSList([h.turnIntoCSList([b,c,n.zero]),h.turnIntoCSList([n.neg(c),b,n.zero]),h.turnIntoCSList([n.zero,n.zero,n.zero])])};t.LineByFixedAngle.updatePosition=function(a){var b=H.csnames[a.args[1]],c=h.productMV(a.rot,H.csnames[a.args[0]].homog);a.homog=h.cross(b.homog,c);a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Line")};t.Through={};t.Through.kind="L";t.Through.signature=["P"];t.Through.isMovable=!0;t.Through.initialize=function(a){a=a.dir?A.wrap(a.dir):
h.realVector([a.pos[1],-a.pos[0],0]);Xa(a)};t.Through.getParamForInput=function(a,b,c){a="dir"===c||"mouse"===c?h.cross(H.csnames[a.args[0]].homog,b):"homog"===c?b:h.turnIntoCSList([n.zero,n.zero,n.zero]);a=h.cross(h.linfty,a);return h.normalizeMax(a)};t.Through.getParamFromState=function(a){return db(3)};t.Through.putParamToState=function(a,b){Xa(b)};t.Through.updatePosition=function(a){var b=db(3);Xa(b);b=h.cross(H.csnames[a.args[0]].homog,b);b=h.normalizeMax(b);a.homog=A.withUsage(b,"Line")};t.Through.getRandomMove=
t._helper.getRandMove;t.Through.stateSize=6;t.Through.set_angle=function(a,b){if("number"===b.ctype){var c=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([c,b,n.real(0)]);Tb(a,c,"dir")}};t.Through.set_slope=function(a,b){"number"===b.ctype&&(b=h.turnIntoCSList([n.real(1),b,n.real(0)]),Tb(a,b,"dir"))};t.Free={};t.Free.kind="P";t.Free.signature=[];t.Free.isMovable=!0;t.Free.initialize=function(a){a=t._helper.initializePoint(a);Xa(a)};t.Free.getParamForInput=function(a,b,c){if("mouse"===c&&Ad&&0!==Ub){b=h.normalizeZ(b);
a=b.value[0].value.real;c=b.value[1].value.real;var d=Math.round(a/Ub)*Ub,f=Math.round(c/Ub)*Ub;Math.abs(d-a)<Vc&&Math.abs(f-c)<Vc&&(b=h.realVector([d,f,1]))}return h.normalizeMax(b)};t.Free.getParamFromState=function(a){return db(3)};t.Free.putParamToState=function(a,b){Xa(b)};t.Free.updatePosition=function(a){var b=db(3);Xa(b);a.homog=A.withUsage(b,"Point")};t.Free.getRandomMove=t._helper.getRandPointMove;t.Free.stateSize=6;t._helper.projectPointToLine=function(a,b){var c=h.turnIntoCSList([b.value[0],
b.value[1],n.zero]);a=h.cross(c,a);return h.normalizeMax(h.cross(a,b))};t.PointOnLine={};t.PointOnLine.kind="P";t.PointOnLine.signature=["L"];t.PointOnLine.isMovable=!0;t.PointOnLine.initialize=function(a){var b=t._helper.initializePoint(a);a=H.csnames[a.args[0]].homog;b=t._helper.projectPointToLine(b,a);b=h.normalizeMax(b);var c=h.cross(h.linfty,b);h.normalizeMax(c);Xa(b);Xa(a);nd=!1};t.PointOnLine.updatePosition=function(a,b){var c=H.csnames[a.args[0]].homog;var d=db(3);db(3);if(!b){ic=a.stateIdx;
var f=Fb;Fb=oc;b=db(3);var k=db(3);Fb=f;f=h.cross(k,c);h._helper.isAlmostZero(f)&&(f=h.cross(h.linfty,c));b=t._helper.CircleMP(f,b);b=t._helper.IntersectLC(c,b);f=t._helper.pointReflection(f,d);d=ke(b[0],b[1],d,f)[0]}d=h.normalizeMax(d);Xa(d);Xa(c);a.homog=A.withUsage(d,"Point")};t.PointOnLine.getParamForInput=function(a,b,c){a=H.csnames[a.args[0]].homog;b=t._helper.projectPointToLine(b,a);"mouse"===c&&Ad&&0!==Ub&&(b=t._helper.snapPointToLine(b,a));return b};t.PointOnLine.getParamFromState=function(a){return db(3)};
t.PointOnLine.putParamToState=function(a,b){return Xa(b)};t.PointOnLine.getRandomMove=t._helper.getRandPointMove;t.PointOnLine.stateSize=12;t.PointOnCircle={};t.PointOnCircle.kind="P";t.PointOnCircle.signature=["C"];t.PointOnCircle.isMovable=!0;t.PointOnCircle.initialize=function(a){var b=H.csnames[a.args[0]];a=h.normalizeZ(t._helper.initializePoint(a));var c=h.normalizeZ(t._helper.CenterOfCircle(b.matrix)),d=h.sub(a,c);d=h.turnIntoCSList([d.value[1],n.neg(d.value[0]),n.zero]);c=h.cross(a,c);b=t._helper.IntersectLC(c,
b.matrix);c=h.projectiveDistMinScal(a,b[0]);h.projectiveDistMinScal(a,b[1])<c?(a=b[1],b=b[0]):(a=b[0],b=b[1]);Xa(d);Xa(a);Xa(b);nd=!1};t.PointOnCircle.putParamToState=function(a,b){Xa(b)};t.PointOnCircle.getParamFromState=function(a){return db(3)};t.PointOnCircle.getParamForInput=function(a,b,c){c=h.normalizeZ(t._helper.CenterOfCircle(H.csnames[a.args[0]].matrix));b=h.sub(b,c);ic=a.stateIdx;a=db(3);var d=h.normalizeZ(db(3));c=h.sub(d,c);0>n.sub(n.mult(a.value[0],c.value[1]),n.mult(a.value[1],c.value[0])).value.real&&
(b=h.neg(b));return h.turnIntoCSList([b.value[1],n.neg(b.value[0]),n.zero])};t.PointOnCircle.parameterPath=function(a,b,c,d,f){d=h.normalizeAbs(d);f=h.normalizeAbs(f);var k=h.scalproduct(d,f);if(0<=k.value.real)return Re(a,b,c,d,f);a=h.turnIntoCSList([n.sub(d.value[1],f.value[1]),n.sub(f.value[0],d.value[0]),n.zero]);k=h.scalproduct(d,a);0>k.value.real&&(a=h.neg(a));0>b?(b=2*b+1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.25,(1-c)*k)):(b=2*b-1,c=b*b,k=.25/(1+c),c=n.complex(2*b*k+.75,(1-c)*k));var m=n.sub(n.real(1),
c);b=n.mult(c,c);k=n.mult(m,m);c=n.mult(c,m);d=h.scalmult(k,d);d=h.add(d,h.scalmult(c,a));return d=h.add(d,h.scalmult(b,f))};t.PointOnCircle.updatePosition=function(a){var b=db(3);Xa(b);var c=H.csnames[a.args[0]];b=h.productMV(c.matrix,b);c=t._helper.IntersectLC(b,c.matrix);c=mc(c[0],c[1]);b=h.normalizeMax(c.value[0]);a.homog=A.withUsage(b,"Point");a.antipodalPoint=c.value[1]};t.PointOnCircle.getRandomMove=t._helper.getRandPointMove;t.PointOnCircle.stateSize=6+mc.stateSize;t.PointOnCircle.get_angle=
function(a){var b=t._helper.CenterOfCircle(H.csnames[a.args[0]].matrix),c=h._helper.isAlmostFarpoint;if(c(a.homog)||c(b))return B;a=h.normalizeZ(a.homog);b=h.normalizeZ(b);b=h.sub(a,b);b=n.arctan2(b.value[0],b.value[1]);a=n.real(Gd);b=n.mod(n.add(b,a),a);return A.withUsage(b,"Angle")};t.PointOnCircle.set_angle=function(a,b){if("number"===b.ctype){var c=H.csnames[a.args[0]],d=t._helper.CenterOfCircle(c.matrix);if(!h._helper.isAlmostFarpoint(d)){d=h.normalizeZ(d);var f=n.cos(b);b=n.sin(b);c=h.turnIntoCSList([n.mult(f,
c.radius),n.mult(b,c.radius),n.real(0)]);Tb(a,h.add(d,c),"homog")}}return B};t.OtherPointOnCircle={};t.OtherPointOnCircle.kind="P";t.OtherPointOnCircle.signature=["P"];t.OtherPointOnCircle.signatureConstraints=function(a){return"PointOnCircle"===H.csnames[a.args[0]].type};t.OtherPointOnCircle.updatePosition=function(a){var b=H.csnames[a.args[0]].antipodalPoint;b=h.normalizeMax(b);a.homog=A.withUsage(b,"Point")};t.PointOnSegment={};t.PointOnSegment.kind="P";t.PointOnSegment.signature=["S"];t.PointOnSegment.isMovable=
!0;t.PointOnSegment.initialize=function(a){var b=t._helper.initializePoint(a);a=t.PointOnSegment.getParamForInput(a,b);Bc(a)};t.PointOnSegment.getParamForInput=function(a,b,c){a=H.csnames[a.args[0]];var d=a.homog;"mouse"===c&&Ad&&0!==Ub&&(b=t._helper.snapPointToLine(b,d));c=h.turnIntoCSList([d.value[0],d.value[1],n.zero]);d=h.sub(a.startpos,a.endpos);b=h.crossratio3(d,a.startpos,a.endpos,b,c);0>b.value.real&&(b=n.complex(0,b.value.imag));1<b.value.real&&(b=n.complex(1,b.value.imag));return b};t.PointOnSegment.getParamFromState=
function(a){return id()};t.PointOnSegment.putParamToState=function(a,b){Bc(b)};t.PointOnSegment.updatePosition=function(a){var b=id();Bc(b);var c=H.csnames[a.args[0]],d=c.startpos;c=h.sub(c.endpos,d);b=h.add(d,h.scalmult(b,c));b=h.normalizeMax(b);a.homog=A.withUsage(b,"Point")};t.PointOnSegment.getRandomMove=t._helper.getRandPointMove;t.PointOnSegment.stateSize=2;t._helper.projectPointToCircle=function(a,b){var c=t._helper.CenterOfCircle(a.matrix);c=h.normalizeMax(c);c=h.normalizeMax(h.cross(b,c));
a=t._helper.IntersectLC(c,a.matrix);c=h.projectiveDistMinScal(b,a[0]);b=h.projectiveDistMinScal(b,a[1]);return c<b?a[0]:a[1]};t.PointOnArc={};t.PointOnArc.kind="P";t.PointOnArc.signature=["C"];t.PointOnArc.signatureConstraints=function(a){return H.csnames[a.args[0]].isArc};t.PointOnArc.isMovable=!0;t.PointOnArc.initialize=function(a){var b=t._helper.initializePoint(a);a=t.PointOnArc.getParamForInput(a,b);Xa(a)};t.PointOnArc.getParamForInput=function(a,b){a=H.csnames[a.args[0]];b=t._helper.projectPointToCircle(a,
b);b=h.normalizeMax(h.crossratio3harm(a.startPoint,a.endPoint,a.viaPoint,b,h.ii));a=n.div(b.value[0],b.value[1]);0>a.value.real&&(b=-1>a.value.real?h.realVector([1,0]):h.realVector([0,1]));return b};t.PointOnArc.getParamFromState=function(a){return db(2)};t.PointOnArc.putParamToState=function(a,b){Xa(b)};t.PointOnArc.updatePosition=function(a){var b=H.csnames[a.args[0]],c=b.startPoint,d=b.viaPoint,f=b.endPoint,k=h.ii,m=h.cross(c,k);d=h.cross(d,k);var p=h.cross(f,k);p=h.turnIntoCSList([m,p]);m=h.transpose(p);
p=h.conjugate(p);m=h.productMM(p,m);d=h.productMV(p,d);m=h.productMV(h.adjoint2(m),d);d=m.value[0];m=m.value[1];p=db(2);Xa(p);c=h.normalizeMax(h.add(h.scalmult(n.mult(d,p.value[0]),c),h.scalmult(n.mult(m,p.value[1]),f)));b=t._helper.conicOtherIntersection(b.matrix,k,c);a.homog=A.withUsage(b,"Point")};t.PointOnArc.getRandomMove=t._helper.getRandPointMove;t.PointOnArc.stateSize=4;t._helper.CenterOfCircle=function(a){return h.turnIntoCSList([a.value[2].value[0],a.value[2].value[1],n.neg(a.value[0].value[0])])};
t._helper.CenterOfConic=function(a){a=h.adjoint3(a);return{ctype:"list",value:[a.value[2].value[0],a.value[2].value[1],a.value[2].value[2]]}};t.CenterOfConic={};t.CenterOfConic.kind="P";t.CenterOfConic.signature=["C"];t.CenterOfConic.updatePosition=function(a){var b=t._helper.CenterOfConic(H.csnames[a.args[0]].matrix);a.homog=b;a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Point")};t._helper.CircleMP=function(a,b){var c=a.value[0],d=a.value[1];a=n.neg(a.value[2]);var f=n.zero;c=h.turnIntoCSList([h.turnIntoCSList([a,
f,c]),h.turnIntoCSList([f,a,d]),h.turnIntoCSList([c,d,f])]);d=A.mult(A.mult(b,c),b);b=A.mult(A.mult(b,h.fund),b);d=A.mult(d,h.fund);b=A.mult(b,c);return h.sub(d,b)};t.CircleMP={};t.CircleMP.kind="C";t.CircleMP.signature=["P","P"];t.CircleMP.updatePosition=function(a){a.matrix=t._helper.CircleMP(H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog);a.matrix=h.normalizeMax(a.matrix);a.matrix=A.withUsage(a.matrix,"Circle")};t.CircleMr={};t.CircleMr.kind="C";t.CircleMr.signature=["P"];t.CircleMr.isMovable=
!0;t.CircleMr.initialize=function(a){Bc(n.real(a.radius))};t.CircleMr.getParamForInput=function(a,b,c){if("radius"===c)return b;a=H.csnames[a.args[0]].homog;a=h.normalizeZ(a);b=h.normalizeZ(b);b=h.sub(a,b);return b=h.abs(b)};t.CircleMr.getParamFromState=function(a){return id()};t.CircleMr.putParamToState=function(a,b){Bc(b)};t.CircleMr.updatePosition=function(a){var b=id();Bc(b);var c=H.csnames[a.args[0]].homog,d=n.mult(c.value[2],b);d=n.mult(d,d);if(!n._helper.isFinite(d)&&!n._helper.isNaN(d))return h.fund;
c=t._helper.ScaledCircleMrr(c,d);a.matrix=A.withUsage(c,"Circle");a.radius=b};t.CircleMr.getRandomMove=function(a){a=a.radius;return{type:"radius",value:n.abs(a).value.real<n.eps?n.getRandComplex(.05,.1):n.mult(a,n.getRandReal(.95,1.05))}};t.CircleMr.stateSize=2;t.CircleMr.set_radius=function(a,b){"number"===b.ctype&&Tb(a,b,"radius")};t._helper.ScaledCircleMrr=function(a,b){var c=a.value[0],d=a.value[1];a=n.neg(a.value[2]);a=h.scalmult(a,h.turnIntoCSList([c,d,a])).value;c=h.turnIntoCSList([c,d]);
b=n.sub(h.scalproduct(c,c),b);b=t._helper.buildConicMatrix([a[2],n.zero,a[2],a[0],a[1],b]);return h.normalizeMax(b)};t.Compass={};t.Compass.kind="C";t.Compass.signature=["P","P","P"];t.Compass.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=b.value[2],k=c.value[2],m=d.value[2];b=h.scalmult(n.mult(k,m),b);c=h.scalmult(n.mult(f,m),c);d=h.scalmult(n.mult(f,k),d);b=h.sub(c,b);d=t._helper.ScaledCircleMrr(d,h.scalproduct(b,b));a.matrix=
A.withUsage(d,"Circle")};t._helper.getConicType=function(a){if(1E-16>n.abs(h.det(a)).value.real)return"degenerate";var b=n.mult(a.value[0].value[0],a.value[1].value[1]);b=n.sub(b,n.pow(a.value[0].value[1],n.real(2)));b=b.value.real;return 1E-16>Math.abs(b)?"parabola":1E-16<b?"ellipsoid":"hyperbola"};t._helper.ConicBy5=function(a,b,c,d,f,k){a=h.turnIntoCSList([h.cross(c,d)]);var m=h.turnIntoCSList([h.cross(b,f)]);b=h.turnIntoCSList([h.cross(b,c)]);d=h.turnIntoCSList([h.cross(d,f)]);return t._helper.conicFromTwoDegenerates(a,
m,b,d,k)};t._helper.conicFromTwoDegenerates=function(a,b,c,d,f){a=A.mult(h.transpose(b),a);c=A.mult(h.transpose(d),c);a=h.add(a,h.transpose(a));c=h.add(c,h.transpose(c));d=A.mult(A.mult(f,a),f);f=A.mult(A.mult(f,c),f);c=A.mult(d,c);f=A.mult(f,a);return h.sub(c,f)};t.ConicBy5={};t.ConicBy5.kind="C";t.ConicBy5.signature=["P","P","P","P","P"];t.ConicBy5.updatePosition=function(a){var b=t._helper.ConicBy5(a,H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,
H.csnames[a.args[4]].homog);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=A.withUsage(a.matrix,"Conic")};t.FreeConic={};t.FreeConic.kind="C";t.FreeConic.signature=[];t.FreeConic.initialize=function(a){var b=a.pos?t._helper.inputConic(a.pos):h.zeromatrix(n.real(3),n.real(3));t.FreeConic.putParamToState(a,b)};t.FreeConic.getParamForInput=function(a,b,c){return h.normalizeMax(b)};t.FreeConic.getParamFromState=function(a){return t._helper.buildConicMatrix(db(6).value)};t.FreeConic.putParamToState=
function(a,b){for(a=0;3>a;++a)for(var c=0;c<=a;++c)Bc(b.value[a].value[c])};t.FreeConic.updatePosition=function(a){var b=db(6);Xa(b);a.matrix=t._helper.buildConicMatrix(b.value);a.matrix=h.normalizeMax(a.matrix);a.matrix=A.withUsage(a.matrix,"Conic")};t.FreeConic.set_matrix=function(a,b){h._helper.isNumberMatrixMN(b,3,3)&&Tb(a,h.add(b,h.transpose(b)),"matrix")};t.FreeConic.stateSize=12;t._helper.buildConicMatrix=function(a){var b=a[1],c=a[2],d=a[3],f=a[4],k=a[5];return h.turnIntoCSList([h.turnIntoCSList([a[0],
b,d]),h.turnIntoCSList([b,c,f]),h.turnIntoCSList([d,f,k])])};t._helper.flattenConicMatrix=function(a){return h.turnIntoCSList([a.value[0].value[0],a.value[0].value[1],a.value[1].value[1],a.value[0].value[2],a.value[1].value[2],a.value[2].value[2]])};t._helper.splitDegenConic=function(a){var b=h.adjoint3(a),c=0,d,f=n.abs2(b.value[0].value[0]).value.real;for(d=1;3>d;d++){var k=n.abs2(b.value[d].value[d]).value.real;k>f&&(c=d,f=k)}d=n.sqrt(n.mult(n.real(-1),b.value[c].value[c]));if(1E-16>n.abs2(d).value.real)return a=
h.turnIntoCSList([n.zero,n.zero,n.zero]),[a,a];c=n.real(c+1);k=h.column(b,c);k=h.scaldiv(d,k);d=k.value[0];f=k.value[1];k=k.value[2];d=h.turnIntoCSList([h.turnIntoCSList([n.real(0),k,n.mult(n.real(-1),f)]),h.turnIntoCSList([n.mult(n.real(-1),k),n.real(0),d]),h.turnIntoCSList([f,n.mult(n.real(-1),d),n.real(0)])]);a=h.add(a,d);var m=0;for(d=f=b=0;3>d;d++)for(c=0;3>c;c++)k=n.abs2(a.value[d].value[c]).value.real,k>f&&(m=d,b=c,f=k);d=a.value[m];a=h.transpose(a);a=a.value[b];d=h.normalizeMax(d);a=h.normalizeMax(a);
d=A.withUsage(d,"Line");a=A.withUsage(a,"Line");return[d,a]};t._helper.inputConic=function(a){var b="xx xy yy xz yz zz".split(" ").map(function(c){var d=n._helper.input(a[c]);c[0]!==c[1]&&(d=n.realmult(.5,d));return d});return t._helper.buildConicMatrix(b)};t.SelectConic={};t.SelectConic.kind="C";t.SelectConic.signature=["Cs"];t.SelectConic.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=t._helper.inputConic(a.pos);a=H.csnames[a.args[0]].results;for(var c=h.conicDist(b,a[0]),d=0,
f=1;f<a.length;++f){var k=h.conicDist(b,a[f]);k<c&&(c=k,d=f)}return d};t.SelectConic.updatePosition=function(a){a.matrix=H.csnames[a.args[0]].results[a.param];a.matrix=h.normalizeMax(a.matrix);a.matrix=A.withUsage(a.matrix,"Conic")};t._helper.ConicBy4p1l=function(a,b,c,d,f,k){var m=h.scalproduct(b,k),p=h.scalproduct(c,k),u=h.scalproduct(d,k),w=h.scalproduct(f,k),z=h.det3(c,d,f),D=h.det3(b,c,f),F=h.det3(b,d,f),K=h.det3(b,c,d),V=n.mult;p=n.sqrt(V(V(p,w),V(z,D)));m=n.sqrt(V(V(m,u),V(F,K)));u=h.cross(h.cross(b,
d),k);k=h.cross(h.cross(c,f),k);u=h.scalmult(p,u);m=h.scalmult(m,k);k=h.normalizeMax(h.add(u,m));m=h.normalizeMax(h.sub(u,m));m=mc(k,m);k=t._helper.ConicBy5(a,b,c,d,f,m.value[0]);a=t._helper.ConicBy5(a,b,c,d,f,m.value[1]);return[h.normalizeMax(k),h.normalizeMax(a)]};t.ConicBy4p1l={};t.ConicBy4p1l.kind="Cs";t.ConicBy4p1l.signature=["P","P","P","P","L"];t.ConicBy4p1l.updatePosition=function(a){var b=t._helper.ConicBy4p1l(a,H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,
H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog);a.results=b};t.ConicBy4p1l.stateSize=mc.stateSize;t._helper.ConicBy3p2l=function(a,b,c,d,f){function k(Ea,La,va,Ia){return n.sub(n.mult(Ea,Ia),n.mult(La,va))}var m=h.cross(a,b),p=h.cross(d,f);d=h.cross(d,m);f=h.cross(f,m);m=h.turnIntoCSList([d,f,p]);c=h.productVM(c,h.adjoint3(m));p=h.adjoint3(h.turnIntoCSList([h.scalmult(c.value[0],d),h.scalmult(c.value[1],f),h.scalmult(c.value[2],p)]));c=h.transpose(p);d=n.mult;f=h.productMV(c,a);a=f.value[0];
f=f.value[1];m=h.productMV(c,b);b=m.value[0];m=m.value[1];var u=n.sqrt(d(a,f)),w=n.sqrt(d(b,m)),z,D=Array(4);for(z=0;4>z;++z){var F=(z&2)-1,K=d(n.real(((z&1)<<1)-1),u),V=d(n.real(F),w),Q=k(f,K,m,V),da=k(b,V,a,K);F=k(a,f,b,m);var W=n.add(n.add(k(b,m,a,f),k(m,V,f,K)),k(V,b,K,a));K=d(Q,Q);V=d(da,da);var na=d(W,W),ia=d(Q,da);Q=d(Q,W);da=d(da,W);ia=n.sub(ia,d(n.real(.5),d(F,F)));F=h.turnIntoCSList([h.turnIntoCSList([K,ia,Q]),h.turnIntoCSList([ia,V,da]),h.turnIntoCSList([Q,da,na])]);F=h.productMM(p,h.productMM(F,
c));F=h.turnIntoCSList([F.value[0].value[0],F.value[0].value[1],F.value[0].value[2],F.value[1].value[1],F.value[1].value[2],F.value[2].value[2]]);D[z]=F}return D};t.ConicBy3p2l={};t.ConicBy3p2l.kind="Cs";t.ConicBy3p2l.signature=["P","P","P","L","L"];t.ConicBy3p2l.updatePosition=function(a){var b=t._helper.ConicBy3p2l(H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog);b=Xe(b);for(var c=Array(4),d=0;4>d;++d){var f=
b[d].value;c[d]=h.turnIntoCSList([h.turnIntoCSList([f[0],f[1],f[2]]),h.turnIntoCSList([f[1],f[3],f[4]]),h.turnIntoCSList([f[2],f[4],f[5]])])}a.results=c};t.ConicBy3p2l.stateSize=48;t.ConicBy2p3l={};t.ConicBy2p3l.kind="Cs";t.ConicBy2p3l.signature=["P","P","L","L","L"];t.ConicBy2p3l.updatePosition=function(a){var b=t._helper.ConicBy3p2l(H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog,H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog);b=Xe(b);for(var c=Array(4),d=
0;4>d;++d){var f=b[d].value;f=h.turnIntoCSList([h.turnIntoCSList([f[0],f[1],f[2]]),h.turnIntoCSList([f[1],f[3],f[4]]),h.turnIntoCSList([f[2],f[4],f[5]])]);c[d]=h.normalizeMax(h.adjoint3(f))}a.results=c};t.ConicBy2p3l.stateSize=48;t.ConicBy1p4l={};t.ConicBy1p4l.kind="Cs";t.ConicBy1p4l.signature=["P","L","L","L","L"];t.ConicBy1p4l.updatePosition=function(a){var b=t._helper.ConicBy4p1l(a,H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog,H.csnames[a.args[0]].homog),
c=b[0];b=b[1];c=h.adjoint3(c);b=h.adjoint3(b);b=[c,b];a.results=b};t.ConicBy1p4l.stateSize=mc.stateSize;t.ConicParabolaPL={};t.ConicParabolaPL.kind="C";t.ConicParabolaPL.signature=["P","L"];t.ConicParabolaPL.updatePosition=function(a){var b=H.csnames[a.args[0]].homog.value,c=H.csnames[a.args[1]].homog.value,d=n.mult,f=n.neg,k=n.add,m=n.sub,p=b[0],u=b[1],w=b[2],z=c[0];b=c[1];c=c[2];var D=d(w,w),F=d(z,z),K=d(b,b),V=d(w,c),Q=f(w);w=k(F,K);K=d(D,K);F=d(D,F);f=d(f(D),d(z,b));z=d(Q,k(d(p,w),d(V,z)));b=
d(Q,k(d(u,w),d(V,b)));d=m(d(k(d(p,p),d(u,u)),w),d(D,d(c,c)));d=t._helper.buildConicMatrix([K,f,F,z,b,d]);d=h.normalizeMax(d);a.matrix=A.withUsage(d,"Conic")};t.ConicBy2Foci1P={};t.ConicBy2Foci1P.kind="Cs";t.ConicBy2Foci1P.signature=["P","P","P"];t.ConicBy2Foci1P.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=h.ii,k=h.jj,m=h.normalizeMax(h.cross(b,d)),p=h.normalizeMax(h.cross(c,d)),u=h.normalizeMax(h.cross(d,f));d=h.normalizeMax(h.cross(d,
k));p=t._helper.coHarmonic(u,d,m,p);m=h.normalizeMax(p[0]);p=h.normalizeMax(p[1]);f=h.turnIntoCSList([f]);u=h.turnIntoCSList([k]);d=h.turnIntoCSList([b]);var w=h.turnIntoCSList([c]);k=t._helper.conicFromTwoDegenerates(f,u,d,w,m);k=h.normalizeMax(k);f=t._helper.conicFromTwoDegenerates(f,u,d,w,p);f=h.normalizeMax(f);k=h.normalizeMax(h.adjoint3(k));f=h.normalizeMax(h.adjoint3(f));"ellipsoid"!==t._helper.getConicType(k)&&(m=k,k=f,f=m);h.almostequals(b,c).value&&(b=n.real(3),f=h.zeromatrix(b,b));a.results=
[k,f]};t.ConicBy2Pol1P={};t.ConicBy2Pol1P.kind="C";t.ConicBy2Pol1P.signature=["P","L","P","L","P"];t.ConicBy2Pol1P.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=H.csnames[a.args[3]].homog,k=H.csnames[a.args[4]].homog,m=h.scalproduct,p=h.scalmult,u=h.sub,w=h.productMM,z=n.realmult,D=h.transpose,F=h.turnIntoCSList,K=u(p(m(c,b),k),p(z(2,m(c,k)),b)),V=u(p(m(f,d),k),p(z(2,m(f,k)),d)),Q=F([h.cross(b,k)]);k=F([h.cross(d,k)]);V=w(D(Q),
F([h.cross(b,V)]));F=w(D(k),F([h.cross(d,K)]));w=w(D(Q),k);b=m(b,f);c=m(d,c);d=h.add(p(c,V),p(b,F));d=u(d,p(z(2,n.mult(b,c)),w));d=h.add(d,D(d));d=h.normalizeMax(d);d=A.withUsage(d,"Conic");a.matrix=d};t.ConicBy2Pol1L={};t.ConicBy2Pol1L.kind="C";t.ConicBy2Pol1L.signature=["P","L","P","L","L"];t.ConicBy2Pol1L.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=H.csnames[a.args[3]].homog,k=H.csnames[a.args[4]].homog,m=h.scalproduct,
p=h.scalmult,u=h.productMM,w=n.mult,z=h.transpose,D=h.turnIntoCSList,F=m(c,b),K=m(c,d),V=m(f,b),Q=m(f,d),da=m(k,b);m=m(k,d);var W=D([h.sub(p(w(V,m),c),p(w(K,da),f))]);b=h.add(u(z(D([p(w(V,K),k)])),D([h.sub(h.add(p(n.sub(w(F,m),w(K,da)),f),p(n.sub(w(Q,da),w(V,m)),c)),p(h.det3(c,f,k),h.cross(b,d)))])),u(z(W),W));b=h.add(b,z(b));b=h.normalizeMax(b);b=A.withUsage(b,"Conic");a.matrix=b};t._helper.conic1Pol3Inc=function(a,b,c,d,f){var k=h.scalproduct,m=h.scalmult,p=h.productMM,u=h.cross,w=n.realmult,z=
n.mult,D=h.transpose,F=h.turnIntoCSList,K=h.det3,V=K(a,c,d),Q=F([u(c,f)]),da=F([u(a,f)]),W=F([u(c,d)]),na=k(b,a),ia=k(b,c);b=k(b,f);u=F([u(d,h.sub(m(na,f),m(w(2,b),a)))]);Q=m(V,p(D(Q),u));a=w(2,n.add(z(K(a,d,f),ia),z(V,b)));a=n.sub(z(K(c,d,f),na),a);Q=h.add(Q,m(a,p(D(da),W)));Q=h.add(Q,D(Q));return Q=h.normalizeMax(Q)};t.ConicBy1Pol3P={};t.ConicBy1Pol3P.kind="C";t.ConicBy1Pol3P.signature=["P","L","P","P","P"];t.ConicBy1Pol3P.updatePosition=function(a){var b=t._helper.conic1Pol3Inc(H.csnames[a.args[0]].homog,
H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog);b=A.withUsage(b,"Conic");a.matrix=b};t.ConicBy1Pol3L={};t.ConicBy1Pol3L.kind="C";t.ConicBy1Pol3L.signature=["P","L","L","L","L"];t.ConicBy1Pol3L.updatePosition=function(a){var b=t._helper.conic1Pol3Inc(H.csnames[a.args[1]].homog,H.csnames[a.args[0]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog);b=h.normalizeMax(h.adjoint3(b));b=A.withUsage(b,"Conic");
a.matrix=b};t.ConicBy1Pol2P1L={};t.ConicBy1Pol2P1L.kind="Cs";t.ConicBy1Pol2P1L.signature=["P","L","P","P","L"];t.ConicBy1Pol2P1L.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=H.csnames[a.args[3]].homog,k=H.csnames[a.args[4]].homog,m=n.add,p=h.turnIntoCSList,u=h.cross,w=h.productMM,z=n.mult,D=n.realmult,F=h.scalmult,K=h.scalproduct,V=n.sub,Q=h.transpose,da=K(c,b),W=K(c,d),na=K(c,f);c=K(k,b);var ia=K(k,d);K=K(k,f);k=p([u(b,d)]);
b=p([u(b,f)]);d=p([u(d,f)]);f=n.sqrt(z(z(ia,K),z(V(z(da,ia),D(2,z(c,W))),V(z(da,K),D(2,z(c,na))))));p=w(Q(k),b);f=F(f,h.add(p,Q(p)));m=F(V(z(da,z(ia,K)),m(z(c,z(W,K)),z(c,z(ia,na)))),p);D=h.add(h.sub(F(na,k),F(W,b)),F(D(.5,da),d));m=h.add(m,F(z(c,c),w(Q(d),D)));m=h.add(m,Q(m));w=h.normalizeMax(h.add(f,m));z=h.normalizeMax(h.sub(f,m));a.results=wd(w,z).value};t.ConicBy1Pol2P1L.stateSize=wd.stateSize;t.ConicBy1Pol1P2L={};t.ConicBy1Pol1P2L.kind="Cs";t.ConicBy1Pol1P2L.signature=["P","L","P","L","L"];
t.ConicBy1Pol1P2L.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=H.csnames[a.args[3]].homog,k=H.csnames[a.args[4]].homog,m=n.add,p=h.turnIntoCSList,u=h.cross,w=h.productMM,z=n.mult,D=n.realmult,F=h.scalmult,K=h.scalproduct,V=n.sub,Q=h.transpose,da=K(c,b),W=K(c,d),na=K(f,b),ia=K(f,d),Ea=K(k,b),La=K(k,d),va=z(da,da),Ia=z(da,W);K=z(W,W);var Ja=z(na,na),Oa=z(na,ia),Ba=z(ia,ia),Wa=z(Ea,Ea),fb=z(Ea,La),Lb=z(La,La),kb=z(z(va,Ba),Lb);
kb=V(kb,D(2,z(z(Ia,Oa),Lb)));kb=V(kb,D(2,z(z(Ia,Ba),fb)));kb=m(kb,D(.5,z(z(K,Ja),Lb)));kb=m(kb,D(3,z(z(K,Oa),fb)));kb=m(kb,D(.5,z(z(K,Ba),Wa)));fb=z(z(da,ia),La);fb=V(fb,z(z(W,na),La));fb=V(fb,z(z(W,ia),Ea));fb=z(fb,z(K,Ea));Lb=V(z(da,ia),D(2,z(W,na)));Lb=z(Lb,z(K,z(ia,Ea)));kb=w(Q(p([c])),p([h.add(h.add(F(kb,c),F(fb,f)),F(Lb,k))]));fb=p([f]);kb=h.add(kb,F(D(.5,z(z(K,K),Wa)),w(Q(fb),fb)));kb=h.add(kb,F(K,w(Q(p([k])),p([h.add(F(V(V(D(2,z(Ia,Oa)),z(va,Ba)),D(.5,z(K,Ja))),k),F(z(h.det3(c,f,k),V(z(da,
ia),z(W,na))),u(b,d)))]))));kb=h.add(kb,Q(kb));b=n.sqrt(z(z(ia,La),z(V(z(da,ia),D(2,z(W,na))),V(z(da,La),D(2,z(W,Ea))))));c=w(Q(p([c])),p([h.sub(F(V(z(W,m(z(na,La),z(ia,Ea))),z(da,z(ia,La))),c),F(K,h.add(F(Ea,f),F(na,k))))]));c=h.add(c,F(z(da,K),w(Q(p([f])),p([k]))));c=F(b,c);c=h.add(c,Q(c));f=h.normalizeMax(h.add(kb,c));k=h.normalizeMax(h.sub(kb,c));a.results=wd(f,k).value};t.ConicBy1Pol1P2L.stateSize=wd.stateSize;t._helper.coHarmonic=function(a,b,c,d){var f=h.realVector([100*Math.random(),100*Math.random(),
1]),k=h.det3(f,c,a),m=h.det3(f,c,b);c=h.det3(f,d,a);d=h.det3(f,d,b);d=n.sqrt(n.mult(d,m));k=n.sqrt(n.mult(c,k));a=A.mult(a,d);k=A.mult(b,k);b=h.add(a,k);a=h.sub(a,k);return[b,a]};t.ConicInSquare={};t.ConicInSquare.kind="C";t.ConicInSquare.signature=["P","P","P","P"];t.ConicInSquare.updatePosition=function(a){var b=J.basismap(H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog),c=n.one;c=t._helper.buildConicMatrix([c,c,c,n.real(-3),c,c]);b=h.adjoint3(b);
b=h.productMM(h.productMM(h.transpose(b),c),b);b=h.normalizeMax(b);a.matrix=A.withUsage(b,"Conic")};t.ConicBy5lines={};t.ConicBy5lines.kind="C";t.ConicBy5lines.signature=["L","L","L","L","L"];t.ConicBy5lines.updatePosition=function(a){var b=t._helper.ConicBy5(a,H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[4]].homog);b=h.adjoint3(b);a.matrix=b;a.matrix=h.normalizeMax(a.matrix);a.matrix=A.withUsage(a.matrix,"Conic")};t.ConicFromPrincipalDirections=
{};t.ConicFromPrincipalDirections.kind="C";t.ConicFromPrincipalDirections.signature=["P","P","P"];t.ConicFromPrincipalDirections.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=t._helper.pointReflection(b,c),k=h.cross(c,b);b=h.turnIntoCSList([k.value[0],k.value[1],n.zero]);k=h.turnIntoCSList([k]);c=h.turnIntoCSList([h.cross(c,b)]);f=h.turnIntoCSList([h.cross(f,b)]);a.matrix=t._helper.conicFromTwoDegenerates(k,k,c,f,d);a.matrix=
h.normalizeMax(a.matrix);a.matrix=A.withUsage(a.matrix,"Conic")};t.CircleBy3={};t.CircleBy3.kind="C";t.CircleBy3.signature=["P","P","P"];t.CircleBy3.updatePosition=function(a){var b=t._helper.ConicBy5(a,H.csnames[a.args[0]].homog,H.csnames[a.args[1]].homog,h.ii,h.jj,H.csnames[a.args[2]].homog);a.matrix=h.normalizeMax(b);a.matrix=A.withUsage(a.matrix,"Circle")};t.ArcBy3={};t.ArcBy3.kind="C";t.ArcBy3.signature=["P","P","P"];t.ArcBy3.updatePosition=function(a){t.CircleBy3.updatePosition(a);a.startPoint=
H.csnames[a.args[0]].homog;a.viaPoint=H.csnames[a.args[1]].homog;a.endPoint=H.csnames[a.args[2]].homog};t.ArcBy3.initialize=function(a){a.startPoint=H.csnames[a.args[0]].homog;a.viaPoint=H.csnames[a.args[1]].homog;a.endPoint=H.csnames[a.args[2]].homog;a.isArc=!0};t.PolarOfPoint={};t.PolarOfPoint.kind="L";t.PolarOfPoint.signature=["P","C"];t.PolarOfPoint.updatePosition=function(a){var b=A.mult(H.csnames[a.args[1]].matrix,H.csnames[a.args[0]].homog);b=h.normalizeMax(b);a.homog=A.withUsage(b,"Line")};
t.PolarOfLine={};t.PolarOfLine.kind="P";t.PolarOfLine.signature=["L","C"];t.PolarOfLine.updatePosition=function(a){var b=H.csnames[a.args[0]],c=h.adjoint3(H.csnames[a.args[1]].matrix);b=A.mult(c,b.homog);b=h.normalizeMax(b);a.homog=A.withUsage(b,"Point")};t.AngleBisector={};t.AngleBisector.kind="Ls";t.AngleBisector.signature=["L","L","P"];t.AngleBisector.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=H.csnames[a.args[2]].homog,f=h.add,k=h.sub,m=h.abs,p=
h.cross,u=h.scalmult,w=h.normalizeMax,z=h._helper.isAlmostZero,D=h.linfty,F=u(m(p(p(D,c),D)),b);b=u(m(p(p(D,b),D)),c);k=k(F,b);f=f(F,b);z(k)&&(k=p(p(p(D,f),D),d));z(f)&&(f=p(p(p(D,k),D),d));a.results=mc(w(k),w(f))};t.AngleBisector.stateSize=mc.stateSize;t._helper.IntersectLC=function(a,b){var c=n,d=h.crossOperator(a),f=h.transpose(d);b=A.mult(f,A.mult(b,d));f=h.maxIndex(a,n.abs2);if(0===f){f=b.value[1].value[1];var k=b.value[1].value[2];var m=b.value[2].value[1];var p=b.value[2].value[2];a=a.value[0]}else 1===
f?(f=b.value[0].value[0],k=b.value[0].value[2],m=b.value[2].value[0],p=b.value[2].value[2],a=a.value[1]):(f=b.value[0].value[0],k=b.value[0].value[1],m=b.value[1].value[0],p=b.value[1].value[1],a=a.value[2]);c=c.div(c.sqrt(c.sub(c.mult(k,m),c.mult(f,p))),a);c=h.add(b,h.scalmult(c,d));f=h.maxIndex(c,h.abs2);d=c.value[f];d=h.normalizeMax(d);d=A.withUsage(d,"Point");c=h.transpose(c);f=h.maxIndex(c,h.abs2);c=c.value[f];c=h.normalizeMax(c);c=A.withUsage(c,"Point");return[d,c]};t.IntersectLC={};t.IntersectLC.kind=
"Ps";t.IntersectLC.signature=["L","C"];t.IntersectLC.updatePosition=function(a){var b=t._helper.IntersectLC(H.csnames[a.args[0]].homog,H.csnames[a.args[1]].matrix);a.results=mc(b[0],b[1])};t.IntersectLC.stateSize=mc.stateSize;t.OtherIntersectionCL={};t.OtherIntersectionCL.kind="P";t.OtherIntersectionCL.signature=["C","L","P"];t.OtherIntersectionCL.updatePosition=function(a){var b=H.csnames[a.args[2]].homog,c=t._helper.IntersectLC(H.csnames[a.args[1]].homog,H.csnames[a.args[0]].matrix),d=c[0];c=c[1];
var f=h.projectiveDistMinScal(d,b);b=h.projectiveDistMinScal(c,b);a.homog=f<b?c:d;a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Point")};t.IntersectCirCir={};t.IntersectCirCir.kind="Ps";t.IntersectCirCir.signature=["C","C"];t.IntersectCirCir.updatePosition=function(a){var b=H.csnames[a.args[0]].matrix,c=H.csnames[a.args[1]].matrix,d=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);d=h.sub(d,c);d=h.turnIntoCSList([d.value[0],d.value[1],n.realmult(.5,
d.value[2])]);d=h.normalizeMax(d);b=t._helper.IntersectLC(d,b);a.results=mc(b[0],b[1])};t.IntersectCirCir.stateSize=mc.stateSize;t.OtherIntersectionCC={};t.OtherIntersectionCC.kind="P";t.OtherIntersectionCC.signature=["C","C","P"];t.OtherIntersectionCC.updatePosition=function(a){var b=H.csnames[a.args[0]].matrix,c=H.csnames[a.args[1]].matrix,d=H.csnames[a.args[2]].homog,f=h.scalmult(c.value[0].value[0],b.value[2]);c=h.scalmult(b.value[0].value[0],c.value[2]);f=h.sub(f,c);f=h.turnIntoCSList([f.value[0],
f.value[1],n.realmult(.5,f.value[2])]);f=h.normalizeMax(f);f=t._helper.IntersectLC(f,b);b=f[0];f=f[1];c=h.projectiveDistMinScal(b,d);d=h.projectiveDistMinScal(f,d);a.homog=c<d?f:b;a.homog=h.normalizeMax(a.homog);a.homog=A.withUsage(a.homog,"Point")};t._helper.IntersectConicConic=function(a,b){var c=a.value[0],d=a.value[1],f=a.value[2],k=b.value[0],m=b.value[1],p=b.value[2],u=h.det3(c,d,f),w=n.add(n.add(h.det3(c,d,p),h.det3(c,m,f)),h.det3(k,d,f));c=n.add(n.add(h.det3(c,m,p),h.det3(k,d,p)),h.det3(k,
m,f));k=h.det3(k,m,p);p=n.abs2(u).value.real;m=n.abs2(k).value.real;p<m&&(p=a,a=b,b=p,p=k,k=u,u=p,p=c,c=w,w=p,p=m);1E-24>p?(u=a,w=b):(w=n.solveCubic(u,w,c,k),c=n.abs2(n.sub(w[0],w[1])).value.real,k=n.abs2(n.sub(w[0],w[2])).value.real,m=n.abs2(n.sub(w[1],w[2])).value.real,c>k?(u=w[1],w=c>m?w[0]:w[2]):(u=w[2],w=k>m?w[0]:w[1]),u=h.add(h.scalmult(u,a),b),w=h.add(h.scalmult(w,a),b));b=t._helper.splitDegenConic(u);a=b[0];b=b[1];u=t._helper.splitDegenConic(w);c=u[0];w=u[1];u=h.cross(a,c);c=h.cross(b,c);
a=h.cross(a,w);b=h.cross(b,w);u=h.normalizeMax(u);c=h.normalizeMax(c);a=h.normalizeMax(a);b=h.normalizeMax(b);u=A.withUsage(u,"Point");c=A.withUsage(c,"Point");a=A.withUsage(a,"Point");b=A.withUsage(b,"Point");return[u,c,a,b]};t.IntersectConicConic={};t.IntersectConicConic.kind="Ps";t.IntersectConicConic.signature=["C","C"];t.IntersectConicConic.updatePosition=function(a){var b=t._helper.IntersectConicConic(H.csnames[a.args[0]].matrix,H.csnames[a.args[1]].matrix);b=le(b[0],b[1],b[2],b[3]);a.results=
b};t.IntersectConicConic.stateSize=le.stateSize;t.SelectP={};t.SelectP.kind="P";t.SelectP.signature=["Ps"];t.SelectP.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=H.csnames[a.args[0]].results.value;a=t._helper.initializePoint(a);for(var c=h.projectiveDistMinScal(a,b[0]),d=0,f=1;f<b.length;++f){var k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};t.SelectP.updatePosition=function(a){a.homog=H.csnames[a.args[0]].results.value[a.param]};t.SelectL={};t.SelectL.kind="L";t.SelectL.signature=
["Ls"];t.SelectL.initialize=function(a){if(void 0!==a.index)return a.index-1;var b=H.csnames[a.args[0]].results.value;a=t._helper.initializeLine(a);for(var c=h.projectiveDistMinScal(a,b[0]),d=0,f=1;f<b.length;++f){var k=h.projectiveDistMinScal(a,b[f]);k<c&&(c=k,d=f)}return d};t.SelectL.updatePosition=function(a){a.homog=H.csnames[a.args[0]].results.value[a.param];a.homog=A.withUsage(a.homog,"Line")};t._helper.moebiusStep=function(a,b,c){var d=n.add,f=n.sub,k=n.mult,m=a.value[0],p=a.value[1];a=a.value[2];
var u=b.value[0],w=b.value[1];b=b.value[2];var z=c.value[0],D=c.value[1],F=c.value[2];c=f(k(b,z),k(u,F));var K=f(k(b,D),k(w,F));z=f(k(m,F),k(a,z));D=f(k(p,F),k(a,D));return[f(k(m,c),k(p,K)),d(k(p,c),k(m,K)),k(a,c),k(a,K),f(k(u,z),k(w,D)),d(k(w,z),k(u,D)),k(b,z),k(b,D)]};t.TrMoebius={};t.TrMoebius.kind="Mt";t.TrMoebius.signature="PPPPPP".split("");t.TrMoebius.updatePosition=function(a){var b=n.neg,c=t._helper.moebiusStep(H.csnames[a.args[0]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[4]].homog),
d=t._helper.moebiusStep(H.csnames[a.args[1]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[5]].homog);d=h.normalizeMax(h.matrix([[d[0],b(d[1]),d[4],b(d[5])],[d[1],d[0],d[5],d[4]],[d[2],b(d[3]),d[6],b(d[7])],[d[3],d[2],d[7],d[6]]]));b=h.normalizeMax(h.matrix([[c[6],b(c[4])],[c[7],b(c[5])],[b(c[2]),c[0]],[b(c[3]),c[1]]]));b=h.normalizeMax(h.productMM(d,b));a.moebius={anti:!1,ar:b.value[0].value[0],ai:b.value[1].value[0],br:b.value[0].value[1],bi:b.value[1].value[1],cr:b.value[2].value[0],ci:b.value[3].value[0],
dr:b.value[2].value[1],di:b.value[3].value[1]};t._helper.moebiusPair(a)};t._helper.moebiusPair=function(a){var b=a.moebius,c=n.neg,d=b.anti?c:A.identity;b=h.normalizeMax(h.turnIntoCSList([h.matrix([[c(b.cr),d(b.ci),c(b.dr)],[b.ci,d(b.cr),b.di],[b.ar,c(d(b.ai)),b.br]]),h.matrix([[c(b.ci),c(d(b.cr)),c(b.di)],[c(b.cr),d(b.ci),c(b.dr)],[b.ai,d(b.ar),b.bi]])]));a.mat1=b.value[0];a.mat2=b.value[1]};t._helper.inverseMoebius=function(a){var b=n.neg,c=a.anti?b:A.identity;return{anti:a.anti,ar:a.dr,ai:c(a.di),
br:b(a.br),bi:b(c(a.bi)),cr:b(a.cr),ci:b(c(a.ci)),dr:a.ar,di:c(a.ai)}};t.TrInverseMoebius={};t.TrInverseMoebius.kind="Mt";t.TrInverseMoebius.signature=["Mt"];t.TrInverseMoebius.updatePosition=function(a){a.moebius=t._helper.inverseMoebius(H.csnames[a.args[0]].moebius);t._helper.moebiusPair(a)};t.TrMoebiusP={};t.TrMoebiusP.kind="P";t.TrMoebiusP.signature=["Mt","P"];t.TrMoebiusP.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]].homog,d=h.productMV(b.mat1,c);b=h.productMV(b.mat2,
c);a.homog=h.normalizeMax(h.cross(d,b));a.homog=A.withUsage(a.homog,"Point")};t._helper.TrMoebiusP=function(a,b){var c=h.productMV(b.mat1,a);a=h.productMV(b.mat2,a);return h.normalizeMax(h.cross(c,a))};t.TrMoebiusL={};t.TrMoebiusL.kind="C";t.TrMoebiusL.signature=["Mt","L"];t.TrMoebiusL.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]].homog,d=function(){var m=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-.5]);return h.normalizeMax(m)},f=h.cross(d(),c),k=
h.cross(d(),c);c=h.cross(d(),c);f=t._helper.TrMoebiusP(f,b);k=t._helper.TrMoebiusP(k,b);b=t._helper.TrMoebiusP(c,b);a.matrix=h.normalizeMax(t._helper.ConicBy5(null,f,k,b,h.ii,h.jj));a.matrix=A.withUsage(a.matrix,"Circle")};t.TrMoebiusS={};t.TrMoebiusS.kind="C";t.TrMoebiusS.signature=["Mt","S"];t.TrMoebiusS.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]],d=c.startpos;c=c.endpos;var f=h.add(d,c);d=t._helper.TrMoebiusP(d,b);f=t._helper.TrMoebiusP(f,b);b=t._helper.TrMoebiusP(c,
b);a.startPoint=d;a.viaPoint=f;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(t._helper.ConicBy5(null,d,f,b,h.ii,h.jj));a.matrix=A.withUsage(a.matrix,"Circle")};t.TrMoebiusC={};t.TrMoebiusC.kind="C";t.TrMoebiusC.signature=["Mt","C"];t.TrMoebiusC.signatureConstraints=function(a){return"Circle"===H.csnames[a.args[1]].matrix.usage};t.TrMoebiusC.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]].matrix,d=function(){var k=h.realVector([Math.random()-.5,Math.random()-.5,Math.random()-
.5]);return h.normalizeMax(k)},f=t._helper.IntersectLC(d(),c);d=t._helper.IntersectLC(d(),c);c=f[1];d=d[1];f=t._helper.TrMoebiusP(f[0],b);c=t._helper.TrMoebiusP(c,b);b=t._helper.TrMoebiusP(d,b);a.matrix=h.normalizeMax(t._helper.ConicBy5(null,f,c,b,h.ii,h.jj));a.matrix=A.withUsage(a.matrix,"Circle")};t.TrMoebiusArc={};t.TrMoebiusArc.kind="C";t.TrMoebiusArc.signature=["Mt","C"];t.TrMoebiusArc.signatureConstraints=function(a){return H.csnames[a.args[1]].isArc};t.TrMoebiusArc.updatePosition=function(a){var b=
H.csnames[a.args[0]],c=H.csnames[a.args[1]],d=c.viaPoint,f=c.endPoint;c=t._helper.TrMoebiusP(c.startPoint,b);d=t._helper.TrMoebiusP(d,b);b=t._helper.TrMoebiusP(f,b);a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(t._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=A.withUsage(a.matrix,"Circle")};t._helper.trBuildMatrix=function(a,b){var c=b(0);b=b(1);var d=h.productMM(b,h.adjoint3(c));a.matrix=h.normalizeMax(d);d=h.transpose(h.productMM(c,h.adjoint3(b)));a.dualMatrix=h.normalizeMax(d)};
t.TrProjection={};t.TrProjection.kind="Tr";t.TrProjection.signature="PPPPPPPP".split("");t.TrProjection.initialize=function(a){a.isEuclidean=0};t.TrProjection.updatePosition=function(a){t._helper.trBuildMatrix(a,function(b){return J.basismap(H.csnames[a.args[0+b]].homog,H.csnames[a.args[2+b]].homog,H.csnames[a.args[4+b]].homog,H.csnames[a.args[6+b]].homog)})};t.TrAffine={};t.TrAffine.kind="Tr";t.TrAffine.signature="PPPPPP".split("");t.TrAffine.initialize=function(a){a.isEuclidean=0};t.TrAffine.updatePosition=
function(a){var b=n.mult,c=h.scalmult,d=h.turnIntoCSList,f=h.transpose,k=h.normalizeMax,m=h.productMM,p=h.adjoint3,u=d([H.csnames[a.args[0]].homog,H.csnames[a.args[2]].homog,H.csnames[a.args[4]].homog]),w=d([H.csnames[a.args[1]].homog,H.csnames[a.args[3]].homog,H.csnames[a.args[5]].homog]),z=f(u);f=f(w);var D=z.value[2].value,F=f.value[2].value,K=[b(D[0],F[2]),b(D[1],F[0]),b(D[2],F[1])];z=p(z).value;a.matrix=k(m(f,d([c(b(K[0],F[1]),z[0]),c(b(K[1],F[2]),z[1]),c(b(K[2],F[0]),z[2])])));z=u.value;a.dualMatrix=
k(m(p(w),d([c(b(D[2],K[1]),z[0]),c(b(D[0],K[2]),z[1]),c(b(D[1],K[0]),z[2])])))};t.TrSimilarity={};t.TrSimilarity.kind="Tr";t.TrSimilarity.signature=["P","P","P","P"];t.TrSimilarity.initialize=function(a){a.isEuclidean=1};t.TrSimilarity.updatePosition=function(a){t._helper.trBuildMatrix(a,function(b){return J.basismap(H.csnames[a.args[0+b]].homog,H.csnames[a.args[2+b]].homog,h.ii,h.jj)})};t.TrTranslation={};t.TrTranslation.kind="Tr";t.TrTranslation.signature=["P","P"];t.TrTranslation.initialize=function(a){a.isEuclidean=
1};t.TrTranslation.updatePosition=function(a){var b=H.csnames[a.args[0]].homog,c=H.csnames[a.args[1]].homog,d=h.cross(b,c).value;b=n.mult(b.value[2],c.value[2]);c=h.turnIntoCSList;var f=n.neg,k=n.zero;d=c([c([b,k,d[1]]),c([k,b,f(d[0])]),c([k,k,b])]);d=h.normalizeMax(d);a.matrix=d;b=f(d.value[0].value[0]);d=c([c([b,k,k]),c([k,b,k]),c([d.value[0].value[2],d.value[1].value[2],b])]);a.dualMatrix=d};t.TrRotationPNumb={};t.TrRotationPNumb.kind="Tr";t.TrRotationPNumb.signature=["P","V"];t.TrRotationPNumb.updatePosition=
function(a){var b=H.csnames[a.args[0]].homog.value,c=H.csnames[a.args[1]].value,d=n.mult,f=n.add,k=n.sub,m=h.turnIntoCSList,p=h.normalizeMax,u=n.zero,w=b[0],z=b[1];b=b[2];var D=n.cos(c),F=n.sin(c),K=k(n.real(1),D);c=d(K,w);K=d(K,z);w=d(F,w);z=d(F,z);D=d(D,b);d=d(F,b);F=n.neg(d);a.matrix=p(m([m([D,F,f(c,z)]),m([d,D,k(K,w)]),m([u,u,b])]));a.dualMatrix=p(m([m([D,F,u]),m([d,D,u]),m([k(c,z),f(K,w),b])]))};t.TrReflectionP={};t.TrReflectionP.kind="Tr";t.TrReflectionP.signature=["P"];t.TrReflectionP.initialize=
function(a){a.isEuclidean=1};t.TrReflectionP.updatePosition=function(a){var b=H.csnames[a.args[0]].homog.value,c=n.realmult(-.5,b[2]),d=n.zero;b=h.turnIntoCSList([h.turnIntoCSList([c,d,b[0]]),h.turnIntoCSList([d,c,b[1]]),h.turnIntoCSList([d,d,n.neg(c)])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};t.TrReflectionL={};t.TrReflectionL.kind="Tr";t.TrReflectionL.signature=["L"];t.TrReflectionL.initialize=function(a){a.isEuclidean=-1};t.TrReflectionL.updatePosition=function(a){var b=n.mult,
c=n.realmult,d=n.zero,f=H.csnames[a.args[0]].homog.value,k=f[0],m=f[1];f=f[2];var p=b(k,k),u=b(m,m),w=c(-.5,n.sub(p,u)),z=b(k,m);b=h.turnIntoCSList([h.turnIntoCSList([n.neg(w),z,b(k,f)]),h.turnIntoCSList([z,w,b(m,f)]),h.turnIntoCSList([d,d,c(-.5,n.add(p,u))])]);b=h.normalizeMax(b);a.matrix=b;a.dualMatrix=h.transpose(b)};t.TrReflectionS={};t.TrReflectionS.kind="Tr";t.TrReflectionS.signature=["S"];t.TrReflectionS.updatePosition=t.TrReflectionL.updatePosition;t.TrReflectionC={};t.TrReflectionC.kind=
"Mt";t.TrReflectionC.signature=["C"];t.TrReflectionC.signatureConstraints=function(a){return"Circle"===H.csnames[a.args[0]].matrix.usage};t.TrReflectionC.updatePosition=function(a){var b=H.csnames[a.args[0]].matrix,c=b.value[0].value[2],d=b.value[1].value[2],f=n.neg;a.moebius={anti:!0,ar:c,ai:d,br:b.value[2].value[2],bi:n.zero,cr:f(b.value[0].value[0]),ci:n.zero,dr:f(c),di:d};t._helper.moebiusPair(a)};t.TrInverse={};t.TrInverse.kind="Tr";t.TrInverse.signature=["Tr"];t.TrInverse.initialize=function(a){a.isEuclidean=
H.csnames[a.args[0]].isEuclidean};t.TrInverse.updatePosition=function(a){var b=H.csnames[a.args[0]];a.dualMatrix=h.transpose(b.matrix);a.matrix=h.transpose(b.dualMatrix)};t.TransformC={};t.TransformC.kind="C";t.TransformC.signature=["Tr","C"];t.TransformC.updatePosition=function(a){var b=H.csnames[a.args[0]].dualMatrix;b=h.productMM(h.productMM(b,H.csnames[a.args[1]].matrix),h.transpose(b));b=h.normalizeMax(b);a.matrix=A.withUsage(b,"Conic")};t.TransformArc={};t.TransformArc.kind="C";t.TransformArc.signature=
["Tr","C"];t.TransformArc.signatureConstraints=function(a){return H.csnames[a.args[0]].isArc};t.TransformArc.updatePosition=function(a){var b=H.csnames[a.args[0]].matrix,c=H.csnames[a.args[1]],d=c.viaPoint,f=c.endPoint;c=h.normalizeMax(h.productMV(b,c.startPoint));d=h.normalizeMax(h.productMV(b,d));b=h.normalizeMax(h.productMV(b,f));a.startPoint=c;a.viaPoint=d;a.endPoint=b;a.isArc=!0;a.matrix=h.normalizeMax(t._helper.ConicBy5(null,c,d,b,h.ii,h.jj));a.matrix=A.withUsage(a.matrix,"Circle")};t.TransformP=
{};t.TransformP.kind="P";t.TransformP.signature=["Tr","P"];t.TransformP.updatePosition=function(a){a.homog=h.normalizeMax(h.productMV(H.csnames[a.args[0]].matrix,H.csnames[a.args[1]].homog));a.homog=A.withUsage(a.homog,"Point")};t.TransformL={};t.TransformL.kind="L";t.TransformL.signature=["Tr","L"];t.TransformL.updatePosition=function(a){a.homog=h.normalizeMax(h.productMV(H.csnames[a.args[0]].dualMatrix,H.csnames[a.args[1]].homog));a.homog=A.withUsage(a.homog,"Line")};t.TransformS={};t.TransformS.kind=
"S";t.TransformS.signature=["Tr","S"];t.TransformS.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]];t.Segment.setSegmentPos(a,h.productMV(b.dualMatrix,c.homog),h.productMV(b.matrix,c.startpos),h.productMV(b.matrix,c.endpos))};t.TransformPolygon={};t.TransformPolygon.kind="Poly";t.TransformPolygon.signature=["Tr","Poly"];t.TransformPolygon.updatePosition=function(a){var b=H.csnames[a.args[0]].matrix;a.vertices=h.turnIntoCSList(H.csnames[a.args[1]].vertices.value.map(function(c){c=
h.normalizeMax(h.productMV(b,c));return c=A.withUsage(c,"Point")}))};t.TrComposeTrTr={};t.TrComposeTrTr.kind="Tr";t.TrComposeTrTr.signature=["Tr","Tr"];t.TrComposeTrTr.initialize=function(a){a.isEuclidean=H.csnames[a.args[0]].isEuclidean*H.csnames[a.args[1]].isEuclidean};t.TrComposeTrTr.updatePosition=function(a){var b=H.csnames[a.args[0]],c=H.csnames[a.args[1]];a.matrix=h.normalizeMax(h.productMM(c.matrix,b.matrix));a.dualMatrix=h.normalizeMax(h.productMM(c.dualMatrix,b.dualMatrix))};t._helper.composeMtMt=
function(a,b,c){function d(D,F,K,V){return m(u(D,F),u(K,V))}function f(D,F,K,V,Q,da,W,na){return m(d(D,F,K,V),d(Q,da,W,na))}function k(D,F,K,V,Q,da,W,na){return p(d(D,F,K,V),d(Q,da,W,na))}var m=n.add,p=n.sub,u=n.mult,w=c.anti?k:f,z=c.anti?f:k;w=h.normalizeMax(h.turnIntoCSList([z(b.ar,c.ar,b.cr,c.br,b.ai,c.ai,b.ci,c.bi),w(b.ar,c.ai,b.cr,c.bi,b.ai,c.ar,b.ci,c.br),z(b.br,c.ar,b.dr,c.br,b.bi,c.ai,b.di,c.bi),w(b.br,c.ai,b.dr,c.bi,b.bi,c.ar,b.di,c.br),z(b.ar,c.cr,b.cr,c.dr,b.ai,c.ci,b.ci,c.di),w(b.ar,c.ci,
b.cr,c.di,b.ai,c.cr,b.ci,c.dr),z(b.br,c.cr,b.dr,c.dr,b.bi,c.ci,b.di,c.di),w(b.br,c.ci,b.dr,c.di,b.bi,c.cr,b.di,c.dr)])).value;a.moebius={anti:b.anti!==c.anti,ar:w[0],ai:w[1],br:w[2],bi:w[3],cr:w[4],ci:w[5],dr:w[6],di:w[7]};t._helper.moebiusPair(a)};t._helper.euc2moeb=function(a){var b=a.matrix.value;return{anti:0>a.isEuclidean,ar:b[0].value[0],ai:b[1].value[0],br:b[0].value[2],bi:b[1].value[2],cr:n.zero,ci:n.zero,dr:b[2].value[2],di:n.zero}};t.TrComposeMtMt={};t.TrComposeMtMt.kind="Mt";t.TrComposeMtMt.signature=
["Mt","Mt"];t.TrComposeMtMt.updatePosition=function(a){t._helper.composeMtMt(a,H.csnames[a.args[0]].moebius,H.csnames[a.args[1]].moebius)};t.TrComposeTrMt={};t.TrComposeTrMt.kind="Mt";t.TrComposeTrMt.signature=["Tr","Mt"];t.TrComposeTrMt.signatureConstraints=function(a){return!!H.csnames[a.args[0]].isEuclidean};t.TrComposeTrMt.updatePosition=function(a){t._helper.composeMtMt(a,t._helper.euc2moeb(H.csnames[a.args[0]]),H.csnames[a.args[1]].moebius)};t.TrComposeMtTr={};t.TrComposeMtTr.kind="Mt";t.TrComposeMtTr.signature=
["Mt","Tr"];t.TrComposeMtTr.signatureConstraints=function(a){return!!H.csnames[a.args[1]].isEuclidean};t.TrComposeMtTr.updatePosition=function(a){t._helper.composeMtMt(a,H.csnames[a.args[0]].moebius,t._helper.euc2moeb(H.csnames[a.args[1]]))};t._helper.pointReflection=function(a,b){return h.normalizeMax(h.sub(h.scalmult(n.realmult(2,b.value[2]),a),h.scalmult(a.value[2],b)))};t._helper.conicOtherIntersection=function(a,b,c){var d=h.productMV(a,c);a=h.scalproduct(c,d);d=h.scalproduct(b,d);d=n.realmult(-2,
d);b=h.scalmult(a,b);c=h.scalmult(d,c);c=h.add(b,c);return c=h.normalizeMax(c)};t.Dist={};t.Dist.kind="V";t.Dist.signature=["P","P"];t.Dist.updatePosition=function(a){var b=H.csnames[a.args[1]].homog;a.value=h.abs(h.sub(h.normalizeZ(H.csnames[a.args[0]].homog),h.normalizeZ(b)))};t.Angle={};t.Angle.kind="V";t.Angle.signature=["L","L","P"];t.Angle.initialize=function(a){void 0===a.angle&&(a.angle=.5*Math.PI);Bc(n._helper.input(a.angle))};t.Angle.updatePosition=function(a){var b=H.csnames[a.args[1]].homog,
c=H.csnames[a.args[2]].homog,d=h.cross(H.csnames[a.args[0]].homog,h.linfty);b=h.cross(b,h.linfty);c=h.crossratio3(d,b,h.ii,h.jj,c);c=n.mult(n.complex(0,.5),n.log(c));d=(id().value.real-c.value.real)/Math.PI;b=Math.round(d);!nd&&.01<Math.abs(b-d)&&vd();c=n.complex(b*Math.PI+c.value.real,c.value.imag);Bc(c);a.value=A.withUsage(c,"Angle")};t.Angle.stateSize=2;t.Text={};t.Text.kind="Text";t.Text.signature="**";t.Text.isMovable=!0;t.Text.updatePosition=dc;t.Text.initialize=function(a){a.text=String(a.text);
a.pos&&(a.homog=t._helper.initializePoint(a));a.dock&&(a.dock.offset=a.dock.offset&&2===a.dock.offset.length?h.realVector([+a.dock.offset[0],+a.dock.offset[1]]):h.realVector([0,0]))};t.Text.set_text=function(a,b){a.text=qa(b)};t.Text.getParamForInput=function(a,b,c){return t.Free.getParamForInput(a,b,c)};t.Text.getParamFromState=function(a){return a.homog};t.Text.putParamToState=function(a,b){a.homog=b};t.Calculation={};t.Calculation.kind="Text";t.Calculation.signature="**";t.Calculation.isMovable=
!0;t.Calculation.updatePosition=dc;t.Calculation.initialize=function(a){t.Text.initialize(a);a.calculation=zc(a.text)};t.Calculation.getText=function(a){return qa(M(a.calculation))};t.Calculation.getParamForInput=t.Text.getParamForInput;t.Calculation.getParamFromState=t.Text.getParamFromState;t.Calculation.putParamToState=t.Text.putParamToState;t.Equation={};t.Equation.kind="Text";t.Equation.isMovable=!0;t.Equation.signature="**";t.Equation.updatePosition=dc;t.Equation.initialize=function(a){t.Text.initialize(a);
a.calculation=zc(a.text)};t.Equation.getText=function(a){return a.text+" = "+qa(M(a.calculation))};t.Equation.getParamForInput=t.Text.getParamForInput;t.Equation.getParamFromState=t.Text.getParamFromState;t.Equation.putParamToState=t.Text.putParamToState;t.Evaluate={};t.Evaluate.kind="Text";t.Evaluate.isMovable=!0;t.Evaluate.signature="**";t.Evaluate.updatePosition=dc;t.Evaluate.initialize=function(a){t.Text.initialize(a);a.calculation=zc(a.text)};t.Evaluate.getText=function(a){M(a.calculation);return a.text};
t.Evaluate.getParamForInput=t.Text.getParamForInput;t.Evaluate.getParamFromState=t.Text.getParamFromState;t.Evaluate.putParamToState=t.Text.putParamToState;t.Plot={};t.Plot.kind="Text";t.Plot.isMovable=!0;t.Plot.signature="**";t.Plot.updatePosition=dc;t.Plot.initialize=function(a){t.Text.initialize(a);a.calculation=zc("plot(("+a.text+"))")};t.Plot.getText=function(a){M(a.calculation);return a.text};t.Plot.getParamForInput=t.Text.getParamForInput;t.Plot.getParamFromState=t.Text.getParamFromState;t.Plot.putParamToState=
t.Text.putParamToState;t.Button={};t.Button.kind="Text";t.Button.signature="**";t.Button.isMovable=!0;t.Button.updatePosition=dc;t.Button.initialize=function(a){var b=document.createElement("button");Td(a,"click",b)};t.Button.getParamForInput=t.Text.getParamForInput;t.Button.getParamFromState=t.Text.getParamFromState;t.Button.putParamToState=t.Text.putParamToState;t.Button.set_fillcolor=function(a,b){h._helper.isNumberVecN(b,3)&&(a.fillcolor=b.value.map(function(c){return c.value.real}),a.html.style.backgroundColor=
N.makeColor(a.fillcolor,a.fillalpha))};t.Button.set_color=function(a,b){h._helper.isNumberVecN(b,3)&&(a.color=b.value.map(function(c){return c.value.real}),a.html.style.color=N.makeColor(a.color,a.alpha))};t.ToggleButton={};t.ToggleButton.kind="Text";t.ToggleButton.signature="**";t.ToggleButton.isMovable=!0;t.ToggleButton.updatePosition=dc;t.ToggleButton.initialize=function(a){var b=void 0;void 0===b&&(b="CindyJSid");b+=++ea;var c=document.createElement("input"),d=document.createElement("label");
c.setAttribute("id",b);d.setAttribute("for",b);c.setAttribute("type","checkbox");a.pressed&&(c.checked=!0);a.checkbox=c;Td(a,"change",c,d)};t.ToggleButton.get_text=function(a){return A.string(String(a.text))};t.ToggleButton.set_currenttext=function(a,b){a.html.value=a.text=qa(b)};t.ToggleButton.getParamForInput=t.Text.getParamForInput;t.ToggleButton.getParamFromState=t.Text.getParamFromState;t.ToggleButton.putParamToState=t.Text.putParamToState;t.ToggleButton.set_fillcolor=t.Button.set_fillcolor;
t.ToggleButton.set_color=t.Button.set_color;t.ToggleButton.set_text=t.ToggleButton.set_currenttext;t.ToggleButton.get_val=t.ToggleButton.get_text;t.ToggleButton.set_val=t.ToggleButton.set_currenttext;t.EditableText={};t.EditableText.kind="Text";t.EditableText.isMovable=!0;t.EditableText.signature=[];t.EditableText.updatePosition=dc;t.EditableText.initialize=function(a){var b=document.createElement("input");b.setAttribute("type","text");b.className="CindyJS-editabletext";Xb(a.minwidth)&&(b.style.width=
a.minwidth-3+"px");"string"===typeof a.text&&(b.value=a.text);b.addEventListener("keydown",function(c){13===c.keyCode&&(a.text=a.html.value,b.blur())});b.addEventListener("change",function(c){a.text=a.html.value});Td(a,"change",b)};t.EditableText.getText=function(a){return!1};t.EditableText.getParamForInput=t.Text.getParamForInput;t.EditableText.getParamFromState=t.Text.getParamFromState;t.EditableText.putParamToState=t.Text.putParamToState;t.EditableText.set_fillcolor=t.Button.set_fillcolor;t.EditableText.set_color=
t.Button.set_color;t.EditableText.get_currenttext=function(a){return A.string(String(a.html.value))};t.EditableText.get_text=t.ToggleButton.get_text;t.EditableText.set_currenttext=t.ToggleButton.set_currenttext;t.EditableText.set_text=t.EditableText.set_currenttext;t.EditableText.get_val=t.EditableText.get_text;t.EditableText.set_val=t.EditableText.set_currenttext;t._helper.initializePoint=function(a){var b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;2===a.pos.length&&
(b=a.pos[0],c=a.pos[1],d=1);3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};t._helper.initializeLine=function(a){var b=0,c=0,d=0;if(a.pos){if("list"===a.pos.ctype&&h.isNumberVector(a.pos))return a.pos;3===a.pos.length&&(b=a.pos[0],c=a.pos[1],d=a.pos[2])}a=h.turnIntoCSList([n._helper.input(b),n._helper.input(c),n._helper.input(d)]);return a=h.normalizeMax(a)};t.Poly={};t.Poly.kind="Poly";
t.Poly.signature="P*";t.Poly.updatePosition=function(a){a.vertices=h.turnIntoCSList(a.args.map(function(b){return H.csnames[b].homog}))};var eb=null;t.IFS={};t.IFS.kind="IFS";t.IFS.signature="**";t.IFS.signatureConstraints=function(a){for(var b=0;b<a.args.length;++b){var c=H.csnames[a.args[b]].kind;if("Tr"!==c&&"Mt"!==c)return!1}return 0<a.args.length};t.IFS.initialize=function(a){if(eb)eb.dirty=!0;else if(a=Eb.getBaseDir(),!1!==a){eb={dirty:!1,params:{generation:0}};var b=eb.worker=new Worker(a+
"ifs.js");b.onmessage=function(c){eb.img&&"function"===typeof eb.img.close&&eb.img.close();if(!Ed){c=c.data;if(c.generation===eb.params.generation){if(c.buffer){eb.canvas||(eb.canvas=document.createElement("canvas"),eb.ctx=eb.canvas.getContext("2d"));eb.canvas.width=c.width;eb.canvas.height=c.height;var d=new Uint8ClampedArray(c.buffer,c.imgPtr,c.width*c.height*4);d=new ImageData(d,c.width,c.height);eb.ctx.putImageData(d,0,0);eb.img=eb.canvas}else eb.img=c.img;x()}else eb.img=null;c.buffer?b.postMessage({cmd:"next",
buffer:c.buffer},[c.buffer]):b.postMessage({cmd:"next"})}};Mc.push(b.terminate.bind(b))}};t.IFS.updatePosition=function(a){eb.dirty=!0};t.IFS.updateParameters=function(){if(eb.worker){var a={cmd:"init",generation:eb.params.generation,width:Math.round(4*hb),height:Math.round(4*jb)};a.systems=H.ifs.map(function(b){var c=0,d,f=b.ifs||[],k=b.args.map(function(D,F){D=f[F]||{};return{prob:D.prob||1,color:D.color||[0,0,0]}});for(d=0;d<k.length;++d)c+=k[d].prob;d=h.realMatrix([[1,0,0],[0,1,0],[0,0,4]]);var m=
h.productMM(P.toMat(),d);for(d=0;d<b.args.length;++d){var p=H.csnames[b.args[d]],u=p.kind,w=k[d];w.kind=u;w.prob/=c;if("Tr"===u)p=h.normalizeMax(h.productMM(h.adjoint3(m),h.productMM(p.matrix,m))),h._helper.isAlmostReal(p)?w.mat=p.value.map(function(D){return D.value.map(function(F){return F.value.real})}):w.kind="cplx";else if("Mt"===u){u=P.drawingstate.matrix;u={anti:0<u.det,ar:n.real(u.a),ai:n.real(u.c),br:n.real(u.tx),bi:n.real(-u.ty),cr:n.zero,ci:n.zero,dr:n.real(.25),di:n.zero};var z={};t._helper.composeMtMt(z,
p.moebius,u);u=t._helper.inverseMoebius(u);t._helper.composeMtMt(z,u,z.moebius);u=z.moebius;u=h.turnIntoCSList([u.ar,u.ai,u.br,u.bi,u.cr,u.ci,u.dr,u.di]);h._helper.isAlmostReal(u)?(u=u.value,w.moebius={ar:u[0].value.real,ai:u[1].value.real,br:u[2].value.real,bi:u[3].value.real,cr:u[4].value.real,ci:u[5].value.real,dr:u[6].value.real,di:u[7].value.real,sign:p.moebius.anti?-1:1}):w.kind="cplx"}}return{trafos:k}});A.deeplyEqual(a,eb.params)||(++a.generation,eb.img=null,eb.params=a,eb.mat=P.drawingstate.matrix,
eb.worker.postMessage(a))}};t.IFS.probSetter=function(a,b,c){"number"===c.ctype&&(b.ifs[a].prob=c.value.real,eb.dirty=!0)};(function(){for(var a=0;10>a;++a)t.IFS["set_prob"+a]=t.IFS.probSetter.bind(null,a)})();t._helper.snapPointToLine=function(a,b){if(n._helper.isAlmostZero(a.value[2]))return a;var c=t._helper.projectPointToLine(a,b);c=h.normalizeZ(c);var d=c.value[0].value.real;c=c.value[1].value.real;var f=Math.round(d/Ub)*Ub,k=Math.round(c/Ub)*Ub,m=h.realVector([f,k,1]);Math.abs(f-d)<Vc&&Math.abs(k-
c)<Vc&&n._helper.isAlmostZero(h.scalproduct(b,m))&&(a=t._helper.projectPointToLine(m,b));return a};var de={CircleByRadius:"CircleMr",IntersectionCircleCircle:"IntersectCirCir",IntersectionConicConic:"IntersectConicConic",FreePoint:"Free",Orthogonal:"Perp",Parallel:"Para",Pole:"PolarOfLine",Polar:"PolarOfPoint",Arc:"ArcBy3",EuclideanMid:"Mid",AngularBisector:"AngleBisector",TransformConic:"TransformC",TransformSegment:"TransformS",TrMoebiusSegment:"TrMoebiusS",ReflectCC:"TrMoebiusC",ReflectCL:"TrMoebiusL",
ReflectCP:"TrMoebiusP",ReflectCArc:"TrMoebiusArc",ReflectCS:"TrMoebiusS",TrMoebiusCircle:"TrMoebiusC"},wf={CircleMFixedr:function(a){a.pinned=!0;a.type="CircleMr";return[a]},CircleByFixedRadius:function(a){a.pinned=!0;a.type="CircleMr";return[a]},IntersectionConicLine:function(a){a.args=[a.args[1],a.args[0]];a.type="IntersectLC";return[a]},angleBisector:function(a){var b={name:a.name+"_Intersection",type:"Meet",args:a.args,visible:!1};a.type="AngleBisector";a.args=[a.args[0],a.args[1],b.name];return[b,
a]},Transform:function(a){var b=H.csnames[a.args[1]];b={Tr:"Transform",Mt:"TrMoebius"}[H.csnames[a.args[0]].kind]+(b.isArc?"Arc":b.kind);if(t.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrReflection:function(a){var b="TrReflection"+H.csnames[a.args[0]].kind;if(t.hasOwnProperty(b))return a.type=b,[a];console.log(b+" not implemented yet");return[]},TrCompose:function(a){var b="TrCompose"+a.args.map(function(c){return H.csnames[c].kind}).join("");if(t.hasOwnProperty(b))return a.type=
b,[a];console.log(b+" not implemented yet");return[]}},If="align alpha angle args arrow arrowposition arrowshape arrowsides arrowsize clip color dashtype drawtrace fillalpha fillcolor filled labeled labelpos name overhang pinned printname radius size text text_fontfamily textbold textitalics textsize tracedim tracelength traceskip tracing type visible".split(" ");Jb.saveState=function(){return{geometry:nf()}};var $b={};var Jf=[[],[.2],[.075,.225],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/
6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]];var ff=[0,.2,.3,.8,8/9,1,1];var Kf=[35/384,0,500/1113,125/192,-2187/6784,11/84,0];var Lf=[5179/57600,0,7571/16695,.6140625,-92097/339200,187/2100,.025];var qc,Kb=[],zf=[],uf=!1;$b.tick=function(a){a/=Wd;for(var b=0;b<Wd;b++)$b.tick1(a),jd+=a,M(Na.simulationstep)};$b.tick1=function(a){for(var b=a,c=0;0<a&&c<.999*a||0>a&&c>.999*a;)b=$b.oneRKStep(b),c+=b,b=Math.min(2*b,a-c),b=Math.max(b,1E-16),
$b.restorePosition(),$b.doCollisions(),$b.calculateForces(),$b.moveToFinalPos();return!0};$b.restorePosition=function(){qc.forEach(function(a){Qa[a.type].restorePos(a,9)})};$b.doCollisions=function(){qc.forEach(function(a){Qa[a.type].doCollisions(a)})};$b.calculateForces=function(){qc.forEach(function(a){Qa[a.type].calculateForces(a)})};$b.moveToFinalPos=function(){qc.forEach(function(a){Qa[a.type].move(a)})};$b.oneRKStep=function(a){for(var b=function(z){qc.forEach(function(D){Qa[D.type].initRK(D,
z);Qa[D.type].storePosition(D)})},c=function(z){qc.forEach(function(D){Qa[D.type].setToTimestep(D,ff[z])})},d=function(z){qc.forEach(function(D){Qa[D.type].proceedMotion(D,ff[z],z,Jf[z])})},f=function(){qc.forEach(function(z){Qa[z.type].resetForces(z)})},k=function(z){qc.forEach(function(D){Qa[D.type].calculateDelta(D,z)})},m=function(z){var D=0;qc.forEach(function(F){Qa[F.type].proceedMotion(F,ff[6],7,Kf);Qa[F.type].savePos(F,8);Qa[F.type].proceedMotion(F,ff[6],7,Lf);Qa[F.type].savePos(F,9);D+=Qa[F.type].sqDist(F,
8,9)});return D=Math.sqrt(D)/a},p=function(z){qc.forEach(function(D){Qa[D.type].recallPosition(D)})},u=!1;!u;){b(a);for(var w=0;7>w;w++)c(w),d(w),f(),$b.calculateForces(),k(w);m(a)>Qa.env.errorbound&&a>Qa.env.lowestdeltat?(a/=Qa.env.slowdownfactor,p()):u=!0}return a};var Qa={Mass:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=1);"undefined"===typeof a.charge&&(a.charge=0);"undefined"===typeof a.friction&&(a.friction=0);a.lnfrict=0;"undefined"===typeof a.limitspeed&&
(a.limitspeed=!1);"undefined"===typeof a.fixed&&(a.fixed=!1);"undefined"===typeof a.radius&&(a.radius=1);a.internalmove=!1;a.fx=0;a.fy=0;a.fz=0;a.vx=a.vx||0;a.vy=a.vy||0;a.vz=a.vz||0;a.mtype=0;a.env=Qa.env;a.deltat=0;a.mx=0;a.my=0;a.mz=0;a.mvx=0;a.mvy=0;a.mvz=0;a.dx=[0,0,0,0,0,0,0,0,0,0];a.dy=[0,0,0,0,0,0,0,0,0,0];a.dz=[0,0,0,0,0,0,0,0,0,0];a.dvx=[0,0,0,0,0,0,0,0,0,0];a.dvy=[0,0,0,0,0,0,0,0,0,0];a.dvz=[0,0,0,0,0,0,0,0,0,0];a.midx=0;a.midy=0;a.midz=0;a.lx=0;a.ly=0;a.lz=0},resetForces:function(a){a.fx=
0;a.fy=0;a.fz=0},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){var c=J.extractPoint(a.el.homog);a.x=c.x;a.y=c.y;a.z=0;a.xo=a.x;a.yo=a.y;a.zo=a.z;a.vxo=a.vx;a.vyo=a.vy;a.vzo=a.vz;a.deltat=b;a.fx=0;a.fy=0;a.fz=0},setVelocity:function(a,b,c,d){d||(d=0);a.vx=b;a.vy=c;a.vz=d},move:function(a){a.pos=[a.x,a.y,1];a.internalmove=!0;sb&&Sa.down&&a.el===sb.mover||Tb(a.el,h.realVector(a.pos),"homog");a.el.sx=a.x;a.el.sy=a.y;a.internalmove=!1},proceedMotion:function(a,b,c,d){if(!a.fixed)for(a.x=
a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz,b=0;b<c;b++)a.x+=d[b]*a.dx[b]*a.deltat,a.y+=d[b]*a.dy[b]*a.deltat,a.z+=d[b]*a.dz[b]*a.deltat,a.vx+=d[b]*a.dvx[b]*a.deltat,a.vy+=d[b]*a.dvy[b]*a.deltat,a.vz+=d[b]*a.dvz[b]*a.deltat},calculateForces:function(a){var b=Math.sqrt(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz);a.lnfrict=-Math.log((1-a.friction)*(1-a.env.friction)*(.1<b&&a.limitSpeed?.1/b:1));a.fx+=-a.vx*a.lnfrict*a.mass;a.fy+=-a.vy*a.lnfrict*a.mass;a.fz+=-a.vz*a.lnfrict*a.mass},calculateDelta:function(a,
b){a.dx[b]=a.vx;a.dy[b]=a.vy;a.dz[b]=a.vz;a.dvx[b]=a.fx/a.mass;a.dvy[b]=a.fy/a.mass;a.dvz[b]=a.fz/a.mass},savePos:function(a,b){a.dx[b]=a.x;a.dy[b]=a.y;a.dz[b]=a.z;a.dvx[b]=a.vx;a.dvy[b]=a.vy;a.dvz[b]=a.vz},restorePos:function(a,b){a.fixed||(a.x=a.dx[b],a.y=a.dy[b],a.z=a.dz[b],a.vx=a.dvx[b],a.vy=a.dvy[b],a.vz=a.dvz[b])},sqDist:function(a,b,c){var d=(a.dx[b]-a.dx[c])*(a.dx[b]-a.dx[c]);d+=(a.dy[b]-a.dy[c])*(a.dy[b]-a.dy[c]);d+=(a.dz[b]-a.dz[c])*(a.dz[b]-a.dz[c]);d+=(a.dvx[b]-a.dvx[c])*(a.dvx[b]-a.dvx[c]);
d+=(a.dvy[b]-a.dvy[c])*(a.dvy[b]-a.dvy[c]);return d+=(a.dvz[b]-a.dvz[c])*(a.dvz[b]-a.dvz[c])},kineticEnergy:function(a){return.5*a.mass*(a.vx*a.vx+a.vy*a.vy+a.vz*a.vz)},storePosition:function(a){a.mx=a.x;a.my=a.y;a.mz=a.z;a.mvx=a.vx;a.mvy=a.vy;a.mvz=a.vz},recallPosition:function(a){a.fixed||(a.x=a.mx,a.y=a.my,a.z=a.mz,a.vx=a.mvx,a.vy=a.mvy,a.vz=a.mvz)},doCollisions:function(a){}},Sun:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.mass&&(a.mass=10);"undefined"===typeof a.friction&&
(a.friction=0);a.charge=0;a.x=0;a.y=0;a.z=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){b=J.extractPoint(a.el.homog);a.x=b.x;a.y=b.y;a.z=0},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){for(var b=a.x,c=a.y,d=a.z,f=$jscomp.makeIterator(Kb),k=f.next();!k.done;k=f.next()){k=k.value;var m=k.behavior.x,p=k.behavior.y,u=k.behavior.z,w=Math.sqrt((b-m)*(b-m)+(c-
p)*(c-p)+(d-u)*(d-u));p=(c-p)*a.mass*k.behavior.mass/(w*w*w);u=(d-u)*a.mass*k.behavior.mass/(w*w*w);k.behavior.fx+=(b-m)*a.mass*k.behavior.mass/(w*w*w)*k.behavior.mass;k.behavior.fy+=p*k.behavior.mass;k.behavior.fz+=u*k.behavior.mass}},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Velocity:{reset:function(a){var b=H.csnames[a.geo[1]];console.log(b);
var c=J.extractPoint(b.homog);a=J.extractPoint(H.csnames[a.geo[2]].homog);b=b.behavior;Qa[b.type].setVelocity(b,a.x-c.x,a.y-c.y,0)},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){var b=H.csnames[a.geo[2]];if(!sb||!Sa.down||b!==sb.mover){var c=H.csnames[a.geo[1]];a=J.extractPoint(c.homog);c=c.behavior;a=h.realVector([a.x+c.vx,a.y+c.vy,1]);Tb(b,a,"homog")}},proceedMotion:function(a,b,c,d){},calculateForces:function(a){},
calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Gravity:{reset:function(a,b){a.vel=[0,0,0];a.pos=[0,0,0,0];a.el=b;"undefined"===typeof a.strength&&(a.strength=1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=H.csnames[a.namea];a.mb=H.csnames[a.nameb]},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,
b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateDelta:function(a,b){},calculateForces:function(a){var b=J.extractPoint(a.ma.homog),c=J.extractPoint(a.mb.homog),d=(c.x-b.x)*a.strength;a=(c.y-b.y)*a.strength;b=$jscomp.makeIterator(Kb);for(c=b.next();!c.done;c=b.next())c=c.value,c.behavior.fx+=d*c.behavior.mass,c.behavior.fy+=a*c.behavior.mass,c.behavior.fz+=0*c.behavior.mass},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},
kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},Spring:{reset:function(a,b){a.el=b;"undefined"===typeof a.strength&&(a.strength=1);"undefined"===typeof a.amplitude&&(a.amplitude=0);"undefined"===typeof a.phase&&(a.phase=0);"undefined"===typeof a.speed&&(a.speed=1);"undefined"===typeof a.l0&&(a.l0=0);"undefined"===typeof a.stype&&(a.stype=1);"undefined"===typeof a.readOnInit&&(a.readOnInit=!1);a.namea=b.args[0];a.nameb=b.args[1];a.ma=
H.csnames[a.namea];a.mb=H.csnames[a.nameb];b=J.extractPoint(a.ma.homog);var c=J.extractPoint(a.mb.homog);a.l0=Math.sqrt((b.x-c.x)*(b.x-c.x)+(b.y-c.y)*(b.y-c.y));a.env=Qa.env;a.ldiff=0},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){if(!a.ma.behavior||sb&&Sa.down&&a.ma===sb.mover){var b=J.extractPoint(a.ma.homog);var c=b.x;var d=b.y}else c=a.ma.behavior.x,
d=a.ma.behavior.y;if(!a.mb.behavior||sb&&Sa.down&&a.mb===sb.mover){var f=J.extractPoint(a.mb.homog);b=f.x;f=f.y}else b=a.mb.behavior.x,f=a.mb.behavior.y;var k=Math.sqrt((c-b)*(c-b)+(d-f)*(d-f)),m=a.l0;a.ldiff=k-m;var p=a.stype;1===p&&(m=0);var u=0;if(2===p||3===p)u=a.ma.behavior.mass*a.mb.behavior.mass*a.strength;2===p&&(u=-u);if(0===k||0!==p&&1!==p)if(a.ma.behavior&&a.mb.behavior&&0!==k){if(k*=k*k,2===p||3===p){var w=(c-b)*u/k;var z=(d-f)*u/k}}else w=z=0;else w=-(c-b)*a.strength*(k-m)/k*a.env.springstrength,
z=-(d-f)*a.strength*(k-m)/k*a.env.springstrength;a.ma.behavior&&(a.ma.behavior.fx+=w,a.ma.behavior.fy+=z);a.mb.behavior&&(a.mb.behavior.fx-=w,a.mb.behavior.fy-=z)},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}},det:function(a,b,c,d,f,k){return c*k-f*d+f*b-a*k+a*d-c*b},Bouncer:{reset:function(a,b){a.el=b;"undefined"===typeof a.xdamp&&
(a.xdamp=0);"undefined"===typeof a.ydamp&&(a.ydamp=0);"undefined"===typeof a.motorchanger&&(a.motorchanger=!0);a.namea=b.args[0];a.nameb=b.args[1];a.ma=H.csnames[a.namea];a.mb=H.csnames[a.nameb];b=J.extractPoint(a.ma.homog);var c=J.extractPoint(a.mb.homog);a.x1o=1.01*b.x-.01*c.x;a.y1o=1.01*b.y-.01*c.y;a.x2o=1.01*c.x-.01*b.x;a.y2o=1.01*c.y-.01*b.y;a.env=Qa.env},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,b){a.deltat=b},setVelocity:function(a,b,c,d){},move:function(a){},
proceedMotion:function(a,b,c,d){},calculateForces:function(a){},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){var b=J.extractPoint(a.ma.homog),c=J.extractPoint(a.mb.homog),d=b.x;b=b.y;var f=c.x;c=c.y;var k=a.x1o,m=a.y1o,p=a.x2o,u=a.y2o,w=Math.sqrt((d-f)*(d-f)+(b-c)*(b-c)),z=(d-f)/w;w=(b-c)/w;for(var D=$jscomp.makeIterator(Kb),
F=D.next();!F.done;F=D.next()){F=F.value;var K=F.behavior.xo,V=F.behavior.yo,Q=F.behavior.x,da=F.behavior.y,W=n.mult(n.complex(k,m),n.complex(f,c)),na=n.mult(n.complex(p,u),n.complex(d,b));W=n.sub(W,na);na=n.mult(n.complex(K,V),n.complex(d,b));W=n.add(W,na);na=n.mult(n.complex(K,V),n.complex(f,c));W=n.sub(W,na);na=n.sub(n.complex(k,m),n.complex(p,u));W=n.div(W,na);0>Qa.det(d,b,f,c,Q,da)*Qa.det(d,b,f,c,W.value.real,W.value.imag)&&0>Qa.det(d,b,Q,da,W.value.real,W.value.imag)*Qa.det(f,c,Q,da,W.value.real,
W.value.imag)&&(V=F.behavior.mvx+a.deltat*(-W.value.real+F.behavior.xo),Q=F.behavior.mvy+a.deltat*(-W.value.imag+F.behavior.yo),K=z*V+w*Q,V=w*V-z*Q,F.behavior.x=W.value.real,F.behavior.y=W.value.imag,F.behavior.vx=z*K*(1-a.xdamp),F.behavior.vy=w*K*(1-a.xdamp),F.behavior.vx+=-w*V*(1-a.ydamp),F.behavior.vy+=z*V*(1-a.ydamp))}a.x1o=d;a.y1o=b;a.x2o=f;a.y2o=c}},Environment:{init:function(a){"undefined"===typeof a.gravity&&(a.gravity=0);"undefined"===typeof a.friction&&(a.friction=0);"undefined"===typeof a.springstrength&&
(a.springstrength=1);"undefined"!==typeof a.accuracy&&(Wd=a.accuracy);"undefined"!==typeof a.deltat&&$a(a.deltat/.6);"undefined"===typeof a.charges&&(a.charges=!1);"undefined"===typeof a.balls&&(a.balls=!1);"undefined"===typeof a.newton&&(a.newton=!1);"undefined"===typeof a.ballInteractionBoosting&&(a.ballInteractionBoosting=1);Qa.env=a;a.errorbound=.001;a.lowestdeltat=1E-7;a.slowdownfactor=2},reset:function(a){},resetForces:function(a){},getBlock:!1,setToTimestep:function(a,b,c){},initRK:function(a,
b){},setVelocity:function(a,b,c,d){},move:function(a){},proceedMotion:function(a,b,c,d){},calculateForces:function(a){var b,c;if(a.newton)for(b=0;b<Kb.length-1;b++){var d=Kb[b];var f=d.behavior.x;var k=d.behavior.y;for(c=b+1;c<Kb.length;c++){var m=Kb[c];var p=m.behavior.x;var u=m.behavior.y;var w=Math.sqrt((f-p)*(f-p)+(k-u)*(k-u));p=(f-p)*d.behavior.mass*m.behavior.mass/(w*w*w);u=(k-u)*d.behavior.mass*m.behavior.mass/(w*w*w);d.behavior.fx-=p;d.behavior.fy-=u;m.behavior.fx+=p;m.behavior.fy+=u}}if(a.charges)for(b=
0;b<Kb.length-1;b++)for(d=Kb[b],f=d.behavior.x,k=d.behavior.y,c=b+1;c<Kb.length;c++)m=Kb[c],p=m.behavior.x,u=m.behavior.y,w=Math.sqrt((f-p)*(f-p)+(k-u)*(k-u)),p=(f-p)*d.behavior.charge*m.behavior.charge/(w*w*w),u=(k-u)*d.behavior.charge*m.behavior.charge/(w*w*w),d.behavior.fx+=p,d.behavior.fy+=u,m.behavior.fx-=p,m.behavior.fy-=u;if(a.balls)for(b=0;b<Kb.length-1;b++)if(d=Kb[b],0!==d.behavior.radius)for(f=d.behavior.x,k=d.behavior.y,c=b+1;c<Kb.length;c++)if(m=Kb[c],0!==m.behavior.radius){p=m.behavior.x;
u=m.behavior.y;var z=d.behavior.radius+m.behavior.radius;w=Math.sqrt((f-p)*(f-p)+(k-u)*(k-u));0===a.ballInteractionBoosting?(p=(f-p)/(w*w*w)*(w>z?0:(w-z)*(w-z)),u=(k-u)/(w*w*w)*(w>z?0:(w-z)*(w-z))):1===a.ballInteractionBoosting?(p=(f-p)/(w*w*w*w)*(w>z?0:(w-z)*(w-z)),u=(k-u)/(w*w*w*w)*(w>z?0:(w-z)*(w-z))):(p=(f-p)/(w*w*w*w*w)*(w>z?0:(w-z)*(w-z)),u=(k-u)/(w*w*w*w*w)*(w>z?0:(w-z)*(w-z)));d.behavior.fx+=p;d.behavior.fy+=u;m.behavior.fx-=p;m.behavior.fy-=u}for(b=0;b<Kb.length;b++)d=Kb[b],d.behavior.fx+=
0,d.behavior.fy+=-a.gravity*d.behavior.mass,d.behavior.fz+=0},calculateDelta:function(a,b){},savePos:function(a,b){},restorePos:function(a,b){},sqDist:function(a,b,c){return 0},kineticEnergy:function(a){},storePosition:function(a){},recallPosition:function(a){},doCollisions:function(a){}}};return Jb};return I}(),createCindy=CindyJS;"undefined"!==typeof process&&"undefined"!==typeof module&&"undefined"!==typeof module.exports&&"undefined"===typeof window&&(module.exports=CindyJS);
//# sourceMappingURL=Cindy.js.map

